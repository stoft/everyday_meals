var Nv=Object.create;var vm=Object.defineProperty;var Lv=Object.getOwnPropertyDescriptor;var Fv=Object.getOwnPropertyNames;var Bv=Object.getPrototypeOf,jv=Object.prototype.hasOwnProperty;var Kv=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Uv=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Fv(t))!jv.call(e,i)&&i!==r&&vm(e,i,{get:()=>t[i],enumerable:!(n=Lv(t,i))||n.enumerable});return e};var zv=(e,t,r)=>(r=e!=null?Nv(Bv(e)):{},Uv(t||!e||!e.__esModule?vm(r,"default",{value:e,enumerable:!0}):r,e));var Vy=Kv((yp,xp)=>{(function(e,t){typeof yp=="object"&&typeof xp<"u"?xp.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.Dexie=t())})(yp,function(){"use strict";var e=function(o,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,c){u.__proto__=c}||function(u,c){for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(u[p]=c[p])},e(o,s)};function t(o,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");e(o,s);function u(){this.constructor=o}o.prototype=s===null?Object.create(s):(u.prototype=s.prototype,new u)}var r=function(){return r=Object.assign||function(s){for(var u,c=1,p=arguments.length;c<p;c++){u=arguments[c];for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(s[d]=u[d])}return s},r.apply(this,arguments)};function n(o,s,u){if(u||arguments.length===2)for(var c=0,p=s.length,d;c<p;c++)(d||!(c in s))&&(d||(d=Array.prototype.slice.call(s,0,c)),d[c]=s[c]);return o.concat(d||Array.prototype.slice.call(s))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,a=Object.keys,l=Array.isArray;typeof Promise<"u"&&!i.Promise&&(i.Promise=Promise);function f(o,s){return typeof s!="object"||a(s).forEach(function(u){o[u]=s[u]}),o}var m=Object.getPrototypeOf,h={}.hasOwnProperty;function g(o,s){return h.call(o,s)}function v(o,s){typeof s=="function"&&(s=s(m(o))),(typeof Reflect>"u"?a:Reflect.ownKeys)(s).forEach(function(u){E(o,u,s[u])})}var O=Object.defineProperty;function E(o,s,u,c){O(o,s,f(u&&g(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},c))}function T(o){return{from:function(s){return o.prototype=Object.create(s.prototype),E(o.prototype,"constructor",o),{extend:v.bind(null,o.prototype)}}}}var C=Object.getOwnPropertyDescriptor;function G(o,s){var u=C(o,s),c;return u||(c=m(o))&&G(c,s)}var X=[].slice;function Q(o,s,u){return X.call(o,s,u)}function K(o,s){return s(o)}function ne(o){if(!o)throw new Error("Assertion Failed")}function Z(o){i.setImmediate?setImmediate(o):setTimeout(o,0)}function fe(o,s){return o.reduce(function(u,c,p){var d=s(c,p);return d&&(u[d[0]]=d[1]),u},{})}function le(o,s){if(typeof s=="string"&&g(o,s))return o[s];if(!s)return o;if(typeof s!="string"){for(var u=[],c=0,p=s.length;c<p;++c){var d=le(o,s[c]);u.push(d)}return u}var _=s.indexOf(".");if(_!==-1){var y=o[s.substr(0,_)];return y==null?void 0:le(y,s.substr(_+1))}}function pe(o,s,u){if(!(!o||s===void 0)&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof s!="string"&&"length"in s){ne(typeof u!="string"&&"length"in u);for(var c=0,p=s.length;c<p;++c)pe(o,s[c],u[c])}else{var d=s.indexOf(".");if(d!==-1){var _=s.substr(0,d),y=s.substr(d+1);if(y==="")u===void 0?l(o)&&!isNaN(parseInt(_))?o.splice(_,1):delete o[_]:o[_]=u;else{var x=o[_];(!x||!g(o,_))&&(x=o[_]={}),pe(x,y,u)}}else u===void 0?l(o)&&!isNaN(parseInt(s))?o.splice(s,1):delete o[s]:o[s]=u}}function ze(o,s){typeof s=="string"?pe(o,s,void 0):"length"in s&&[].map.call(s,function(u){pe(o,u,void 0)})}function Ot(o){var s={};for(var u in o)g(o,u)&&(s[u]=o[u]);return s}var pn=[].concat;function Zt(o){return pn.apply([],o)}var nt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Zt([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(s){return s+o+"Array"})}))).filter(function(o){return i[o]}),Zi=new Set(nt.map(function(o){return i[o]}));function _s(o){var s={};for(var u in o)if(g(o,u)){var c=o[u];s[u]=!c||typeof c!="object"||Zi.has(c.constructor)?c:_s(c)}return s}function fl(o){for(var s in o)if(g(o,s))return!1;return!0}var mn=null;function St(o){mn=new WeakMap;var s=jr(o);return mn=null,s}function jr(o){if(!o||typeof o!="object")return o;var s=mn.get(o);if(s)return s;if(l(o)){s=[],mn.set(o,s);for(var u=0,c=o.length;u<c;++u)s.push(jr(o[u]))}else if(Zi.has(o.constructor))s=o;else{var p=m(o);s=p===Object.prototype?{}:Object.create(p),mn.set(o,s);for(var d in o)g(o,d)&&(s[d]=jr(o[d]))}return s}var eo={}.toString;function Kr(o){return eo.call(o).slice(8,-1)}var to=typeof Symbol<"u"?Symbol.iterator:"@@iterator",it=typeof to=="symbol"?function(o){var s;return o!=null&&(s=o[to])&&s.apply(o)}:function(){return null};function Be(o,s){var u=o.indexOf(s);return u>=0&&o.splice(u,1),u>=0}var jt={};function Kt(o){var s,u,c,p;if(arguments.length===1){if(l(o))return o.slice();if(this===jt&&typeof o=="string")return[o];if(p=it(o)){for(u=[];c=p.next(),!c.done;)u.push(c.value);return u}if(o==null)return[o];if(s=o.length,typeof s=="number"){for(u=new Array(s);s--;)u[s]=o[s];return u}return[o]}for(s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return u}var pl=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},lx=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Rp=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ml=lx.concat(Rp),cx={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ti(o,s){this.name=o,this.message=s}T(ti).from(Error).extend({toString:function(){return this.name+": "+this.message}});function Np(o,s){return o+". Errors: "+Object.keys(s).map(function(u){return s[u].toString()}).filter(function(u,c,p){return p.indexOf(u)===c}).join(`
`)}function gs(o,s,u,c){this.failures=s,this.failedKeys=c,this.successCount=u,this.message=Np(o,s)}T(gs).from(ti);function ri(o,s){this.name="BulkError",this.failures=Object.keys(s).map(function(u){return s[u]}),this.failuresByPos=s,this.message=Np(o,this.failures)}T(ri).from(ti);var dl=ml.reduce(function(o,s){return o[s]=s+"Error",o},{}),fx=ti,ie=ml.reduce(function(o,s){var u=s+"Error";function c(p,d){this.name=u,p?typeof p=="string"?(this.message="".concat(p).concat(d?`
 `+d:""),this.inner=d||null):typeof p=="object"&&(this.message="".concat(p.name," ").concat(p.message),this.inner=p):(this.message=cx[s]||u,this.inner=null)}return T(c).from(fx),o[s]=c,o},{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var Lp=Rp.reduce(function(o,s){return o[s+"Error"]=ie[s],o},{});function px(o,s){if(!o||o instanceof ti||o instanceof TypeError||o instanceof SyntaxError||!o.name||!Lp[o.name])return o;var u=new Lp[o.name](s||o.message,o);return"stack"in o&&E(u,"stack",{get:function(){return this.inner.stack}}),u}var ys=ml.reduce(function(o,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(o[s+"Error"]=ie[s]),o},{});ys.ModifyError=gs,ys.DexieError=ti,ys.BulkError=ri;function Ae(){}function ro(o){return o}function mx(o,s){return o==null||o===ro?s:function(u){return s(o(u))}}function dn(o,s){return function(){o.apply(this,arguments),s.apply(this,arguments)}}function dx(o,s){return o===Ae?s:function(){var u=o.apply(this,arguments);u!==void 0&&(arguments[0]=u);var c=this.onsuccess,p=this.onerror;this.onsuccess=null,this.onerror=null;var d=s.apply(this,arguments);return c&&(this.onsuccess=this.onsuccess?dn(c,this.onsuccess):c),p&&(this.onerror=this.onerror?dn(p,this.onerror):p),d!==void 0?d:u}}function hx(o,s){return o===Ae?s:function(){o.apply(this,arguments);var u=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?dn(u,this.onsuccess):u),c&&(this.onerror=this.onerror?dn(c,this.onerror):c)}}function _x(o,s){return o===Ae?s:function(u){var c=o.apply(this,arguments);f(u,c);var p=this.onsuccess,d=this.onerror;this.onsuccess=null,this.onerror=null;var _=s.apply(this,arguments);return p&&(this.onsuccess=this.onsuccess?dn(p,this.onsuccess):p),d&&(this.onerror=this.onerror?dn(d,this.onerror):d),c===void 0?_===void 0?void 0:_:f(c,_)}}function gx(o,s){return o===Ae?s:function(){return s.apply(this,arguments)===!1?!1:o.apply(this,arguments)}}function hl(o,s){return o===Ae?s:function(){var u=o.apply(this,arguments);if(u&&typeof u.then=="function"){for(var c=this,p=arguments.length,d=new Array(p);p--;)d[p]=arguments[p];return u.then(function(){return s.apply(c,d)})}return s.apply(this,arguments)}}var er=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Fp(o,s){er=o}var no={},Bp=100,_l=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,m(o),o];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,m(s),o]}(),jp=_l[0],Kp=_l[1],yx=_l[2],xx=Kp&&Kp.then,hn=jp&&jp.constructor,gl=!!yx;function vx(){queueMicrotask($x)}var io=function(o,s){oo.push([o,s]),xs&&(vx(),xs=!1)},yl=!0,xs=!0,_n=[],vs=[],xl=ro,Ur={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ae,pgp:!1,env:{},finalize:Ae},ee=Ur,oo=[],gn=0,ws=[];function q(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=ee;if(typeof o!="function"){if(o!==no)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&wl(this,this._value);return}this._state=null,this._value=null,++s.ref,zp(this,o)}var vl={get:function(){var o=ee,s=Os;function u(c,p){var d=this,_=!o.global&&(o!==ee||s!==Os),y=_&&!Wr(),x=new q(function(w,S){$l(d,new Up(Vp(c,o,_,y),Vp(p,o,_,y),w,S,o))});return this._consoleTask&&(x._consoleTask=this._consoleTask),x}return u.prototype=no,u},set:function(o){E(this,"then",o&&o.prototype===no?vl:{get:function(){return o},set:vl.set})}};v(q.prototype,{then:vl,_then:function(o,s){$l(this,new Up(null,null,o,s,ee))},catch:function(o){if(arguments.length===1)return this.then(null,o);var s=arguments[0],u=arguments[1];return typeof s=="function"?this.then(null,function(c){return c instanceof s?u(c):$s(c)}):this.then(null,function(c){return c&&c.name===s?u(c):$s(c)})},finally:function(o){return this.then(function(s){return q.resolve(o()).then(function(){return s})},function(s){return q.resolve(o()).then(function(){return $s(s)})})},timeout:function(o,s){var u=this;return o<1/0?new q(function(c,p){var d=setTimeout(function(){return p(new ie.Timeout(s))},o);u.then(c,p).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&E(q.prototype,Symbol.toStringTag,"Dexie.Promise"),Ur.env=qp();function Up(o,s,u,c,p){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof s=="function"?s:null,this.resolve=u,this.reject=c,this.psd=p}v(q,{all:function(){var o=Kt.apply(null,arguments).map(Ss);return new q(function(s,u){o.length===0&&s([]);var c=o.length;o.forEach(function(p,d){return q.resolve(p).then(function(_){o[d]=_,--c||s(o)},u)})})},resolve:function(o){if(o instanceof q)return o;if(o&&typeof o.then=="function")return new q(function(u,c){o.then(u,c)});var s=new q(no,!0,o);return s},reject:$s,race:function(){var o=Kt.apply(null,arguments).map(Ss);return new q(function(s,u){o.map(function(c){return q.resolve(c).then(s,u)})})},PSD:{get:function(){return ee},set:function(o){return ee=o}},totalEchoes:{get:function(){return Os}},newPSD:zr,usePSD:yn,scheduler:{get:function(){return io},set:function(o){io=o}},rejectionMapper:{get:function(){return xl},set:function(o){xl=o}},follow:function(o,s){return new q(function(u,c){return zr(function(p,d){var _=ee;_.unhandleds=[],_.onunhandled=d,_.finalize=dn(function(){var y=this;bx(function(){y.unhandleds.length===0?p():d(y.unhandleds[0])})},_.finalize),o()},s,u,c)})}}),hn&&(hn.allSettled&&E(q,"allSettled",function(){var o=Kt.apply(null,arguments).map(Ss);return new q(function(s){o.length===0&&s([]);var u=o.length,c=new Array(u);o.forEach(function(p,d){return q.resolve(p).then(function(_){return c[d]={status:"fulfilled",value:_}},function(_){return c[d]={status:"rejected",reason:_}}).then(function(){return--u||s(c)})})})}),hn.any&&typeof AggregateError<"u"&&E(q,"any",function(){var o=Kt.apply(null,arguments).map(Ss);return new q(function(s,u){o.length===0&&u(new AggregateError([]));var c=o.length,p=new Array(c);o.forEach(function(d,_){return q.resolve(d).then(function(y){return s(y)},function(y){p[_]=y,--c||u(new AggregateError(p))})})})}),hn.withResolvers&&(q.withResolvers=hn.withResolvers));function zp(o,s){try{s(function(u){if(o._state===null){if(u===o)throw new TypeError("A promise cannot be resolved with itself.");var c=o._lib&&ni();u&&typeof u.then=="function"?zp(o,function(p,d){u instanceof q?u._then(p,d):u.then(p,d)}):(o._state=!0,o._value=u,Wp(o)),c&&ii()}},wl.bind(null,o))}catch(u){wl(o,u)}}function wl(o,s){if(vs.push(s),o._state===null){var u=o._lib&&ni();s=xl(s),o._state=!1,o._value=s,Ex(o),Wp(o),u&&ii()}}function Wp(o){var s=o._listeners;o._listeners=[];for(var u=0,c=s.length;u<c;++u)$l(o,s[u]);var p=o._PSD;--p.ref||p.finalize(),gn===0&&(++gn,io(function(){--gn===0&&bl()},[]))}function $l(o,s){if(o._state===null){o._listeners.push(s);return}var u=o._state?s.onFulfilled:s.onRejected;if(u===null)return(o._state?s.resolve:s.reject)(o._value);++s.psd.ref,++gn,io(wx,[u,o,s])}function wx(o,s,u){try{var c,p=s._value;!s._state&&vs.length&&(vs=[]),c=er&&s._consoleTask?s._consoleTask.run(function(){return o(p)}):o(p),!s._state&&vs.indexOf(p)===-1&&Ox(s),u.resolve(c)}catch(d){u.reject(d)}finally{--gn===0&&bl(),--u.psd.ref||u.psd.finalize()}}function $x(){yn(Ur,function(){ni()&&ii()})}function ni(){var o=yl;return yl=!1,xs=!1,o}function ii(){var o,s,u;do for(;oo.length>0;)for(o=oo,oo=[],u=o.length,s=0;s<u;++s){var c=o[s];c[0].apply(null,c[1])}while(oo.length>0);yl=!0,xs=!0}function bl(){var o=_n;_n=[],o.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)});for(var s=ws.slice(0),u=s.length;u;)s[--u]()}function bx(o){function s(){o(),ws.splice(ws.indexOf(s),1)}ws.push(s),++gn,io(function(){--gn===0&&bl()},[])}function Ex(o){_n.some(function(s){return s._value===o._value})||_n.push(o)}function Ox(o){for(var s=_n.length;s;)if(_n[--s]._value===o._value){_n.splice(s,1);return}}function $s(o){return new q(no,!1,o)}function Ce(o,s){var u=ee;return function(){var c=ni(),p=ee;try{return qr(u,!0),o.apply(this,arguments)}catch(d){s&&s(d)}finally{qr(p,!1),c&&ii()}}}var We={awaits:0,echoes:0,id:0},Sx=0,bs=[],Es=0,Os=0,Ax=0;function zr(o,s,u,c){var p=ee,d=Object.create(p);d.parent=p,d.ref=0,d.global=!1,d.id=++Ax,Ur.env,d.env=gl?{Promise:q,PromiseProp:{value:q,configurable:!0,writable:!0},all:q.all,race:q.race,allSettled:q.allSettled,any:q.any,resolve:q.resolve,reject:q.reject}:{},s&&f(d,s),++p.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()};var _=yn(d,o,u,c);return d.ref===0&&d.finalize(),_}function oi(){return We.id||(We.id=++Sx),++We.awaits,We.echoes+=Bp,We.id}function Wr(){return We.awaits?(--We.awaits===0&&(We.id=0),We.echoes=We.awaits*Bp,!0):!1}(""+xx).indexOf("[native code]")===-1&&(oi=Wr=Ae);function Ss(o){return We.echoes&&o&&o.constructor===hn?(oi(),o.then(function(s){return Wr(),s},function(s){return Wr(),Pe(s)})):o}function kx(o){++Os,(!We.echoes||--We.echoes===0)&&(We.echoes=We.awaits=We.id=0),bs.push(ee),qr(o,!0)}function Tx(){var o=bs[bs.length-1];bs.pop(),qr(o,!1)}function qr(o,s){var u=ee;if((s?We.echoes&&(!Es++||o!==ee):Es&&(!--Es||o!==ee))&&queueMicrotask(s?kx.bind(null,o):Tx),o!==ee&&(ee=o,u===Ur&&(Ur.env=qp()),gl)){var c=Ur.env.Promise,p=o.env;(u.global||o.global)&&(Object.defineProperty(i,"Promise",p.PromiseProp),c.all=p.all,c.race=p.race,c.resolve=p.resolve,c.reject=p.reject,p.allSettled&&(c.allSettled=p.allSettled),p.any&&(c.any=p.any))}}function qp(){var o=i.Promise;return gl?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function yn(o,s,u,c,p){var d=ee;try{return qr(o,!0),s(u,c,p)}finally{qr(d,!1)}}function Vp(o,s,u,c){return typeof o!="function"?o:function(){var p=ee;u&&oi(),qr(s,!0);try{return o.apply(this,arguments)}finally{qr(p,!1),c&&queueMicrotask(Wr)}}}function El(o){Promise===hn&&We.echoes===0?Es===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}var Pe=q.reject;function Ol(o,s,u,c){if(!o.idbdb||!o._state.openComplete&&!ee.letThrough&&!o._vip){if(o._state.openComplete)return Pe(new ie.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return Pe(new ie.DatabaseClosed);o.open().catch(Ae)}return o._state.dbReadyPromise.then(function(){return Ol(o,s,u,c)})}else{var p=o._createTransaction(s,u,o._dbSchema);try{p.create(),o._state.PR1398_maxLoop=3}catch(d){return d.name===dl.InvalidState&&o.isOpen()&&--o._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),o.close({disableAutoOpen:!1}),o.open().then(function(){return Ol(o,s,u,c)})):Pe(d)}return p._promise(s,function(d,_){return zr(function(){return ee.trans=p,c(d,_,p)})}).then(function(d){if(s==="readwrite")try{p.idbtrans.commit()}catch{}return s==="readonly"?d:p._completion.then(function(){return d})})}}var Hp="4.0.9",xn="\uFFFF",Sl=-1/0,$r="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Gp="String expected.",si=[],As="__dbnames",Al="readonly",kl="readwrite";function vn(o,s){return o?s?function(){return o.apply(this,arguments)&&s.apply(this,arguments)}:o:s}var Yp={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ks(o){return typeof o=="string"&&!/\./.test(o)?function(s){return s[o]===void 0&&o in s&&(s=St(s),delete s[o]),s}:function(s){return s}}function Qp(){throw ie.Type()}function ge(o,s){try{var u=Jp(o),c=Jp(s);if(u!==c)return u==="Array"?1:c==="Array"?-1:u==="binary"?1:c==="binary"?-1:u==="string"?1:c==="string"?-1:u==="Date"?1:c!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return o>s?1:o<s?-1:0;case"binary":return Cx(Xp(o),Xp(s));case"Array":return Ix(o,s)}}catch{}return NaN}function Ix(o,s){for(var u=o.length,c=s.length,p=u<c?u:c,d=0;d<p;++d){var _=ge(o[d],s[d]);if(_!==0)return _}return u===c?0:u<c?-1:1}function Cx(o,s){for(var u=o.length,c=s.length,p=u<c?u:c,d=0;d<p;++d)if(o[d]!==s[d])return o[d]<s[d]?-1:1;return u===c?0:u<c?-1:1}function Jp(o){var s=typeof o;if(s!=="object")return s;if(ArrayBuffer.isView(o))return"binary";var u=Kr(o);return u==="ArrayBuffer"?"binary":u}function Xp(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var Zp=function(){function o(){}return o.prototype._trans=function(s,u,c){var p=this._tx||ee.trans,d=this.name,_=er&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(s==="readonly"?"read":"write"," ").concat(this.name));function y(S,$,M){if(!M.schema[d])throw new ie.NotFound("Table "+d+" not part of transaction");return u(M.idbtrans,M)}var x=ni();try{var w=p&&p.db._novip===this.db._novip?p===ee.trans?p._promise(s,y,c):zr(function(){return p._promise(s,y,c)},{trans:p,transless:ee.transless||ee}):Ol(this.db,s,[this.name],y);return _&&(w._consoleTask=_,w=w.catch(function(S){return console.trace(S),Pe(S)})),w}finally{x&&ii()}},o.prototype.get=function(s,u){var c=this;return s&&s.constructor===Object?this.where(s).first(u):s==null?Pe(new ie.Type("Invalid argument to Table.get()")):this._trans("readonly",function(p){return c.core.get({trans:p,key:s}).then(function(d){return c.hook.reading.fire(d)})}).then(u)},o.prototype.where=function(s){if(typeof s=="string")return new this.db.WhereClause(this,s);if(l(s))return new this.db.WhereClause(this,"[".concat(s.join("+"),"]"));var u=a(s);if(u.length===1)return this.where(u[0]).equals(s[u[0]]);var c=this.schema.indexes.concat(this.schema.primKey).filter(function(S){if(S.compound&&u.every(function(M){return S.keyPath.indexOf(M)>=0})){for(var $=0;$<u.length;++$)if(u.indexOf(S.keyPath[$])===-1)return!1;return!0}return!1}).sort(function(S,$){return S.keyPath.length-$.keyPath.length})[0];if(c&&this.db._maxKey!==xn){var p=c.keyPath.slice(0,u.length);return this.where(p).equals(p.map(function(S){return s[S]}))}!c&&er&&console.warn("The query ".concat(JSON.stringify(s)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var d=this.schema.idxByName;function _(S,$){return ge(S,$)===0}var y=u.reduce(function(S,$){var M=S[0],j=S[1],b=d[$],A=s[$];return[M||b,M||!b?vn(j,b&&b.multi?function(I){var D=le(I,$);return l(D)&&D.some(function(N){return _(A,N)})}:function(I){return _(A,le(I,$))}):j]},[null,null]),x=y[0],w=y[1];return x?this.where(x.name).equals(s[x.keyPath]).filter(w):c?this.filter(w):this.where(u).equals("")},o.prototype.filter=function(s){return this.toCollection().and(s)},o.prototype.count=function(s){return this.toCollection().count(s)},o.prototype.offset=function(s){return this.toCollection().offset(s)},o.prototype.limit=function(s){return this.toCollection().limit(s)},o.prototype.each=function(s){return this.toCollection().each(s)},o.prototype.toArray=function(s){return this.toCollection().toArray(s)},o.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},o.prototype.orderBy=function(s){return new this.db.Collection(new this.db.WhereClause(this,l(s)?"[".concat(s.join("+"),"]"):s))},o.prototype.reverse=function(){return this.toCollection().reverse()},o.prototype.mapToClass=function(s){var u=this,c=u.db,p=u.name;this.schema.mappedClass=s,s.prototype instanceof Qp&&(s=function(x){t(w,x);function w(){return x!==null&&x.apply(this,arguments)||this}return Object.defineProperty(w.prototype,"db",{get:function(){return c},enumerable:!1,configurable:!0}),w.prototype.table=function(){return p},w}(s));for(var d=new Set,_=s.prototype;_;_=m(_))Object.getOwnPropertyNames(_).forEach(function(x){return d.add(x)});var y=function(x){if(!x)return x;var w=Object.create(s.prototype);for(var S in x)if(!d.has(S))try{w[S]=x[S]}catch{}return w};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=y,this.hook("reading",y),s},o.prototype.defineClass=function(){function s(u){f(this,u)}return this.mapToClass(s)},o.prototype.add=function(s,u){var c=this,p=this.schema.primKey,d=p.auto,_=p.keyPath,y=s;return _&&d&&(y=ks(_)(s)),this._trans("readwrite",function(x){return c.core.mutate({trans:x,type:"add",keys:u!=null?[u]:null,values:[y]})}).then(function(x){return x.numFailures?q.reject(x.failures[0]):x.lastResult}).then(function(x){if(_)try{pe(s,_,x)}catch{}return x})},o.prototype.update=function(s,u){if(typeof s=="object"&&!l(s)){var c=le(s,this.schema.primKey.keyPath);return c===void 0?Pe(new ie.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(u)}else return this.where(":id").equals(s).modify(u)},o.prototype.put=function(s,u){var c=this,p=this.schema.primKey,d=p.auto,_=p.keyPath,y=s;return _&&d&&(y=ks(_)(s)),this._trans("readwrite",function(x){return c.core.mutate({trans:x,type:"put",values:[y],keys:u!=null?[u]:null})}).then(function(x){return x.numFailures?q.reject(x.failures[0]):x.lastResult}).then(function(x){if(_)try{pe(s,_,x)}catch{}return x})},o.prototype.delete=function(s){var u=this;return this._trans("readwrite",function(c){return u.core.mutate({trans:c,type:"delete",keys:[s]})}).then(function(c){return c.numFailures?q.reject(c.failures[0]):void 0})},o.prototype.clear=function(){var s=this;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"deleteRange",range:Yp})}).then(function(u){return u.numFailures?q.reject(u.failures[0]):void 0})},o.prototype.bulkGet=function(s){var u=this;return this._trans("readonly",function(c){return u.core.getMany({keys:s,trans:c}).then(function(p){return p.map(function(d){return u.hook.reading.fire(d)})})})},o.prototype.bulkAdd=function(s,u,c){var p=this,d=Array.isArray(u)?u:void 0;c=c||(d?void 0:u);var _=c?c.allKeys:void 0;return this._trans("readwrite",function(y){var x=p.schema.primKey,w=x.auto,S=x.keyPath;if(S&&d)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(d&&d.length!==s.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var $=s.length,M=S&&w?s.map(ks(S)):s;return p.core.mutate({trans:y,type:"add",keys:d,values:M,wantResults:_}).then(function(j){var b=j.numFailures,A=j.results,I=j.lastResult,D=j.failures,N=_?A:I;if(b===0)return N;throw new ri("".concat(p.name,".bulkAdd(): ").concat(b," of ").concat($," operations failed"),D)})})},o.prototype.bulkPut=function(s,u,c){var p=this,d=Array.isArray(u)?u:void 0;c=c||(d?void 0:u);var _=c?c.allKeys:void 0;return this._trans("readwrite",function(y){var x=p.schema.primKey,w=x.auto,S=x.keyPath;if(S&&d)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(d&&d.length!==s.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var $=s.length,M=S&&w?s.map(ks(S)):s;return p.core.mutate({trans:y,type:"put",keys:d,values:M,wantResults:_}).then(function(j){var b=j.numFailures,A=j.results,I=j.lastResult,D=j.failures,N=_?A:I;if(b===0)return N;throw new ri("".concat(p.name,".bulkPut(): ").concat(b," of ").concat($," operations failed"),D)})})},o.prototype.bulkUpdate=function(s){var u=this,c=this.core,p=s.map(function(y){return y.key}),d=s.map(function(y){return y.changes}),_=[];return this._trans("readwrite",function(y){return c.getMany({trans:y,keys:p,cache:"clone"}).then(function(x){var w=[],S=[];s.forEach(function(M,j){var b=M.key,A=M.changes,I=x[j];if(I){for(var D=0,N=Object.keys(A);D<N.length;D++){var L=N[D],F=A[L];if(L===u.schema.primKey.keyPath){if(ge(F,b)!==0)throw new ie.Constraint("Cannot update primary key in bulkUpdate()")}else pe(I,L,F)}_.push(j),w.push(b),S.push(I)}});var $=w.length;return c.mutate({trans:y,type:"put",keys:w,values:S,updates:{keys:p,changeSpecs:d}}).then(function(M){var j=M.numFailures,b=M.failures;if(j===0)return $;for(var A=0,I=Object.keys(b);A<I.length;A++){var D=I[A],N=_[Number(D)];if(N!=null){var L=b[D];delete b[D],b[N]=L}}throw new ri("".concat(u.name,".bulkUpdate(): ").concat(j," of ").concat($," operations failed"),b)})})})},o.prototype.bulkDelete=function(s){var u=this,c=s.length;return this._trans("readwrite",function(p){return u.core.mutate({trans:p,type:"delete",keys:s})}).then(function(p){var d=p.numFailures,_=p.lastResult,y=p.failures;if(d===0)return _;throw new ri("".concat(u.name,".bulkDelete(): ").concat(d," of ").concat(c," operations failed"),y)})},o}();function so(o){var s={},u=function(y,x){if(x){for(var w=arguments.length,S=new Array(w-1);--w;)S[w-1]=arguments[w];return s[y].subscribe.apply(null,S),o}else if(typeof y=="string")return s[y]};u.addEventType=d;for(var c=1,p=arguments.length;c<p;++c)d(arguments[c]);return u;function d(y,x,w){if(typeof y=="object")return _(y);x||(x=gx),w||(w=Ae);var S={subscribers:[],fire:w,subscribe:function($){S.subscribers.indexOf($)===-1&&(S.subscribers.push($),S.fire=x(S.fire,$))},unsubscribe:function($){S.subscribers=S.subscribers.filter(function(M){return M!==$}),S.fire=S.subscribers.reduce(x,w)}};return s[y]=u[y]=S,S}function _(y){a(y).forEach(function(x){var w=y[x];if(l(w))d(x,y[x][0],y[x][1]);else if(w==="asap")var S=d(x,ro,function(){for(var M=arguments.length,j=new Array(M);M--;)j[M]=arguments[M];S.subscribers.forEach(function(b){Z(function(){b.apply(null,j)})})});else throw new ie.InvalidArgument("Invalid event config")})}}function ao(o,s){return T(s).from({prototype:o}),s}function Mx(o){return ao(Zp.prototype,function(u,c,p){this.db=o,this._tx=p,this.name=u,this.schema=c,this.hook=o._allTables[u]?o._allTables[u].hook:so(null,{creating:[dx,Ae],reading:[mx,ro],updating:[_x,Ae],deleting:[hx,Ae]})})}function ai(o,s){return!(o.filter||o.algorithm||o.or)&&(s?o.justLimit:!o.replayFilter)}function Tl(o,s){o.filter=vn(o.filter,s)}function Il(o,s,u){var c=o.replayFilter;o.replayFilter=c?function(){return vn(c(),s())}:s,o.justLimit=u&&!c}function Dx(o,s){o.isMatch=vn(o.isMatch,s)}function Ts(o,s){if(o.isPrimKey)return s.primaryKey;var u=s.getIndexByKeyPath(o.index);if(!u)throw new ie.Schema("KeyPath "+o.index+" on object store "+s.name+" is not indexed");return u}function em(o,s,u){var c=Ts(o,s.schema);return s.openCursor({trans:u,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:c,range:o.range}})}function Is(o,s,u,c){var p=o.replayFilter?vn(o.filter,o.replayFilter()):o.filter;if(o.or){var d={},_=function(y,x,w){if(!p||p(x,w,function(M){return x.stop(M)},function(M){return x.fail(M)})){var S=x.primaryKey,$=""+S;$==="[object ArrayBuffer]"&&($=""+new Uint8Array(S)),g(d,$)||(d[$]=!0,s(y,x,w))}};return Promise.all([o.or._iterate(_,u),tm(em(o,c,u),o.algorithm,_,!o.keysOnly&&o.valueMapper)])}else return tm(em(o,c,u),vn(o.algorithm,p),s,!o.keysOnly&&o.valueMapper)}function tm(o,s,u,c){var p=c?function(_,y,x){return u(c(_),y,x)}:u,d=Ce(p);return o.then(function(_){if(_)return _.start(function(){var y=function(){return _.continue()};(!s||s(_,function(x){return y=x},function(x){_.stop(x),y=Ae},function(x){_.fail(x),y=Ae}))&&d(_.value,_,function(x){return y=x}),y()})})}var Px=Symbol(),uo=function(){function o(s){Object.assign(this,s)}return o.prototype.execute=function(s){var u;if(this.add!==void 0){var c=this.add;if(l(c))return n(n([],l(s)?s:[],!0),c,!0).sort();if(typeof c=="number")return(Number(s)||0)+c;if(typeof c=="bigint")try{return BigInt(s)+c}catch{return BigInt(0)+c}throw new TypeError("Invalid term ".concat(c))}if(this.remove!==void 0){var p=this.remove;if(l(p))return l(s)?s.filter(function(_){return!p.includes(_)}).sort():[];if(typeof p=="number")return Number(s)-p;if(typeof p=="bigint")try{return BigInt(s)-p}catch{return BigInt(0)-p}throw new TypeError("Invalid subtrahend ".concat(p))}var d=(u=this.replacePrefix)===null||u===void 0?void 0:u[0];return d&&typeof s=="string"&&s.startsWith(d)?this.replacePrefix[1]+s.substring(d.length):s},o}(),Rx=function(){function o(){}return o.prototype._read=function(s,u){var c=this._ctx;return c.error?c.table._trans(null,Pe.bind(null,c.error)):c.table._trans("readonly",s).then(u)},o.prototype._write=function(s){var u=this._ctx;return u.error?u.table._trans(null,Pe.bind(null,u.error)):u.table._trans("readwrite",s,"locked")},o.prototype._addAlgorithm=function(s){var u=this._ctx;u.algorithm=vn(u.algorithm,s)},o.prototype._iterate=function(s,u){return Is(this._ctx,s,u,this._ctx.table.core)},o.prototype.clone=function(s){var u=Object.create(this.constructor.prototype),c=Object.create(this._ctx);return s&&f(c,s),u._ctx=c,u},o.prototype.raw=function(){return this._ctx.valueMapper=null,this},o.prototype.each=function(s){var u=this._ctx;return this._read(function(c){return Is(u,s,c,u.table.core)})},o.prototype.count=function(s){var u=this;return this._read(function(c){var p=u._ctx,d=p.table.core;if(ai(p,!0))return d.count({trans:c,query:{index:Ts(p,d.schema),range:p.range}}).then(function(y){return Math.min(y,p.limit)});var _=0;return Is(p,function(){return++_,!1},c,d).then(function(){return _})}).then(s)},o.prototype.sortBy=function(s,u){var c=s.split(".").reverse(),p=c[0],d=c.length-1;function _(w,S){return S?_(w[c[S]],S-1):w[p]}var y=this._ctx.dir==="next"?1:-1;function x(w,S){var $=_(w,d),M=_(S,d);return ge($,M)*y}return this.toArray(function(w){return w.sort(x)}).then(u)},o.prototype.toArray=function(s){var u=this;return this._read(function(c){var p=u._ctx;if(p.dir==="next"&&ai(p,!0)&&p.limit>0){var d=p.valueMapper,_=Ts(p,p.table.core.schema);return p.table.core.query({trans:c,limit:p.limit,values:!0,query:{index:_,range:p.range}}).then(function(x){var w=x.result;return d?w.map(d):w})}else{var y=[];return Is(p,function(x){return y.push(x)},c,p.table.core).then(function(){return y})}},s)},o.prototype.offset=function(s){var u=this._ctx;return s<=0?this:(u.offset+=s,ai(u)?Il(u,function(){var c=s;return function(p,d){return c===0?!0:c===1?(--c,!1):(d(function(){p.advance(c),c=0}),!1)}}):Il(u,function(){var c=s;return function(){return--c<0}}),this)},o.prototype.limit=function(s){return this._ctx.limit=Math.min(this._ctx.limit,s),Il(this._ctx,function(){var u=s;return function(c,p,d){return--u<=0&&p(d),u>=0}},!0),this},o.prototype.until=function(s,u){return Tl(this._ctx,function(c,p,d){return s(c.value)?(p(d),u):!0}),this},o.prototype.first=function(s){return this.limit(1).toArray(function(u){return u[0]}).then(s)},o.prototype.last=function(s){return this.reverse().first(s)},o.prototype.filter=function(s){return Tl(this._ctx,function(u){return s(u.value)}),Dx(this._ctx,s),this},o.prototype.and=function(s){return this.filter(s)},o.prototype.or=function(s){return new this.db.WhereClause(this._ctx.table,s,this)},o.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},o.prototype.desc=function(){return this.reverse()},o.prototype.eachKey=function(s){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(c,p){s(p.key,p)})},o.prototype.eachUniqueKey=function(s){return this._ctx.unique="unique",this.eachKey(s)},o.prototype.eachPrimaryKey=function(s){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(c,p){s(p.primaryKey,p)})},o.prototype.keys=function(s){var u=this._ctx;u.keysOnly=!u.isMatch;var c=[];return this.each(function(p,d){c.push(d.key)}).then(function(){return c}).then(s)},o.prototype.primaryKeys=function(s){var u=this._ctx;if(u.dir==="next"&&ai(u,!0)&&u.limit>0)return this._read(function(p){var d=Ts(u,u.table.core.schema);return u.table.core.query({trans:p,values:!1,limit:u.limit,query:{index:d,range:u.range}})}).then(function(p){var d=p.result;return d}).then(s);u.keysOnly=!u.isMatch;var c=[];return this.each(function(p,d){c.push(d.primaryKey)}).then(function(){return c}).then(s)},o.prototype.uniqueKeys=function(s){return this._ctx.unique="unique",this.keys(s)},o.prototype.firstKey=function(s){return this.limit(1).keys(function(u){return u[0]}).then(s)},o.prototype.lastKey=function(s){return this.reverse().firstKey(s)},o.prototype.distinct=function(){var s=this._ctx,u=s.index&&s.table.schema.idxByName[s.index];if(!u||!u.multi)return this;var c={};return Tl(this._ctx,function(p){var d=p.primaryKey.toString(),_=g(c,d);return c[d]=!0,!_}),this},o.prototype.modify=function(s){var u=this,c=this._ctx;return this._write(function(p){var d;if(typeof s=="function")d=s;else{var _=a(s),y=_.length;d=function(D){for(var N=!1,L=0;L<y;++L){var F=_[L],R=s[F],z=le(D,F);R instanceof uo?(pe(D,F,R.execute(z)),N=!0):z!==R&&(pe(D,F,R),N=!0)}return N}}var x=c.table.core,w=x.schema.primaryKey,S=w.outbound,$=w.extractKey,M=u.db._options.modifyChunkSize||200,j=[],b=0,A=[],I=function(D,N){var L=N.failures,F=N.numFailures;b+=D-F;for(var R=0,z=a(L);R<z.length;R++){var V=z[R];j.push(L[V])}};return u.clone().primaryKeys().then(function(D){var N=ai(c)&&c.limit===1/0&&(typeof s!="function"||s===Cl)&&{index:c.index,range:c.range},L=function(F){var R=Math.min(M,D.length-F);return x.getMany({trans:p,keys:D.slice(F,F+R),cache:"immutable"}).then(function(z){for(var V=[],W=[],oe=S?[]:null,ce=[],Y=0;Y<R;++Y){var he=z[Y],re={value:St(he),primKey:D[F+Y]};d.call(re,re.value,re)!==!1&&(re.value==null?ce.push(D[F+Y]):!S&&ge($(he),$(re.value))!==0?(ce.push(D[F+Y]),V.push(re.value)):(W.push(re.value),S&&oe.push(D[F+Y])))}return Promise.resolve(V.length>0&&x.mutate({trans:p,type:"add",values:V}).then(function(xe){for(var ae in xe.failures)ce.splice(parseInt(ae),1);I(V.length,xe)})).then(function(){return(W.length>0||N&&typeof s=="object")&&x.mutate({trans:p,type:"put",keys:oe,values:W,criteria:N,changeSpec:typeof s!="function"&&s,isAdditionalChunk:F>0}).then(function(xe){return I(W.length,xe)})}).then(function(){return(ce.length>0||N&&s===Cl)&&x.mutate({trans:p,type:"delete",keys:ce,criteria:N,isAdditionalChunk:F>0}).then(function(xe){return I(ce.length,xe)})}).then(function(){return D.length>F+R&&L(F+M)})})};return L(0).then(function(){if(j.length>0)throw new gs("Error modifying one or more objects",j,b,A);return D.length})})})},o.prototype.delete=function(){var s=this._ctx,u=s.range;return ai(s)&&(s.isPrimKey||u.type===3)?this._write(function(c){var p=s.table.core.schema.primaryKey,d=u;return s.table.core.count({trans:c,query:{index:p,range:d}}).then(function(_){return s.table.core.mutate({trans:c,type:"deleteRange",range:d}).then(function(y){var x=y.failures;y.lastResult,y.results;var w=y.numFailures;if(w)throw new gs("Could not delete some values",Object.keys(x).map(function(S){return x[S]}),_-w);return _-w})})}):this.modify(Cl)},o}(),Cl=function(o,s){return s.value=null};function Nx(o){return ao(Rx.prototype,function(u,c){this.db=o;var p=Yp,d=null;if(c)try{p=c()}catch(w){d=w}var _=u._ctx,y=_.table,x=y.hook.reading.fire;this._ctx={table:y,index:_.index,isPrimKey:!_.index||y.schema.primKey.keyPath&&_.index===y.schema.primKey.name,range:p,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:_.or,valueMapper:x!==ro?x:null}})}function Lx(o,s){return o<s?-1:o===s?0:1}function Fx(o,s){return o>s?-1:o===s?0:1}function _t(o,s,u){var c=o instanceof nm?new o.Collection(o):o;return c._ctx.error=u?new u(s):new TypeError(s),c}function ui(o){return new o.Collection(o,function(){return rm("")}).limit(0)}function Bx(o){return o==="next"?function(s){return s.toUpperCase()}:function(s){return s.toLowerCase()}}function jx(o){return o==="next"?function(s){return s.toLowerCase()}:function(s){return s.toUpperCase()}}function Kx(o,s,u,c,p,d){for(var _=Math.min(o.length,c.length),y=-1,x=0;x<_;++x){var w=s[x];if(w!==c[x])return p(o[x],u[x])<0?o.substr(0,x)+u[x]+u.substr(x+1):p(o[x],c[x])<0?o.substr(0,x)+c[x]+u.substr(x+1):y>=0?o.substr(0,y)+s[y]+u.substr(y+1):null;p(o[x],w)<0&&(y=x)}return _<c.length&&d==="next"?o+u.substr(o.length):_<o.length&&d==="prev"?o.substr(0,u.length):y<0?null:o.substr(0,y)+c[y]+u.substr(y+1)}function Cs(o,s,u,c){var p,d,_,y,x,w,S,$=u.length;if(!u.every(function(A){return typeof A=="string"}))return _t(o,Gp);function M(A){p=Bx(A),d=jx(A),_=A==="next"?Lx:Fx;var I=u.map(function(D){return{lower:d(D),upper:p(D)}}).sort(function(D,N){return _(D.lower,N.lower)});y=I.map(function(D){return D.upper}),x=I.map(function(D){return D.lower}),w=A,S=A==="next"?"":c}M("next");var j=new o.Collection(o,function(){return Vr(y[0],x[$-1]+c)});j._ondirectionchange=function(A){M(A)};var b=0;return j._addAlgorithm(function(A,I,D){var N=A.key;if(typeof N!="string")return!1;var L=d(N);if(s(L,x,b))return!0;for(var F=null,R=b;R<$;++R){var z=Kx(N,L,y[R],x[R],_,w);z===null&&F===null?b=R+1:(F===null||_(F,z)>0)&&(F=z)}return I(F!==null?function(){A.continue(F+S)}:D),!1}),j}function Vr(o,s,u,c){return{type:2,lower:o,upper:s,lowerOpen:u,upperOpen:c}}function rm(o){return{type:1,lower:o,upper:o}}var nm=function(){function o(){}return Object.defineProperty(o.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),o.prototype.between=function(s,u,c,p){c=c!==!1,p=p===!0;try{return this._cmp(s,u)>0||this._cmp(s,u)===0&&(c||p)&&!(c&&p)?ui(this):new this.Collection(this,function(){return Vr(s,u,!c,!p)})}catch{return _t(this,$r)}},o.prototype.equals=function(s){return s==null?_t(this,$r):new this.Collection(this,function(){return rm(s)})},o.prototype.above=function(s){return s==null?_t(this,$r):new this.Collection(this,function(){return Vr(s,void 0,!0)})},o.prototype.aboveOrEqual=function(s){return s==null?_t(this,$r):new this.Collection(this,function(){return Vr(s,void 0,!1)})},o.prototype.below=function(s){return s==null?_t(this,$r):new this.Collection(this,function(){return Vr(void 0,s,!1,!0)})},o.prototype.belowOrEqual=function(s){return s==null?_t(this,$r):new this.Collection(this,function(){return Vr(void 0,s)})},o.prototype.startsWith=function(s){return typeof s!="string"?_t(this,Gp):this.between(s,s+xn,!0,!0)},o.prototype.startsWithIgnoreCase=function(s){return s===""?this.startsWith(s):Cs(this,function(u,c){return u.indexOf(c[0])===0},[s],xn)},o.prototype.equalsIgnoreCase=function(s){return Cs(this,function(u,c){return u===c[0]},[s],"")},o.prototype.anyOfIgnoreCase=function(){var s=Kt.apply(jt,arguments);return s.length===0?ui(this):Cs(this,function(u,c){return c.indexOf(u)!==-1},s,"")},o.prototype.startsWithAnyOfIgnoreCase=function(){var s=Kt.apply(jt,arguments);return s.length===0?ui(this):Cs(this,function(u,c){return c.some(function(p){return u.indexOf(p)===0})},s,xn)},o.prototype.anyOf=function(){var s=this,u=Kt.apply(jt,arguments),c=this._cmp;try{u.sort(c)}catch{return _t(this,$r)}if(u.length===0)return ui(this);var p=new this.Collection(this,function(){return Vr(u[0],u[u.length-1])});p._ondirectionchange=function(_){c=_==="next"?s._ascending:s._descending,u.sort(c)};var d=0;return p._addAlgorithm(function(_,y,x){for(var w=_.key;c(w,u[d])>0;)if(++d,d===u.length)return y(x),!1;return c(w,u[d])===0?!0:(y(function(){_.continue(u[d])}),!1)}),p},o.prototype.notEqual=function(s){return this.inAnyRange([[Sl,s],[s,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},o.prototype.noneOf=function(){var s=Kt.apply(jt,arguments);if(s.length===0)return new this.Collection(this);try{s.sort(this._ascending)}catch{return _t(this,$r)}var u=s.reduce(function(c,p){return c?c.concat([[c[c.length-1][1],p]]):[[Sl,p]]},null);return u.push([s[s.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},o.prototype.inAnyRange=function(s,u){var c=this,p=this._cmp,d=this._ascending,_=this._descending,y=this._min,x=this._max;if(s.length===0)return ui(this);if(!s.every(function(R){return R[0]!==void 0&&R[1]!==void 0&&d(R[0],R[1])<=0}))return _t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var w=!u||u.includeLowers!==!1,S=u&&u.includeUppers===!0;function $(R,z){for(var V=0,W=R.length;V<W;++V){var oe=R[V];if(p(z[0],oe[1])<0&&p(z[1],oe[0])>0){oe[0]=y(oe[0],z[0]),oe[1]=x(oe[1],z[1]);break}}return V===W&&R.push(z),R}var M=d;function j(R,z){return M(R[0],z[0])}var b;try{b=s.reduce($,[]),b.sort(j)}catch{return _t(this,$r)}var A=0,I=S?function(R){return d(R,b[A][1])>0}:function(R){return d(R,b[A][1])>=0},D=w?function(R){return _(R,b[A][0])>0}:function(R){return _(R,b[A][0])>=0};function N(R){return!I(R)&&!D(R)}var L=I,F=new this.Collection(this,function(){return Vr(b[0][0],b[b.length-1][1],!w,!S)});return F._ondirectionchange=function(R){R==="next"?(L=I,M=d):(L=D,M=_),b.sort(j)},F._addAlgorithm(function(R,z,V){for(var W=R.key;L(W);)if(++A,A===b.length)return z(V),!1;return N(W)?!0:(c._cmp(W,b[A][1])===0||c._cmp(W,b[A][0])===0||z(function(){M===d?R.continue(b[A][0]):R.continue(b[A][1])}),!1)}),F},o.prototype.startsWithAnyOf=function(){var s=Kt.apply(jt,arguments);return s.every(function(u){return typeof u=="string"})?s.length===0?ui(this):this.inAnyRange(s.map(function(u){return[u,u+xn]})):_t(this,"startsWithAnyOf() only works with strings")},o}();function Ux(o){return ao(nm.prototype,function(u,c,p){if(this.db=o,this._ctx={table:u,index:c===":id"?null:c,or:p},this._cmp=this._ascending=ge,this._descending=function(d,_){return ge(_,d)},this._max=function(d,_){return ge(d,_)>0?d:_},this._min=function(d,_){return ge(d,_)<0?d:_},this._IDBKeyRange=o._deps.IDBKeyRange,!this._IDBKeyRange)throw new ie.MissingAPI})}function tr(o){return Ce(function(s){return lo(s),o(s.target.error),!1})}function lo(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var co="storagemutated",Ml="x-storagemutated-1",Hr=so(null,co),zx=function(){function o(){}return o.prototype._lock=function(){return ne(!ee.global),++this._reculock,this._reculock===1&&!ee.global&&(ee.lockOwnerFor=this),this},o.prototype._unlock=function(){if(ne(!ee.global),--this._reculock===0)for(ee.global||(ee.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var s=this._blockedFuncs.shift();try{yn(s[1],s[0])}catch{}}return this},o.prototype._locked=function(){return this._reculock&&ee.lockOwnerFor!==this},o.prototype.create=function(s){var u=this;if(!this.mode)return this;var c=this.db.idbdb,p=this.db._state.dbOpenError;if(ne(!this.idbtrans),!s&&!c)switch(p&&p.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(p);case"MissingAPIError":throw new ie.MissingAPI(p.message,p);default:throw new ie.OpenFailed(p)}if(!this.active)throw new ie.TransactionInactive;return ne(this._completion._state===null),s=this.idbtrans=s||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):c.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),s.onerror=Ce(function(d){lo(d),u._reject(s.error)}),s.onabort=Ce(function(d){lo(d),u.active&&u._reject(new ie.Abort(s.error)),u.active=!1,u.on("abort").fire(d)}),s.oncomplete=Ce(function(){u.active=!1,u._resolve(),"mutatedParts"in s&&Hr.storagemutated.fire(s.mutatedParts)}),this},o.prototype._promise=function(s,u,c){var p=this;if(s==="readwrite"&&this.mode!=="readwrite")return Pe(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return Pe(new ie.TransactionInactive);if(this._locked())return new q(function(_,y){p._blockedFuncs.push([function(){p._promise(s,u,c).then(_,y)},ee])});if(c)return zr(function(){var _=new q(function(y,x){p._lock();var w=u(y,x,p);w&&w.then&&w.then(y,x)});return _.finally(function(){return p._unlock()}),_._lib=!0,_});var d=new q(function(_,y){var x=u(_,y,p);x&&x.then&&x.then(_,y)});return d._lib=!0,d},o.prototype._root=function(){return this.parent?this.parent._root():this},o.prototype.waitFor=function(s){var u=this._root(),c=q.resolve(s);if(u._waitingFor)u._waitingFor=u._waitingFor.then(function(){return c});else{u._waitingFor=c,u._waitingQueue=[];var p=u.idbtrans.objectStore(u.storeNames[0]);(function _(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(p.get(-1/0).onsuccess=_)})()}var d=u._waitingFor;return new q(function(_,y){c.then(function(x){return u._waitingQueue.push(Ce(_.bind(null,x)))},function(x){return u._waitingQueue.push(Ce(y.bind(null,x)))}).finally(function(){u._waitingFor===d&&(u._waitingFor=null)})})},o.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ie.Abort))},o.prototype.table=function(s){var u=this._memoizedTables||(this._memoizedTables={});if(g(u,s))return u[s];var c=this.schema[s];if(!c)throw new ie.NotFound("Table "+s+" not part of transaction");var p=new this.db.Table(s,c,this);return p.core=this.db.core.table(s),u[s]=p,p},o}();function Wx(o){return ao(zx.prototype,function(u,c,p,d,_){var y=this;this.db=o,this.mode=u,this.storeNames=c,this.schema=p,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=so(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new q(function(x,w){y._resolve=x,y._reject=w}),this._completion.then(function(){y.active=!1,y.on.complete.fire()},function(x){var w=y.active;return y.active=!1,y.on.error.fire(x),y.parent?y.parent._reject(x):w&&y.idbtrans&&y.idbtrans.abort(),Pe(x)})})}function Dl(o,s,u,c,p,d,_){return{name:o,keyPath:s,unique:u,multi:c,auto:p,compound:d,src:(u&&!_?"&":"")+(c?"*":"")+(p?"++":"")+im(s)}}function im(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Pl(o,s,u){return{name:o,primKey:s,indexes:u,mappedClass:null,idxByName:fe(u,function(c){return[c.name,c]})}}function qx(o){return o.length===1?o[0]:o}var fo=function(o){try{return o.only([[]]),fo=function(){return[[]]},[[]]}catch{return fo=function(){return xn},xn}};function Rl(o){return o==null?function(){}:typeof o=="string"?Vx(o):function(s){return le(s,o)}}function Vx(o){var s=o.split(".");return s.length===1?function(u){return u[o]}:function(u){return le(u,o)}}function om(o){return[].slice.call(o)}var Hx=0;function po(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function Gx(o,s,u){function c($,M){var j=om($.objectStoreNames);return{schema:{name:$.name,tables:j.map(function(b){return M.objectStore(b)}).map(function(b){var A=b.keyPath,I=b.autoIncrement,D=l(A),N=A==null,L={},F={name:b.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:N,compound:D,keyPath:A,autoIncrement:I,unique:!0,extractKey:Rl(A)},indexes:om(b.indexNames).map(function(R){return b.index(R)}).map(function(R){var z=R.name,V=R.unique,W=R.multiEntry,oe=R.keyPath,ce=l(oe),Y={name:z,compound:ce,keyPath:oe,unique:V,multiEntry:W,extractKey:Rl(oe)};return L[po(oe)]=Y,Y}),getIndexByKeyPath:function(R){return L[po(R)]}};return L[":id"]=F.primaryKey,A!=null&&(L[po(A)]=F.primaryKey),F})},hasGetAll:j.length>0&&"getAll"in M.objectStore(j[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function p($){if($.type===3)return null;if($.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var M=$.lower,j=$.upper,b=$.lowerOpen,A=$.upperOpen,I=M===void 0?j===void 0?null:s.upperBound(j,!!A):j===void 0?s.lowerBound(M,!!b):s.bound(M,j,!!b,!!A);return I}function d($){var M=$.name;function j(I){var D=I.trans,N=I.type,L=I.keys,F=I.values,R=I.range;return new Promise(function(z,V){z=Ce(z);var W=D.objectStore(M),oe=W.keyPath==null,ce=N==="put"||N==="add";if(!ce&&N!=="delete"&&N!=="deleteRange")throw new Error("Invalid operation type: "+N);var Y=(L||F||{length:1}).length;if(L&&F&&L.length!==F.length)throw new Error("Given keys array must have same length as given values array.");if(Y===0)return z({numFailures:0,failures:{},results:[],lastResult:void 0});var he,re=[],xe=[],ae=0,Re=function(nr){++ae,lo(nr)};if(N==="deleteRange"){if(R.type===4)return z({numFailures:ae,failures:xe,results:[],lastResult:void 0});R.type===3?re.push(he=W.clear()):re.push(he=W.delete(p(R)))}else{var Ye=ce?oe?[F,L]:[F,null]:[L,null],Qr=Ye[0],rr=Ye[1];if(ce)for(var At=0;At<Y;++At)re.push(he=rr&&rr[At]!==void 0?W[N](Qr[At],rr[At]):W[N](Qr[At])),he.onerror=Re;else for(var At=0;At<Y;++At)re.push(he=W[N](Qr[At])),he.onerror=Re}var Jr=function(nr){var _o=nr.target.result;re.forEach(function(Ut,zs){return Ut.error!=null&&(xe[zs]=Ut.error)}),z({numFailures:ae,failures:xe,results:N==="delete"?L:re.map(function(Ut){return Ut.result}),lastResult:_o})};he.onerror=function(nr){Re(nr),Jr(nr)},he.onsuccess=Jr})}function b(I){var D=I.trans,N=I.values,L=I.query,F=I.reverse,R=I.unique;return new Promise(function(z,V){z=Ce(z);var W=L.index,oe=L.range,ce=D.objectStore(M),Y=W.isPrimaryKey?ce:ce.index(W.name),he=F?R?"prevunique":"prev":R?"nextunique":"next",re=N||!("openKeyCursor"in Y)?Y.openCursor(p(oe),he):Y.openKeyCursor(p(oe),he);re.onerror=tr(V),re.onsuccess=Ce(function(xe){var ae=re.result;if(!ae){z(null);return}ae.___id=++Hx,ae.done=!1;var Re=ae.continue.bind(ae),Ye=ae.continuePrimaryKey;Ye&&(Ye=Ye.bind(ae));var Qr=ae.advance.bind(ae),rr=function(){throw new Error("Cursor not started")},At=function(){throw new Error("Cursor not stopped")};ae.trans=D,ae.stop=ae.continue=ae.continuePrimaryKey=ae.advance=rr,ae.fail=Ce(V),ae.next=function(){var Jr=this,nr=1;return this.start(function(){return nr--?Jr.continue():Jr.stop()}).then(function(){return Jr})},ae.start=function(Jr){var nr=new Promise(function(Ut,zs){Ut=Ce(Ut),re.onerror=tr(zs),ae.fail=zs,ae.stop=function(Rv){ae.stop=ae.continue=ae.continuePrimaryKey=ae.advance=At,Ut(Rv)}}),_o=function(){if(re.result)try{Jr()}catch(Ut){ae.fail(Ut)}else ae.done=!0,ae.start=function(){throw new Error("Cursor behind last entry")},ae.stop()};return re.onsuccess=Ce(function(Ut){re.onsuccess=_o,_o()}),ae.continue=Re,ae.continuePrimaryKey=Ye,ae.advance=Qr,_o(),nr},z(ae)},V)})}function A(I){return function(D){return new Promise(function(N,L){N=Ce(N);var F=D.trans,R=D.values,z=D.limit,V=D.query,W=z===1/0?void 0:z,oe=V.index,ce=V.range,Y=F.objectStore(M),he=oe.isPrimaryKey?Y:Y.index(oe.name),re=p(ce);if(z===0)return N({result:[]});if(I){var xe=R?he.getAll(re,W):he.getAllKeys(re,W);xe.onsuccess=function(Qr){return N({result:Qr.target.result})},xe.onerror=tr(L)}else{var ae=0,Re=R||!("openKeyCursor"in he)?he.openCursor(re):he.openKeyCursor(re),Ye=[];Re.onsuccess=function(Qr){var rr=Re.result;if(!rr)return N({result:Ye});if(Ye.push(R?rr.value:rr.primaryKey),++ae===z)return N({result:Ye});rr.continue()},Re.onerror=tr(L)}})}}return{name:M,schema:$,mutate:j,getMany:function(I){var D=I.trans,N=I.keys;return new Promise(function(L,F){L=Ce(L);for(var R=D.objectStore(M),z=N.length,V=new Array(z),W=0,oe=0,ce,Y=function(ae){var Re=ae.target;(V[Re._pos]=Re.result)!=null,++oe===W&&L(V)},he=tr(F),re=0;re<z;++re){var xe=N[re];xe!=null&&(ce=R.get(N[re]),ce._pos=re,ce.onsuccess=Y,ce.onerror=he,++W)}W===0&&L(V)})},get:function(I){var D=I.trans,N=I.key;return new Promise(function(L,F){L=Ce(L);var R=D.objectStore(M),z=R.get(N);z.onsuccess=function(V){return L(V.target.result)},z.onerror=tr(F)})},query:A(x),openCursor:b,count:function(I){var D=I.query,N=I.trans,L=D.index,F=D.range;return new Promise(function(R,z){var V=N.objectStore(M),W=L.isPrimaryKey?V:V.index(L.name),oe=p(F),ce=oe?W.count(oe):W.count();ce.onsuccess=Ce(function(Y){return R(Y.target.result)}),ce.onerror=tr(z)})}}}var _=c(o,u),y=_.schema,x=_.hasGetAll,w=y.tables.map(function($){return d($)}),S={};return w.forEach(function($){return S[$.name]=$}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function($){var M=S[$];if(!M)throw new Error("Table '".concat($,"' not found"));return S[$]},MIN_KEY:-1/0,MAX_KEY:fo(s),schema:y}}function Yx(o,s){return s.reduce(function(u,c){var p=c.create;return r(r({},u),p(u))},o)}function Qx(o,s,u,c){var p=u.IDBKeyRange;u.indexedDB;var d=Yx(Gx(s,p,c),o.dbcore);return{dbcore:d}}function Ms(o,s){var u=s.db,c=Qx(o._middlewares,u,o._deps,s);o.core=c.dbcore,o.tables.forEach(function(p){var d=p.name;o.core.schema.tables.some(function(_){return _.name===d})&&(p.core=o.core.table(d),o[d]instanceof o.Table&&(o[d].core=p.core))})}function Ds(o,s,u,c){u.forEach(function(p){var d=c[p];s.forEach(function(_){var y=G(_,p);(!y||"value"in y&&y.value===void 0)&&(_===o.Transaction.prototype||_ instanceof o.Transaction?E(_,p,{get:function(){return this.table(p)},set:function(x){O(this,p,{value:x,writable:!0,configurable:!0,enumerable:!0})}}):_[p]=new o.Table(p,d))})})}function Nl(o,s){s.forEach(function(u){for(var c in u)u[c]instanceof o.Table&&delete u[c]})}function Jx(o,s){return o._cfg.version-s._cfg.version}function Xx(o,s,u,c){var p=o._dbSchema;u.objectStoreNames.contains("$meta")&&!p.$meta&&(p.$meta=Pl("$meta",am("")[0],[]),o._storeNames.push("$meta"));var d=o._createTransaction("readwrite",o._storeNames,p);d.create(u),d._completion.catch(c);var _=d._reject.bind(d),y=ee.transless||ee;zr(function(){if(ee.trans=d,ee.transless=y,s===0)a(p).forEach(function(x){Fl(u,x,p[x].primKey,p[x].indexes)}),Ms(o,u),q.follow(function(){return o.on.populate.fire(d)}).catch(_);else return Ms(o,u),ev(o,d,s).then(function(x){return tv(o,x,d,u)}).catch(_)})}function Zx(o,s){sm(o._dbSchema,s),s.db.version%10===0&&!s.objectStoreNames.contains("$meta")&&s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var u=Rs(o,o.idbdb,s);Ns(o,o._dbSchema,s);for(var c=Ll(u,o._dbSchema),p=function(w){if(w.change.length||w.recreate)return console.warn("Unable to patch indexes of table ".concat(w.name," because it has changes on the type of index or primary key.")),{value:void 0};var S=s.objectStore(w.name);w.add.forEach(function($){er&&console.debug("Dexie upgrade patch: Creating missing index ".concat(w.name,".").concat($.src)),Ps(S,$)})},d=0,_=c.change;d<_.length;d++){var y=_[d],x=p(y);if(typeof x=="object")return x.value}}function ev(o,s,u){return s.storeNames.includes("$meta")?s.table("$meta").get("version").then(function(c){return c??u}):q.resolve(u)}function tv(o,s,u,c){var p=[],d=o._versions,_=o._dbSchema=Rs(o,o.idbdb,c),y=d.filter(function(w){return w._cfg.version>=s});if(y.length===0)return q.resolve();y.forEach(function(w){p.push(function(){var S=_,$=w._cfg.dbschema;Ns(o,S,c),Ns(o,$,c),_=o._dbSchema=$;var M=Ll(S,$);M.add.forEach(function(N){Fl(c,N[0],N[1].primKey,N[1].indexes)}),M.change.forEach(function(N){if(N.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var L=c.objectStore(N.name);N.add.forEach(function(F){return Ps(L,F)}),N.change.forEach(function(F){L.deleteIndex(F.name),Ps(L,F)}),N.del.forEach(function(F){return L.deleteIndex(F)})});var j=w._cfg.contentUpgrade;if(j&&w._cfg.version>s){Ms(o,c),u._memoizedTables={};var b=Ot($);M.del.forEach(function(N){b[N]=S[N]}),Nl(o,[o.Transaction.prototype]),Ds(o,[o.Transaction.prototype],a(b),b),u.schema=b;var A=pl(j);A&&oi();var I,D=q.follow(function(){if(I=j(u),I&&A){var N=Wr.bind(null,null);I.then(N,N)}});return I&&typeof I.then=="function"?q.resolve(I):D.then(function(){return I})}}),p.push(function(S){var $=w._cfg.dbschema;rv($,S),Nl(o,[o.Transaction.prototype]),Ds(o,[o.Transaction.prototype],o._storeNames,o._dbSchema),u.schema=o._dbSchema}),p.push(function(S){o.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(o.idbdb.version/10)===w._cfg.version?(o.idbdb.deleteObjectStore("$meta"),delete o._dbSchema.$meta,o._storeNames=o._storeNames.filter(function($){return $!=="$meta"})):S.objectStore("$meta").put(w._cfg.version,"version"))})});function x(){return p.length?q.resolve(p.shift()(u.idbtrans)).then(x):q.resolve()}return x().then(function(){sm(_,c)})}function Ll(o,s){var u={del:[],add:[],change:[]},c;for(c in o)s[c]||u.del.push(c);for(c in s){var p=o[c],d=s[c];if(!p)u.add.push([c,d]);else{var _={name:c,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(p.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||p.primKey.auto!==d.primKey.auto)_.recreate=!0,u.change.push(_);else{var y=p.idxByName,x=d.idxByName,w=void 0;for(w in y)x[w]||_.del.push(w);for(w in x){var S=y[w],$=x[w];S?S.src!==$.src&&_.change.push($):_.add.push($)}(_.del.length>0||_.add.length>0||_.change.length>0)&&u.change.push(_)}}}return u}function Fl(o,s,u,c){var p=o.db.createObjectStore(s,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});return c.forEach(function(d){return Ps(p,d)}),p}function sm(o,s){a(o).forEach(function(u){s.db.objectStoreNames.contains(u)||(er&&console.debug("Dexie: Creating missing table",u),Fl(s,u,o[u].primKey,o[u].indexes))})}function rv(o,s){[].slice.call(s.db.objectStoreNames).forEach(function(u){return o[u]==null&&s.db.deleteObjectStore(u)})}function Ps(o,s){o.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Rs(o,s,u){var c={},p=Q(s.objectStoreNames,0);return p.forEach(function(d){for(var _=u.objectStore(d),y=_.keyPath,x=Dl(im(y),y||"",!0,!1,!!_.autoIncrement,y&&typeof y!="string",!0),w=[],S=0;S<_.indexNames.length;++S){var $=_.index(_.indexNames[S]);y=$.keyPath;var M=Dl($.name,y,!!$.unique,!!$.multiEntry,!1,y&&typeof y!="string",!1);w.push(M)}c[d]=Pl(d,x,w)}),c}function nv(o,s,u){o.verno=s.version/10;var c=o._dbSchema=Rs(o,s,u);o._storeNames=Q(s.objectStoreNames,0),Ds(o,[o._allTables],a(c),c)}function iv(o,s){var u=Rs(o,o.idbdb,s),c=Ll(u,o._dbSchema);return!(c.add.length||c.change.some(function(p){return p.add.length||p.change.length}))}function Ns(o,s,u){for(var c=u.db.objectStoreNames,p=0;p<c.length;++p){var d=c[p],_=u.objectStore(d);o._hasGetAll="getAll"in _;for(var y=0;y<_.indexNames.length;++y){var x=_.indexNames[y],w=_.index(x).keyPath,S=typeof w=="string"?w:"["+Q(w).join("+")+"]";if(s[d]){var $=s[d].idxByName[S];$&&($.name=x,delete s[d].idxByName[S],s[d].idxByName[x]=$)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function am(o){return o.split(",").map(function(s,u){s=s.trim();var c=s.replace(/([&*]|\+\+)/g,""),p=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Dl(c,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),l(p),u===0)})}var ov=function(){function o(){}return o.prototype._parseStoresSpec=function(s,u){a(s).forEach(function(c){if(s[c]!==null){var p=am(s[c]),d=p.shift();if(d.unique=!0,d.multi)throw new ie.Schema("Primary key cannot be multi-valued");p.forEach(function(_){if(_.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!_.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}),u[c]=Pl(c,d,p)}})},o.prototype.stores=function(s){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?f(this._cfg.storesSource,s):s;var c=u._versions,p={},d={};return c.forEach(function(_){f(p,_._cfg.storesSource),d=_._cfg.dbschema={},_._parseStoresSpec(p,d)}),u._dbSchema=d,Nl(u,[u._allTables,u,u.Transaction.prototype]),Ds(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],a(d),d),u._storeNames=a(d),this},o.prototype.upgrade=function(s){return this._cfg.contentUpgrade=hl(this._cfg.contentUpgrade||Ae,s),this},o}();function sv(o){return ao(ov.prototype,function(u){this.db=o,this._cfg={version:u,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Bl(o,s){var u=o._dbNamesDB;return u||(u=o._dbNamesDB=new br(As,{addons:[],indexedDB:o,IDBKeyRange:s}),u.version(1).stores({dbnames:"name"})),u.table("dbnames")}function jl(o){return o&&typeof o.databases=="function"}function av(o){var s=o.indexedDB,u=o.IDBKeyRange;return jl(s)?Promise.resolve(s.databases()).then(function(c){return c.map(function(p){return p.name}).filter(function(p){return p!==As})}):Bl(s,u).toCollection().primaryKeys()}function uv(o,s){var u=o.indexedDB,c=o.IDBKeyRange;!jl(u)&&s!==As&&Bl(u,c).put({name:s}).catch(Ae)}function lv(o,s){var u=o.indexedDB,c=o.IDBKeyRange;!jl(u)&&s!==As&&Bl(u,c).delete(s).catch(Ae)}function Kl(o){return zr(function(){return ee.letThrough=!0,o()})}function cv(){var o=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!o||!indexedDB.databases)return Promise.resolve();var s;return new Promise(function(u){var c=function(){return indexedDB.databases().finally(u)};s=setInterval(c,100),c()}).finally(function(){return clearInterval(s)})}var Ul;function zl(o){return!("from"in o)}var et=function(o,s){if(this)f(this,arguments.length?{d:1,from:o,to:arguments.length>1?s:o}:{d:0});else{var u=new et;return o&&"d"in o&&f(u,o),u}};v(et.prototype,(Ul={add:function(o){return ho(this,o),this},addKey:function(o){return mo(this,o,o),this},addKeys:function(o){var s=this;return o.forEach(function(u){return mo(s,u,u)}),this},hasKey:function(o){var s=Ls(this).next(o).value;return s&&ge(s.from,o)<=0&&ge(s.to,o)>=0}},Ul[to]=function(){return Ls(this)},Ul));function mo(o,s,u){var c=ge(s,u);if(!isNaN(c)){if(c>0)throw RangeError();if(zl(o))return f(o,{from:s,to:u,d:1});var p=o.l,d=o.r;if(ge(u,o.from)<0)return p?mo(p,s,u):o.l={from:s,to:u,d:1,l:null,r:null},lm(o);if(ge(s,o.to)>0)return d?mo(d,s,u):o.r={from:s,to:u,d:1,l:null,r:null},lm(o);ge(s,o.from)<0&&(o.from=s,o.l=null,o.d=d?d.d+1:1),ge(u,o.to)>0&&(o.to=u,o.r=null,o.d=o.l?o.l.d+1:1);var _=!o.r;p&&!o.l&&ho(o,p),d&&_&&ho(o,d)}}function ho(o,s){function u(c,p){var d=p.from,_=p.to,y=p.l,x=p.r;mo(c,d,_),y&&u(c,y),x&&u(c,x)}zl(s)||u(o,s)}function um(o,s){var u=Ls(s),c=u.next();if(c.done)return!1;for(var p=c.value,d=Ls(o),_=d.next(p.from),y=_.value;!c.done&&!_.done;){if(ge(y.from,p.to)<=0&&ge(y.to,p.from)>=0)return!0;ge(p.from,y.from)<0?p=(c=u.next(y.from)).value:y=(_=d.next(p.from)).value}return!1}function Ls(o){var s=zl(o)?null:{s:0,n:o};return{next:function(u){for(var c=arguments.length>0;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&ge(u,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||ge(u,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function lm(o){var s,u,c=(((s=o.r)===null||s===void 0?void 0:s.d)||0)-(((u=o.l)===null||u===void 0?void 0:u.d)||0),p=c>1?"r":c<-1?"l":"";if(p){var d=p==="r"?"l":"r",_=r({},o),y=o[p];o.from=y.from,o.to=y.to,o[p]=y[p],_[p]=y[d],o[d]=_,_.d=cm(_)}o.d=cm(o)}function cm(o){var s=o.r,u=o.l;return(s?u?Math.max(s.d,u.d):s.d:u?u.d:0)+1}function Fs(o,s){return a(s).forEach(function(u){o[u]?ho(o[u],s[u]):o[u]=_s(s[u])}),o}function Wl(o,s){return o.all||s.all||Object.keys(o).some(function(u){return s[u]&&um(s[u],o[u])})}var wn={},ql={},Vl=!1;function Bs(o,s){Fs(ql,o),Vl||(Vl=!0,setTimeout(function(){Vl=!1;var u=ql;ql={},Hl(u,!1)},0))}function Hl(o,s){s===void 0&&(s=!1);var u=new Set;if(o.all)for(var c=0,p=Object.values(wn);c<p.length;c++){var d=p[c];fm(d,o,u,s)}else for(var _ in o){var y=/^idb\:\/\/(.*)\/(.*)\//.exec(_);if(y){var x=y[1],w=y[2],d=wn["idb://".concat(x,"/").concat(w)];d&&fm(d,o,u,s)}}u.forEach(function(S){return S()})}function fm(o,s,u,c){for(var p=[],d=0,_=Object.entries(o.queries.query);d<_.length;d++){for(var y=_[d],x=y[0],w=y[1],S=[],$=0,M=w;$<M.length;$++){var j=M[$];Wl(s,j.obsSet)?j.subscribers.forEach(function(D){return u.add(D)}):c&&S.push(j)}c&&p.push([x,S])}if(c)for(var b=0,A=p;b<A.length;b++){var I=A[b],x=I[0],S=I[1];o.queries.query[x]=S}}function fv(o){var s=o._state,u=o._deps.indexedDB;if(s.isBeingOpened||o.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?Pe(s.dbOpenError):o});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,p=Math.round(o.verno*10),d=!1;function _(){if(s.openCanceller!==c)throw new ie.DatabaseClosed("db.open() was cancelled")}var y=s.dbReadyResolve,x=null,w=!1,S=function(){return new q(function($,M){if(_(),!u)throw new ie.MissingAPI;var j=o.name,b=s.autoSchema||!p?u.open(j):u.open(j,p);if(!b)throw new ie.MissingAPI;b.onerror=tr(M),b.onblocked=Ce(o._fireOnBlocked),b.onupgradeneeded=Ce(function(A){if(x=b.transaction,s.autoSchema&&!o._options.allowEmptyDB){b.onerror=lo,x.abort(),b.result.close();var I=u.deleteDatabase(j);I.onsuccess=I.onerror=Ce(function(){M(new ie.NoSuchDatabase("Database ".concat(j," doesnt exist")))})}else{x.onerror=tr(M);var D=A.oldVersion>Math.pow(2,62)?0:A.oldVersion;w=D<1,o.idbdb=b.result,d&&Zx(o,x),Xx(o,D/10,x,M)}},M),b.onsuccess=Ce(function(){x=null;var A=o.idbdb=b.result,I=Q(A.objectStoreNames);if(I.length>0)try{var D=A.transaction(qx(I),"readonly");if(s.autoSchema)nv(o,A,D);else if(Ns(o,o._dbSchema,D),!iv(o,D)&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),A.close(),p=A.version+1,d=!0,$(S());Ms(o,D)}catch{}si.push(o),A.onversionchange=Ce(function(N){s.vcFired=!0,o.on("versionchange").fire(N)}),A.onclose=Ce(function(N){o.on("close").fire(N)}),w&&uv(o._deps,j),$()},M)}).catch(function($){switch($?.name){case"UnknownError":if(s.PR1398_maxLoop>0)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),S();break;case"VersionError":if(p>0)return p=0,S();break}return q.reject($)})};return q.race([c,(typeof navigator>"u"?q.resolve():cv()).then(S)]).then(function(){return _(),s.onReadyBeingFired=[],q.resolve(Kl(function(){return o.on.ready.fire(o.vip)})).then(function $(){if(s.onReadyBeingFired.length>0){var M=s.onReadyBeingFired.reduce(hl,Ae);return s.onReadyBeingFired=[],q.resolve(Kl(function(){return M(o.vip)})).then($)}})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function($){s.dbOpenError=$;try{x&&x.abort()}catch{}return c===s.openCanceller&&o._close(),Pe($)}).finally(function(){s.openComplete=!0,y()}).then(function(){if(w){var $={};o.tables.forEach(function(M){M.schema.indexes.forEach(function(j){j.name&&($["idb://".concat(o.name,"/").concat(M.name,"/").concat(j.name)]=new et(-1/0,[[[]]]))}),$["idb://".concat(o.name,"/").concat(M.name,"/")]=$["idb://".concat(o.name,"/").concat(M.name,"/:dels")]=new et(-1/0,[[[]]])}),Hr(co).fire($),Hl($,!0)}return o})}function Gl(o){var s=function(_){return o.next(_)},u=function(_){return o.throw(_)},c=d(s),p=d(u);function d(_){return function(y){var x=_(y),w=x.value;return x.done?w:!w||typeof w.then!="function"?l(w)?Promise.all(w).then(c,p):c(w):w.then(c,p)}}return d(s)()}function pv(o,s,u){var c=arguments.length;if(c<2)throw new ie.InvalidArgument("Too few arguments");for(var p=new Array(c-1);--c;)p[c-1]=arguments[c];u=p.pop();var d=Zt(p);return[o,d,u]}function pm(o,s,u,c,p){return q.resolve().then(function(){var d=ee.transless||ee,_=o._createTransaction(s,u,o._dbSchema,c);_.explicit=!0;var y={trans:_,transless:d};if(c)_.idbtrans=c.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,o._state.PR1398_maxLoop=3}catch($){return $.name===dl.InvalidState&&o.isOpen()&&--o._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),o.close({disableAutoOpen:!1}),o.open().then(function(){return pm(o,s,u,null,p)})):Pe($)}var x=pl(p);x&&oi();var w,S=q.follow(function(){if(w=p.call(_,_),w)if(x){var $=Wr.bind(null,null);w.then($,$)}else typeof w.next=="function"&&typeof w.throw=="function"&&(w=Gl(w))},y);return(w&&typeof w.then=="function"?q.resolve(w).then(function($){return _.active?$:Pe(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):S.then(function(){return w})).then(function($){return c&&_._resolve(),_._completion.then(function(){return $})}).catch(function($){return _._reject($),Pe($)})})}function js(o,s,u){for(var c=l(o)?o.slice():[o],p=0;p<u;++p)c.push(s);return c}function mv(o){return r(r({},o),{table:function(s){var u=o.table(s),c=u.schema,p={},d=[];function _(A,I,D){var N=po(A),L=p[N]=p[N]||[],F=A==null?0:typeof A=="string"?1:A.length,R=I>0,z=r(r({},D),{name:R?"".concat(N,"(virtual-from:").concat(D.name,")"):D.name,lowLevelIndex:D,isVirtual:R,keyTail:I,keyLength:F,extractKey:Rl(A),unique:!R&&D.unique});if(L.push(z),z.isPrimaryKey||d.push(z),F>1){var V=F===2?A[0]:A.slice(0,F-1);_(V,I+1,D)}return L.sort(function(W,oe){return W.keyTail-oe.keyTail}),z}var y=_(c.primaryKey.keyPath,0,c.primaryKey);p[":id"]=[y];for(var x=0,w=c.indexes;x<w.length;x++){var S=w[x];_(S.keyPath,0,S)}function $(A){var I=p[po(A)];return I&&I[0]}function M(A,I){return{type:A.type===1?2:A.type,lower:js(A.lower,A.lowerOpen?o.MAX_KEY:o.MIN_KEY,I),lowerOpen:!0,upper:js(A.upper,A.upperOpen?o.MIN_KEY:o.MAX_KEY,I),upperOpen:!0}}function j(A){var I=A.query.index;return I.isVirtual?r(r({},A),{query:{index:I.lowLevelIndex,range:M(A.query.range,I.keyTail)}}):A}var b=r(r({},u),{schema:r(r({},c),{primaryKey:y,indexes:d,getIndexByKeyPath:$}),count:function(A){return u.count(j(A))},query:function(A){return u.query(j(A))},openCursor:function(A){var I=A.query.index,D=I.keyTail,N=I.isVirtual,L=I.keyLength;if(!N)return u.openCursor(A);function F(R){function z(W){W!=null?R.continue(js(W,A.reverse?o.MAX_KEY:o.MIN_KEY,D)):A.unique?R.continue(R.key.slice(0,L).concat(A.reverse?o.MIN_KEY:o.MAX_KEY,D)):R.continue()}var V=Object.create(R,{continue:{value:z},continuePrimaryKey:{value:function(W,oe){R.continuePrimaryKey(js(W,o.MAX_KEY,D),oe)}},primaryKey:{get:function(){return R.primaryKey}},key:{get:function(){var W=R.key;return L===1?W[0]:W.slice(0,L)}},value:{get:function(){return R.value}}});return V}return u.openCursor(j(A)).then(function(R){return R&&F(R)})}});return b}})}var dv={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:mv};function Yl(o,s,u,c){return u=u||{},c=c||"",a(o).forEach(function(p){if(!g(s,p))u[c+p]=void 0;else{var d=o[p],_=s[p];if(typeof d=="object"&&typeof _=="object"&&d&&_){var y=Kr(d),x=Kr(_);y!==x?u[c+p]=s[p]:y==="Object"?Yl(d,_,u,c+p+"."):d!==_&&(u[c+p]=s[p])}else d!==_&&(u[c+p]=s[p])}}),a(s).forEach(function(p){g(o,p)||(u[c+p]=s[p])}),u}function Ql(o,s){return s.type==="delete"?s.keys:s.keys||s.values.map(o.extractKey)}var hv={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return r(r({},o),{table:function(s){var u=o.table(s),c=u.schema.primaryKey,p=r(r({},u),{mutate:function(d){var _=ee.trans,y=_.table(s).hook,x=y.deleting,w=y.creating,S=y.updating;switch(d.type){case"add":if(w.fire===Ae)break;return _._promise("readwrite",function(){return $(d)},!0);case"put":if(w.fire===Ae&&S.fire===Ae)break;return _._promise("readwrite",function(){return $(d)},!0);case"delete":if(x.fire===Ae)break;return _._promise("readwrite",function(){return $(d)},!0);case"deleteRange":if(x.fire===Ae)break;return _._promise("readwrite",function(){return M(d)},!0)}return u.mutate(d);function $(b){var A=ee.trans,I=b.keys||Ql(c,b);if(!I)throw new Error("Keys missing");return b=b.type==="add"||b.type==="put"?r(r({},b),{keys:I}):r({},b),b.type!=="delete"&&(b.values=n([],b.values,!0)),b.keys&&(b.keys=n([],b.keys,!0)),_v(u,b,I).then(function(D){var N=I.map(function(L,F){var R=D[F],z={onerror:null,onsuccess:null};if(b.type==="delete")x.fire.call(z,L,R,A);else if(b.type==="add"||R===void 0){var V=w.fire.call(z,L,b.values[F],A);L==null&&V!=null&&(L=V,b.keys[F]=L,c.outbound||pe(b.values[F],c.keyPath,L))}else{var W=Yl(R,b.values[F]),oe=S.fire.call(z,W,L,R,A);if(oe){var ce=b.values[F];Object.keys(oe).forEach(function(Y){g(ce,Y)?ce[Y]=oe[Y]:pe(ce,Y,oe[Y])})}}return z});return u.mutate(b).then(function(L){for(var F=L.failures,R=L.results,z=L.numFailures,V=L.lastResult,W=0;W<I.length;++W){var oe=R?R[W]:I[W],ce=N[W];oe==null?ce.onerror&&ce.onerror(F[W]):ce.onsuccess&&ce.onsuccess(b.type==="put"&&D[W]?b.values[W]:oe)}return{failures:F,results:R,numFailures:z,lastResult:V}}).catch(function(L){return N.forEach(function(F){return F.onerror&&F.onerror(L)}),Promise.reject(L)})})}function M(b){return j(b.trans,b.range,1e4)}function j(b,A,I){return u.query({trans:b,values:!1,query:{index:c,range:A},limit:I}).then(function(D){var N=D.result;return $({type:"delete",keys:N,trans:b}).then(function(L){return L.numFailures>0?Promise.reject(L.failures[0]):N.length<I?{failures:[],numFailures:0,lastResult:void 0}:j(b,r(r({},A),{lower:N[N.length-1],lowerOpen:!0}),I)})})}}});return p}})}};function _v(o,s,u){return s.type==="add"?Promise.resolve([]):o.getMany({trans:s.trans,keys:u,cache:"immutable"})}function mm(o,s,u){try{if(!s||s.keys.length<o.length)return null;for(var c=[],p=0,d=0;p<s.keys.length&&d<o.length;++p)ge(s.keys[p],o[d])===0&&(c.push(u?St(s.values[p]):s.values[p]),++d);return c.length===o.length?c:null}catch{return null}}var gv={stack:"dbcore",level:-1,create:function(o){return{table:function(s){var u=o.table(s);return r(r({},u),{getMany:function(c){if(!c.cache)return u.getMany(c);var p=mm(c.keys,c.trans._cache,c.cache==="clone");return p?q.resolve(p):u.getMany(c).then(function(d){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?St(d):d},d})},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),u.mutate(c)}})}}}};function dm(o,s){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function hm(o,s){switch(o){case"query":return s.values&&!s.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var yv={stack:"dbcore",level:0,name:"Observability",create:function(o){var s=o.schema.name,u=new et(o.MIN_KEY,o.MAX_KEY);return r(r({},o),{transaction:function(c,p,d){if(ee.subscr&&p!=="readonly")throw new ie.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ee.querier));return o.transaction(c,p,d)},table:function(c){var p=o.table(c),d=p.schema,_=d.primaryKey,y=d.indexes,x=_.extractKey,w=_.outbound,S=_.autoIncrement&&y.filter(function(b){return b.compound&&b.keyPath.includes(_.keyPath)}),$=r(r({},p),{mutate:function(b){var A,I,D=b.trans,N=b.mutatedParts||(b.mutatedParts={}),L=function(re){var xe="idb://".concat(s,"/").concat(c,"/").concat(re);return N[xe]||(N[xe]=new et)},F=L(""),R=L(":dels"),z=b.type,V=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[Ql(_,b).filter(function(re){return re}),b.values]:[],W=V[0],oe=V[1],ce=b.trans._cache;if(l(W)){F.addKeys(W);var Y=z==="delete"||W.length===oe.length?mm(W,ce):null;Y||R.addKeys(W),(Y||oe)&&xv(L,d,Y,oe)}else if(W){var he={from:(A=W.lower)!==null&&A!==void 0?A:o.MIN_KEY,to:(I=W.upper)!==null&&I!==void 0?I:o.MAX_KEY};R.add(he),F.add(he)}else F.add(u),R.add(u),d.indexes.forEach(function(re){return L(re.name).add(u)});return p.mutate(b).then(function(re){return W&&(b.type==="add"||b.type==="put")&&(F.addKeys(re.results),S&&S.forEach(function(xe){var ae=b.values.map(function(Ye){return xe.extractKey(Ye)}),Re=xe.keyPath.findIndex(function(Ye){return Ye===_.keyPath});re.results.forEach(function(Ye){return ae[Re]=Ye}),L(xe.name).addKeys(ae)})),D.mutatedParts=Fs(D.mutatedParts||{},N),re})}}),M=function(b){var A,I,D=b.query,N=D.index,L=D.range;return[N,new et((A=L.lower)!==null&&A!==void 0?A:o.MIN_KEY,(I=L.upper)!==null&&I!==void 0?I:o.MAX_KEY)]},j={get:function(b){return[_,new et(b.key)]},getMany:function(b){return[_,new et().addKeys(b.keys)]},count:M,query:M,openCursor:M};return a(j).forEach(function(b){$[b]=function(A){var I=ee.subscr,D=!!I,N=dm(ee,p)&&hm(b,A),L=N?A.obsSet={}:I;if(D){var F=function(Y){var he="idb://".concat(s,"/").concat(c,"/").concat(Y);return L[he]||(L[he]=new et)},R=F(""),z=F(":dels"),V=j[b](A),W=V[0],oe=V[1];if(b==="query"&&W.isPrimaryKey&&!A.values?z.add(oe):F(W.name||"").add(oe),!W.isPrimaryKey)if(b==="count")z.add(u);else{var ce=b==="query"&&w&&A.values&&p.query(r(r({},A),{values:!1}));return p[b].apply(this,arguments).then(function(Y){if(b==="query"){if(w&&A.values)return ce.then(function(ae){var Re=ae.result;return R.addKeys(Re),Y});var he=A.values?Y.result.map(x):Y.result;A.values?R.addKeys(he):z.addKeys(he)}else if(b==="openCursor"){var re=Y,xe=A.values;return re&&Object.create(re,{key:{get:function(){return z.addKey(re.primaryKey),re.key}},primaryKey:{get:function(){var ae=re.primaryKey;return z.addKey(ae),ae}},value:{get:function(){return xe&&R.addKey(re.primaryKey),re.value}}})}return Y})}}return p[b].apply(this,arguments)}}),$}})}};function xv(o,s,u,c){function p(d){var _=o(d.name||"");function y(w){return w!=null?d.extractKey(w):null}var x=function(w){return d.multiEntry&&l(w)?w.forEach(function(S){return _.addKey(S)}):_.addKey(w)};(u||c).forEach(function(w,S){var $=u&&y(u[S]),M=c&&y(c[S]);ge($,M)!==0&&($!=null&&x($),M!=null&&x(M))})}s.indexes.forEach(p)}function _m(o,s,u){if(u.numFailures===0)return s;if(s.type==="deleteRange")return null;var c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;if(u.numFailures===c)return null;var p=r({},s);return l(p.keys)&&(p.keys=p.keys.filter(function(d,_){return!(_ in u.failures)})),"values"in p&&l(p.values)&&(p.values=p.values.filter(function(d,_){return!(_ in u.failures)})),p}function vv(o,s){return s.lower===void 0?!0:s.lowerOpen?ge(o,s.lower)>0:ge(o,s.lower)>=0}function wv(o,s){return s.upper===void 0?!0:s.upperOpen?ge(o,s.upper)<0:ge(o,s.upper)<=0}function Jl(o,s){return vv(o,s)&&wv(o,s)}function gm(o,s,u,c,p,d){if(!u||u.length===0)return o;var _=s.query.index,y=_.multiEntry,x=s.query.range,w=c.schema.primaryKey,S=w.extractKey,$=_.extractKey,M=(_.lowLevelIndex||_).extractKey,j=u.reduce(function(b,A){var I=b,D=[];if(A.type==="add"||A.type==="put")for(var N=new et,L=A.values.length-1;L>=0;--L){var F=A.values[L],R=S(F);if(!N.hasKey(R)){var z=$(F);(y&&l(z)?z.some(function(Y){return Jl(Y,x)}):Jl(z,x))&&(N.addKey(R),D.push(F))}}switch(A.type){case"add":{var V=new et().addKeys(s.values?b.map(function(Y){return S(Y)}):b);I=b.concat(s.values?D.filter(function(Y){var he=S(Y);return V.hasKey(he)?!1:(V.addKey(he),!0)}):D.map(function(Y){return S(Y)}).filter(function(Y){return V.hasKey(Y)?!1:(V.addKey(Y),!0)}));break}case"put":{var W=new et().addKeys(A.values.map(function(Y){return S(Y)}));I=b.filter(function(Y){return!W.hasKey(s.values?S(Y):Y)}).concat(s.values?D:D.map(function(Y){return S(Y)}));break}case"delete":var oe=new et().addKeys(A.keys);I=b.filter(function(Y){return!oe.hasKey(s.values?S(Y):Y)});break;case"deleteRange":var ce=A.range;I=b.filter(function(Y){return!Jl(S(Y),ce)});break}return I},o);return j===o?o:(j.sort(function(b,A){return ge(M(b),M(A))||ge(S(b),S(A))}),s.limit&&s.limit<1/0&&(j.length>s.limit?j.length=s.limit:o.length===s.limit&&j.length<s.limit&&(p.dirty=!0)),d?Object.freeze(j):j)}function ym(o,s){return ge(o.lower,s.lower)===0&&ge(o.upper,s.upper)===0&&!!o.lowerOpen==!!s.lowerOpen&&!!o.upperOpen==!!s.upperOpen}function $v(o,s,u,c){if(o===void 0)return s!==void 0?-1:0;if(s===void 0)return 1;var p=ge(o,s);if(p===0){if(u&&c)return 0;if(u)return 1;if(c)return-1}return p}function bv(o,s,u,c){if(o===void 0)return s!==void 0?1:0;if(s===void 0)return-1;var p=ge(o,s);if(p===0){if(u&&c)return 0;if(u)return-1;if(c)return 1}return p}function Ev(o,s){return $v(o.lower,s.lower,o.lowerOpen,s.lowerOpen)<=0&&bv(o.upper,s.upper,o.upperOpen,s.upperOpen)>=0}function Ov(o,s,u,c){var p=wn["idb://".concat(o,"/").concat(s)];if(!p)return[];var d=p.queries[u];if(!d)return[null,!1,p,null];var _=c.query?c.query.index.name:null,y=d[_||""];if(!y)return[null,!1,p,null];switch(u){case"query":var x=y.find(function($){return $.req.limit===c.limit&&$.req.values===c.values&&ym($.req.query.range,c.query.range)});if(x)return[x,!0,p,y];var w=y.find(function($){var M="limit"in $.req?$.req.limit:1/0;return M>=c.limit&&(c.values?$.req.values:!0)&&Ev($.req.query.range,c.query.range)});return[w,!1,p,y];case"count":var S=y.find(function($){return ym($.req.query.range,c.query.range)});return[S,!!S,p,y]}}function Sv(o,s,u,c){o.subscribers.add(u),c.addEventListener("abort",function(){o.subscribers.delete(u),o.subscribers.size===0&&Av(o,s)})}function Av(o,s){setTimeout(function(){o.subscribers.size===0&&Be(s,o)},3e3)}var kv={stack:"dbcore",level:0,name:"Cache",create:function(o){var s=o.schema.name,u=r(r({},o),{transaction:function(c,p,d){var _=o.transaction(c,p,d);if(p==="readwrite"){var y=new AbortController,x=y.signal,w=function(S){return function(){if(y.abort(),p==="readwrite"){for(var $=new Set,M=0,j=c;M<j.length;M++){var b=j[M],A=wn["idb://".concat(s,"/").concat(b)];if(A){var I=o.table(b),D=A.optimisticOps.filter(function(xe){return xe.trans===_});if(_._explicit&&S&&_.mutatedParts)for(var N=0,L=Object.values(A.queries.query);N<L.length;N++)for(var F=L[N],R=0,z=F.slice();R<z.length;R++){var V=z[R];Wl(V.obsSet,_.mutatedParts)&&(Be(F,V),V.subscribers.forEach(function(xe){return $.add(xe)}))}else if(D.length>0){A.optimisticOps=A.optimisticOps.filter(function(xe){return xe.trans!==_});for(var W=0,oe=Object.values(A.queries.query);W<oe.length;W++)for(var F=oe[W],ce=0,Y=F.slice();ce<Y.length;ce++){var V=Y[ce];if(V.res!=null&&_.mutatedParts)if(S&&!V.dirty){var he=Object.isFrozen(V.res),re=gm(V.res,V.req,D,I,V,he);V.dirty?(Be(F,V),V.subscribers.forEach(function(Re){return $.add(Re)})):re!==V.res&&(V.res=re,V.promise=q.resolve({result:re}))}else V.dirty&&Be(F,V),V.subscribers.forEach(function(Re){return $.add(Re)})}}}}$.forEach(function(xe){return xe()})}}};_.addEventListener("abort",w(!1),{signal:x}),_.addEventListener("error",w(!1),{signal:x}),_.addEventListener("complete",w(!0),{signal:x})}return _},table:function(c){var p=o.table(c),d=p.schema.primaryKey,_=r(r({},p),{mutate:function(y){var x=ee.trans;if(d.outbound||x.db._options.cache==="disabled"||x.explicit||x.idbtrans.mode!=="readwrite")return p.mutate(y);var w=wn["idb://".concat(s,"/").concat(c)];if(!w)return p.mutate(y);var S=p.mutate(y);return(y.type==="add"||y.type==="put")&&(y.values.length>=50||Ql(d,y).some(function($){return $==null}))?S.then(function($){var M=r(r({},y),{values:y.values.map(function(b,A){var I;if($.failures[A])return b;var D=!((I=d.keyPath)===null||I===void 0)&&I.includes(".")?St(b):r({},b);return pe(D,d.keyPath,$.results[A]),D})}),j=_m(w,M,$);w.optimisticOps.push(j),queueMicrotask(function(){return y.mutatedParts&&Bs(y.mutatedParts)})}):(w.optimisticOps.push(y),y.mutatedParts&&Bs(y.mutatedParts),S.then(function($){if($.numFailures>0){Be(w.optimisticOps,y);var M=_m(w,y,$);M&&w.optimisticOps.push(M),y.mutatedParts&&Bs(y.mutatedParts)}}),S.catch(function(){Be(w.optimisticOps,y),y.mutatedParts&&Bs(y.mutatedParts)})),S},query:function(y){var x;if(!dm(ee,p)||!hm("query",y))return p.query(y);var w=((x=ee.trans)===null||x===void 0?void 0:x.db._options.cache)==="immutable",S=ee,$=S.requery,M=S.signal,j=Ov(s,c,"query",y),b=j[0],A=j[1],I=j[2],D=j[3];if(b&&A)b.obsSet=y.obsSet;else{var N=p.query(y).then(function(L){var F=L.result;if(b&&(b.res=F),w){for(var R=0,z=F.length;R<z;++R)Object.freeze(F[R]);Object.freeze(F)}else L.result=St(F);return L}).catch(function(L){return D&&b&&Be(D,b),Promise.reject(L)});b={obsSet:y.obsSet,promise:N,subscribers:new Set,type:"query",req:y,dirty:!1},D?D.push(b):(D=[b],I||(I=wn["idb://".concat(s,"/").concat(c)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),I.queries.query[y.query.index.name||""]=D)}return Sv(b,D,$,M),b.promise.then(function(L){return{result:gm(L.result,y,I?.optimisticOps,p,b,w)}})}});return _}});return u}};function Ks(o,s){return new Proxy(o,{get:function(u,c,p){return c==="db"?s:Reflect.get(u,c,p)}})}var br=function(){function o(s,u){var c=this;this._middlewares={},this.verno=0;var p=o.dependencies;this._options=u=r({addons:o.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange};var d=u.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var _={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ae,dbReadyPromise:null,cancelOpen:Ae,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};_.dbReadyPromise=new q(function(x){_.dbReadyResolve=x}),_.openCanceller=new q(function(x,w){_.cancelOpen=w}),this._state=_,this.name=s,this.on=so(this,"populate","blocked","versionchange","close",{ready:[hl,Ae]}),this.on.ready.subscribe=K(this.on.ready.subscribe,function(x){return function(w,S){o.vip(function(){var $=c._state;if($.openComplete)$.dbOpenError||q.resolve().then(w),S&&x(w);else if($.onReadyBeingFired)$.onReadyBeingFired.push(w),S&&x(w);else{x(w);var M=c;S||x(function j(){M.on.ready.unsubscribe(w),M.on.ready.unsubscribe(j)})}})}}),this.Collection=Nx(this),this.Table=Mx(this),this.Transaction=Wx(this),this.Version=sv(this),this.WhereClause=Ux(this),this.on("versionchange",function(x){x.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(c.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(c.name,"'. Closing db now to resume the delete request.")),c.close({disableAutoOpen:!1})}),this.on("blocked",function(x){!x.newVersion||x.newVersion<x.oldVersion?console.warn("Dexie.delete('".concat(c.name,"') was blocked")):console.warn("Upgrade '".concat(c.name,"' blocked by other connection holding version ").concat(x.oldVersion/10))}),this._maxKey=fo(u.IDBKeyRange),this._createTransaction=function(x,w,S,$){return new c.Transaction(x,w,S,c._options.chromeTransactionDurability,$)},this._fireOnBlocked=function(x){c.on("blocked").fire(x),si.filter(function(w){return w.name===c.name&&w!==c&&!w._state.vcFired}).map(function(w){return w.on("versionchange").fire(x)})},this.use(gv),this.use(kv),this.use(yv),this.use(dv),this.use(hv);var y=new Proxy(this,{get:function(x,w,S){if(w==="_vip")return!0;if(w==="table")return function(M){return Ks(c.table(M),y)};var $=Reflect.get(x,w,S);return $ instanceof Zp?Ks($,y):w==="tables"?$.map(function(M){return Ks(M,y)}):w==="_createTransaction"?function(){var M=$.apply(this,arguments);return Ks(M,y)}:$}});this.vip=y,d.forEach(function(x){return x(c)})}return o.prototype.version=function(s){if(isNaN(s)||s<.1)throw new ie.Type("Given version is not a positive number");if(s=Math.round(s*10)/10,this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,s);var u=this._versions,c=u.filter(function(p){return p._cfg.version===s})[0];return c||(c=new this.Version(s),u.push(c),u.sort(Jx),c.stores({}),this._state.autoSchema=!1,c)},o.prototype._whenReady=function(s){var u=this;return this.idbdb&&(this._state.openComplete||ee.letThrough||this._vip)?s():new q(function(c,p){if(u._state.openComplete)return p(new ie.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen){p(new ie.DatabaseClosed);return}u.open().catch(Ae)}u._state.dbReadyPromise.then(c,p)}).then(s)},o.prototype.use=function(s){var u=s.stack,c=s.create,p=s.level,d=s.name;d&&this.unuse({stack:u,name:d});var _=this._middlewares[u]||(this._middlewares[u]=[]);return _.push({stack:u,create:c,level:p??10,name:d}),_.sort(function(y,x){return y.level-x.level}),this},o.prototype.unuse=function(s){var u=s.stack,c=s.name,p=s.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(d){return p?d.create!==p:c?d.name!==c:!1})),this},o.prototype.open=function(){var s=this;return yn(Ur,function(){return fv(s)})},o.prototype._close=function(){var s=this._state,u=si.indexOf(this);if(u>=0&&si.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}s.isBeingOpened||(s.dbReadyPromise=new q(function(c){s.dbReadyResolve=c}),s.openCanceller=new q(function(c,p){s.cancelOpen=p}))},o.prototype.close=function(s){var u=s===void 0?{disableAutoOpen:!0}:s,c=u.disableAutoOpen,p=this._state;c?(p.isBeingOpened&&p.cancelOpen(new ie.DatabaseClosed),this._close(),p.autoOpen=!1,p.dbOpenError=new ie.DatabaseClosed):(this._close(),p.autoOpen=this._options.autoOpen||p.isBeingOpened,p.openComplete=!1,p.dbOpenError=null)},o.prototype.delete=function(s){var u=this;s===void 0&&(s={disableAutoOpen:!0});var c=arguments.length>0&&typeof arguments[0]!="object",p=this._state;return new q(function(d,_){var y=function(){u.close(s);var x=u._deps.indexedDB.deleteDatabase(u.name);x.onsuccess=Ce(function(){lv(u._deps,u.name),d()}),x.onerror=tr(_),x.onblocked=u._fireOnBlocked};if(c)throw new ie.InvalidArgument("Invalid closeOptions argument to db.delete()");p.isBeingOpened?p.dbReadyPromise.then(y):y()})},o.prototype.backendDB=function(){return this.idbdb},o.prototype.isOpen=function(){return this.idbdb!==null},o.prototype.hasBeenClosed=function(){var s=this._state.dbOpenError;return s&&s.name==="DatabaseClosed"},o.prototype.hasFailed=function(){return this._state.dbOpenError!==null},o.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(o.prototype,"tables",{get:function(){var s=this;return a(this._allTables).map(function(u){return s._allTables[u]})},enumerable:!1,configurable:!0}),o.prototype.transaction=function(){var s=pv.apply(this,arguments);return this._transaction.apply(this,s)},o.prototype._transaction=function(s,u,c){var p=this,d=ee.trans;(!d||d.db!==this||s.indexOf("!")!==-1)&&(d=null);var _=s.indexOf("?")!==-1;s=s.replace("!","").replace("?","");var y,x;try{if(x=u.map(function(S){var $=S instanceof p.Table?S.name:S;if(typeof $!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return $}),s=="r"||s===Al)y=Al;else if(s=="rw"||s==kl)y=kl;else throw new ie.InvalidArgument("Invalid transaction mode: "+s);if(d){if(d.mode===Al&&y===kl)if(_)d=null;else throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");d&&x.forEach(function(S){if(d&&d.storeNames.indexOf(S)===-1)if(_)d=null;else throw new ie.SubTransaction("Table "+S+" not included in parent transaction.")}),_&&d&&!d.active&&(d=null)}}catch(S){return d?d._promise(null,function($,M){M(S)}):Pe(S)}var w=pm.bind(null,this,y,x,d,c);return d?d._promise(y,w,"lock"):ee.trans?yn(ee.transless,function(){return p._whenReady(w)}):this._whenReady(w)},o.prototype.table=function(s){if(!g(this._allTables,s))throw new ie.InvalidTable("Table ".concat(s," does not exist"));return this._allTables[s]},o}(),Tv=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Iv=function(){function o(s){this._subscribe=s}return o.prototype.subscribe=function(s,u,c){return this._subscribe(!s||typeof s=="function"?{next:s,error:u,complete:c}:s)},o.prototype[Tv]=function(){return this},o}(),Us;try{Us={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Us={indexedDB:null,IDBKeyRange:null}}function xm(o){var s=!1,u,c=new Iv(function(p){var d=pl(o);function _(D){var N=ni();try{d&&oi();var L=zr(o,D);return d&&(L=L.finally(Wr)),L}finally{N&&ii()}}var y=!1,x,w={},S={},$={get closed(){return y},unsubscribe:function(){y||(y=!0,x&&x.abort(),M&&Hr.storagemutated.unsubscribe(A))}};p.start&&p.start($);var M=!1,j=function(){return El(I)};function b(){return Wl(S,w)}var A=function(D){Fs(w,D),b()&&j()},I=function(){if(!(y||!Us.indexedDB)){w={};var D={};x&&x.abort(),x=new AbortController;var N={subscr:D,signal:x.signal,requery:j,querier:o,trans:null},L=_(N);Promise.resolve(L).then(function(F){s=!0,u=F,!(y||N.signal.aborted)&&(w={},S=D,!fl(S)&&!M&&(Hr(co,A),M=!0),El(function(){return!y&&p.next&&p.next(F)}))},function(F){s=!1,["DatabaseClosedError","AbortError"].includes(F?.name)||y||El(function(){y||p.error&&p.error(F)})})}};return setTimeout(j,0),$});return c.hasValue=function(){return s},c.getValue=function(){return u},c}var $n=br;v($n,r(r({},ys),{delete:function(o){var s=new $n(o,{addons:[]});return s.delete()},exists:function(o){return new $n(o,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return av($n.dependencies).then(o)}catch{return Pe(new ie.MissingAPI)}},defineClass:function(){function o(s){f(this,s)}return o},ignoreTransaction:function(o){return ee.trans?yn(ee.transless,o):o()},vip:Kl,async:function(o){return function(){try{var s=Gl(o.apply(this,arguments));return!s||typeof s.then!="function"?q.resolve(s):s}catch(u){return Pe(u)}}},spawn:function(o,s,u){try{var c=Gl(o.apply(u,s||[]));return!c||typeof c.then!="function"?q.resolve(c):c}catch(p){return Pe(p)}},currentTransaction:{get:function(){return ee.trans||null}},waitFor:function(o,s){var u=q.resolve(typeof o=="function"?$n.ignoreTransaction(o):o).timeout(s||6e4);return ee.trans?ee.trans.waitFor(u):u},Promise:q,debug:{get:function(){return er},set:function(o){Fp(o)}},derive:T,extend:f,props:v,override:K,Events:so,on:Hr,liveQuery:xm,extendObservabilitySet:Fs,getByKeyPath:le,setByKeyPath:pe,delByKeyPath:ze,shallowClone:Ot,deepClone:St,getObjectDiff:Yl,cmp:ge,asap:Z,minKey:Sl,addons:[],connections:si,errnames:dl,dependencies:Us,cache:wn,semVer:Hp,version:Hp.split(".").map(function(o){return parseInt(o)}).reduce(function(o,s,u){return o+s/Math.pow(10,u*2)})})),$n.maxKey=fo($n.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Hr(co,function(o){if(!Gr){var s;s=new CustomEvent(Ml,{detail:o}),Gr=!0,dispatchEvent(s),Gr=!1}}),addEventListener(Ml,function(o){var s=o.detail;Gr||Xl(s)}));function Xl(o){var s=Gr;try{Gr=!0,Hr.storagemutated.fire(o),Hl(o,!0)}finally{Gr=s}}var Gr=!1,Yr,Zl=function(){};typeof BroadcastChannel<"u"&&(Zl=function(){Yr=new BroadcastChannel(Ml),Yr.onmessage=function(o){return o.data&&Xl(o.data)}},Zl(),typeof Yr.unref=="function"&&Yr.unref(),Hr(co,function(o){Gr||Yr.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!br.disableBfCache&&o.persisted){er&&console.debug("Dexie: handling persisted pagehide"),Yr?.close();for(var s=0,u=si;s<u.length;s++){var c=u[s];c.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(o){!br.disableBfCache&&o.persisted&&(er&&console.debug("Dexie: handling persisted pageshow"),Zl(),Xl({all:new et(-1/0,[[]])}))}));function Cv(o){return new uo({add:o})}function Mv(o){return new uo({remove:o})}function Dv(o,s){return new uo({replacePrefix:[o,s]})}q.rejectionMapper=px,Fp(er);var Pv=Object.freeze({__proto__:null,Dexie:br,liveQuery:xm,Entity:Qp,cmp:ge,PropModSymbol:Px,PropModification:uo,replacePrefix:Dv,add:Cv,remove:Mv,default:br,RangeSet:et,mergeRanges:ho,rangesOverlap:um});return r(br,Pv,{default:br}),br})});var B=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},tt=class{static fromArray(t,r){let n=r||new Ws;for(let i=t.length-1;i>=0;--i)n=new bn(t[i],n);return n}[Symbol.iterator](){return new ec(this)}toArray(){return[...this]}atLeastLength(t){for(let r of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let r of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let r of this)t++;return t}};function me(e,t){return new bn(e,t)}function k(e,t){return tt.fromArray(e,t)}var ec=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Ws)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Ws=class extends tt{},bn=class extends tt{constructor(t,r){super(),this.head=t,this.tail=r}},go=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,r,n){return qv(this.buffer,t,r,n)}intFromSlice(t,r,n,i){return Wv(this.buffer,t,r,n,i)}binaryFromSlice(t,r){return new e(this.buffer.slice(t,r))}sliceAfter(t){return new e(this.buffer.slice(t))}},qs=class{constructor(t){this.value=t}};function Wv(e,t,r,n,i){let a=0;if(n)for(let l=t;l<r;l++)a=a*256+e[l];else for(let l=r-1;l>=t;l--)a=a*256+e[l];if(i){let f=2**((r-t)*8-1);a>=f&&(a-=f*2)}return a}function qv(e,t,r,n){let i=new DataView(e.buffer),a=r-t;if(a===8)return i.getFloat64(t,!n);if(a===4)return i.getFloat32(t,!n);{let l=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${a*8} bits`;throw new globalThis.Error(l)}}var li=class e extends B{static isResult(t){return t instanceof e}},J=class extends li{constructor(t){super(),this[0]=t}isOk(){return!0}},se=class extends li{constructor(t){super(),this[0]=t}isOk(){return!1}};function Me(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!wm(n)||!wm(i)||!Zv(n,i)||Hv(n,i)||Gv(n,i)||Yv(n,i)||Qv(n,i)||Jv(n,i)||Xv(n,i))return!1;let l=Object.getPrototypeOf(n);if(l!==null&&typeof l.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[f,m]=Vv(n);for(let h of f(n))r.push(m(n,h),m(i,h))}return!0}function Vv(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function Hv(e,t){return e instanceof Date&&(e>t||e<t)}function Gv(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function Yv(e,t){return Array.isArray(e)&&e.length!==t.length}function Qv(e,t){return e instanceof Map&&e.size!==t.size}function Jv(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Xv(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function wm(e){return typeof e=="object"&&e!==null}function Zv(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function En(e,t){return t===0?0:e%t}function On(e,t){return Math.trunc($m(e,t))}function $m(e,t){return t===0?0:e/t}function Sn(e,t,r,n,i,a){let l=new globalThis.Error(i);l.gleam_error=e,l.module=t,l.line=r,l.function=n,l.fn=n;for(let f in a)l[f]=a[f];return l}function ci(e,t,r){return e?t:r()}var de=class extends B{constructor(t){super(),this[0]=t}},Ee=class extends B{};function bm(e,t){if(e instanceof de){let r=e[0];return new J(r)}else return new se(t)}function Em(e,t){if(e instanceof de){let r=e[0];return new de(t(r))}else return new Ee}function Om(e){return e instanceof de?e[0]:new Ee}function sr(){return Am()}function pi(e,t,r){return Tm(t,r,e)}function t0(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=me(i,n)}}}function r0(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return t0(n,k([]));{let i=r.head;e=r.tail,t=me(i[0],n)}}}function n0(e){let t=Hs(e);return r0(t,k([]))}function tc(e){return n0(e)}var mi=class extends B{constructor(t){super(),this[0]=t}},Gs=class extends B{constructor(t){super(),this[0]=t}};function s0(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function Cm(e){return s0(e,0)}function a0(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=me(i,n)}}}function rt(e){return a0(e,k([]))}function u0(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return rt(a);{let l=n.head,f=n.tail,m=i(l)?me(l,a):a;e=f,t=i,r=m}}}function Sr(e,t){return u0(e,t,k([]))}function l0(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return rt(a);{let l=n.head;e=n.tail,t=i,r=me(i(l),a)}}}function Qe(e,t){return l0(e,t,k([]))}function c0(e,t,r,n){for(;;){let i=e,a=t,l=r,f=n;if(i.hasLength(0))return rt(f);{let m=i.head,h=i.tail,g=me(a(m,l),f);e=h,t=a,r=l+1,n=g}}}function Ys(e,t){return c0(e,t,0,k([]))}function Qs(e,t){for(;;){let r=e,n=t;if(n<=0)return r;if(r.hasLength(0))return k([]);e=r.tail,t=n-1}}function f0(e,t,r){for(;;){let n=e,i=t,a=r;if(i<=0)return rt(a);if(n.hasLength(0))return rt(a);{let f=n.head;e=n.tail,t=i-1,r=me(f,a)}}}function Mm(e,t){return f0(e,t,k([]))}function p0(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=me(i,n)}}}function kt(e,t){return p0(rt(e),t)}function Xr(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return i;{let l=n.head;e=n.tail,t=a(i,l),r=a}}}function m0(e,t,r,n){for(;;){let i=e,a=t,l=r,f=n;if(i.hasLength(0))return a;{let m=i.head;e=i.tail,t=l(a,m,f),r=l,n=f+1}}}function rc(e,t,r){return m0(e,t,r,0)}function Dm(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return i;{let l=n.head,f=n.tail,m=a(i,l);if(m instanceof mi){let h=m[0];e=f,t=h,r=a}else return m[0]}}}function Pm(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return!1;{let i=r.head,a=r.tail;if(n(i))return!0;e=a,t=n}}}function yo(e){return ic(e)}function di(e){return e}function xo(e){return Fm(e)}function sc(e,t,r){if(r<0)return"";if(t<0){let a=xo(e)+t;return a<0?"":oc(e,a,r)}else return oc(e,t,r)}function Xs(e,t){return t<0?e:sc(e,t,xo(e)-t)}function vo(e){let r=yo(e);return di(r)}function v0(e,t,r){for(;;){let n=e,i=t,a=r;if(i<=0)return a;e=n,t=i-1,r=a+n}}function ac(e,t){return v0(e,t,"")}function wo(e,t){return Bm(e,t)}function w0(e,t){let r=xo(t),n=On(e,r),i=En(e,r);return ac(t,n)+sc(t,0,i)}function Zr(e,t,r){let n=xo(e),i=t-n;return i<=0?e:w0(i,r)+e}function uc(e){return jm(e)}function Tt(e){let t=lr(e);return di(t)}function kr(e,t){if(e.isOk()){let r=e[0];return new J(t(r))}else{let r=e[0];return new se(r)}}function cc(e,t){if(e.isOk()){let r=e[0];return new J(r)}else{let r=e[0];return new se(t(r))}}function fc(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new se(r)}}var zt=class extends B{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function Tr(e){return mc(e)}function Zs(e){return Vm(e)}function pc(e){return Hm(e)}function Wm(e){return t=>Gm(t,e)}function ea(e){return t=>{if(e.hasLength(0))return new se(k([new zt("another type",Tr(t),k([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let a=i[0];return new J(a)}else return ea(n)(t)}}}function S0(e,t){let r=t,n=ea(k([kn,a=>kr(Zs(a),Xe)])),i=(()=>{let a=n(r);if(a.isOk())return a[0];{let l=k(["<",Tr(r),">"]),f=yo(l);return di(f)}})();return e.withFields({path:me(i,e.path)})}function A0(e,t){return cc(e,r=>Qe(r,t))}function kn(e){return qm(e)}function ta(e,t){return r=>{let n=new zt("field","nothing",k([]));return fc(Ym(r,e),i=>{let l=bm(i,k([n])),f=fc(l,t);return A0(f,m=>S0(m,e))})}}var Qm=new WeakMap,dc=new DataView(new ArrayBuffer(8)),hc=0;function _c(e){let t=Qm.get(e);if(t!==void 0)return t;let r=hc++;return hc===2147483647&&(hc=0),Qm.set(e,r),r}function gc(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function xc(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Jm(e){dc.setFloat64(0,e);let t=dc.getInt32(0),r=dc.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function k0(e){return xc(e.toString())}function T0(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return _c(e);if(e instanceof Date)return Jm(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+It(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+It(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+gc(It(n),It(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let a=n[i],l=e[a];r=r+gc(It(l),xc(a))|0}}return r}function It(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Jm(e);case"string":return xc(e);case"bigint":return k0(e);case"object":return T0(e);case"symbol":return _c(e);case"function":return _c(e);default:return 0}}var fr=5,vc=Math.pow(2,fr),I0=vc-1,C0=vc/2,M0=vc/4,ot=0,cr=1,gt=2,Cn=3,wc={type:gt,bitmap:0,array:[]};function $o(e,t){return e>>>t&I0}function na(e,t){return 1<<$o(e,t)}function D0(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function $c(e,t){return D0(e&t-1)}function Ct(e,t,r){let n=e.length,i=new Array(n);for(let a=0;a<n;++a)i[a]=e[a];return i[t]=r,i}function P0(e,t,r){let n=e.length,i=new Array(n+1),a=0,l=0;for(;a<t;)i[l++]=e[a++];for(i[l++]=r;a<n;)i[l++]=e[a++];return i}function yc(e,t){let r=e.length,n=new Array(r-1),i=0,a=0;for(;i<t;)n[a++]=e[i++];for(++i;i<r;)n[a++]=e[i++];return n}function Xm(e,t,r,n,i,a){let l=It(t);if(l===n)return{type:Cn,hash:l,array:[{type:ot,k:t,v:r},{type:ot,k:i,v:a}]};let f={val:!1};return bo(bc(wc,e,l,t,r,f),e,n,i,a,f)}function bo(e,t,r,n,i,a){switch(e.type){case cr:return R0(e,t,r,n,i,a);case gt:return bc(e,t,r,n,i,a);case Cn:return N0(e,t,r,n,i,a)}}function R0(e,t,r,n,i,a){let l=$o(r,t),f=e.array[l];if(f===void 0)return a.val=!0,{type:cr,size:e.size+1,array:Ct(e.array,l,{type:ot,k:n,v:i})};if(f.type===ot)return Me(n,f.k)?i===f.v?e:{type:cr,size:e.size,array:Ct(e.array,l,{type:ot,k:n,v:i})}:(a.val=!0,{type:cr,size:e.size,array:Ct(e.array,l,Xm(t+fr,f.k,f.v,r,n,i))});let m=bo(f,t+fr,r,n,i,a);return m===f?e:{type:cr,size:e.size,array:Ct(e.array,l,m)}}function bc(e,t,r,n,i,a){let l=na(r,t),f=$c(e.bitmap,l);if(e.bitmap&l){let m=e.array[f];if(m.type!==ot){let g=bo(m,t+fr,r,n,i,a);return g===m?e:{type:gt,bitmap:e.bitmap,array:Ct(e.array,f,g)}}let h=m.k;return Me(n,h)?i===m.v?e:{type:gt,bitmap:e.bitmap,array:Ct(e.array,f,{type:ot,k:n,v:i})}:(a.val=!0,{type:gt,bitmap:e.bitmap,array:Ct(e.array,f,Xm(t+fr,h,m.v,r,n,i))})}else{let m=e.array.length;if(m>=C0){let h=new Array(32),g=$o(r,t);h[g]=bc(wc,t+fr,r,n,i,a);let v=0,O=e.bitmap;for(let E=0;E<32;E++){if(O&1){let T=e.array[v++];h[E]=T}O=O>>>1}return{type:cr,size:m+1,array:h}}else{let h=P0(e.array,f,{type:ot,k:n,v:i});return a.val=!0,{type:gt,bitmap:e.bitmap|l,array:h}}}}function N0(e,t,r,n,i,a){if(r===e.hash){let l=Ec(e,n);if(l!==-1)return e.array[l].v===i?e:{type:Cn,hash:r,array:Ct(e.array,l,{type:ot,k:n,v:i})};let f=e.array.length;return a.val=!0,{type:Cn,hash:r,array:Ct(e.array,f,{type:ot,k:n,v:i})}}return bo({type:gt,bitmap:na(e.hash,t),array:[e]},t,r,n,i,a)}function Ec(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(Me(t,e.array[n].k))return n;return-1}function ra(e,t,r,n){switch(e.type){case cr:return L0(e,t,r,n);case gt:return F0(e,t,r,n);case Cn:return B0(e,n)}}function L0(e,t,r,n){let i=$o(r,t),a=e.array[i];if(a!==void 0){if(a.type!==ot)return ra(a,t+fr,r,n);if(Me(n,a.k))return a}}function F0(e,t,r,n){let i=na(r,t);if(!(e.bitmap&i))return;let a=$c(e.bitmap,i),l=e.array[a];if(l.type!==ot)return ra(l,t+fr,r,n);if(Me(n,l.k))return l}function B0(e,t){let r=Ec(e,t);if(!(r<0))return e.array[r]}function Oc(e,t,r,n){switch(e.type){case cr:return j0(e,t,r,n);case gt:return K0(e,t,r,n);case Cn:return U0(e,n)}}function j0(e,t,r,n){let i=$o(r,t),a=e.array[i];if(a===void 0)return e;let l;if(a.type===ot){if(!Me(a.k,n))return e}else if(l=Oc(a,t+fr,r,n),l===a)return e;if(l===void 0){if(e.size<=M0){let f=e.array,m=new Array(e.size-1),h=0,g=0,v=0;for(;h<i;){let O=f[h];O!==void 0&&(m[g]=O,v|=1<<h,++g),++h}for(++h;h<f.length;){let O=f[h];O!==void 0&&(m[g]=O,v|=1<<h,++g),++h}return{type:gt,bitmap:v,array:m}}return{type:cr,size:e.size-1,array:Ct(e.array,i,l)}}return{type:cr,size:e.size,array:Ct(e.array,i,l)}}function K0(e,t,r,n){let i=na(r,t);if(!(e.bitmap&i))return e;let a=$c(e.bitmap,i),l=e.array[a];if(l.type!==ot){let f=Oc(l,t+fr,r,n);return f===l?e:f!==void 0?{type:gt,bitmap:e.bitmap,array:Ct(e.array,a,f)}:e.bitmap===i?void 0:{type:gt,bitmap:e.bitmap^i,array:yc(e.array,a)}}return Me(n,l.k)?e.bitmap===i?void 0:{type:gt,bitmap:e.bitmap^i,array:yc(e.array,a)}:e}function U0(e,t){let r=Ec(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Cn,hash:e.hash,array:yc(e.array,r)}}function Zm(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let a=r[i];if(a!==void 0){if(a.type===ot){t(a.v,a.k);continue}Zm(a,t)}}}var pr=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let a=r[i];n=n.set(a,t[a])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=ra(this.root,0,It(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?wc:this.root,a=bo(i,0,It(t),t,r,n);return a===this.root?this:new e(a,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Oc(this.root,0,It(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:ra(this.root,0,It(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){Zm(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+gc(It(r),It(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let r=!0;return this.forEach((n,i)=>{r=r&&Me(t.get(i,!n),n)}),r}};var W0=void 0,ed={};function id(e){return e.toString()}function od(e){let t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{let r=t.indexOf("e");return r>=0?t.slice(0,r)+".0"+t.slice(r):t+".0"}}function Fm(e){if(e==="")return 0;let t=sd(e);if(t){let r=0;for(let n of t)r++;return r}else return e.match(/./gsu).length}var td;function sd(e){if(globalThis.Intl&&Intl.Segmenter)return td||=new Intl.Segmenter,td.segment(e)[Symbol.iterator]()}function Bm(e,t){let r=e[Symbol.iterator](),n=r.next().value||"",i=r.next();for(;!i.done;)n=n+t+i.value,i=r.next();return n}function ic(e){let t="";for(let r of e)t=t+r;return t}function oc(e,t,r){if(r<=0||t>=e.length)return"";let n=sd(e);if(n){for(;t-- >0;)n.next();let i="";for(;r-- >0;){let a=n.next().value;if(a===void 0)break;i+=a.segment}return i}else return e.match(/./gsu).slice(t,t+r).join("")}var ad=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),q0=new RegExp(`^([${ad}]*)`,"g"),V0=new RegExp(`([${ad}]*)$`,"g");function jm(e){return Km(Um(e))}function Km(e){return e.replace(q0,"")}function Um(e){return e.replace(V0,"")}function ud(e){typeof process=="object"&&process.stderr?.write?process.stderr.write(e+`
`):typeof Deno=="object"?Deno.stderr.writeSync(new TextEncoder().encode(e+`
`)):console.log(e)}function Am(){return pr.new()}function Hs(e){return tt.fromArray(e.entries())}function km(e,t){let r=e.get(t,ed);return r===ed?new se(W0):new J(r)}function Tm(e,t,r){return r.set(e,t)}function mc(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof li)return"Result";if(e instanceof tt)return"List";if(e instanceof go)return"BitArray";if(e instanceof pr)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function ia(e,t){return H0(e,mc(t))}function H0(e,t){return new se(tt.fromArray([new zt(e,t,tt.fromArray([]))]))}function qm(e){return typeof e=="string"?new J(e):ia("String",e)}function Vm(e){return Number.isInteger(e)?new J(e):ia("Int",e)}function Hm(e){return typeof e=="boolean"?new J(e):ia("Bool",e)}function Gm(e,t){if(e==null||e instanceof Ee)return new J(new Ee);e instanceof de&&(e=e[0]);let r=t(e);return r.isOk()?new J(new de(r[0])):r}function Ym(e,t){let r=()=>ia("Dict",e);if(e instanceof pr||e instanceof WeakMap||e instanceof Map){let n=km(e,t);return new J(n.isOk()?new de(n[0]):new Ee)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?rd(e,t,()=>new J(new Ee)):rd(e,t,r)}function rd(e,t,r){try{return t in e?new J(new de(e[t])):r()}catch{return r()}}function lr(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return G0(e);if(t==="bigint"||Number.isInteger(e))return e.toString();if(t==="number")return od(e);if(Array.isArray(e))return`#(${e.map(lr).join(", ")})`;if(e instanceof tt)return X0(e);if(e instanceof qs)return ew(e);if(e instanceof go)return Z0(e);if(e instanceof B)return J0(e);if(e instanceof pr)return Y0(e);if(e instanceof Set)return`//js(Set(${[...e].map(lr).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return Q0(e)}function G0(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];switch(n){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}}return t+='"',t}function Y0(e){let t="dict.from_list([",r=!0;return e.forEach((n,i)=>{r||(t=t+", "),t=t+"#("+lr(i)+", "+lr(n)+")",r=!1}),t+"])"}function Q0(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let a of Object.keys(e))r.push(`${lr(a)}: ${lr(e[a])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function J0(e){let t=Object.keys(e).map(r=>{let n=lr(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function X0(e){return`[${e.toArray().map(lr).join(", ")}]`}function Z0(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function ew(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function In(e){return e>=0?e:e*-1}function Xe(e){return id(e)}var Eo=class extends B{constructor(t){super(),this[0]=t}},hi=class extends B{},Oo=class extends B{},So=class extends B{},_i=class extends B{},Mn=class extends B{},Ao=class extends B{},ko=class extends B{},To=class extends B{},oa=class extends B{};function tn(e,t){return[On(e,t),En(e,t)]}var fd=1e3;var pd=1e6;var md=6e7;var dd=36e8;var Ac=864e8;function hd(e){return new Eo(e*Ac)}var _d=6048e8;var gd=2592e9;var yd=31536e9;function xd(e){let r=Xr(e,0,(n,i)=>{if(i[1]instanceof hi){let a=i[0];return n+a}else if(i[1]instanceof Oo){let a=i[0];return n+a*fd}else if(i[1]instanceof So){let a=i[0];return n+a*pd}else if(i[1]instanceof _i){let a=i[0];return n+a*md}else if(i[1]instanceof Mn){let a=i[0];return n+a*dd}else if(i[1]instanceof Ao){let a=i[0];return n+a*Ac}else if(i[1]instanceof ko){let a=i[0];return n+a*_d}else if(i[1]instanceof To){let a=i[0];return n+a*gd}else{let a=i[0];return n+a*yd}});return new Eo(r)}function vd(e){let t=e[0],r=In(t),n=tn(r,yd),i=n[0],a=n[1],l=tn(a,gd),f=l[0],m=l[1],h=tn(m,_d),g=h[0],v=h[1],O=tn(v,Ac),E=O[0],T=O[1],C=tn(T,dd),G=C[0],X=C[1],Q=tn(X,md),K=Q[0],ne=Q[1],Z=tn(ne,pd),fe=Z[0],le=Z[1],pe=tn(le,fd),ze=pe[0],Ot=pe[1],pn=k([[i,new oa],[f,new To],[g,new ko],[E,new Ao],[G,new Mn],[K,new _i],[fe,new So],[ze,new Oo],[Ot,new hi]]),Zt=Sr(pn,nt=>nt[0]>0);return Qe(Zt,nt=>t<0?[-1*nt[0],nt[1]]:nt)}var $d=k([["Africa/Abidjan",0],["Africa/Algiers",3600],["Africa/Bissau",0],["Africa/Cairo",7200],["Africa/Casablanca",3600],["Africa/Ceuta",3600],["Africa/El_Aaiun",3600],["Africa/Johannesburg",7200],["Africa/Juba",7200],["Africa/Khartoum",7200],["Africa/Lagos",3600],["Africa/Maputo",7200],["Africa/Monrovia",0],["Africa/Nairobi",10800],["Africa/Ndjamena",3600],["Africa/Sao_Tome",0],["Africa/Tripoli",7200],["Africa/Tunis",3600],["Africa/Windhoek",7200],["America/Adak",-36e3],["America/Anchorage",-32400],["America/Araguaina",-10800],["America/Argentina/Buenos_Aires",-10800],["America/Argentina/Catamarca",-10800],["America/Argentina/Cordoba",-10800],["America/Argentina/Jujuy",-10800],["America/Argentina/La_Rioja",-10800],["America/Argentina/Mendoza",-10800],["America/Argentina/Rio_Gallegos",-10800],["America/Argentina/Salta",-10800],["America/Argentina/San_Juan",-10800],["America/Argentina/San_Luis",-10800],["America/Argentina/Tucuman",-10800],["America/Argentina/Ushuaia",-10800],["America/Asuncion",-14400],["America/Bahia",-10800],["America/Bahia_Banderas",-21600],["America/Barbados",-14400],["America/Belem",-10800],["America/Belize",-21600],["America/Boa_Vista",-14400],["America/Bogota",-18e3],["America/Boise",-25200],["America/Cambridge_Bay",-25200],["America/Campo_Grande",-14400],["America/Cancun",-18e3],["America/Caracas",-14400],["America/Cayenne",-10800],["America/Chicago",-21600],["America/Chihuahua",-21600],["America/Ciudad_Juarez",-25200],["America/Costa_Rica",-21600],["America/Cuiaba",-14400],["America/Danmarkshavn",0],["America/Dawson",-25200],["America/Dawson_Creek",-25200],["America/Denver",-25200],["America/Detroit",-18e3],["America/Edmonton",-25200],["America/Eirunepe",-18e3],["America/El_Salvador",-21600],["America/Fort_Nelson",-25200],["America/Fortaleza",-10800],["America/Glace_Bay",-14400],["America/Goose_Bay",-14400],["America/Grand_Turk",-18e3],["America/Guatemala",-21600],["America/Guayaquil",-18e3],["America/Guyana",-14400],["America/Halifax",-14400],["America/Havana",-18e3],["America/Hermosillo",-25200],["America/Indiana/Indianapolis",-18e3],["America/Indiana/Knox",-21600],["America/Indiana/Marengo",-18e3],["America/Indiana/Petersburg",-18e3],["America/Indiana/Tell_City",-21600],["America/Indiana/Vevay",-18e3],["America/Indiana/Vincennes",-18e3],["America/Indiana/Winamac",-18e3],["America/Inuvik",-25200],["America/Iqaluit",-18e3],["America/Jamaica",-18e3],["America/Juneau",-32400],["America/Kentucky/Louisville",-18e3],["America/Kentucky/Monticello",-18e3],["America/La_Paz",-14400],["America/Lima",-18e3],["America/Los_Angeles",-28800],["America/Maceio",-10800],["America/Managua",-21600],["America/Manaus",-14400],["America/Martinique",-14400],["America/Matamoros",-21600],["America/Mazatlan",-25200],["America/Menominee",-21600],["America/Merida",-21600],["America/Metlakatla",-32400],["America/Mexico_City",-21600],["America/Miquelon",-10800],["America/Moncton",-14400],["America/Monterrey",-21600],["America/Montevideo",-10800],["America/New_York",-18e3],["America/Nome",-32400],["America/Noronha",-7200],["America/North_Dakota/Beulah",-21600],["America/North_Dakota/Center",-21600],["America/North_Dakota/New_Salem",-21600],["America/Nuuk",-7200],["America/Ojinaga",-21600],["America/Panama",-18e3],["America/Paramaribo",-10800],["America/Phoenix",-25200],["America/Port-au-Prince",-18e3],["America/Porto_Velho",-14400],["America/Puerto_Rico",-14400],["America/Punta_Arenas",-10800],["America/Rankin_Inlet",-21600],["America/Recife",-10800],["America/Regina",-21600],["America/Resolute",-21600],["America/Rio_Branco",-18e3],["America/Santarem",-10800],["America/Santiago",-14400],["America/Santo_Domingo",-14400],["America/Sao_Paulo",-10800],["America/Scoresbysund",-7200],["America/Sitka",-32400],["America/St_Johns",-12600],["America/Swift_Current",-21600],["America/Tegucigalpa",-21600],["America/Thule",-14400],["America/Tijuana",-28800],["America/Toronto",-18e3],["America/Vancouver",-28800],["America/Whitehorse",-25200],["America/Winnipeg",-21600],["America/Yakutat",-32400],["Antarctica/Casey",28800],["Antarctica/Davis",25200],["Antarctica/Macquarie",36e3],["Antarctica/Mawson",18e3],["Antarctica/Palmer",-10800],["Antarctica/Rothera",-10800],["Antarctica/Troll",0],["Antarctica/Vostok",18e3],["Asia/Almaty",18e3],["Asia/Amman",10800],["Asia/Anadyr",43200],["Asia/Aqtau",18e3],["Asia/Aqtobe",18e3],["Asia/Ashgabat",18e3],["Asia/Atyrau",18e3],["Asia/Baghdad",10800],["Asia/Baku",14400],["Asia/Bangkok",25200],["Asia/Barnaul",25200],["Asia/Beirut",7200],["Asia/Bishkek",21600],["Asia/Chita",32400],["Asia/Choibalsan",28800],["Asia/Colombo",19800],["Asia/Damascus",10800],["Asia/Dhaka",21600],["Asia/Dili",32400],["Asia/Dubai",14400],["Asia/Dushanbe",18e3],["Asia/Famagusta",7200],["Asia/Gaza",7200],["Asia/Hebron",7200],["Asia/Ho_Chi_Minh",25200],["Asia/Hong_Kong",28800],["Asia/Hovd",25200],["Asia/Irkutsk",28800],["Asia/Jakarta",25200],["Asia/Jayapura",32400],["Asia/Jerusalem",7200],["Asia/Kabul",16200],["Asia/Kamchatka",43200],["Asia/Karachi",18e3],["Asia/Kathmandu",20700],["Asia/Khandyga",32400],["Asia/Kolkata",19800],["Asia/Krasnoyarsk",25200],["Asia/Kuching",28800],["Asia/Macau",28800],["Asia/Magadan",39600],["Asia/Makassar",28800],["Asia/Manila",28800],["Asia/Nicosia",7200],["Asia/Novokuznetsk",25200],["Asia/Novosibirsk",25200],["Asia/Omsk",21600],["Asia/Oral",18e3],["Asia/Pontianak",25200],["Asia/Pyongyang",32400],["Asia/Qatar",10800],["Asia/Qostanay",18e3],["Asia/Qyzylorda",18e3],["Asia/Riyadh",10800],["Asia/Sakhalin",39600],["Asia/Samarkand",18e3],["Asia/Seoul",32400],["Asia/Shanghai",28800],["Asia/Singapore",28800],["Asia/Srednekolymsk",39600],["Asia/Taipei",28800],["Asia/Tashkent",18e3],["Asia/Tbilisi",14400],["Asia/Tehran",12600],["Asia/Thimphu",21600],["Asia/Tokyo",32400],["Asia/Tomsk",25200],["Asia/Ulaanbaatar",28800],["Asia/Urumqi",21600],["Asia/Ust-Nera",36e3],["Asia/Vladivostok",36e3],["Asia/Yakutsk",32400],["Asia/Yangon",23400],["Asia/Yekaterinburg",18e3],["Asia/Yerevan",14400],["Atlantic/Azores",-3600],["Atlantic/Bermuda",-14400],["Atlantic/Canary",0],["Atlantic/Cape_Verde",-3600],["Atlantic/Faroe",0],["Atlantic/Madeira",0],["Atlantic/South_Georgia",-7200],["Atlantic/Stanley",-10800],["Australia/Adelaide",34200],["Australia/Brisbane",36e3],["Australia/Broken_Hill",34200],["Australia/Darwin",34200],["Australia/Eucla",31500],["Australia/Hobart",36e3],["Australia/Lindeman",36e3],["Australia/Lord_Howe",37800],["Australia/Melbourne",36e3],["Australia/Perth",28800],["Australia/Sydney",36e3],["CET",3600],["CST6CDT",-21600],["EET",7200],["EST",-18e3],["EST5EDT",-18e3],["Etc/GMT",0],["Etc/GMT+1",-3600],["Etc/GMT+10",-36e3],["Etc/GMT+11",-39600],["Etc/GMT+12",-43200],["Etc/GMT+2",-7200],["Etc/GMT+3",-10800],["Etc/GMT+4",-14400],["Etc/GMT+5",-18e3],["Etc/GMT+6",-21600],["Etc/GMT+7",-25200],["Etc/GMT+8",-28800],["Etc/GMT+9",-32400],["Etc/GMT-1",3600],["Etc/GMT-10",36e3],["Etc/GMT-11",39600],["Etc/GMT-12",43200],["Etc/GMT-13",46800],["Etc/GMT-14",50400],["Etc/GMT-2",7200],["Etc/GMT-3",10800],["Etc/GMT-4",14400],["Etc/GMT-5",18e3],["Etc/GMT-6",21600],["Etc/GMT-7",25200],["Etc/GMT-8",28800],["Etc/GMT-9",32400],["Etc/UTC",0],["Europe/Andorra",3600],["Europe/Astrakhan",14400],["Europe/Athens",7200],["Europe/Belgrade",3600],["Europe/Berlin",3600],["Europe/Brussels",3600],["Europe/Bucharest",7200],["Europe/Budapest",3600],["Europe/Chisinau",7200],["Europe/Dublin",3600],["Europe/Gibraltar",3600],["Europe/Helsinki",7200],["Europe/Istanbul",10800],["Europe/Kaliningrad",7200],["Europe/Kirov",10800],["Europe/Kyiv",7200],["Europe/Lisbon",0],["Europe/London",0],["Europe/Madrid",3600],["Europe/Malta",3600],["Europe/Minsk",10800],["Europe/Moscow",10800],["Europe/Paris",3600],["Europe/Prague",3600],["Europe/Riga",7200],["Europe/Rome",3600],["Europe/Samara",14400],["Europe/Saratov",14400],["Europe/Simferopol",10800],["Europe/Sofia",7200],["Europe/Tallinn",7200],["Europe/Tirane",3600],["Europe/Ulyanovsk",14400],["Europe/Vienna",3600],["Europe/Vilnius",7200],["Europe/Volgograd",10800],["Europe/Warsaw",3600],["Europe/Zurich",3600],["HST",-36e3],["Indian/Chagos",21600],["Indian/Maldives",18e3],["Indian/Mauritius",14400],["MET",3600],["MST",-25200],["MST7MDT",-25200],["PST8PDT",-28800],["Pacific/Apia",46800],["Pacific/Auckland",43200],["Pacific/Bougainville",39600],["Pacific/Chatham",45900],["Pacific/Easter",-21600],["Pacific/Efate",39600],["Pacific/Fakaofo",46800],["Pacific/Fiji",43200],["Pacific/Galapagos",-21600],["Pacific/Gambier",-32400],["Pacific/Guadalcanal",39600],["Pacific/Guam",36e3],["Pacific/Honolulu",-36e3],["Pacific/Kanton",46800],["Pacific/Kiritimati",50400],["Pacific/Kosrae",39600],["Pacific/Kwajalein",43200],["Pacific/Marquesas",-34200],["Pacific/Nauru",43200],["Pacific/Niue",-39600],["Pacific/Norfolk",39600],["Pacific/Noumea",39600],["Pacific/Pago_Pago",-39600],["Pacific/Palau",32400],["Pacific/Pitcairn",-28800],["Pacific/Port_Moresby",36e3],["Pacific/Rarotonga",-36e3],["Pacific/Tahiti",-36e3],["Pacific/Tarawa",43200],["Pacific/Tongatapu",46800],["WET",0]]);function bd(){return Date.now()*1e3}function Ed(){return-new Date().getTimezoneOffset()}function Od(){return new de(Intl.DateTimeFormat().resolvedOptions().timeZone)}function Sd(){return Math.floor(globalThis.performance.now()*1e3)}function Ad(e,t){let r=new Date((e+t)/1e3);return[[r.getUTCFullYear(),r.getUTCMonth()+1,r.getUTCDate()],[r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()]]}function kd(e,t){return new Date((e+t)/1e3).getUTCDay()}var gi=class extends B{constructor(t,r,n,i){super(),this.wall_time=t,this.offset=r,this.timezone=n,this.monotonic_time=i}};var sa=class extends B{},aa=class extends B{},ua=class extends B{},la=class extends B{},ca=class extends B{},fa=class extends B{},kc=class extends B{};function Tc(e){{let t=e.wall_time;return On(t,1e6)}}function Td(e){return new gi(e*1e6,0,new Ee,new Ee)}function Id(e,t){let r=e.wall_time,n=e.offset,i=e.timezone,a=e.monotonic_time,l=t[0];if(a instanceof de){let f=a[0];return new gi(r+l,n,i,new de(f+l))}else return new gi(r+l,n,i,new Ee)}function Cd(e){return e instanceof sa?"Mon":e instanceof aa?"Tue":e instanceof ua?"Wed":e instanceof la?"Thu":e instanceof ca?"Fri":e instanceof fa?"Sat":"Sun"}function fw(e){return ci(e===0,new J("Z"),()=>{let t=(()=>{let r=k([[e,new hi]]),n=xd(r);return vd(n)})();if(t.hasLength(2)&&t.head[1]instanceof Mn&&t.tail.head[1]instanceof _i){let r=t.head[0],n=t.tail.head[0],i=k([r>0?vo(k(["+",(()=>{let m=Xe(r);return Zr(m,2,"0")})()])):vo(k(["-",(()=>{let m=In(r),h=Xe(m);return Zr(h,2,"0")})()])),(()=>{let f=In(n),m=Xe(f);return Zr(m,2,"0")})()]),a=wo(i,":");return new J(a)}else if(t.hasLength(1)&&t.head[1]instanceof Mn){let r=t.head[0],n=k([r>0?vo(k(["+",(()=>{let f=Xe(r);return Zr(f,2,"0")})()])):vo(k(["-",(()=>{let f=In(r),m=Xe(f);return Zr(m,2,"0")})()])),"00"]),i=wo(n,":");return new J(i)}else return new se(void 0)})}function pw(e){return e===0?new J(new kc):e===1?new J(new sa):e===2?new J(new aa):e===3?new J(new ua):e===4?new J(new la):e===5?new J(new ca):e===6?new J(new fa):new se(void 0)}function mw(e){{let t=e.wall_time,r=e.offset,n=Ad(t,r),i=n[0],a=n[1],l=fw(r);if(!l.isOk())throw Sn("let_assert","birl",1318,"to_parts","Pattern match failed, no pattern matched the value.",{value:l});let f=l[0];return[i,a,f]}}function Md(e){let t=mw(e),r=t[0][0],n=t[0][1],i=t[0][2];return Xe(r)+"-"+(()=>{let l=Xe(n);return Zr(l,2,"0")})()+"-"+(()=>{let l=Xe(i);return Zr(l,2,"0")})()}function Dd(e){{let t=e.wall_time,r=e.offset,n=pw(kd(t,r));if(!n.isOk())throw Sn("let_assert","birl",1033,"weekday","Pattern match failed, no pattern matched the value.",{value:n});return n[0]}}function pa(){let e=bd(),t=Ed(),r=Sd(),n=Od();return new gi(e,t*6e7,(()=>{let i=Em(n,a=>Pm($d,f=>f[0]===a)?new de(a):new Ee);return Om(i)})(),new de(r))}function Pd(e,t){let r=Number.isInteger(t);if(e instanceof pr||e instanceof WeakMap||e instanceof Map){let n=e.get(t,void 0);return new J(n)}if((t===1||t===2)&&e instanceof tt){let n=0;for(let i of e){if(n===t)return new J(i);n++}return new se("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?new J(e[t]):new se(r?"Indexable":"Dict")}function Rd(e,t,r,n,i){if(!(e instanceof tt||Array.isArray(e))){let l=new zt("List",Tr(e),i);return[i,tt.fromArray([l])]}let a=[];for(let l of e){let f=t(l),[m,h]=f;if(h instanceof bn){let[g,v]=r(f,n.toString());return[i,v]}a.push(m),n++}return[tt.fromArray(a),i]}var Wt=class extends B{constructor(t){super(),this.function=t}};function Ld(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new J(n):new se(i)}function yi(e){return new Wt(t=>[e,k([])])}function Cc(e,t,r){let n=r(e);if(n.isOk())return[n[0],k([])];{let i=n[0];return[t,i]}}function Mc(e,t){return new Wt(r=>{let n=e.function(r),i=n[0],a=n[1],f=t(i).function(r),m=f,h=f[0];return a.hasLength(0)?m:[h,a]})}function _w(e,t){return k([new zt(e,Tr(t),k([]))])}function gw(e){return Cc(e,"",kn)}function yw(e){return Cc(e,!1,pc)}function xw(e){return Cc(e,0,Zs)}function Fd(e){return new Wt(t=>{let r=Wm(n=>new J(n))(t);if(r.isOk()&&r[0]instanceof Ee)return[new Ee,k([])];if(r.isOk()&&r[0]instanceof de){let n=r[0][0],i=e.function(n),a=i[0],l=i[1];return[new de(a),l]}else{let n=e.function(t),i=n[0],a=n[1];return[new de(i),a]}})}function Bd(e,t){return new Wt(r=>[e,_w(t,r)])}var ma=new Wt(gw),jd=new Wt(yw),Kd=new Wt(xw);function Ud(e){return new Wt(t=>Rd(t,e.function,(r,n)=>Ic(r,k([n])),0,k([])))}function Ic(e,t){let r=ea(k([kn,a=>kr(Zs(a),Xe)])),n=Qe(t,a=>{let l=a,f=r(l);return f.isOk()?f[0]:"<"+Tr(l)+">"}),i=Qe(e[1],a=>a.withFields({path:kt(n,a.path)}));return[e[0],i]}function vw(e,t,r,n){for(;;){let i=e,a=t,l=r,f=n;if(i.hasLength(0)){let m=l(f);return Ic(m,rt(a))}else{let m=i.head,h=i.tail,g=Pd(f,m);if(g.isOk()){let v=g[0];e=h,t=me(m,a),r=l,n=v}else{let v=g[0],T=[l(f)[0],k([new zt(v,Tr(f),k([]))])];return Ic(T,rt(a))}}}}function ww(e,t,r){return new Wt(n=>{let i=vw(e,k([]),t.function,n),a=i[0],l=i[1],f=r(a).function(n),m=f[0],h=f[1];return[m,kt(l,h)]})}function Dn(e,t,r){return ww(k([e]),t,r)}var da=class e{constructor(t){this.promise=t}static wrap(t){return t instanceof Promise?new e(t):t}static unwrap(t){return t instanceof e?t.promise:t}};function xi(e,t){return e.then(r=>da.wrap(t(da.unwrap(r))))}function vi(e,t){return e.catch(r=>t(r))}function Dc(e){return JSON.stringify(e)}function zd(e){return Object.fromEntries(e)}function Wd(e){return e.toArray()}function qd(){return null}function Vd(e){return Dc(e)}function Pn(e){return e}function Rc(e){return e}function ha(e){return e}function Hd(){return qd()}function _a(e){return zd(e)}function Nc(e){return Wd(e)}function Lc(e,t){let n=Qe(e,t);return Nc(n)}function qt(e){let r=Tt(e);return ud(r),e}var Io=class extends B{constructor(t){super(),this.all=t}},Bc=class extends B{constructor(t,r,n,i){super(),this.dispatch=t,this.emit=r,this.select=n,this.root=i}};function Gd(e){return new Io(k([t=>e(t.dispatch,t.emit,t.select,t.root)]))}function Co(e){return Gd((t,r,n,i)=>e(t))}function pt(){return new Io(k([]))}function Mo(e,t){return new Io(Qe(e.all,r=>n=>r(new Bc(i=>n.dispatch(t(i)),n.emit,i=>{},n.root))))}var Rn=class extends B{constructor(t){super(),this.content=t}},Ne=class extends B{constructor(t,r,n,i,a,l,f){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=a,this.self_closing=l,this.void=f}},Do=class extends B{constructor(t){super(),this.subtree=t}},bi=class extends B{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},Po=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}};function Tw(e){if(e instanceof bi)return new se(void 0);{let t=e[0],r=e[1],n=Xs(t,2);return new J([n,r])}}function Iw(e,t,r){return rc(e,t,(n,i,a)=>{let l=r+"-"+Xe(a);return Yd(i,n,l)})}function Yd(e,t,r){for(;;){let n=e,i=t,a=r;if(n instanceof Rn)return i;if(n instanceof Do){let l=n.subtree;e=l(),t=i,r=a}else{let l=n.attrs,f=n.children,m=Xr(l,i,(h,g)=>{let v=Tw(g);if(v.isOk()){let O=v[0][0],E=v[0][1];return pi(h,a+"-"+O,E)}else return h});return Iw(f,m,a)}}}function Qd(e){return Yd(e,sr(),"0")}function Le(e,t){return new bi(e,t,!1)}function Xd(e,t){return new Po("on"+e,t)}function Oe(e){return Le("class",e)}function Ro(e){return Le("title",e)}function Zd(e){return Le("type",e)}function eh(e){return Le("value",e)}function th(e){return Le("placeholder",e)}function mr(e,t,r){return e==="area"?new Ne("","",e,t,k([]),!1,!0):e==="base"?new Ne("","",e,t,k([]),!1,!0):e==="br"?new Ne("","",e,t,k([]),!1,!0):e==="col"?new Ne("","",e,t,k([]),!1,!0):e==="embed"?new Ne("","",e,t,k([]),!1,!0):e==="hr"?new Ne("","",e,t,k([]),!1,!0):e==="img"?new Ne("","",e,t,k([]),!1,!0):e==="input"?new Ne("","",e,t,k([]),!1,!0):e==="link"?new Ne("","",e,t,k([]),!1,!0):e==="meta"?new Ne("","",e,t,k([]),!1,!0):e==="param"?new Ne("","",e,t,k([]),!1,!0):e==="source"?new Ne("","",e,t,k([]),!1,!0):e==="track"?new Ne("","",e,t,k([]),!1,!0):e==="wbr"?new Ne("","",e,t,k([]),!1,!0):new Ne("","",e,t,r,!1,!1)}function ya(e,t,r,n){return new Ne("",e,t,r,n,!1,!1)}function st(e){return new Rn(e)}function No(){return new Rn("")}var Uc=class extends B{constructor(t){super(),this.dict=t}};function rh(){return new Uc(sr())}var xa=class extends B{constructor(t){super(),this[0]=t}},va=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},wa=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}};function nh(e){return Me(e.created,sr())&&Me(e.removed,rh())&&Me(e.updated,sr())}var $a=class extends B{constructor(t){super(),this[0]=t}},ba=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},Lo=class extends B{constructor(t){super(),this[0]=t}},dr=class extends B{constructor(t){super(),this[0]=t}},Fo=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},Ea=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}};var Bo=class extends B{},Oa=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},Sa=class extends B{constructor(t){super(),this[0]=t}},Aa=class extends B{constructor(t){super(),this[0]=t}};window&&window.customElements&&window.customElements.define("lustre-fragment",class extends HTMLElement{constructor(){super()}});function zc(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:a,next:l,parent:f}=i.pop();for(;l.subtree!==void 0;)l=l.subtree();if(l.content!==void 0)if(a)if(a.nodeType===Node.TEXT_NODE)a.textContent!==l.content&&(a.textContent=l.content),n??=a;else{let m=document.createTextNode(l.content);f.replaceChild(m,a),n??=m}else{let m=document.createTextNode(l.content);f.appendChild(m),n??=m}else if(l.tag!==void 0){let m=Rw({prev:a,next:l,dispatch:r,stack:i});a?a!==m&&f.replaceChild(m,a):f.appendChild(m),n??=m}}return n}function Rw({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",a=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),l=a?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),f;if(jo.has(l))f=jo.get(l);else{let K=new Map;jo.set(l,K),f=K}let m=a?new Set(f.keys()):null,h=a?new Set(Array.from(e.attributes,K=>K.name)):null,g=null,v=null,O=null;if(a&&t.tag==="textarea"){let K=t.children[Symbol.iterator]().next().value?.content;K!==void 0&&(l.value=K)}let E=[];for(let K of t.attrs){let ne=K[0],Z=K[1];if(K.as_property)l[ne]!==Z&&(l[ne]=Z),a&&h.delete(ne);else if(ne.startsWith("on")){let fe=ne.slice(2),le=r(Z,fe==="input");f.has(fe)||l.addEventListener(fe,Ko),f.set(fe,le),a&&m.delete(fe)}else if(ne.startsWith("data-lustre-on-")){let fe=ne.slice(15),le=r(Nw);f.has(fe)||l.addEventListener(fe,Ko),f.set(fe,le),l.setAttribute(ne,Z)}else ne.startsWith("delegate:data-")||ne.startsWith("delegate:aria-")?(l.setAttribute(ne,Z),E.push([ne.slice(10),Z])):ne==="class"?g=g===null?Z:g+" "+Z:ne==="style"?v=v===null?Z:v+Z:ne==="dangerous-unescaped-html"?O=Z:(l.getAttribute(ne)!==Z&&l.setAttribute(ne,Z),(ne==="value"||ne==="selected")&&(l[ne]=Z),a&&h.delete(ne))}if(g!==null&&(l.setAttribute("class",g),a&&h.delete("class")),v!==null&&(l.setAttribute("style",v),a&&h.delete("style")),a){for(let K of h)l.removeAttribute(K);for(let K of m)f.delete(K),l.removeEventListener(K,Ko)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let K of l.assignedElements())for(let[ne,Z]of E)K.hasAttribute(ne)||K.setAttribute(ne,Z)}),t.key!==void 0&&t.key!=="")l.setAttribute("data-lustre-key",t.key);else if(O!==null)return l.innerHTML=O,l;let T=l.firstChild,C=null,G=null,X=null,Q=ka(t).next().value;if(a&&Q!==void 0&&Q.key!==void 0&&Q.key!==""){C=new Set,G=ih(e),X=ih(t);for(let K of ka(t))T=Lw(T,K,l,n,X,G,C)}else for(let K of ka(t))n.unshift({prev:T,next:K,parent:l}),T=T?.nextSibling;for(;T;){let K=T.nextSibling;l.removeChild(T),T=K}return l}var jo=new WeakMap;function Ko(e){let t=e.currentTarget;if(!jo.has(t)){t.removeEventListener(e.type,Ko);return}let r=jo.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,Ko);return}r.get(e.type)(e)}function Nw(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((a,l)=>{let f=l.split(".");for(let m=0,h=a,g=e;m<f.length;m++)m===f.length-1?h[f[m]]=g[f[m]]:(h[f[m]]??={},g=g[f[m]],h=h[f[m]]);return a},{data:n})}}function ih(e){let t=new Map;if(e)for(let r of ka(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function Lw(e,t,r,n,i,a,l){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let m=e.nextSibling;r.removeChild(e),e=m}if(a.size===0)return n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e;if(l.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;l.add(t.key);let f=a.get(t.key);if(!f&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!f&&e!==null){let m=document.createTextNode("");return r.insertBefore(m,e),n.unshift({prev:m,next:t,parent:r}),e}return!f||f===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(f,e),n.unshift({prev:f,next:t,parent:r}),e)}function*ka(e){for(let t of e.children)yield*oh(t)}function*oh(e){e.subtree!==void 0?yield*oh(e.subtree()):yield e}var Wc=class e{static start({init:t,update:r,view:n},i,a){if(!Vc())return new se(new Uo);let l=i instanceof HTMLElement?i:document.querySelector(i);if(!l)return new se(new Ta(i));let f=new e(l,t(a),r,n);return new J(m=>f.send(m))}constructor(t,[r,n],i,a){this.root=t,this.#e=r,this.#o=i,this.#r=a,this.#t=window.requestAnimationFrame(()=>this.#n(n.all.toArray(),!0))}root;send(t){if(t instanceof Lo){if(t[0]instanceof Aa){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(a,l=!1)=>f=>{let m=a(f);m instanceof J&&this.send(new dr(m[0],l))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));zc(i,r,n)}}else if(t instanceof dr){let r=t[0],n=t[1]??!1;this.#i.push(r),n?(this.#t=window.cancelAnimationFrame(this.#t),this.#n()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#n()))}else if(t instanceof Fo){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof Bo)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#o=null,this.#r=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#o;#r;#i=[];#t;#n(t=[],r=!1){if(this.#t=void 0,!this.#s(t,r))return;let n=this.#r(this.#e),i=(l,f=!1)=>m=>{let h=l(m);h instanceof J&&this.send(new dr(h[0],f))},a=this.root.firstChild??this.root.appendChild(document.createTextNode(""));zc(a,n,i)}#s(t=[],r=!1){for(;this.#i.length>0;){let n=this.#i.shift(),[i,a]=this.#o(this.#e,n);r||=this.#e!==i,t=t.concat(a.all.toArray()),this.#e=i}for(;t.length>0;){let n=t.shift(),i=m=>this.send(new dr(m)),a=(m,h)=>this.root.dispatchEvent(new CustomEvent(m,{detail:h,bubbles:!0,composed:!0})),l=()=>{},f=this.root;n({dispatch:i,emit:a,select:l,root:f})}return this.#i.length>0?this.#s(t,r):r}},sh=Wc.start;var qc=class e{static start({init:t,update:r,view:n,on_attribute_change:i},a){let l=new e(t(a),r,n,i);return new J(f=>l.send(f))}constructor([t,r],n,i,a){this.#e=t,this.#o=n,this.#i=i,this.#t=i(t),this.#u=a,this.#n=new Map,this.#s=Qd(this.#t),this.#a(r.all.toArray())}send(t){if(t instanceof $a){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof se||this.#r.push(i)}this.#a()}else if(t instanceof ba)this.#r=this.#r.concat(t[0].toArray()),this.#a(t[1].all.toArray());else if(!(t instanceof Lo))if(t instanceof dr)this.#r.push(t[0]),this.#a();else if(t instanceof Fo){let r=new va(t[0],t[1]);for(let[n,i]of this.#n)i(r)}else if(t instanceof Ea){let r=this.#s.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof se)return;this.#r.push(n[0]),this.#a()}else if(t instanceof Oa){let r=tc(this.#u),n=new wa(r,this.#t);this.#n=this.#n.set(t[0],t[1]),t[1](n)}else t instanceof Sa&&(this.#n=this.#n.delete(t[0]))}#e;#o;#r;#i;#t;#n;#s;#u;#a(t=[]){if(!this.#l(!1,t))return;let r=this.#i(this.#e),n=elements(this.#t,r);if(!nh(n)){let i=new xa(n);for(let[a,l]of this.#n)l(i)}this.#t=r,this.#s=n.handlers}#l(t=!1,r=[]){for(;this.#r.length>0;){let n=this.#r.shift(),[i,a]=this.#o(this.#e,n);t||=this.#e!==i,r=r.concat(a.all.toArray()),this.#e=i}for(;r.length>0;)r.shift()({dispatch:m=>this.send(new dr(m)),emit:(m,h)=>this.root.dispatchEvent(new CustomEvent(m,{detail:h,bubbles:!0,composed:!0})),select:()=>{},root:null});return this.#r.length>0?this.#l(t,r):t}},Fw=qc.start,Vc=()=>globalThis.window&&window.document;var Hc=class extends B{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var Ta=class extends B{constructor(t){super(),this.selector=t}},Uo=class extends B{};function ah(e,t,r){return new Hc(e,t,r,new Ee)}function uh(e,t,r){return ci(!Vc(),new se(new Uo),()=>sh(e,t,r))}function lh(e,t){return mr("h1",e,t)}function ch(e,t){return mr("h2",e,t)}function je(e,t){return mr("div",e,t)}function fh(e,t){return mr("li",e,t)}function ph(e,t){return mr("ul",e,t)}function Gc(e,t){return mr("span",e,t)}function rn(e,t){return mr("button",e,t)}function mh(e){return mr("input",e,k([]))}function Yc(e,t){return Xd(e,t)}function Ir(e){return Yc("click",t=>new J(e))}function dh(e){return Yc("keydown",t=>{let r=t,n=ta("key",kn)(r);return kr(n,e)})}function Kw(e){let t=e;return ta("target",ta("value",kn))(t)}function hh(e){return Yc("input",t=>{let r=Kw(t);return kr(r,e)})}var _h="http://www.w3.org/2000/svg";function gh(e,t){return ya(_h,"svg",e,t)}function Nn(e){return ya(_h,"path",e,k([]))}function yh(e){return gh(me(Le("stroke-linejoin","round"),me(Le("stroke-linecap","round"),me(Le("stroke-width","2"),me(Le("stroke","currentColor"),me(Le("fill","none"),me(Le("viewBox","0 0 24 24"),me(Le("height","24"),me(Le("width","24"),e)))))))),k([Nn(k([Le("d","m5 8 6 6")])),Nn(k([Le("d","m4 14 6-6 2-3")])),Nn(k([Le("d","M2 5h12")])),Nn(k([Le("d","M7 2h1")])),Nn(k([Le("d","m22 22-5-10-5 10")])),Nn(k([Le("d","M14 18h6")]))]))}function Ln(e){"@babel/helpers - typeof";return Ln=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ln(e)}function xh(e,t){if(Ln(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ln(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vh(e){var t=xh(e,"string");return Ln(t)=="symbol"?t:t+""}function wh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vh(n.key),n)}}function at(e,t,r){return t&&wh(e.prototype,t),r&&wh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zo(e){return Array.isArray(e)?e.slice(0):[e]}function Ei(e){return Array.isArray(e)}function $h(e){return e!=null}function Ia(e,t){var r=0,n=-1;for(var i of e){n=n+1;var a=t(i,n);if(a)r=r+1;else break}return r}function Cr(e,t){var r=t.length;if(r!==0){var n=e.length;e.length=n+t.length;for(var i=0;i<r;++i)e[n+i]=t[i]}}function bh(e){return e.filter(function(t,r,n){return n.indexOf(t)===r})}function Fn(e){for(var t="",r=0;r<e.length;r++){var n=e[r];if(n==="-")return parseInt(t,10);t+=n}throw new Error("malformatted revision: "+e)}function Oi(e,t){var r=t?Fn(t._rev)+1:1;return r+"-"+e}function Eh(e){var t=e.split("."),r=t.length;return r===1?n=>n[e]:n=>{for(var i=n,a=0;a<r;++a){var l=t[a];if(i=i[l],typeof i>"u")return i}return i}}function ke(e){return Object.assign({},e)}function Oh(e){return Object.keys(e)[0]}function Si(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort((n,i)=>typeof n=="string"&&typeof i=="string"?n.localeCompare(i):typeof n=="object"?1:-1).map(n=>Si(n,t));if(typeof e=="object"&&!Array.isArray(e)){var r={};return Object.keys(e).sort((n,i)=>n.localeCompare(i)).forEach(n=>{r[n]=Si(e[n],t)}),r}return e}function Qc(e){if(!e||e===null||typeof e!="object")return e;if(Array.isArray(e)){for(var t=new Array(e.length),r=t.length;r--;)t[r]=Qc(e[r]);return t}var n={};for(var i in e)n[i]=Qc(e[i]);return n}var hr=Qc;function yt(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}var Ca=1;function nn(){return{lwt:Ca}}function Mr(){return""}function Sh(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function Ah(e,t,r){if(t.length!==r.length)return!1;for(var n=0,i=t.length;n<i;){var a=t[n],l=r[n];if(n++,a._rev!==l._rev||a[e]!==l[e])return!1}return!0}var DC=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});var PC=Object.freeze(["prototype","__proto__","constructor"]);var qw="[native code] }",RC=qw.length;var Vw=Object.defineProperty,Hw=(e,t,r)=>t in e?Vw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ai=(e,t,r)=>(Hw(e,typeof t!="symbol"?t+"":t,r),r),on=class e{constructor(t,r){Ai(this,"words"),Ai(this,"sigBytes"),t=this.words=t||[],this.sigBytes=r===void 0?t.length*4:r}toString(t){return(t||Gw).stringify(this)}concat(t){if(this.clamp(),this.sigBytes%4)for(let r=0;r<t.sigBytes;r++){let n=t.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=n<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<t.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=t.words[r>>>2];return this.sigBytes+=t.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new e([...this.words])}},Gw={stringify(e){let t=[];for(let r=0;r<e.sigBytes;r++){let n=e.words[r>>>2]>>>24-r%4*8&255;t.push((n>>>4).toString(16),(n&15).toString(16))}return t.join("")}};var Yw={parse(e){let t=e.length,r=[];for(let n=0;n<t;n++)r[n>>>2]|=(e.charCodeAt(n)&255)<<24-n%4*8;return new on(r,t)}},Qw={parse(e){return Yw.parse(unescape(encodeURIComponent(e)))}},Jc=class{constructor(){Ai(this,"_data",new on),Ai(this,"_nDataBytes",0),Ai(this,"_minBufferSize",0),Ai(this,"blockSize",512/32)}reset(){this._data=new on,this._nDataBytes=0}_append(t){typeof t=="string"&&(t=Qw.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_doProcessBlock(t,r){}_process(t){let r,n=this._data.sigBytes/(this.blockSize*4);t?n=Math.ceil(n):n=Math.max((n|0)-this._minBufferSize,0);let i=n*this.blockSize,a=Math.min(i*4,this._data.sigBytes);if(i){for(let l=0;l<i;l+=this.blockSize)this._doProcessBlock(this._data.words,l);r=this._data.words.splice(0,i),this._data.sigBytes-=a}return new on(r,a)}},Xc=class extends Jc{update(t){return this._append(t),this._process(),this}finalize(t){t&&this._append(t)}},Jw=Object.defineProperty,Xw=(e,t,r)=>t in e?Jw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Zw=(e,t,r)=>(Xw(e,typeof t!="symbol"?t+"":t,r),r),kh=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],e$=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Bn=[],Zc=class extends Xc{constructor(){super(...arguments),Zw(this,"_hash",new on([...kh]))}reset(){super.reset(),this._hash=new on([...kh])}_doProcessBlock(t,r){let n=this._hash.words,i=n[0],a=n[1],l=n[2],f=n[3],m=n[4],h=n[5],g=n[6],v=n[7];for(let O=0;O<64;O++){if(O<16)Bn[O]=t[r+O]|0;else{let K=Bn[O-15],ne=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,Z=Bn[O-2],fe=(Z<<15|Z>>>17)^(Z<<13|Z>>>19)^Z>>>10;Bn[O]=ne+Bn[O-7]+fe+Bn[O-16]}let E=m&h^~m&g,T=i&a^i&l^a&l,C=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),G=(m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25),X=v+G+E+e$[O]+Bn[O],Q=C+T;v=g,g=h,h=m,m=f+X|0,f=l,l=a,a=i,i=X+Q|0}n[0]=n[0]+i|0,n[1]=n[1]+a|0,n[2]=n[2]+l|0,n[3]=n[3]+f|0,n[4]=n[4]+m|0,n[5]=n[5]+h|0,n[6]=n[6]+g|0,n[7]=n[7]+v|0}finalize(t){super.finalize(t);let r=this._nDataBytes*8,n=this._data.sigBytes*8;return this._data.words[n>>>5]|=128<<24-n%32,this._data.words[(n+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(n+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}};function Th(e){return new Zc().finalize(e).toString()}function t$(e){return Promise.resolve(Th(e))}async function r$(e){var t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t),n=Array.prototype.map.call(new Uint8Array(r),i=>("00"+i.toString(16)).slice(-2)).join("");return n}var n$=typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof crypto.subtle.digest=="function",Ma=n$?r$:t$;function Ih(){return new Promise(e=>setTimeout(e,0))}function Ch(e=0){return new Promise(t=>setTimeout(t,e))}var i$=Promise.resolve(!0),_r=Promise.resolve(!1),Mh=Promise.resolve(null),ki=Promise.resolve();function Ti(e=1e4){return typeof requestIdleCallback=="function"?new Promise(t=>{requestIdleCallback(()=>t(),{timeout:e})}):Ch(0)}var ef=ki;function Dh(e=void 0){return ef=ef.then(()=>Ti(e)),ef}function Ph(e,t){return e.reduce((r,n)=>r.then(n),Promise.resolve(t))}var Rh=/\./g;var Nh="abcdefghijklmnopqrstuvwxyz";function jn(e=10){for(var t="",r=0;r<e;r++)t+=Nh.charAt(Math.floor(Math.random()*Nh.length));return t}function Da(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)}function Kn(e){for(;e.charAt(0)===".";)e=e.substr(1);for(;e.slice(-1)===".";)e=e.slice(0,-1);return e}function Ii(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n;if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Ii(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var i=Object.keys(e);if(r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){var a=i[n];if(!Ii(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}var rf=e=>{var t=typeof e;return e!==null&&(t==="object"||t==="function")},tf=new Set(["__proto__","prototype","constructor"]),o$=new Set("0123456789");function Lh(e){var t=[],r="",n="start",i=!1;for(var a of e)switch(a){case"\\":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");i&&(r+=a),n="property",i=!i;break}case".":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="property";break}if(i){i=!1,r+=a;break}if(tf.has(r))return[];t.push(r),r="",n="property";break}case"[":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="index";break}if(i){i=!1,r+=a;break}if(n==="property"){if(tf.has(r))return[];t.push(r),r=""}n="index";break}case"]":{if(n==="index"){t.push(Number.parseInt(r,10)),r="",n="indexEnd";break}if(n==="indexEnd")throw new Error("Invalid character after an index")}default:{if(n==="index"&&!o$.has(a))throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");n==="start"&&(n="property"),i&&(i=!1,r+="\\"),r+=a}}switch(i&&(r+="\\"),n){case"property":{if(tf.has(r))return[];t.push(r);break}case"index":throw new Error("Index was not closed");case"start":{t.push("");break}}return t}function Fh(e,t){if(typeof t!="number"&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function s$(e,t){if(Fh(e,t))throw new Error("Cannot use string index")}function Dr(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!rf(e)||typeof t!="string")return r===void 0?e:r;var n=Lh(t);if(n.length===0)return r;for(var i=0;i<n.length;i++){var a=n[i];if(Fh(e,a)?e=i===n.length-1?void 0:null:e=e[a],e==null){if(i!==n.length-1)return r;break}}return e===void 0?r:e}function nf(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!rf(e)||typeof t!="string")return e;for(var n=e,i=Lh(t),a=0;a<i.length;a++){var l=i[a];s$(e,l),a===i.length-1?e[l]=r:rf(e[l])||(e[l]=typeof i[a+1]=="number"?[]:{}),e=e[l]}return n}function sn(e,t){var r=e.get(t);if(typeof r>"u")throw new Error("missing value from map "+t);return r}function xt(e,t,r,n){var i=e.get(t);return typeof i>"u"?(i=r(),e.set(t,i)):n&&n(i),i}function $e(e){var t=e.split("-"),r="RxDB";return t.forEach(n=>{r+=Da(n)}),r+="Plugin",new Error(`You are using a function which must be overwritten by a plugin.
        You should either prevent the usage of this function or add the plugin via:
            import { `+r+" } from 'rxdb/plugins/"+e+`';
            addRxPlugin(`+r+`);
        `)}var of=0;function Ke(){var e=Date.now();e=e+.01,e<=of&&(e=of+.01);var t=parseFloat(e.toFixed(2));return of=t,t}function be(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}var Pa={bufferSize:1,refCount:!0};var Wo="15.38.2";var Ra={},Bh="6da4936d1425ff3a5c44c02342c6daf791d266be3ae8479b8ec59e261df41b93";function an(e,t){return an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},an(e,t)}function sf(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,an(e,t)}function Na(e){return Na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Na(e)}function jh(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function af(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(af=function(){return!!e})()}function Kh(e,t,r){if(af())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&an(i,r.prototype),i}function qo(e){var t=typeof Map=="function"?new Map:void 0;return qo=function(n){if(n===null||!jh(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(n))return t.get(n);t.set(n,i)}function i(){return Kh(n,arguments,Na(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),an(i,n)},qo(e)}var Te={isDevMode(){return!1},deepFreezeWhenDevMode(e){return e},tunnelErrorMessage(e){return"RxDB Error-Code "+e+`.
        Error messages are not included in RxDB core to reduce build size.
        `}};function a$(e){var t="";return Object.keys(e).length===0||(t+=`Given parameters: {
`,t+=Object.keys(e).map(r=>{var n="[object Object]";try{r==="errors"?n=e[r].map(i=>JSON.stringify(i,Object.getOwnPropertyNames(i))):n=JSON.stringify(e[r],function(i,a){return a===void 0?null:a},2)}catch{}return r+":"+n}).join(`
`),t+="}"),t}function Uh(e,t,r){return"RxError ("+t+`):
`+e+`
`+a$(r)}var u$=function(e){function t(n,i,a={}){var l,f=Uh(i,n,a);return l=e.call(this,f)||this,l.code=n,l.message=f,l.url=uf(n),l.parameters=a,l.rxdb=!0,l}sf(t,e);var r=t.prototype;return r.toString=function(){return this.message},at(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])}(qo(Error)),l$=function(e){function t(n,i,a={}){var l,f=Uh(i,n,a);return l=e.call(this,f)||this,l.code=n,l.message=f,l.url=uf(n),l.parameters=a,l.rxdb=!0,l}sf(t,e);var r=t.prototype;return r.toString=function(){return this.message},at(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])}(qo(TypeError));function uf(e){return"https://rxdb.info/errors.html?console=errors#"+e}function zh(e){return`
 You can find out more about this error here: `+uf(e)+" "}function te(e,t){return new u$(e,Te.tunnelErrorMessage(e)+zh(e),t)}function La(e,t){return new l$(e,Te.tunnelErrorMessage(e)+zh(e),t)}function Fa(e){return e&&e.status===409?e:!1}var c$={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function Wh(e){return te("COL20",{name:c$[e.status],document:e.documentId,writeError:e})}var lf={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],postCleanup:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function qe(e,t){lf[e].length>0&&lf[e].forEach(r=>r(t))}function un(e,t){return Promise.all(lf[e].map(r=>r(t)))}function Pr(e,t){var r=t;r=r.replace(Rh,".properties."),r="properties."+r,r=Kn(r);var n=Dr(e,r);return n}function qh(e,t,r){if(typeof t.primaryKey=="string")return r;var n=Vo(t,r),i=r[e];if(i&&i!==n)throw te("DOC19",{args:{documentData:r,existingPrimary:i,newPrimary:n},schema:t});return r[e]=n,r}function Mt(e){return typeof e=="string"?e:e.key}function Vo(e,t){if(typeof e.primaryKey=="string")return t[e.primaryKey];var r=e.primaryKey;return r.fields.map(n=>{var i=Dr(t,n);if(typeof i>"u")throw te("DOC18",{args:{field:n,documentData:t}});return i}).join(r.separator)}function Vh(e){var t=Si(e,!0);return t}function f$(e){return["_deleted",e]}function Ba(e){e=ke(e);var t=Mt(e.primaryKey);e.properties=ke(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=p$,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=cf(e);Cr(e.required,r),e.required=e.required.filter(a=>!a.includes(".")).filter((a,l,f)=>f.indexOf(a)===l),e.version=e.version||0;var n=e.indexes.map(a=>{var l=Ei(a)?a.slice(0):[a];return l.includes(t)||l.push(t),l[0]!=="_deleted"&&l.unshift("_deleted"),l});n.length===0&&n.push(f$(t)),n.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map(a=>{n.push(a)});var i=new Set;return n.filter(a=>{var l=a.join(",");return i.has(l)?!1:(i.add(l),!0)}),e.indexes=n,e}var p$={type:"object",properties:{lwt:{type:"number",minimum:Ca,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function cf(e){var t=Object.keys(e.properties).filter(n=>e.properties[n].final),r=Mt(e.primaryKey);return t.push(r),typeof e.primaryKey!="string"&&e.primaryKey.fields.forEach(n=>t.push(n)),t}function Hh(e,t){for(var r=Object.keys(e.defaultValues),n=0;n<r.length;++n){var i=r[n];(!Object.prototype.hasOwnProperty.call(t,i)||typeof t[i]>"u")&&(t[i]=e.defaultValues[i])}return t}var m$=function(){function e(r,n){this.jsonSchema=r,this.hashFunction=n,this.indexes=d$(this.jsonSchema),this.primaryPath=Mt(this.jsonSchema.primaryKey),this.finalFields=cf(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(n,i){this.finalFields.forEach(a=>{if(!Ii(n[a],i[a]))throw te("DOC9",{dataBefore:n,dataAfter:i,fieldName:a,schema:this.jsonSchema})})},t.getDocumentPrototype=function(){var n={},i=Pr(this.jsonSchema,"");return Object.keys(i).forEach(a=>{var l=a;n.__defineGetter__(a,function(){if(!(!this.get||typeof this.get!="function")){var f=this.get(l);return f}}),Object.defineProperty(n,a+"$",{get:function(){return this.get$(l)},enumerable:!1,configurable:!1}),Object.defineProperty(n,a+"$$",{get:function(){return this.get$$(l)},enumerable:!1,configurable:!1}),Object.defineProperty(n,a+"_",{get:function(){return this.populate(l)},enumerable:!1,configurable:!1})}),yt(this,"getDocumentPrototype",()=>n),n},t.getPrimaryOfDocumentData=function(n){return Vo(this.jsonSchema,n)},at(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var r={};return Object.entries(this.jsonSchema.properties).filter(([,n])=>Object.prototype.hasOwnProperty.call(n,"default")).forEach(([n,i])=>r[n]=i.default),yt(this,"defaultValues",r)}},{key:"hash",get:function(){return yt(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])}();function d$(e){return(e.indexes||[]).map(t=>Ei(t)?t:[t])}function Gh(e,t,r=!0){r&&qe("preCreateRxSchema",e);var n=Ba(e);n=Vh(n),Te.deepFreezeWhenDevMode(n);var i=new m$(n,t);return qe("createRxSchema",i),i}function ve(e){return typeof e=="function"}function h$(e){return ve(e?.lift)}function Ve(e){return function(t){if(h$(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var ff=function(e,t){return ff=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},ff(e,t)};function Dt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ff(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Yh(e,t,r,n){function i(a){return a instanceof r?a:new r(function(l){l(a)})}return new(r||(r=Promise))(function(a,l){function f(g){try{h(n.next(g))}catch(v){l(v)}}function m(g){try{h(n.throw(g))}catch(v){l(v)}}function h(g){g.done?a(g.value):i(g.value).then(f,m)}h((n=n.apply(e,t||[])).next())})}function ja(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=f(0),l.throw=f(1),l.return=f(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(h){return function(g){return m([h,g])}}function m(h){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,h[0]&&(r=0)),r;)try{if(n=1,i&&(a=h[0]&2?i.return:h[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,h[1])).done)return a;switch(i=0,a&&(h=[h[0]&2,a.value]),h[0]){case 0:case 1:a=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){r.label=h[1];break}if(h[0]===6&&r.label<a[1]){r.label=a[1],a=h;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(h);break}a[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(g){h=[6,g],i=0}finally{n=a=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Rr(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pt(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],l;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(f){l={error:f}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return a}function Rt(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function Un(e){return this instanceof Un?(this.v=e,this):new Un(e)}function Qh(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(E){return function(T){return Promise.resolve(T).then(E,v)}}function f(E,T){n[E]&&(i[E]=function(C){return new Promise(function(G,X){a.push([E,C,G,X])>1||m(E,C)})},T&&(i[E]=T(i[E])))}function m(E,T){try{h(n[E](T))}catch(C){O(a[0][3],C)}}function h(E){E.value instanceof Un?Promise.resolve(E.value.v).then(g,v):O(a[0][2],E)}function g(E){m("next",E)}function v(E){m("throw",E)}function O(E,T){E(T),a.shift(),a.length&&m(a[0][0],a[0][1])}}function Jh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Rr=="function"?Rr(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(l){return new Promise(function(f,m){l=e[a](l),i(f,m,l.done,l.value)})}}function i(a,l,f,m){Promise.resolve(m).then(function(h){a({value:h,done:f})},l)}}var Ka=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Ua(e){return ve(e?.then)}function za(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var Wa=za(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function Ho(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var Ci=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,n,i,a;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var f=Rr(l),m=f.next();!m.done;m=f.next()){var h=m.value;h.remove(this)}}catch(C){t={error:C}}finally{try{m&&!m.done&&(r=f.return)&&r.call(f)}finally{if(t)throw t.error}}else l.remove(this);var g=this.initialTeardown;if(ve(g))try{g()}catch(C){a=C instanceof Wa?C.errors:[C]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var O=Rr(v),E=O.next();!E.done;E=O.next()){var T=E.value;try{Xh(T)}catch(C){a=a??[],C instanceof Wa?a=Rt(Rt([],Pt(a)),Pt(C.errors)):a.push(C)}}}catch(C){n={error:C}}finally{try{E&&!E.done&&(i=O.return)&&i.call(O)}finally{if(n)throw n.error}}}if(a)throw new Wa(a)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Xh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&Ho(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&Ho(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();var pf=Ci.EMPTY;function qa(e){return e instanceof Ci||e&&"closed"in e&&ve(e.remove)&&ve(e.add)&&ve(e.unsubscribe)}function Xh(e){ve(e)?e():e.unsubscribe()}var Vt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Mi={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=Mi.delegate;return i?.setTimeout?i.setTimeout.apply(i,Rt([e,t],Pt(r))):setTimeout.apply(void 0,Rt([e,t],Pt(r)))},clearTimeout:function(e){var t=Mi.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Va(e){Mi.setTimeout(function(){var t=Vt.onUnhandledError;if(t)t(e);else throw e})}function mf(){}var Zh=function(){return df("C",void 0,void 0)}();function e_(e){return df("E",void 0,e)}function t_(e){return df("N",e,void 0)}function df(e,t,r){return{kind:e,value:t,error:r}}var zn=null;function Di(e){if(Vt.useDeprecatedSynchronousErrorHandling){var t=!zn;if(t&&(zn={errorThrown:!1,error:null}),e(),t){var r=zn,n=r.errorThrown,i=r.error;if(zn=null,n)throw i}}else e()}function r_(e){Vt.useDeprecatedSynchronousErrorHandling&&zn&&(zn.errorThrown=!0,zn.error=e)}var Go=function(e){Dt(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,qa(r)&&r.add(n)):n.destination=x$,n}return t.create=function(r,n,i){return new Wn(r,n,i)},t.prototype.next=function(r){this.isStopped?_f(t_(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?_f(e_(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?_f(Zh,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Ci);var _$=Function.prototype.bind;function hf(e,t){return _$.call(e,t)}var g$=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(n){Ha(n)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(n){Ha(n)}else Ha(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){Ha(r)}},e}(),Wn=function(e){Dt(t,e);function t(r,n,i){var a=e.call(this)||this,l;if(ve(r)||!r)l={next:r??void 0,error:n??void 0,complete:i??void 0};else{var f;a&&Vt.useDeprecatedNextContext?(f=Object.create(r),f.unsubscribe=function(){return a.unsubscribe()},l={next:r.next&&hf(r.next,f),error:r.error&&hf(r.error,f),complete:r.complete&&hf(r.complete,f)}):l=r}return a.destination=new g$(l),a}return t}(Go);function Ha(e){Vt.useDeprecatedSynchronousErrorHandling?r_(e):Va(e)}function y$(e){throw e}function _f(e,t){var r=Vt.onStoppedNotification;r&&Mi.setTimeout(function(){return r(e,t)})}var x$={closed:!0,next:mf,error:y$,complete:mf};var Pi=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ri(e){return e}function n_(e){return e.length===0?Ri:e.length===1?e[0]:function(r){return e.reduce(function(n,i){return i(n)},r)}}var He=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var i=this,a=w$(t)?t:new Wn(t,r,n);return Di(function(){var l=i,f=l.operator,m=l.source;a.add(f?f.call(a,m):m?i._subscribe(a):i._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=i_(r),new r(function(i,a){var l=new Wn({next:function(f){try{t(f)}catch(m){a(m),l.unsubscribe()}},error:a,complete:i});n.subscribe(l)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[Pi]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n_(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=i_(t),new t(function(n,i){var a;r.subscribe(function(l){return a=l},function(l){return i(l)},function(){return n(a)})})},e.create=function(t){return new e(t)},e}();function i_(e){var t;return(t=e??Vt.Promise)!==null&&t!==void 0?t:Promise}function v$(e){return e&&ve(e.next)&&ve(e.error)&&ve(e.complete)}function w$(e){return e&&e instanceof Go||v$(e)&&qa(e)}function Ga(e){return ve(e[Pi])}function Ya(e){return Symbol.asyncIterator&&ve(e?.[Symbol.asyncIterator])}function Qa(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function $$(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ja=$$();function Xa(e){return ve(e?.[Ja])}function Za(e){return Qh(this,arguments,function(){var r,n,i,a;return ja(this,function(l){switch(l.label){case 0:r=e.getReader(),l.label=1;case 1:l.trys.push([1,,9,10]),l.label=2;case 2:return[4,Un(r.read())];case 3:return n=l.sent(),i=n.value,a=n.done,a?[4,Un(void 0)]:[3,5];case 4:return[2,l.sent()];case 5:return[4,Un(i)];case 6:return[4,l.sent()];case 7:return l.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function eu(e){return ve(e?.getReader)}function ut(e){if(e instanceof He)return e;if(e!=null){if(Ga(e))return b$(e);if(Ka(e))return E$(e);if(Ua(e))return O$(e);if(Ya(e))return o_(e);if(Xa(e))return S$(e);if(eu(e))return A$(e)}throw Qa(e)}function b$(e){return new He(function(t){var r=e[Pi]();if(ve(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function E$(e){return new He(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function O$(e){return new He(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,Va)})}function S$(e){return new He(function(t){var r,n;try{for(var i=Rr(e),a=i.next();!a.done;a=i.next()){var l=a.value;if(t.next(l),t.closed)return}}catch(f){r={error:f}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t.complete()})}function o_(e){return new He(function(t){k$(e,t).catch(function(r){return t.error(r)})})}function A$(e){return o_(Za(e))}function k$(e,t){var r,n,i,a;return Yh(this,void 0,void 0,function(){var l,f;return ja(this,function(m){switch(m.label){case 0:m.trys.push([0,5,6,11]),r=Jh(e),m.label=1;case 1:return[4,r.next()];case 2:if(n=m.sent(),!!n.done)return[3,4];if(l=n.value,t.next(l),t.closed)return[2];m.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return f=m.sent(),i={error:f},[3,11];case 6:return m.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:m.sent(),m.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Ht(e,t,r,n,i){return new T$(e,t,r,n,i)}var T$=function(e){Dt(t,e);function t(r,n,i,a,l,f){var m=e.call(this,r)||this;return m.onFinalize=l,m.shouldUnsubscribe=f,m._next=n?function(h){try{n(h)}catch(g){r.error(g)}}:e.prototype._next,m._error=a?function(h){try{a(h)}catch(g){r.error(g)}finally{this.unsubscribe()}}:e.prototype._error,m._complete=i?function(){try{i()}catch(h){r.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,m}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(Go);var gf={now:function(){return(gf.delegate||Date).now()},delegate:void 0};function s_(e){return e&&ve(e.schedule)}function a_(e){return e[e.length-1]}function ln(e){return s_(a_(e))?e.pop():void 0}function tu(e,t){return typeof a_(e)=="number"?e.pop():t}function Nt(e,t,r,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var a=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(a),!i)return a}function ru(e,t){return t===void 0&&(t=0),Ve(function(r,n){r.subscribe(Ht(n,function(i){return Nt(n,e,function(){return n.next(i)},t)},function(){return Nt(n,e,function(){return n.complete()},t)},function(i){return Nt(n,e,function(){return n.error(i)},t)}))})}function nu(e,t){return t===void 0&&(t=0),Ve(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function u_(e,t){return ut(e).pipe(nu(t),ru(t))}function l_(e,t){return ut(e).pipe(nu(t),ru(t))}function c_(e,t){return new He(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function f_(e,t){return new He(function(r){var n;return Nt(r,t,function(){n=e[Ja](),Nt(r,t,function(){var i,a,l;try{i=n.next(),a=i.value,l=i.done}catch(f){r.error(f);return}l?r.complete():r.next(a)},0,!0)}),function(){return ve(n?.return)&&n.return()}})}function iu(e,t){if(!e)throw new Error("Iterable cannot be null");return new He(function(r){Nt(r,t,function(){var n=e[Symbol.asyncIterator]();Nt(r,t,function(){n.next().then(function(i){i.done?r.complete():r.next(i.value)})},0,!0)})})}function p_(e,t){return iu(Za(e),t)}function m_(e,t){if(e!=null){if(Ga(e))return u_(e,t);if(Ka(e))return c_(e,t);if(Ua(e))return l_(e,t);if(Ya(e))return iu(e,t);if(Xa(e))return f_(e,t);if(eu(e))return p_(e,t)}throw Qa(e)}function Ni(e,t){return t?m_(e,t):ut(e)}function lt(e,t){return Ve(function(r,n){var i=0;r.subscribe(Ht(n,function(a){n.next(e.call(t,a,i++))}))})}function d_(e,t,r,n,i,a,l,f){var m=[],h=0,g=0,v=!1,O=function(){v&&!m.length&&!h&&t.complete()},E=function(C){return h<n?T(C):m.push(C)},T=function(C){a&&t.next(C),h++;var G=!1;ut(r(C,g++)).subscribe(Ht(t,function(X){i?.(X),a?E(X):t.next(X)},function(){G=!0},void 0,function(){if(G)try{h--;for(var X=function(){var Q=m.shift();l?Nt(t,l,function(){return T(Q)}):T(Q)};m.length&&h<n;)X();O()}catch(Q){t.error(Q)}}))};return e.subscribe(Ht(t,E,function(){v=!0,O()})),function(){f?.()}}function Gt(e,t,r){return r===void 0&&(r=1/0),ve(t)?Gt(function(n,i){return lt(function(a,l){return t(n,a,i,l)})(ut(e(n,i)))},r):(typeof t=="number"&&(r=t),Ve(function(n,i){return d_(n,i,e,r)}))}var I$=Array.isArray;function h_(e){return e.length===1&&I$(e[0])?e[0]:e}function Li(e){return e===void 0&&(e=1/0),Gt(Ri,e)}function __(){return Li(1)}var g_=za(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var ct=function(e){Dt(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new y_(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new g_},t.prototype.next=function(r){var n=this;Di(function(){var i,a;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var l=Rr(n.currentObservers),f=l.next();!f.done;f=l.next()){var m=f.value;m.next(r)}}catch(h){i={error:h}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}})},t.prototype.error=function(r){var n=this;Di(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},t.prototype.complete=function(){var r=this;Di(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,i=this,a=i.hasError,l=i.isStopped,f=i.observers;return a||l?pf:(this.currentObservers=null,f.push(r),new Ci(function(){n.currentObservers=null,Ho(f,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,a=n.thrownError,l=n.isStopped;i?r.error(a):l&&r.complete()},t.prototype.asObservable=function(){var r=new He;return r.source=this,r},t.create=function(r,n){return new y_(r,n)},t}(He);var y_=function(e){Dt(t,e);function t(r,n){var i=e.call(this)||this;return i.destination=r,i.source=n,i}return t.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},t.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:pf},t}(ct);function yf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __()(Ni(e,ln(e)))}var x_=new He(function(e){return e.complete()});function Fi(e,t){return t===void 0&&(t=Ri),e=e??C$,Ve(function(r,n){var i,a=!0;r.subscribe(Ht(n,function(l){var f=t(l);(a||!e(i,f))&&(a=!1,i=f,n.next(l))}))})}function C$(e,t){return e===t}function Ue(e,t){return Ve(function(r,n){var i=0;r.subscribe(Ht(n,function(a){return e.call(t,a,i++)&&n.next(a)}))})}function v_(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ln(e),n=tu(e,1/0);return e=h_(e),Ve(function(i,a){Li(n)(Ni(Rt([i],Pt(e)),r)).subscribe(a)})}function xf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return v_.apply(void 0,Rt([],Pt(e)))}var vf=function(e){Dt(t,e);function t(r){var n=e.call(this)||this;return n._value=r,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(r){var n=e.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},t.prototype.getValue=function(){var r=this,n=r.hasError,i=r.thrownError,a=r._value;if(n)throw i;return this._throwIfClosed(),a},t.prototype.next=function(r){e.prototype.next.call(this,this._value=r)},t}(ct);var w_=function(e){Dt(t,e);function t(r,n,i){r===void 0&&(r=1/0),n===void 0&&(n=1/0),i===void 0&&(i=gf);var a=e.call(this)||this;return a._bufferSize=r,a._windowTime=n,a._timestampProvider=i,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=n===1/0,a._bufferSize=Math.max(1,r),a._windowTime=Math.max(1,n),a}return t.prototype.next=function(r){var n=this,i=n.isStopped,a=n._buffer,l=n._infiniteTimeWindow,f=n._timestampProvider,m=n._windowTime;i||(a.push(r),!l&&a.push(f.now()+m)),this._trimBuffer(),e.prototype.next.call(this,r)},t.prototype._subscribe=function(r){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(r),i=this,a=i._infiniteTimeWindow,l=i._buffer,f=l.slice(),m=0;m<f.length&&!r.closed;m+=a?1:2)r.next(f[m]);return this._checkFinalizedStatuses(r),n},t.prototype._trimBuffer=function(){var r=this,n=r._bufferSize,i=r._timestampProvider,a=r._buffer,l=r._infiniteTimeWindow,f=(l?1:2)*n;if(n<1/0&&f<a.length&&a.splice(0,a.length-f),!l){for(var m=i.now(),h=0,g=1;g<a.length&&a[g]<=m;g+=2)h=g;h&&a.splice(0,h+1)}},t}(ct);function $_(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new ct}:t,n=e.resetOnError,i=n===void 0?!0:n,a=e.resetOnComplete,l=a===void 0?!0:a,f=e.resetOnRefCountZero,m=f===void 0?!0:f;return function(h){var g,v,O,E=0,T=!1,C=!1,G=function(){v?.unsubscribe(),v=void 0},X=function(){G(),g=O=void 0,T=C=!1},Q=function(){var K=g;X(),K?.unsubscribe()};return Ve(function(K,ne){E++,!C&&!T&&G();var Z=O=O??r();ne.add(function(){E--,E===0&&!C&&!T&&(v=wf(Q,m))}),Z.subscribe(ne),!g&&E>0&&(g=new Wn({next:function(fe){return Z.next(fe)},error:function(fe){C=!0,G(),v=wf(X,i,fe),Z.error(fe)},complete:function(){T=!0,G(),v=wf(X,l),Z.complete()}}),ut(K).subscribe(g))})(h)}}function wf(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(t===!0){e();return}if(t!==!1){var i=new Wn({next:function(){i.unsubscribe(),e()}});return ut(t.apply(void 0,Rt([],Pt(r)))).subscribe(i)}}function Yo(e,t,r){var n,i,a,l,f=!1;return e&&typeof e=="object"?(n=e.bufferSize,l=n===void 0?1/0:n,i=e.windowTime,t=i===void 0?1/0:i,a=e.refCount,f=a===void 0?!1:a,r=e.scheduler):l=e??1/0,$_({connector:function(){return new w_(l,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:f})}function Qo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ln(e);return Ve(function(n,i){(r?yf(e,n,r):yf(e,n)).subscribe(i)})}function b_(e){return e.documentData?e.documentData:e.previousDocumentData}function E_(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:Te.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}function $f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ln(e),n=tu(e,1/0),i=e;return i.length?i.length===1?ut(i[0]):Li(n)(Ni(i,r)):x_}function ou(e){return e[e.length-1]}function M$(e){let t=typeof e;return e!==null&&(t==="object"||t==="function")}function bf(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!M$(e)||typeof t!="string")return r===void 0?e:r;let n=t.split(".");if(n.length===0)return r;for(let i=0;i<n.length;i++){let a=n[i];if(D$(e,a)?e=i===n.length-1?void 0:null:e=e[a],e==null){if(i!==n.length-1)return r;break}}return e===void 0?r:e}function D$(e,t){if(typeof t!="number"&&Array.isArray(e)){let r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}var Ef=e=>!!e.queryParams.limit,O_=e=>e.queryParams.limit===1,S_=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),A_=e=>e.changeEvent.operation==="DELETE",k_=e=>e.changeEvent.operation==="INSERT",T_=e=>e.changeEvent.operation==="UPDATE",I_=e=>Ef(e)&&e.previousResults.length>=e.queryParams.limit,C_=e=>{let t=e.queryParams.sortFields,r=e.changeEvent.previous,n=e.changeEvent.doc;if(!n)return!1;if(!r)return!0;for(let i=0;i<t.length;i++){let a=t[i],l=bf(r,a),f=bf(n,a);if(l!==f)return!0}return!1},M_=e=>{let t=e.changeEvent.id;if(e.keyDocumentMap)return e.keyDocumentMap.has(t);{let r=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][r]===t)return!0;return!1}},D_=e=>{let t=e.previousResults[0];return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},P_=e=>{let t=ou(e.previousResults);return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},R_=e=>{let t=e.changeEvent.previous;if(!t)return!1;let r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},N_=e=>{let t=e.changeEvent.previous;if(!t)return!1;let r=ou(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},L_=e=>{let t=e.changeEvent.doc;if(!t)return!1;let r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},F_=e=>{let t=e.changeEvent.doc;if(!t)return!1;let r=ou(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},B_=e=>{let t=e.changeEvent.previous;return t?e.queryParams.queryMatcher(t):!1},j_=e=>{let t=e.changeEvent.doc;return t?e.queryParams.queryMatcher(t):!1},K_=e=>e.previousResults.length===0;var U_={0:k_,1:T_,2:A_,3:Ef,4:O_,5:S_,6:K_,7:I_,8:D_,9:P_,10:C_,11:M_,12:R_,13:N_,14:L_,15:F_,16:B_,17:j_};function z_(e,t,r,n){var i=e.length,a=i-1,l=0;if(i===0)return e.push(t),0;for(var f;n<=a;)l=n+(a-n>>1),f=e[l],r(f,t)<=0?n=l+1:a=l-1;return r(f,t)<=0&&l++,e.splice(l,0,t),l}var W_=e=>{},su=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},au=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},uu=e=>{let t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},lu=e=>{let t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},q_=e=>{uu(e),au(e)},V_=e=>{lu(e),su(e)},H_=e=>{uu(e),su(e)},G_=e=>{lu(e),au(e)},Of=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);let t=e.queryParams.primaryKey,r=e.previousResults;for(let n=0;n<r.length;n++)if(r[n][t]===e.changeEvent.id){r.splice(n,1);break}},Y_=e=>{let t=e.changeEvent.doc,r=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][r]===e.changeEvent.id){n[i]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}},Q_=e=>{let t={_id:"wrongHuman"+new Date().getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},Sf=e=>{let t=e.changeEvent.id,r=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,r)}else if(e.previousResults.find(i=>i[e.queryParams.primaryKey]===t))return;z_(e.previousResults,r,e.queryParams.sortComparator,0)},J_=e=>{Of(e),Sf(e)},X_=e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},Z_=e=>{throw new Error("Action unknownAction should never be called")};var eg=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],tg={doNothing:W_,insertFirst:su,insertLast:au,removeFirstItem:uu,removeLastItem:lu,removeFirstInsertLast:q_,removeLastInsertFirst:V_,removeFirstInsertFirst:H_,removeLastInsertLast:G_,removeExisting:Of,replaceExisting:Y_,alwaysWrong:Q_,insertAtSortPosition:Sf,removeExistingAndInsertAtSortPosition:J_,runFullQueryAgain:X_,unknownAction:Z_};function cu(e){return e.charCodeAt(0)-40}function rg(e){return e?"1":"0"}function P$(e=6){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length;for(let i=0;i<e;i++)t+=r.charAt(Math.floor(Math.random()*n));return t}var HR=P$(4);function Af(e,t){let r=[];for(let n=0,i=e.length;n<i;n+=t)r.push(e.substring(n,n+t));return r}function ng(e){let t=new Map,n=2+parseInt(e.charAt(0)+e.charAt(1),10)*2,i=e.substring(2,n),a=Af(i,2);for(let C=0;C<a.length;C++){let G=a[C],X=G.charAt(0),Q=cu(G.charAt(1));t.set(X,Q)}let l=e.substring(n,e.length-3),f=Af(l,4);for(let C=0;C<f.length;C++){let G=f[C],X=G.charAt(0),Q=G.charAt(1),K=G.charAt(2),ne=cu(G.charAt(3));if(!t.has(Q))throw new Error("missing node with id "+Q);if(!t.has(K))throw new Error("missing node with id "+K);let Z=t.get(Q),fe=t.get(K),le={l:ne,0:Z,1:fe};t.set(X,le)}let m=e.slice(-3),h=m.charAt(0),g=m.charAt(1),v=cu(m.charAt(2)),O=t.get(h),E=t.get(g);return{l:v,0:O,1:E}}function ig(e,t,r){let n=e,i=e.l;for(;;){let a=t[i](r),l=rg(a);if(n=n[l],typeof n=="number"||typeof n=="string")return n;i=n.l}}var R$="14a1b,c+d2e5f0g/h.i4j*k-l)m(n6oeh6pnm6qen6ril6snh6tin6ubo9vce9wmh9xns9yne9zmi9{cm9|ad9}cp9~aq9\x7Fae9\xA1bf9\xA2bq9\xA3cg9\xA4ck9\xA5cn9\xA6nd9\xA7np9\xA8nq9\xA9nf9\xAAng9\xABnm9\xACnk9\xADmr9\xAEms9\xAFmt9\xB0mj9\xB1mk9\xB2ml9\xB3mn9\xB4mc8\xB5\xB3{8\xB6\xAF}8\xB7\xB0\xA48\xB8\xB3\xA78\xB9mn8\xBA\xB3\xAB8\xBB\xB3m8\xBCm\xB44\xBDz\xB24\xBE\xB3w4\xBFz\xB54\xC0\xAF\xB64\xC1\xB0\xB74\xC2\xB3\xBA4\xC3\xB3\xB84\xC4m\xB94\xC5v\xA47\xC6yn7\xC7\xC0\xC17\xC8~\x7F7\xC9\xA5\xA47\xCA\xC3\xC47\xCB\xA8n7\xCC\xBA\xB97\xCD\xAD\xB07\xCE\xAEm7\xCF\xAF\xB07\xD0\xB1m7\xD1\xB3m7\xD2\xBCm5\xD3\xC4m5\xD4\xB9m5\xD5\xBD\xB05\xD6\xBEm5\xD7\xBF\xB05\xD8\xC7\xCF5\xD9\xC2m5\xDA\xCA\xD15\xDB\xB1m5\xDC\xBAm5\xDD\xCC\xD15\xDE\xD5\xCD2\xDF|\x7F2\xE0\xA1u2\xE1\xA3\xC52\xE2\xD6\xCE2\xE3\xA6\xC62\xE4\xA9x2\xE5\xAA\xC62\xE6\xD7\xD82\xE7|\xC82\xE8\xA1\xA22\xE9\xA3\xC92\xEA\xA4\xA52\xEB\xD9\xDA2\xEC\xA6\xCB2\xED\xA9n2\xEE\xAAn2\xEF\xDB\xD02\xF0\xDC\xDD2\xF1\xACn2\xF2\xD2\xD3/\xF3an/\xF4bn/\xF5cn/\xF6\xDE\xE2/\xF7\xDF\xE3/\xF8\xE0\xE4/\xF9\xE1\xE5/\xFA\xE6\xEB/\xFB\xE7\xEC/\xFC\xE8\xED/\xFD\xE9\xEE/\xFE\xCD\xCE/\xFF\xCF\xD1/\u0100\xF2\xD4,\u0101cn,\u0102\xF6\xEF,\u0103\xA4\xF1,\u0104\xFA\xF0,\u0105\xEA\xF1,\u0106\xFE\xD0,\u0107\xFF\xD1,\u0108ac0\u0109bc0\u010A\xF3\xF50\u010B\xF4\u01010\u010C\xDF\xE10\u010D\xE0\xA40\u010E\xE7\xE90\u010F\xE8\xEA0\u0110\xF7\xF90\u0111\xF8\u01030\u0112\xFB\xFD0\u0113\xFC\u01050\u0114m\xD2-\u0115m\u0100-\u0116\xDE\xE6-\u0117\u010C\u010E-\u0118\u010D\u010F-\u0119\u0102\u0104-\u011A\u0110\u0112-\u011B\u0111\u0113-\u011C\xB2\xBB-\u011D\xCD\xCF-\u011E\u0106\u0107-\u011F\xB2\xB3-\u0120\u0114\u01083\u0121\u0115\u010A3\u0122\u0116\u01173\u0123\u0119\u011A3\u0124\u0122\u011D(\u0125\u011C\u011F(\u0126\u0123\u011E(\u0127\u0120\u0121+\u0128\u0109\u010B+\u0129\u0124\u0126+\u012A\u0118\u011B+\u012B\u0127\u01281\u012C\u0129\u012A1\u012D\u012C\u012B*\u012E\u0125m*\u012D\u012E.",kf;function N$(){return kf||(kf=ng(R$)),kf}var og=e=>ig(N$(),U_,e);function sg(e){let t=og(e);return eg[t]}function ag(e,t,r,n,i){let a=tg[e];return a({queryParams:t,changeEvent:r,previousResults:n,keyDocumentMap:i}),n}var qn="\uFFFF",Vn=Number.MIN_SAFE_INTEGER;function ug(e,t){var r=t.selector,n=e.indexes?e.indexes.slice(0):[];t.index&&(n=[t.index]);var i=!!t.sort.find(g=>Object.values(g)[0]==="desc"),a=new Set;Object.keys(r).forEach(g=>{var v=Pr(e,g);v&&v.type==="boolean"&&Object.prototype.hasOwnProperty.call(r[g],"$eq")&&a.add(g)});var l=t.sort.map(g=>Object.keys(g)[0]),f=l.filter(g=>!a.has(g)).join(","),m=-1,h;if(n.forEach(g=>{var v=!0,O=!0,E=g.map(Q=>{var K=r[Q],ne=K?Object.keys(K):[],Z={};if(!K||!ne.length){var fe=O?Vn:qn;Z={startKey:fe,endKey:v?qn:Vn,inclusiveStart:!0,inclusiveEnd:!0}}else ne.forEach(le=>{if(fu.has(le)){var pe=K[le],ze=j$(le,pe);Z=Object.assign(Z,ze)}});return typeof Z.startKey>"u"&&(Z.startKey=Vn),typeof Z.endKey>"u"&&(Z.endKey=qn),typeof Z.inclusiveStart>"u"&&(Z.inclusiveStart=!0),typeof Z.inclusiveEnd>"u"&&(Z.inclusiveEnd=!0),O&&!Z.inclusiveStart&&(O=!1),v&&!Z.inclusiveEnd&&(v=!1),Z}),T=E.map(Q=>Q.startKey),C=E.map(Q=>Q.endKey),G={index:g,startKeys:T,endKeys:C,inclusiveEnd:v,inclusiveStart:O,sortSatisfiedByIndex:!i&&f===g.filter(Q=>!a.has(Q)).join(","),selectorSatisfiedByIndex:B$(g,t.selector,T,C)},X=K$(e,t,G);(X>=m||t.index)&&(m=X,h=G)}),!h)throw te("SNH",{query:t});return h}var fu=new Set(["$eq","$gt","$gte","$lt","$lte"]),L$=new Set(["$eq","$gt","$gte"]),F$=new Set(["$eq","$lt","$lte"]);function B$(e,t,r,n){var i=Object.entries(t),a=i.find(([le,pe])=>{if(!e.includes(le))return!0;var ze=Object.entries(pe).find(([Ot,pn])=>!fu.has(Ot));return ze});if(a||t.$and||t.$or)return!1;var l=[],f=new Set;for(var[m,h]of Object.entries(t)){if(!e.includes(m))return!1;var g=Object.keys(h).filter(le=>L$.has(le));if(g.length>1)return!1;var v=g[0];if(v&&f.add(m),v!=="$eq"){if(l.length>0)return!1;l.push(v)}}var O=[],E=new Set;for(var[T,C]of Object.entries(t)){if(!e.includes(T))return!1;var G=Object.keys(C).filter(le=>F$.has(le));if(G.length>1)return!1;var X=G[0];if(X&&E.add(T),X!=="$eq"){if(O.length>0)return!1;O.push(X)}}var Q=0;for(var K of e){for(var ne of[f,E]){if(!ne.has(K)&&ne.size>0)return!1;ne.delete(K)}var Z=r[Q],fe=n[Q];if(Z!==fe&&f.size>0&&E.size>0)return!1;Q++}return!0}function j$(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}function K$(e,t,r){var n=0,i=g=>{g>0&&(n=n+g)},a=10,l=Ia(r.startKeys,g=>g!==Vn&&g!==qn);i(l*a);var f=Ia(r.startKeys,g=>g!==qn&&g!==Vn);i(f*a);var m=Ia(r.startKeys,(g,v)=>g===r.endKeys[v]);i(m*a*1.5);var h=r.sortSatisfiedByIndex?5:0;return i(h),n}var Ze=class extends Error{},_u=2147483647,gu=-2147483648,Mf=Number.MAX_SAFE_INTEGER,Df=Number.MIN_SAFE_INTEGER,Hn=Symbol("missing"),pg=Object.freeze(new Error("mingo: cycle detected while processing object/array")),U$="[object Object]",z$=/^\[object ([a-zA-Z0-9]+)\]$/,yu=e=>{let t=G$(e),r=0,n=t.length;for(;n;)r=(r<<5)-r^t.charCodeAt(--n);return r>>>0},mg=new Set(["null","undefined","boolean","number","string","date","regexp"]),W$={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},Fe=(e,t)=>{e===Hn&&(e=void 0),t===Hn&&(t=void 0);let[r,n]=[e,t].map(i=>W$[cn(i).toLowerCase()]);return r!==n?r-n:r===1||r===2||r===6?e<t?-1:e>t?1:0:wt(e,t)?0:e<t?-1:e>t?1:0};function U(e,t){if(!e)throw new Ze(t)}var cn=e=>z$.exec(Object.prototype.toString.call(e))[1],Jo=e=>typeof e=="boolean",we=e=>typeof e=="string";var _e=e=>!isNaN(e)&&typeof e=="number";var ue=Array.isArray,ye=e=>{if(!e)return!1;let t=Object.getPrototypeOf(e);return(t===Object.prototype||t===null)&&U$===Object.prototype.toString.call(e)},Xo=e=>e===Object(e),ji=e=>e instanceof Date,Ki=e=>e instanceof RegExp,xu=e=>typeof e=="function",H=e=>e==null,gr=(e,t)=>e.includes(t),vu=(e,t)=>!gr(e,t),yr=(e,t=!0)=>!!e||t&&e==="",vt=e=>H(e)||we(e)&&!e||e instanceof Array&&e.length===0||ye(e)&&Object.keys(e).length===0,lg=e=>e===Hn,Nr=e=>e instanceof Array?e:[e],mt=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),Pf=e=>typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e),q$=[ji,Ki,Pf],If=(e,t)=>{if(H(e))return e;if(t.has(e))throw pg;let r=e.constructor;if(q$.some(n=>n(e)))return new r(e);try{if(t.add(e),ue(e))return e.map(n=>If(n,t));if(ye(e)){let n={};for(let i in e)n[i]=If(e[i],t);return n}}finally{t.delete(e)}return e},wu=e=>If(e,new Set),V$=(e,t)=>ye(e)&&ye(t)||ue(e)&&ue(t);function mu(e,t,r){if(r=r||{flatten:!1},lg(e)||H(e))return t;if(lg(t)||H(t))return e;if(!V$(e,t)){if(r.skipValidation)return t||e;throw Error("mismatched types. must both be array or object")}if(r.skipValidation=!0,ue(e)){let n=e,i=t;if(r.flatten){let a=0,l=0;for(;a<n.length&&l<i.length;)n[a]=mu(n[a++],i[l++],r);for(;l<i.length;)n.push(t[l++])}else Lt(n,i)}else for(let n in t)e[n]=mu(e[n],t[n],r);return e}function cg(e,t=yu){let r=new Map;return e.forEach((n,i)=>{let a=$u(n,t);r.has(a)?r.get(a).some(l=>wt(e[l],n))||r.get(a).push(i):r.set(a,[i])}),r}function Gn(e,t=yu){if(e.some(f=>f.length==0))return[];if(e.length===1)return Array.from(e);let r=dg(e.map((f,m)=>[m,f.length]),f=>f[1]),n=e[r[0][0]],i=cg(n,t),a=new Map,l=new Array;return i.forEach((f,m)=>{let h=f.map(E=>n[E]),g=h.map(E=>0),v=h.map(E=>[r[0][0],0]),O=!1;for(let E=1;E<e.length;E++){let[T,C]=r[E],G=e[T];if(a.has(E)||a.set(E,cg(G)),a.get(E).has(m)){let X=a.get(E).get(m).map(Q=>G[Q]);O=h.map((Q,K)=>X.some((ne,Z)=>{let fe=g[K];return wt(Q,ne)&&(g[K]++,T<v[K][0]&&(v[K]=[T,a.get(E).get(m)[Z]])),fe<g[K]})).some(Boolean)}if(!O)return}O&&Lt(l,g.map((E,T)=>E===e.length-1?[h[T],v[T]]:Hn).filter(E=>E!==Hn))}),l.sort((f,m)=>{let[h,[g,v]]=f,[O,[E,T]]=m,C=Fe(g,E);return C!==0?C:Fe(v,T)}).map(f=>f[0])}function Rf(e,t=0){let r=new Array;function n(i,a){for(let l=0,f=i.length;l<f;l++)ue(i[l])&&(a>0||a<0)?n(i[l],Math.max(-1,a-1)):r.push(i[l])}return n(e,t),r}var H$=e=>{let[t,r]=[Object.getPrototypeOf(e),Object.getOwnPropertyNames(e)],n=t;for(;!r.length&&t!==Object.prototype&&t!==Array.prototype;)n=t,r=Object.getOwnPropertyNames(t),t=Object.getPrototypeOf(t);let i={};return r.forEach(a=>i[a]=e[a]),[i,n]};function wt(e,t){if(e===t||Object.is(e,t))return!0;let r=!!e&&e.constructor||e;if(e===null||t===null||e===void 0||t===void 0||r!==t.constructor||r===Function)return!1;if(r===Array||r===Object){let a=Object.keys(e),l=Object.keys(t);if(a.length!==l.length||new Set([...a,...l]).size!=a.length)return!1;for(let f of a)if(!wt(e[f],t[f]))return!1;return!0}let n=Object.getPrototypeOf(e);return(Pf(e)||n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))&&e.toString()===t.toString()}var pu=(e,t)=>{if(e===null)return"null";if(e===void 0)return"undefined";let r=e.constructor;switch(r){case RegExp:case Number:case Boolean:case Function:case Symbol:return e.toString();case String:return JSON.stringify(e);case Date:return e.toISOString()}if(Pf(e))return r.name+"["+e.toString()+"]";if(t.has(e))throw pg;try{if(t.add(e),ue(e))return"["+e.map(l=>pu(l,t)).join(",")+"]";if(r===Object)return"{"+Object.keys(e).sort().map(l=>l+":"+pu(e[l],t)).join(",")+"}";let n=Object.getPrototypeOf(e);if(n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))return r.name+"("+JSON.stringify(e.toString())+")";let[i,a]=H$(e);return r.name+pu(i,t)}finally{t.delete(e)}},G$=e=>pu(e,new Set);function $u(e,t){return t=t||yu,H(e)?null:t(e).toString()}function dg(e,t,r=Fe){if(vt(e))return e;let n=new Array,i=new Array;for(let a=0;a<e.length;a++){let l=e[a],f=t(l,a);H(f)?i.push(l):n.push([f,l])}return n.sort((a,l)=>r(a[0],l[0])),Lt(i,n.map(a=>a[1]))}function bu(e,t,r=yu){if(e.length<1)return new Map;let n=new Map,i=new Map;for(let a=0;a<e.length;a++){let l=e[a],f=t(l,a),m=$u(f,r);if(m===null)i.has(null)?i.get(null).push(l):i.set(null,[l]);else{let h=n.has(m)?n.get(m).find(g=>wt(g,f)):null;H(h)?(i.set(f,[l]),n.has(m)?n.get(m).push(f):n.set(m,[f])):i.get(h).push(l)}}return i}var Tf=5e4;function Lt(e,...t){return e instanceof Array?t.reduce((r,n)=>{let i=Math.ceil(n.length/Tf),a=0;for(;i-- >0;)Array.prototype.push.apply(r,n.slice(a,a+Tf)),a+=Tf;return r},e):t.filter(Xo).reduce((r,n)=>(Object.assign(r,n),r),e)}function Cf(e,t){return Xo(e)?e[t]:void 0}function Y$(e,t){if(t<1)return e;for(;t--&&e.length===1;)e=e[0];return e}function Lr(e,t,r){let n=0;function i(l,f){let m=l;for(let h=0;h<f.length;h++){let g=f[h];if(/^\d+$/.exec(g)===null&&m instanceof Array){if(h===0&&n>0)break;n+=1;let O=f.slice(h);m=m.reduce((E,T)=>{let C=i(T,O);return C!==void 0&&E.push(C),E},[]);break}else m=Cf(m,g);if(m===void 0)break}return m}let a=mg.has(cn(e).toLowerCase())?e:i(e,t.split("."));return a instanceof Array&&r?.unwrapArray?Y$(a,n):a}function Bi(e,t,r){let n=t.split("."),i=n[0],a=n.slice(1).join("."),l=/^\d+$/.exec(i)!==null,f=n.length>1,m,h;if(e instanceof Array)if(l)m=Cf(e,Number(i)),f&&(m=Bi(m,a,r)),m=[m];else{m=[];for(let g of e)h=Bi(g,t,r),r?.preserveMissing?(h===void 0&&(h=Hn),m.push(h)):h!==void 0&&m.push(h)}else{if(h=Cf(e,i),f&&(h=Bi(h,a,r)),h===void 0)return;m=r?.preserveKeys?{...e}:{},m[i]=h}return m}function du(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===Hn?e.splice(t,1):du(e[t]);else if(ye(e))for(let t in e)mt(e,t)&&du(e[t])}var fg=/^\d+$/;function hu(e,t,r,n){let i=t.split("."),a=i[0],l=i.slice(1).join(".");if(i.length===1)(ye(e)||ue(e)&&fg.test(a))&&r(e,a);else{n?.buildGraph&&H(e[a])&&(e[a]={});let f=e[a];if(!f)return;let m=!!(i.length>1&&fg.test(i[1]));f instanceof Array&&n?.descendArray&&!m?f.forEach(h=>hu(h,l,r,n)):hu(f,l,r,n)}}function Eu(e,t,r){hu(e,t,(n,i)=>{n[i]=xu(r)?r(n[i]):r},{buildGraph:!0})}function Zo(e,t,r){hu(e,t,(n,i)=>{if(n instanceof Array){if(/^\d+$/.test(i))n.splice(parseInt(i),1);else if(r&&r.descendArray)for(let a of n)ye(a)&&delete a[i]}else ye(n)&&delete n[i]},r)}var Q$=/^\$[a-zA-Z0-9_]+$/;function Yt(e){return Q$.test(e)}function Ou(e){if(mg.has(cn(e).toLowerCase()))return Ki(e)?{$regex:e}:{$eq:e};if(Xo(e)){if(!Object.keys(e).some(Yt))return{$eq:e};if(mt(e,"$regex")){let r={...e};return r.$regex=new RegExp(e.$regex,e.$options),delete r.$options,r}}return e}var Qn=(e=>(e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF",e))(Qn||{}),De=class e{constructor(t,r,n,i=Date.now()){this._opts=t,this._root=r,this._local=n,this.timestamp=i,this.update(r,n)}static init(t,r,n){return t instanceof e?new e(t._opts,H(t.root)?r:t.root,Object.assign({},t.local,n)):new e(t,r,n)}update(t,r){return this._root=t,this._local=r&&Object.assign({},r,{variables:Object.assign({},this._local?.variables,r?.variables)}),this}getOptions(){return Object.freeze({...this._opts,context:Ui.from(this._opts.context)})}get root(){return this._root}get local(){return this._local}get idKey(){return this._opts.idKey}get collation(){return this._opts?.collation}get processingMode(){return this._opts?.processingMode||"CLONE_OFF"}get useStrictMode(){return this._opts?.useStrictMode}get scriptEnabled(){return this._opts?.scriptEnabled}get useGlobalContext(){return this._opts?.useGlobalContext}get hashFunction(){return this._opts?.hashFunction}get collectionResolver(){return this._opts?.collectionResolver}get jsonSchemaValidator(){return this._opts?.jsonSchemaValidator}get variables(){return this._opts?.variables}get context(){return this._opts?.context}};function zi(e){return e instanceof De?e.getOptions():Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:"CLONE_OFF",...e,context:e?.context?Ui.from(e?.context):Ui.init({})})}var Jt=(e=>(e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window",e))(Jt||{}),Ui=class e{constructor(t){this.operators={accumulator:{},expression:{},pipeline:{},projection:{},query:{},window:{}};for(let[r,n]of Object.entries(t))this.addOperators(r,n)}static init(t={}){return new e(t)}static from(t){return new e(t.operators)}addOperators(t,r){for(let[n,i]of Object.entries(r))this.getOperator(t,n)||(this.operators[t][n]=i);return this}addAccumulatorOps(t){return this.addOperators("accumulator",t)}addExpressionOps(t){return this.addOperators("expression",t)}addQueryOps(t){return this.addOperators("query",t)}addPipelineOps(t){return this.addOperators("pipeline",t)}addProjectionOps(t){return this.addOperators("projection",t)}addWindowOps(t){return this.addOperators("window",t)}getOperator(t,r){return t in this.operators&&this.operators[t][r]||null}},Yn=Ui.init();function Ff(e,t){for(let[r,n]of Object.entries(t)){U(xu(n)&&Yt(r),`'${r}' is not a valid operator`);let i=Qt(e,r,null);U(!i||n===i,`${r} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case"accumulator":Yn.addAccumulatorOps(t);break;case"expression":Yn.addExpressionOps(t);break;case"pipeline":Yn.addPipelineOps(t);break;case"projection":Yn.addProjectionOps(t);break;case"query":Yn.addQueryOps(t);break;case"window":Yn.addWindowOps(t);break}}function Qt(e,t,r){let{context:n,useGlobalContext:i}=r||{},a=n?n.getOperator(e,t):null;return!a&&i?Yn.getOperator(e,t):a}var hg={$$ROOT(e,t,r){return r.root},$$CURRENT(e,t,r){return e},$$REMOVE(e,t,r){},$$NOW(e,t,r){return new Date(r.timestamp)}},Nf={$$KEEP(e,t,r){return e},$$PRUNE(e,t,r){},$$DESCEND(e,t,r){if(!mt(t,"$cond"))return e;let n;for(let[i,a]of Object.entries(e))if(Xo(a)){if(a instanceof Array){let l=[];for(let f of a)ye(f)&&(f=Lf(f,t,r.update(f))),H(f)||l.push(f);n=l}else n=Lf(a,t,r.update(a));H(n)?delete e[i]:e[i]=n}return e}};function P(e,t,r,n){let i=De.init(n,e);if(r=r||"",Yt(r)){let a=Qt("expression",r,n);if(a)return a(e,t,i);let l=Qt("accumulator",r,n);if(l)return e instanceof Array||(e=P(e,t,null,i),t=null),U(e instanceof Array,`'${r}' target must be an array.`),l(e,t,i.update(null,i.local));throw new Ze(`operator '${r}' is not registered`)}if(we(t)&&t.length>0&&t[0]==="$"){if(mt(Nf,t))return t;let a=i.root,l=t.split(".");if(mt(hg,l[0]))a=hg[l[0]](e,null,i),t=t.slice(l[0].length+1);else if(l[0].slice(0,2)==="$$"){a=Object.assign({},i.variables,{this:e},i.local?.variables);let f=l[0].slice(2);U(mt(a,f),`Use of undefined variable: ${f}`),t=t.slice(2)}else t=t.slice(1);return t===""?a:Lr(a,t)}if(ue(t))return t.map(a=>P(e,a,null,i));if(ye(t)){let a={};for(let[l,f]of Object.entries(t))if(a[l]=P(e,f,l,i),["expression","accumulator"].some(m=>!!Qt(m,l,n)))return U(Object.keys(t).length===1,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),a[l];return a}return t}function Lf(e,t,r){let n=P(e,t,null,r);return mt(Nf,n)?Nf[n](e,t,r):n}function $t(e){return e instanceof es?e:new es(e)}function Su(...e){let t=0;return $t(()=>{for(;t<e.length;){let r=e[t].next();if(!r.done)return r;t++}return{done:!0}})}function J$(e){return!!e&&typeof e=="object"&&e?.next instanceof Function}function X$(e,t){let r=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,r)}var Bf=new Error;function Z$(e,t,r){let n=!1,i=-1,a=0;return function(l){try{e:for(;!n;){let f=e();i++;let m=-1,h=t.length,g=!1;for(;++m<h;){let v=t[m];switch(v.action){case 0:f=v.func(f,i);break;case 1:if(!v.func(f,i))continue e;break;case 2:--v.count,v.count||(g=!0);break;case 3:--v.count,v.count||X$(t,m);continue e;default:break e}}if(n=g,l)r[a++]=f;else return{value:f,done:!1}}}catch(f){if(f!==Bf)throw f}return n=!0,{done:n}}}var es=class{constructor(t){this.iteratees=[],this.yieldedValues=[],this.isDone=!1;let r;if(t instanceof Function&&(t={next:t}),J$(t)){let n=t;r=()=>{let i=n.next();if(i.done)throw Bf;return i.value}}else if(t instanceof Array){let n=t,i=n.length,a=0;r=()=>{if(a<i)return n[a++];throw Bf}}else if(!(t instanceof Function))throw new Ze("Lazy must be initialized with an array, generator, or function.");this.getNext=Z$(r,this.iteratees,this.yieldedValues)}push(t,r){return typeof r=="function"?this.iteratees.push({action:t,func:r}):typeof r=="number"&&this.iteratees.push({action:t,count:r}),this}next(){return this.getNext()}map(t){return this.push(0,t)}filter(t){return this.push(1,t)}take(t){return t>0?this.push(2,t):this}drop(t){return t>0?this.push(3,t):this}transform(t){let r=this,n;return $t(()=>(n||(n=$t(t(r.value()))),n.next()))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(t){for(;;){let r=this.next();if(r.done)break;if(t(r.value)===!1)return!1}return!0}reduce(t,r){let n=this.next();for(r===void 0&&!n.done&&(r=n.value,n=this.next());!n.done;)r=t(r,n.value),n=this.next();return r}size(){return this.reduce((t,r)=>++t,0)}[Symbol.iterator](){return this}};var xr=class{constructor(t,r){this.pipeline=t,this.options=zi(r)}stream(t){let r=$t(t),n=this.options.processingMode;(n==Qn.CLONE_ALL||n==Qn.CLONE_INPUT)&&r.map(wu);let i=new Array;if(!vt(this.pipeline))for(let a of this.pipeline){let l=Object.keys(a),f=l[0],m=Qt(Jt.PIPELINE,f,this.options);U(l.length===1&&!!m,`invalid pipeline operator ${f}`),i.push(f),r=m(r,a[f],this.options)}return(n==Qn.CLONE_OUTPUT||n==Qn.CLONE_ALL&&Gn([["$group","$unwind"],i]).length)&&r.map(wu),r}run(t){return this.stream(t).value()}};var Au=class{constructor(t,r,n,i){this.source=t,this.predicate=r,this.projection=n,this.options=i,this.operators=[],this.result=null,this.buffer=[]}fetch(){return this.result?this.result:(ye(this.projection)&&this.operators.push({$project:this.projection}),this.result=$t(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new xr(this.operators,this.options).stream(this.result)),this.result)}fetchAll(){let t=$t([...this.buffer]);return this.buffer=[],Su(t,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(t){return this.operators.push({$skip:t}),this}limit(t){return this.operators.push({$limit:t}),this}sort(t){return this.operators.push({$sort:t}),this}collation(t){return this.options={...this.options,collation:t},this}next(){if(this.buffer.length>0)return this.buffer.pop();let t=this.fetch().next();if(!t.done)return t.value}hasNext(){if(this.buffer.length>0)return!0;let t=this.fetch().next();return t.done?!1:(this.buffer.push(t.value),!0)}map(t){return this.all().map(t)}forEach(t){this.all().forEach(t)}[Symbol.iterator](){return this.fetchAll()}};var bt=class{constructor(t,r){this.condition=t,this.options=zi(r),this.compiled=[],this.compile()}compile(){U(ye(this.condition),`query criteria must be an object: ${JSON.stringify(this.condition)}`);let t={};for(let[r,n]of Object.entries(this.condition)){if(r==="$where")Object.assign(t,{field:r,expr:n});else if(gr(["$and","$or","$nor","$expr","$jsonSchema"],r))this.processOperator(r,r,n);else{U(!Yt(r),`unknown top level operator: ${r}`);for(let[i,a]of Object.entries(Ou(n)))this.processOperator(r,i,a)}t.field&&this.processOperator(t.field,t.field,t.expr)}}processOperator(t,r,n){let i=Qt(Jt.QUERY,r,this.options);if(!i)throw new Ze(`unknown query operator ${r}`);let a=i(t,n,this.options);this.compiled.push(a)}test(t){for(let r=0,n=this.compiled.length;r<n;r++)if(!this.compiled[r](t))return!1;return!0}find(t,r){return new Au(t,n=>this.test(n),r||{},this.options)}remove(t){return t.reduce((r,n)=>(this.test(n)||r.push(n),r),[])}};var Wi=1e3*60*60*24,gg={week:Wi*7,day:Wi,hour:1e3*60*60,minute:1e3*60,second:1e3,millisecond:1};var tB={week:Wi*7,day:Wi,hour:Wi/24,minute:6e4,second:1e3,millisecond:1};var Tu=(e,t,r)=>{if(vt(t)||!ye(t))return e;let n=Fe,i=r.collation;return ye(i)&&we(i.locale)&&(n=lb(i)),e.transform(a=>{let l=Object.keys(t);for(let f of l.reverse()){let m=bu(a,g=>Lr(g,f),r.hashFunction),h=Array.from(m.keys()).sort(n);t[f]===-1&&h.reverse(),a=[],h.reduce((g,v)=>Lt(g,m.get(v)),a)}return a})},ub={1:"base",2:"accent",3:"variant"};function lb(e){let t={sensitivity:ub[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(t.sensitivity==="base"&&(t.sensitivity="case"),t.sensitivity==="accent"&&(t.sensitivity="variant"));let r=new Intl.Collator(e.locale,t);return(n,i)=>{if(!we(n)||!we(i))return Fe(n,i);let a=r.compare(n,i);return a<0?-1:a>0?1:0}}function Se(e){let t=(r,n,i)=>{let a={unwrapArray:!0},l=Math.max(1,r.split(".").length-1);return f=>{let m=Lr(f,r,a);return e(m,n,{...i,depth:l})}};return t.op="query",t}function dt(e){return(t,r,n)=>{let i=P(t,r,null,n);return e(...i)}}function ts(e,t,r){if(wt(e,t)||H(e)&&H(t))return!0;if(e instanceof Array){let n=wt.bind(null,t);return e.some(n)||Rf(e,r?.depth).some(n)}return!1}function Iu(e,t,r){return!ts(e,t,r)}function Kf(e,t,r){return H(e)?t.some(n=>n===null):Gn([Nr(e),t],r?.hashFunction).length>0}function Cu(e,t,r){return!Kf(e,t,r)}function Mu(e,t,r){return Nu(e,t,(n,i)=>Fe(n,i)<0)}function Du(e,t,r){return Nu(e,t,(n,i)=>Fe(n,i)<=0)}function Pu(e,t,r){return Nu(e,t,(n,i)=>Fe(n,i)>0)}function Ru(e,t,r){return Nu(e,t,(n,i)=>Fe(n,i)>=0)}function bg(e,t,r){return Nr(e).some(n=>t.length===2&&n%t[0]===t[1])}function Eg(e,t,r){let n=Nr(e),i=a=>we(a)&&yr(t.exec(a),r?.useStrictMode);return n.some(i)||Rf(n,1).some(i)}function Og(e,t,r){return(t===!1||t===0)&&e===void 0||(t===!0||t===1)&&e!==void 0}function Sg(e,t,r){if(!ue(e)||!ue(t)||!e.length||!t.length)return!1;let n=!0;for(let i of t){if(!n)break;ye(i)&&gr(Object.keys(i),"$elemMatch")?n=Uf(e,i.$elemMatch,r):i instanceof RegExp?n=e.some(a=>typeof a=="string"&&i.test(a)):n=e.some(a=>wt(i,a))}return n}function Ag(e,t,r){return Array.isArray(e)&&e.length===t}function mb(e){return Yt(e)&&["$and","$or","$nor"].indexOf(e)===-1}function Uf(e,t,r){if(ue(e)&&!vt(e)){let n=l=>l,i=t;Object.keys(t).every(mb)&&(i={temp:t},n=l=>({temp:l}));let a=new bt(i,r);for(let l=0,f=e.length;l<f;l++)if(a.test(n(e[l])))return!0}return!1}var xg=e=>e===null,vg=e=>_e(e)&&e>=gu&&e<=_u&&e.toString().indexOf(".")===-1,wg=e=>_e(e)&&e>=Df&&e<=Mf&&e.toString().indexOf(".")===-1,db={array:ue,bool:Jo,boolean:Jo,date:ji,decimal:_e,double:_e,int:vg,long:wg,number:_e,null:xg,object:ye,regex:Ki,regexp:Ki,string:we,undefined:H,function:e=>{throw new Ze("unsupported type key `function`.")},1:_e,2:we,3:ye,4:ue,6:H,8:Jo,9:ji,10:xg,11:Ki,16:vg,18:wg,19:_e};function $g(e,t,r){let n=db[t];return n?n(e):!1}function kg(e,t,r){return Array.isArray(t)?t.findIndex(n=>$g(e,n,r))>=0:$g(e,t,r)}function Nu(e,t,r){return Nr(e).some(n=>cn(n)===cn(t)&&r(n,t))}var c4=dt(Cu);var qi=(e,t)=>(r,n,i)=>{U(ue(n),`${e}: expression must be an array.`);let a=P(r,n,null,i);return a.some(H)?null:(U(a.every(_e),`${e}: expression must evalue to array of numbers.`),t(a))};var s6=qi("$bitAnd",e=>e.reduce((t,r)=>t&r,-1));var p6=qi("$bitOr",e=>e.reduce((t,r)=>t|r,0));var h6=qi("$bitXor",e=>e.reduce((t,r)=>t^r,0));var F6=dt(ts);var K6=dt(Pu);var W6=dt(Ru);var H6=dt(Mu);var Q6=dt(Du);var Z6=dt(Iu);var Tg=(e,t)=>{let r={};return e.split("").forEach((n,i)=>r[n]=t*(i+1)),r},P5={...Tg("ABCDEFGHIKLM",1),...Tg("NOPQRSTUVWXY",-1),Z:0};var Dg={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function Ie(e,t=Dg){let r=Object.assign({},Dg,t),n=new Set(Object.keys(r));return(i,a,l)=>{let f=P(i,a,null,l);if(n.has(`${f}`)){let m=r[`${f}`];if(m instanceof Error)throw new Ze(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return m}return e(f)}}var FU=Ie(Math.acos,{Infinity:1/0,0:new Error});var KU=Ie(Math.acosh,{Infinity:1/0,0:new Error});var WU=Ie(Math.asin);var HU=Ie(Math.asinh,{Infinity:1/0,"-Infinity":-1/0});var QU=Ie(Math.atan);var rz=Ie(Math.atanh,{1:1/0,"-1":-1/0});var oz=Ie(Math.cos);var uz=Ie(Math.cosh,{"-Infinity":1/0,Infinity:1/0});var yb=Math.PI/180,fz=Ie(e=>e*yb,{Infinity:1/0,"-Infinity":1/0});var xb=180/Math.PI,dz=Ie(e=>e*xb,{Infinity:1/0,"-Infinity":-1/0});var gz=Ie(Math.sin);var vz=Ie(Math.sinh,{"-Infinity":-1/0,Infinity:1/0});var bz=Ie(Math.tan);var Wf=(e,t,r)=>{if(vt(t))return e;let n=Object.keys(t),i=!1;Rg(t,r);let a=r.idKey;if(gr(n,a)){let f=t[a];(f===0||f===!1)&&(n=n.filter(vu.bind(null,[a])),i=n.length==0)}else n.push(a);let l=De.init(r);return e.map(f=>zf(f,t,l.update(f),n,i))};function zf(e,t,r,n,i){let a={},l=!1,f=!1,m=[];i&&m.push(r.idKey);for(let h of n){let g,v=t[h];if(h!==r.idKey&&gr([0,!1],v)&&(f=!0),h===r.idKey&&vt(v))g=e[h];else if(we(v))g=P(e,v,h,r);else if(!gr([1,!0],v))if(v instanceof Array)g=v.map(E=>{let T=P(e,E,null,r);return H(T)?null:T});else if(ye(v)){let E=v,T=Object.keys(v),C=T.length==1?T[0]:"",G=Qt(Jt.PROJECTION,C,r);if(G)C==="$slice"?Nr(E[C]).every(_e)?(g=G(e,E[C],h,r),l=!0):g=P(e,E,h,r):g=G(e,E[C],h,r);else if(Yt(C))g=P(e,E[C],C,r);else if(mt(e,h)){Rg(E,r);let X=e[h];X instanceof Array?g=X.map(Q=>zf(Q,E,r,T,!1)):(X=ye(X)?X:e,g=zf(X,E,r,T,!1))}else g=P(e,v,null,r)}else{m.push(h);continue}let O=Bi(e,h,{preserveMissing:!0});O!==void 0&&mu(a,O,{flatten:!0}),vu([0,1,!1,!0],v)&&(g===void 0?Zo(a,h,{descendArray:!0}):Eu(a,h,g))}if(du(a),(l||f||i)&&(a=Lt({},e,a),m.length>0))for(let h of m)Zo(a,h,{descendArray:!0});return a}function Rg(e,t){let r=[!1,!1];for(let[n,i]of Object.entries(e)){if(n===t?.idKey)return;i===0||i===!1?r[0]=!0:(i===1||i===!0)&&(r[1]=!0),U(!(r[0]&&r[1]),"Projection cannot have a mix of inclusion and exclusion.")}}var Ng=(e,t,r)=>{U(ue(t),"Invalid expression: $and expects value to be an Array.");let n=t.map(i=>new bt(i,r));return i=>n.every(a=>a.test(i))};var Lu=(e,t,r)=>{U(ue(t),"Invalid expression. $or expects value to be an Array");let n=t.map(i=>new bt(i,r));return i=>n.some(a=>a.test(i))};var Lg=(e,t,r)=>{U(ue(t),"Invalid expression. $nor expects value to be an array.");let n=Lu("$or",t,r);return i=>!n(i)};var Fg=(e,t,r)=>{let n={};n[e]=Ou(t);let i=new bt(n,r);return a=>!i.test(a)};var qf=Se(ts);var Vf=Se(Pu);var Hf=Se(Ru);var Gf=Se(Kf);var Yf=Se(Mu);var Qf=Se(Du);var Jf=Se(Iu);var Xf=Se(Cu);var Bg=Se(bg);var jg=Se(Eg);var S7=Se(Sg);var Kg=Se(Uf);var Ug=Se(Ag);var zg=Se(Og);var Wg=Se(kg);var qg=!1;function Vg(e){return qg||(Ff(Jt.PIPELINE,{$sort:Tu,$project:Wf}),Ff(Jt.QUERY,{$and:Ng,$eq:qf,$elemMatch:Kg,$exists:zg,$gt:Vf,$gte:Hf,$in:Gf,$lt:Yf,$lte:Qf,$ne:Jf,$nin:Xf,$mod:Bg,$nor:Lg,$not:Fg,$or:Lu,$regex:jg,$size:Ug,$type:Wg}),qg=!0),new bt(e)}function rs(e,t){var r=Mt(e.primaryKey);t=ke(t);var n=hr(t);if(typeof n.skip!="number"&&(n.skip=0),n.selector?(n.selector=n.selector,Object.entries(n.selector).forEach(([h,g])=>{(typeof g!="object"||g===null)&&(n.selector[h]={$eq:g})})):n.selector={},n.index){var i=zo(n.index);i.includes(r)||i.push(r),n.index=i}if(n.sort){var m=n.sort.find(h=>Oh(h)===r);m||(n.sort=n.sort.slice(0),n.sort.push({[r]:"asc"}))}else if(n.index)n.sort=n.index.map(h=>({[h]:"asc"}));else{if(e.indexes){var a=new Set;Object.entries(n.selector).forEach(([h,g])=>{var v=!1;typeof g=="object"&&g!==null?v=!!Object.keys(g).find(O=>fu.has(O)):v=!0,v&&a.add(h)});var l=-1,f;e.indexes.forEach(h=>{var g=Ei(h)?h:[h],v=g.findIndex(O=>!a.has(O));v>0&&v>l&&(l=v,f=g)}),f&&(n.sort=f.map(h=>({[h]:"asc"})))}n.sort||(n.sort=[{[r]:"asc"}])}return n}function Fu(e,t){if(!t.sort)throw te("SNH",{query:t});var r=[];t.sort.forEach(i=>{var a=Object.keys(i)[0],l=Object.values(i)[0];r.push({key:a,direction:l,getValueFn:Eh(a)})});var n=(i,a)=>{for(var l=0;l<r.length;++l){var f=r[l],m=f.getValueFn(i),h=f.getValueFn(a);if(m!==h){var g=f.direction==="asc"?Fe(m,h):Fe(h,m);return g}}};return n}function Vi(e,t){if(!t.sort)throw te("SNH",{query:t});var r=Vg(t.selector),n=i=>r.test(i);return n}async function Hi(e,t){var r=await e.exec();if(!r)return null;if(Array.isArray(r))return Promise.all(r.map(i=>t(i)));var n=await t(r);return n}function $b(e,t){return!t.sort||t.sort.length===0?[e]:t.sort.map(r=>Object.keys(r)[0])}var bb=new WeakMap;function Eb(e){return xt(bb,e,()=>{var t=e.collection,r=rs(t.storageInstance.schema,hr(e.mangoQuery)),n=t.schema.primaryPath,i=Fu(t.schema.jsonSchema,r),a=(h,g)=>{var v={docA:h,docB:g,rxQuery:e};return i(v.docA,v.docB)},l=Vi(t.schema.jsonSchema,r),f=h=>{var g={doc:h,rxQuery:e};return l(g.doc)},m={primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:$b(n,r),sortComparator:a,queryMatcher:f};return m})}function Hg(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=Eb(e),n=be(e._result).docsData.slice(0),i=be(e._result).docsDataMap,a=!1,l=t.map(m=>E_(m)).filter($h),f=l.find(m=>{var h={queryParams:r,changeEvent:m,previousResults:n,keyDocumentMap:i},g=sg(h);if(g==="runFullQueryAgain")return!0;if(g!=="doNothing")return a=!0,ag(g,r,m,n,i),!1});return f?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:a,newResults:n}}var Ob=function(){function e(){this._map=new Map}var t=e.prototype;return t.getByQuery=function(n){var i=n.toString();return xt(this._map,i,()=>n)},e}();function Yg(){return new Ob}function Gg(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function Sb(e){return e.refCount$.observers.length}var Ab=100,kb=30*1e3,Tb=(e,t)=>(r,n)=>{if(!(n._map.size<e)){var i=Ke()-t,a=[],l=Array.from(n._map.values());for(var f of l)if(!(Sb(f)>0)){if(f._lastEnsureEqual===0&&f._creationTime<i){Gg(n,f);continue}a.push(f)}var m=a.length-e;if(!(m<=0)){var h=a.sort((v,O)=>v._lastEnsureEqual-O._lastEnsureEqual),g=h.slice(0,m);g.forEach(v=>Gg(n,v))}}},ep=Tb(Ab,kb),Zf=new WeakSet;function Qg(e){Zf.has(e)||(Zf.add(e),Ih().then(()=>Dh(200)).then(()=>{e.destroyed||e.cacheReplacementPolicy(e,e._queryCache),Zf.delete(e)}))}var Xg=function(){function e(r,n,i){this.cacheItemByDocId=new Map,this.tasks=new Set,this.registry=typeof FinalizationRegistry=="function"?new FinalizationRegistry(a=>{var l=a.docId,f=this.cacheItemByDocId.get(l);f&&(f[0].delete(a.revisionHeight),f[0].size===0&&this.cacheItemByDocId.delete(l))}):void 0,this.primaryPath=r,this.changes$=n,this.documentCreator=i,n.subscribe(a=>{this.tasks.add(()=>{for(var l=this.cacheItemByDocId,f=0;f<a.length;f++){var m=a[f],h=l.get(m.documentId);if(h){var g=m.documentData;g||(g=m.previousDocumentData),h[1]=g}}}),this.tasks.size<=1&&Ti().then(()=>{this.processTasks()})})}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var n=Array.from(this.tasks);n.forEach(i=>i()),this.tasks.clear()}},t.getLatestDocumentData=function(n){this.processTasks();var i=sn(this.cacheItemByDocId,n);return i[1]},t.getLatestDocumentDataIfExists=function(n){this.processTasks();var i=this.cacheItemByDocId.get(n);if(i)return i[1]},at(e,[{key:"getCachedRxDocuments",get:function(){var r=Jg(this);return yt(this,"getCachedRxDocuments",r)}},{key:"getCachedRxDocument",get:function(){var r=Jg(this);return yt(this,"getCachedRxDocument",n=>r([n])[0])}}])}();function Jg(e){var t=e.primaryPath,r=e.cacheItemByDocId,n=e.registry,i=Te.deepFreezeWhenDevMode,a=e.documentCreator,l=f=>{for(var m=new Array(f.length),h=[],g=0;g<f.length;g++){var v=f[g],O=v[t],E=Fn(v._rev),T=void 0,C=void 0,G=r.get(O);G?(T=G[0],C=T.get(E)):(T=new Map,G=[T,v],r.set(O,G));var X=C?C.deref():void 0;X||(v=i(v),X=a(v),T.set(E,Cb(X)),n&&h.push(X)),m[g]=X}return h.length>0&&n&&(e.tasks.add(()=>{for(var Q=0;Q<h.length;Q++){var K=h[Q];n.register(K,{docId:K.primary,revisionHeight:Fn(K.revision)})}}),e.tasks.size<=1&&Ti().then(()=>{e.processTasks()})),m};return l}function Bu(e,t){var r=e.getCachedRxDocuments;return r(t)}var Ib=typeof WeakRef=="function",Cb=Ib?Mb:Db;function Mb(e){return new WeakRef(e)}function Db(e){return{deref(){return e}}}var tp=function(){function e(r,n,i){this.time=Ke(),this.query=r,this.count=i,this.documents=Bu(this.query.collection._docCache,n)}var t=e.prototype;return t.getValue=function(n){var i=this.query.op;if(i==="count")return this.count;if(i==="findOne"){var a=this.documents.length===0?null:this.documents[0];if(!a&&n)throw te("QU10",{collection:this.query.collection.name,query:this.query.mangoQuery,op:i});return a}else return i==="findByIds"?this.docsMap:this.documents.slice(0)},at(e,[{key:"docsData",get:function(){return yt(this,"docsData",this.documents.map(r=>r._data))}},{key:"docsDataMap",get:function(){var r=new Map;return this.documents.forEach(n=>{r.set(n.primary,n._data)}),yt(this,"docsDataMap",r)}},{key:"docsMap",get:function(){for(var r=new Map,n=this.documents,i=0;i<n.length;i++){var a=n[i];r.set(a.primary,a)}return yt(this,"docsMap",r)}}])}();var Pb=0,Rb=function(){return++Pb},Nb=function(){function e(r,n,i,a={}){this.id=Rb(),this._execOverDatabaseCount=0,this._creationTime=Ke(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new vf(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=_r,this.op=r,this.mangoQuery=n,this.collection=i,this.other=a,n||(this.mangoQuery=ns()),this.isFindOneByIdQuery=jb(this.collection.schema.primaryPath,n)}var t=e.prototype;return t._setResultData=function(n){if(typeof n>"u")throw te("QU18",{database:this.collection.database.name,collection:this.collection.name});if(typeof n=="number"){this._result=new tp(this,[],n);return}else n instanceof Map&&(n=Array.from(n.values()));var i=new tp(this,n,n.length);this._result=i},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=Ke(),this.op==="count"){var n=this.getPreparedQuery(),i=await this.collection.storageInstance.count(n);if(i.mode==="slow"&&!this.collection.database.allowSlowCount)throw te("QU14",{collection:this.collection,queryObj:this.mangoQuery});return i.count}if(this.op==="findByIds"){var a=be(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,l=new Map,f=[];if(a.forEach(g=>{var v=this.collection._docCache.getLatestDocumentDataIfExists(g);if(v){if(!v._deleted){var O=this.collection._docCache.getCachedRxDocument(v);l.set(g,O)}}else f.push(g)}),f.length>0){var m=await this.collection.storageInstance.findDocumentsById(f,!1);m.forEach(g=>{var v=this.collection._docCache.getCachedRxDocument(g);l.set(v.primary,v)})}return l}var h=Bb(this);return h.then(g=>(this._lastExecEnd=Ke(),g))},t.exec=async function(n){if(n&&this.op!=="findOne")throw te("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});await Zg(this);var i=be(this._result);return i.getValue(n)},t.toString=function(){var n=Si({op:this.op,query:this.mangoQuery,other:this.other},!0),i=JSON.stringify(n);return this.toString=()=>i,i},t.getPreparedQuery=function(){var n={rxQuery:this,mangoQuery:rs(this.collection.schema.jsonSchema,this.mangoQuery)};n.mangoQuery.selector._deleted={$eq:!1},n.mangoQuery.index&&n.mangoQuery.index.unshift("_deleted"),qe("prePrepareQuery",n);var i=rp(this.collection.schema.jsonSchema,n.mangoQuery);return this.getPreparedQuery=()=>i,i},t.doesDocumentDataMatch=function(n){return n._deleted?!1:this.queryMatcher(n)},t.remove=function(){return this.exec().then(n=>Array.isArray(n)?Promise.all(n.map(i=>i.remove())):n.remove())},t.incrementalRemove=function(){return Hi(this.asRxQuery,n=>n.incrementalRemove())},t.update=function(n){throw $e("update")},t.patch=function(n){return Hi(this.asRxQuery,i=>i.patch(n))},t.incrementalPatch=function(n){return Hi(this.asRxQuery,i=>i.incrementalPatch(n))},t.modify=function(n){return Hi(this.asRxQuery,i=>i.modify(n))},t.incrementalModify=function(n){return Hi(this.asRxQuery,i=>i.incrementalModify(n))},t.where=function(n){throw $e("query-builder")},t.sort=function(n){throw $e("query-builder")},t.skip=function(n){throw $e("query-builder")},t.limit=function(n){throw $e("query-builder")},at(e,[{key:"$",get:function(){if(!this._$){var r=this.collection.$.pipe(Ue(n=>!n.isLocal),Qo(null),Gt(()=>Zg(this)),lt(()=>this._result),Yo(Pa),Fi((n,i)=>!!(n&&n.time===be(i).time)),Ue(n=>!!n),lt(n=>be(n).getValue()));this._$=$f(r,this.refCount$.pipe(Ue(()=>!1)))}return this._$}},{key:"$$",get:function(){var r=this.collection.database.getReactivityFactory();return r.fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){var r=this.collection.schema.jsonSchema,n=rs(this.collection.schema.jsonSchema,this.mangoQuery);return yt(this,"queryMatcher",Vi(r,n))}},{key:"asRxQuery",get:function(){return this}}])}();function ns(){return{selector:{}}}function Lb(e){return e.collection._queryCache.getByQuery(e)}function Gi(e,t,r,n){qe("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:n});var i=new Nb(e,t,r,n);return i=Lb(i),Qg(r),i}function ey(e){var t=e.asRxQuery.collection._changeEventBuffer.getCounter();return e._latestChangeEvent>=t}async function Zg(e){return e.collection.awaitBeforeReads.size>0&&await Promise.all(Array.from(e.collection.awaitBeforeReads).map(t=>t())),e.collection.database.destroyed||ey(e)?!1:(e._ensureEqualQueue=e._ensureEqualQueue.then(()=>Fb(e)),e._ensureEqualQueue)}function Fb(e){if(e._lastEnsureEqual=Ke(),e.collection.database.destroyed||ey(e))return _r;var t=!1,r=!1;if(e._latestChangeEvent===-1&&(r=!0),!r){var n=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(n===null)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.getCounter();var i=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(n);if(e.op==="count"){var a=be(e._result).count,l=a;i.forEach(m=>{var h=m.previousDocumentData&&e.doesDocumentDataMatch(m.previousDocumentData),g=e.doesDocumentDataMatch(m.documentData);!h&&g&&l++,h&&!g&&l--}),l!==a&&(t=!0,e._setResultData(l))}else{var f=Hg(e,i);f.runFullQueryAgain?r=!0:f.changed&&(t=!0,e._setResultData(f.newResults))}}}return r?e._execOverDatabase().then(m=>(e._latestChangeEvent=e.collection._changeEventBuffer.getCounter(),typeof m=="number"?((!e._result||m!==e._result.count)&&(t=!0,e._setResultData(m)),t):((!e._result||!Ah(e.collection.schema.primaryPath,m,e._result.docsData))&&(t=!0,e._setResultData(m)),t))):Promise.resolve(t)}function rp(e,t){if(!t.sort)throw te("SNH",{query:t});var r=ug(e,t);return{query:t,queryPlan:r}}async function Bb(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var n=e.isFindOneByIdQuery;if(n=n.filter(g=>{var v=e.collection._docCache.getLatestDocumentDataIfExists(g);return v?(v._deleted||t.push(v),!1):!0}),n.length>0){var i=await r.storageInstance.findDocumentsById(n,!1);Cr(t,i)}}else{var a=e.isFindOneByIdQuery,l=e.collection._docCache.getLatestDocumentDataIfExists(a);if(!l){var f=await r.storageInstance.findDocumentsById([a],!1);f[0]&&(l=f[0])}l&&!l._deleted&&t.push(l)}else{var m=e.getPreparedQuery(),h=await r.storageInstance.query(m);t=h.documents}return t}function jb(e,t){if(!t.skip&&t.selector&&Object.keys(t.selector).length===1&&t.selector[e]){var r=t.selector[e];if(typeof r=="string")return r;if(Object.keys(r).length===1&&typeof r.$eq=="string"||Object.keys(r).length===1&&Array.isArray(r.$eq)&&!r.$eq.find(n=>typeof n!="string"))return r.$eq}return!1}var ty="_rxdb_internal";async function ip(e,t){var r=await e.findDocumentsById([t],!1),n=r[0];if(n)return n}function Yi(e,t,r,n){if(n)throw n.status===409?te("CONFLICT",{collection:e.name,id:t,writeError:n,data:r}):n.status===422?te("VD2",{collection:e.name,id:t,writeError:n,data:r}):n}function ry(e,t,r,n,i,a,l){for(var f=!!e.schema.attachments,m=[],h=[],g=[],v=jn(10),O={id:v,events:[],checkpoint:null,context:i,startTime:Ke(),endTime:0},E=O.events,T=[],C=[],G=[],X=r.size>0,Q,K=n.length,ne=function(){var fe=n[Z],le=fe.document,pe=fe.previous,ze=le[t],Ot=le._deleted,pn=pe&&pe._deleted,Zt=void 0;X&&(Zt=r.get(ze));var nt;if(Zt){var fl=Zt._rev;if(!pe||pe&&fl!==pe._rev){var mn={isError:!0,status:409,documentId:ze,writeRow:fe,documentInDb:Zt};return g.push(mn),1}var St=f?np(fe):fe;f&&(Ot?pe&&Object.keys(pe._attachments).forEach(it=>{C.push({documentId:ze,attachmentId:it,digest:be(pe)._attachments[it].digest})}):(Object.entries(le._attachments).find(([it,Be])=>{var jt=pe?pe._attachments[it]:void 0;return!jt&&!Be.data&&(nt={documentId:ze,documentInDb:Zt,isError:!0,status:510,writeRow:fe,attachmentId:it}),!0}),nt||Object.entries(le._attachments).forEach(([it,Be])=>{var jt=pe?pe._attachments[it]:void 0;if(!jt)T.push({documentId:ze,attachmentId:it,attachmentData:Be,digest:Be.digest});else{var Kt=St.document._attachments[it].digest;Be.data&&jt.digest!==Kt&&G.push({documentId:ze,attachmentId:it,attachmentData:Be,digest:Be.digest})}}))),nt?g.push(nt):(f?(h.push(np(St)),l&&l(le)):(h.push(St),l&&l(le)),Q=St);var jr=null,eo=null,Kr=null;if(pn&&!Ot)Kr="INSERT",jr=f?vr(le):le;else if(pe&&!pn&&!Ot)Kr="UPDATE",jr=f?vr(le):le,eo=pe;else if(Ot)Kr="DELETE",jr=be(le),eo=pe;else throw te("SNH",{args:{writeRow:fe}});var to={documentId:ze,documentData:jr,previousDocumentData:eo,operation:Kr};E.push(to)}else{var Zi=!!Ot;if(f&&Object.entries(le._attachments).forEach(([it,Be])=>{Be.data?T.push({documentId:ze,attachmentId:it,attachmentData:Be,digest:Be.digest}):(nt={documentId:ze,isError:!0,status:510,writeRow:fe,attachmentId:it},g.push(nt))}),nt||(f?(m.push(np(fe)),a&&a(le)):(m.push(fe),a&&a(le)),Q=fe),!Zi){var _s={documentId:ze,operation:"INSERT",documentData:f?vr(le):le,previousDocumentData:f&&pe?vr(pe):pe};E.push(_s)}}},Z=0;Z<K;Z++)ne();return{bulkInsertDocs:m,bulkUpdateDocs:h,newestRow:Q,errors:g,eventBulk:O,attachmentsAdd:T,attachmentsRemove:C,attachmentsUpdate:G}}function np(e){return{previous:e.previous,document:vr(e.document)}}function Kb(e){return atob(e).length}function Ub(e){var t=e.data;if(!t)return e;var r={length:Kb(t),digest:e.digest,type:e.type};return r}function vr(e){if(!e._attachments||Object.keys(e._attachments).length===0)return e;var t=ke(e);return t._attachments={},Object.entries(e._attachments).forEach(([r,n])=>{t._attachments[r]=Ub(n)}),t}function Jn(e){return Object.assign({},e,{_meta:ke(e._meta)})}var ny=new WeakMap;function ju(e,t,r){Te.deepFreezeWhenDevMode(r);var n=Mt(t.schema.primaryKey),i={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(a,l){for(var f=e.token,m=new Array(a.length),h=Ke(),g=0;g<a.length;g++){var v=a[g],O=Jn(v.document);O._meta.lwt=h;var E=v.previous;O._rev=Oi(f,E),m[g]={document:O,previous:E}}return qe("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:m}),e.lockedRun(()=>t.bulkWrite(m,l)).then(T=>{var C={error:[]},G=Ft(n,m,T);ny.set(C,G);var X=T.error.length===0?[]:T.error.filter(K=>K.status===409&&!K.writeRow.previous&&!K.writeRow.document._deleted&&be(K.documentInDb)._deleted?!0:(C.error.push(K),!1));if(X.length>0){var Q=X.map(K=>({previous:K.documentInDb,document:Object.assign({},K.writeRow.document,{_rev:Oi(e.token,K.documentInDb)})}));return e.lockedRun(()=>t.bulkWrite(Q,l)).then(K=>{Cr(C.error,K.error);var ne=Ft(n,Q,K);return Cr(G,ne),C})}return C})},query(a){return e.lockedRun(()=>t.query(a))},count(a){return e.lockedRun(()=>t.count(a))},findDocumentsById(a,l){return e.lockedRun(()=>t.findDocumentsById(a,l))},getAttachmentData(a,l,f){return e.lockedRun(()=>t.getAttachmentData(a,l,f))},getChangedDocumentsSince:t.getChangedDocumentsSince?(a,l)=>e.lockedRun(()=>t.getChangedDocumentsSince(be(a),l)):void 0,cleanup(a){return e.lockedRun(()=>t.cleanup(a))},remove(){return e.storageInstances.delete(i),e.lockedRun(()=>t.remove())},close(){return e.storageInstances.delete(i),e.lockedRun(()=>t.close())},changeStream(){return t.changeStream()},conflictResultionTasks(){return t.conflictResultionTasks()},resolveConflictResultionTask(a){if(a.output.isEqual)return t.resolveConflictResultionTask(a);var l=Object.assign({},a.output.documentData,{_meta:nn(),_rev:Mr(),_attachments:{}}),f=ke(l);return delete f._meta,delete f._rev,delete f._attachments,t.resolveConflictResultionTask({id:a.id,output:{isEqual:!1,documentData:f}})}};return e.storageInstances.add(i),i}function iy(e){if(e.schema.keyCompression)throw te("UT5",{args:{params:e}});if(zb(e.schema))throw te("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw te("UT7",{args:{params:e}})}function zb(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}function Ft(e,t,r){var n=ny.get(r);if(n)return n;var i=[];if(r.error.length>0){for(var a=new Set,l=0;l<r.error.length;l++){var f=r.error[l];a.add(f.documentId)}for(var m=0;m<t.length;m++){var h=t[m].document;a.has(h[e])||i.push(vr(h))}}else{i.length=t.length-r.error.length;for(var g=0;g<t.length;g++){var v=t[g].document;i[g]=vr(v)}}return i}var oy=function(){function e(r,n,i,a){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=r,this.primaryPath=n,this.preWrite=i,this.postWrite=a}var t=e.prototype;return t.addWrite=function(n,i){var a=n[this.primaryPath],l=xt(this.queueByDocId,a,()=>[]),f=new Promise((m,h)=>{var g={lastKnownDocumentState:n,modifier:i,resolve:m,reject:h};be(l).push(g),this.triggerRun()});return f},t.triggerRun=async function(){if(!(this.isRunning===!0||this.queueByDocId.size===0)){this.isRunning=!0;var n=[],i=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(i.entries()).map(async([l,f])=>{var m=Wb(f.map(v=>v.lastKnownDocumentState)),h=m;for(var g of f)try{h=await g.modifier(hr(h))}catch(v){g.reject(v),g.reject=()=>{},g.resolve=()=>{}}try{await this.preWrite(h,m)}catch(v){f.forEach(O=>O.reject(v));return}n.push({previous:m,document:h})}));var a=n.length>0?await this.storageInstance.bulkWrite(n,"incremental-write"):{error:[]};return await Promise.all(Ft(this.primaryPath,n,a).map(l=>{var f=l[this.primaryPath];this.postWrite(l);var m=sn(i,f);m.forEach(h=>h.resolve(l))})),a.error.forEach(l=>{var f=l.documentId,m=sn(i,f),h=Fa(l);if(h){var g=xt(this.queueByDocId,f,()=>[]);m.reverse().forEach(O=>{O.lastKnownDocumentState=be(h.documentInDb),be(g).unshift(O)})}else{var v=Wh(l);m.forEach(O=>O.reject(v))}}),this.isRunning=!1,this.triggerRun()}},e}();function op(e){var t=async r=>{var n=Sh(r);n._deleted=r._deleted;var i=await e(n),a=Object.assign({},i,{_meta:r._meta,_attachments:r._attachments,_rev:r._rev,_deleted:typeof i._deleted<"u"?i._deleted:r._deleted});return typeof a._deleted>"u"&&(a._deleted=!1),a};return t}function Wb(e){var t=e[0],r=Fn(t._rev);return e.forEach(n=>{var i=Fn(n._rev);i>r&&(t=n,r=i)}),t}var sp={get primaryPath(){var e=this;if(e.isInstanceOfRxDocument)return e.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){var e=this;if(e.isInstanceOfRxDocument)return e._data._rev},get deleted$(){var e=this;if(e.isInstanceOfRxDocument)return e.$.pipe(lt(t=>t._data._deleted))},get deleted$$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){var e=this;if(e.isInstanceOfRxDocument)return e._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){var e=this;return e.collection.$.pipe(Ue(t=>!t.isLocal),Ue(t=>t.documentId===this.primary),lt(t=>b_(t)),Qo(e.collection._docCache.getLatestDocumentData(this.primary)),Fi((t,r)=>t._rev===r._rev),lt(t=>this.collection._docCache.getCachedRxDocument(t)),Yo(Pa))},get $$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(Te.isDevMode()){if(e.includes(".item."))throw te("DOC1",{path:e});if(e===this.primaryPath)throw te("DOC2");if(this.collection.schema.finalFields.includes(e))throw te("DOC3",{path:e});var t=Pr(this.collection.schema.jsonSchema,e);if(!t)throw te("DOC4",{path:e})}return this.$.pipe(lt(r=>Dr(r,e)),Fi())},get$$(e){var t=this.get$(e),r=this.collection.database.getReactivityFactory();return r.fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=Pr(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return Mh;if(!t)throw te("DOC5",{path:e});if(!t.ref)throw te("DOC6",{path:e,schemaObj:t});var n=this.collection.database.collections[t.ref];if(!n)throw te("DOC7",{ref:t.ref,path:e,schemaObj:t});return t.type==="array"?n.findByIds(r).exec().then(i=>{var a=i.values();return Array.from(a)}):n.findOne(r).exec()},get(e){return uy(this,e)},toJSON(e=!1){if(e)return Te.deepFreezeWhenDevMode(this._data);var t=ke(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,Te.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return hr(this.toJSON(e))},update(e){throw $e("update")},incrementalUpdate(e){throw $e("update")},updateCRDT(e){throw $e("crdt")},putAttachment(){throw $e("attachments")},getAttachment(){throw $e("attachments")},allAttachments(){throw $e("attachments")},get allAttachments$(){throw $e("attachments")},async modify(e,t){var r=this._data,n=await op(e)(r);return this._saveData(n,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,op(e)).then(r=>this.collection._docCache.getCachedRxDocument(r))},patch(e){var t=this._data,r=hr(t);return Object.entries(e).forEach(([n,i])=>{r[n]=i}),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify(t=>(Object.entries(e).forEach(([r,n])=>{t[r]=n}),t))},async _saveData(e,t){if(e=ke(e),this._data._deleted)throw te("DOC11",{id:this.primary,document:this});await ap(this.collection,e,t);var r=[{previous:t,document:e}],n=await this.collection.storageInstance.bulkWrite(r,"rx-document-save-data"),i=n.error[0];return Yi(this.collection,this.primary,e,i),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(Ft(this.collection.schema.primaryPath,r,n)[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject(te("DOC13",{document:this,id:this.primary}));var t=ke(this._data),r;return e._runHooks("pre","remove",t,this).then(async()=>{t._deleted=!0;var n=[{previous:this._data,document:t}],i=await e.storageInstance.bulkWrite(n,"rx-document-remove"),a=i.error[0];return Yi(e,this.primary,t,a),Ft(this.collection.schema.primaryPath,n,i)[0]}).then(n=>(r=n,this.collection._runHooks("post","remove",t,this))).then(()=>this.collection._docCache.getCachedRxDocument(r))},incrementalRemove(){return this.incrementalModify(async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e)).then(async e=>(await this.collection._runHooks("post","remove",e._data,e),e))},destroy(){throw te("DOC14")}};function sy(e=sp){var t=function(n,i){this.collection=n,this._data=i,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function ay(e,t,r){var n=new e(t,r);return qe("createRxDocument",n),n}function ap(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),Te.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}function uy(e,t){return xt(e._propertyCache,t,()=>{var r=Dr(e._data,t);if(typeof r!="object"||r===null||Array.isArray(r))return Te.deepFreezeWhenDevMode(r);var n=new Proxy(ke(r),{get(i,a){if(typeof a!="string")return i[a];var l=a.charAt(a.length-1);if(l==="$")if(a.endsWith("$$")){var f=a.slice(0,-2);return e.get$$(Kn(t+"."+f))}else{var m=a.slice(0,-1);return e.get$(Kn(t+"."+m))}else if(l==="_"){var h=a.slice(0,-1);return e.populate(Kn(t+"."+h))}else{var g=i[a];return typeof g=="number"||typeof g=="string"||typeof g=="boolean"?g:uy(e,Kn(t+"."+a))}}});return n})}var Qi="collection",up="storage-token",qb="rx-migration-status",Vb="RxInternalDocument",Ku=Ba({version:0,title:Vb,primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[Qi,up,qb,"OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function Uu(e,t){return Vo(Ku,{key:e,context:t})}async function zu(e){var t=rp(e.schema,{selector:{context:Qi,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0}),r=await e.query(t),n=r.documents;return n}var ly="storageToken",Hb=Uu(ly,up);async function cy(e){var t=jn(10),r=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,n={id:Hb,context:up,key:ly,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:nn(),_rev:Mr(),_attachments:{}},i=[{document:n}],a=await e.internalStore.bulkWrite(i,"internal-add-storage-token");if(!a.error[0])return Ft("id",i,a)[0];var l=be(a.error[0]);if(l.isError&&Fa(l)){var f=l;if(!Gb(f.documentInDb.data.rxdbVersion,e.rxdbVersion))throw te("DM5",{args:{database:e.name,databaseStateVersion:f.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(r&&r!==f.documentInDb.data.passwordHash)throw te("DB1",{passwordHash:r,existingPasswordHash:f.documentInDb.data.passwordHash});var m=f.documentInDb;return be(m)}throw l}function Gb(e,t){if(!e||t.includes("beta")&&t!==e)return!1;var r=e.split(".")[0],n=t.split(".")[0];return r===n}function lp(e,t){return e+"-"+t.version}function is(e,t){return t=ke(t),t=Hh(e,t),typeof e.jsonSchema.primaryKey!="string"&&(t=qh(e.primaryPath,e.jsonSchema,t)),t._meta=nn(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=Mr()),t}async function fy(e,t){t.multiInstance=e.multiInstance;var r=await e.storage.createStorageInstance(t);return r}async function Wu(e,t,r,n,i,a,l){var f=await zu(t),m=f.filter(O=>O.data.name===i),h=[];m.forEach(O=>{h.push({collectionName:O.data.name,schema:O.data.schema,isCollection:!0}),O.data.connectedStorages.forEach(E=>h.push({collectionName:E.collectionName,isCollection:!1,schema:E.schema}))});var g=new Set;if(h=h.filter(O=>{var E=O.collectionName+"||"+O.schema.version;return g.has(E)?!1:(g.add(E),!0)}),await Promise.all(h.map(async O=>{var E=await e.createStorageInstance({collectionName:O.collectionName,databaseInstanceToken:r,databaseName:n,multiInstance:!1,options:{},schema:O.schema,password:a,devMode:Te.isDevMode()});await E.remove(),O.isCollection&&await un("postRemoveRxCollection",{storage:e,databaseName:n,collectionName:i})})),l){var v=m.map(O=>{var E=Jn(O);return E._deleted=!0,E._meta.lwt=Ke(),E._rev=Oi(r,O),{previous:O,document:E}});await t.bulkWrite(v,"rx-database-remove-collection-all")}}function Et(e){if(e.destroyed)throw te("COL21",{collection:e.name,version:e.schema.version})}var Yb=function(){function e(r){this.subs=[],this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.limit=100,this.tasks=new Set,this.collection=r,this.subs.push(this.collection.database.eventBulks$.pipe(Ue(n=>n.collectionName===this.collection.name),Ue(n=>{var i=n.events[0];return!i.isLocal})).subscribe(n=>{this.tasks.add(()=>this._handleChangeEvents(n.events)),this.tasks.size<=1&&Ti().then(()=>{this.processTasks()})}))}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var n=Array.from(this.tasks);n.forEach(i=>i()),this.tasks.clear()}},t._handleChangeEvents=function(n){var i=this.counter;this.counter=this.counter+n.length,n.length>this.limit?this.buffer=n.slice(n.length*-1):(Cr(this.buffer,n),this.buffer=this.buffer.slice(this.limit*-1));for(var a=i+1,l=this.eventCounterMap,f=0;f<n.length;f++){var m=n[f];l.set(m,a+f)}},t.getCounter=function(){return this.processTasks(),this.counter},t.getBuffer=function(){return this.processTasks(),this.buffer},t.getArrayIndexByPointer=function(n){this.processTasks();var i=this.buffer[0],a=this.eventCounterMap.get(i);if(n<a)return null;var l=n-a;return l},t.getFrom=function(n){this.processTasks();var i=[],a=this.getArrayIndexByPointer(n);if(a===null)return null;for(;;){var l=this.buffer[a];if(a++,l)i.push(l);else return i}},t.runFrom=function(n,i){this.processTasks();var a=this.getFrom(n);if(a===null)throw new Error("out of bounds");a.forEach(l=>i(l))},t.reduceByLastOfDoc=function(n){return this.processTasks(),n.slice(0);var i={};return n.forEach(a=>{i[a.documentId]=a}),Object.values(i)},t.destroy=function(){this.tasks.clear(),this.subs.forEach(n=>n.unsubscribe())},e}();function py(e){return new Yb(e)}var Qb=new WeakMap;function Jb(e){var t=e.schema.getDocumentPrototype(),r=Xb(e),n=sp,i={};return[t,r,n].forEach(a=>{var l=Object.getOwnPropertyNames(a);l.forEach(f=>{var m=Object.getOwnPropertyDescriptor(a,f),h=!0;(f.startsWith("_")||f.endsWith("_")||f.startsWith("$")||f.endsWith("$"))&&(h=!1),typeof m.value=="function"?Object.defineProperty(i,f,{get(){return m.value.bind(this)},enumerable:h,configurable:!1}):(m.enumerable=h,m.configurable=!1,m.writable&&(m.writable=!1),Object.defineProperty(i,f,m))})}),i}function my(e){return xt(Qb,e,()=>sy(Jb(e)))}function dy(e,t,r){var n=ay(t,e,Te.deepFreezeWhenDevMode(r));return e._runHooksSync("post","create",r,n),qe("postCreateRxDocument",n),n}function Xb(e){var t={};return Object.entries(e.methods).forEach(([r,n])=>{t[r]=n}),t}var cp=function(e,t){var r=vr(e.newDocumentState),n=vr(e.realMasterState);return Ii(r,n)?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};var _y=["pre","post"],gy=["insert","save","remove","create"],hy=!1,Zb=function(){function e(r,n,i,a,l={},f={},m={},h={},g={},v=ep,O={},E=cp){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this.awaitBeforeReads=new Set,this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=Yg(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.onRemove=[],this.database=r,this.name=n,this.schema=i,this.internalStorageInstance=a,this.instanceCreationOptions=l,this.migrationStrategies=f,this.methods=m,this.attachments=h,this.options=g,this.cacheReplacementPolicy=v,this.statics=O,this.conflictHandler=E,e1(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=ju(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new oy(this.storageInstance,this.schema.primaryPath,(m,h)=>ap(this,m,h),m=>this._runHooks("post","save",m));var n=this.database.eventBulks$.pipe(Ue(m=>m.collectionName===this.name));this.$=n.pipe(Gt(m=>m.events)),this.checkpoint$=n.pipe(lt(m=>m.checkpoint)),this._changeEventBuffer=py(this.asRxCollection);var i;this._docCache=new Xg(this.schema.primaryPath,this.database.eventBulks$.pipe(Ue(m=>m.collectionName===this.name&&!m.events[0].isLocal),lt(m=>m.events)),m=>(i||(i=my(this.asRxCollection)),dy(this.asRxCollection,i,m)));var a=this.database.internalStore.changeStream().pipe(Ue(m=>{var h=this.name+"-"+this.schema.version,g=m.events.find(v=>v.documentData.context==="collection"&&v.documentData.key===h&&v.operation==="DELETE");return!!g})).subscribe(async()=>{await this.destroy(),await Promise.all(this.onRemove.map(m=>m()))});this._subs.push(a);var l=await this.database.storageToken,f=this.storageInstance.changeStream().subscribe(m=>{for(var h=new Array(m.events.length),g=m.events,v=this.name,O=Te.deepFreezeWhenDevMode,E=0;E<g.length;E++){var T=g[E];h[E]={documentId:T.documentId,collectionName:v,isLocal:!1,operation:T.operation,documentData:O(T.documentData),previousDocumentData:O(T.previousDocumentData)}}var C={id:m.id,internal:!1,collectionName:this.name,storageToken:l,events:h,databaseToken:this.database.token,checkpoint:m.checkpoint,context:m.context,endTime:m.endTime,startTime:m.startTime};this.database.$emit(C)});return this._subs.push(f),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe(m=>{this.conflictHandler(m.input,m.context).then(h=>{this.storageInstance.resolveConflictResultionTask({id:m.id,output:h})})})),ki},t.cleanup=function(n){throw Et(this),$e("cleanup")},t.migrationNeeded=function(){throw $e("migration-schema")},t.getMigrationState=function(){throw $e("migration-schema")},t.startMigration=function(n=10){return Et(this),this.getMigrationState().startMigration(n)},t.migratePromise=function(n=10){return this.getMigrationState().migratePromise(n)},t.insert=async function(n){Et(this);var i=await this.bulkInsert([n]),a=i.error[0];Yi(this,n[this.schema.primaryPath],n,a);var l=be(i.success[0]);return l},t.bulkInsert=async function(n){if(Et(this),n.length===0)return{success:[],error:[]};var i=this.schema.primaryPath,a;if(this.hasHooks("pre","insert"))a=await Promise.all(n.map(C=>{var G=is(this.schema,C);return this._runHooks("pre","insert",G).then(()=>({document:G}))}));else{a=new Array(n.length);for(var l=this.schema,f=0;f<n.length;f++){var m=n[f],h=is(l,m);a[f]={document:h}}}var g=await this.storageInstance.bulkWrite(a,"rx-collection-bulk-insert"),v,O=this,E={get success(){if(!v){var C=Ft(O.schema.primaryPath,a,g);v=Bu(O._docCache,C)}return v},error:g.error};if(this.hasHooks("post","insert")){var T=new Map;a.forEach(C=>{var G=C.document;T.set(G[i],G)}),await Promise.all(E.success.map(C=>this._runHooks("post","insert",T.get(C.primary),C)))}return E},t.bulkRemove=async function(n){Et(this);var i=this.schema.primaryPath;if(n.length===0)return{success:[],error:[]};var a=await this.findByIds(n).exec(),l=[],f=new Map;Array.from(a.values()).forEach(E=>{var T=E.toMutableJSON(!0);l.push(T),f.set(E.primary,T)}),await Promise.all(l.map(E=>{var T=E[this.schema.primaryPath];return this._runHooks("pre","remove",E,a.get(T))}));var m=l.map(E=>{var T=ke(E);return T._deleted=!0,{previous:E,document:T}}),h=await this.storageInstance.bulkWrite(m,"rx-collection-bulk-remove"),g=Ft(this.schema.primaryPath,m,h),v=g.map(E=>E[i]);await Promise.all(v.map(E=>this._runHooks("post","remove",f.get(E),a.get(E))));var O=v.map(E=>sn(a,E));return{success:O,error:h.error}},t.bulkUpsert=async function(n){Et(this);var i=[],a=new Map;n.forEach(h=>{var g=is(this.schema,h),v=g[this.schema.primaryPath];if(!v)throw te("COL3",{primaryPath:this.schema.primaryPath,data:g,schema:this.schema.jsonSchema});a.set(v,g),i.push(g)});var l=await this.bulkInsert(i),f=l.success.slice(0),m=[];return await Promise.all(l.error.map(async h=>{if(h.status!==409)m.push(h);else{var g=h.documentId,v=sn(a,g),O=be(h.documentInDb),E=this._docCache.getCachedRxDocuments([O])[0],T=await E.incrementalModify(()=>v);f.push(T)}})),{error:m,success:f}},t.upsert=async function(n){Et(this);var i=await this.bulkUpsert([n]);return Yi(this.asRxCollection,n[this.schema.primaryPath],n,i.error[0]),i.success[0]},t.incrementalUpsert=function(n){Et(this);var i=is(this.schema,n),a=i[this.schema.primaryPath];if(!a)throw te("COL4",{data:n});var l=this._incrementalUpsertQueues.get(a);return l||(l=ki),l=l.then(()=>r1(this,a,i)).then(f=>f.inserted?f.doc:t1(f.doc,i)),this._incrementalUpsertQueues.set(a,l),l},t.find=function(n){if(Et(this),typeof n=="string")throw te("COL5",{queryObj:n});n||(n=ns());var i=Gi("find",n,this);return i},t.findOne=function(n){if(Et(this),typeof n=="number"||Array.isArray(n))throw La("COL6",{queryObj:n});var i;if(typeof n=="string")i=Gi("findOne",{selector:{[this.schema.primaryPath]:n},limit:1},this);else{if(n||(n=ns()),n.limit)throw te("QU6");n=ke(n),n.limit=1,i=Gi("findOne",n,this)}return i},t.count=function(n){Et(this),n||(n=ns());var i=Gi("count",n,this);return i},t.findByIds=function(n){Et(this);var i={selector:{[this.schema.primaryPath]:{$in:n.slice(0)}}},a=Gi("findByIds",i,this);return a},t.exportJSON=function(){throw $e("json-dump")},t.importJSON=function(n){throw $e("json-dump")},t.insertCRDT=function(n){throw $e("crdt")},t.addPipeline=function(n){throw $e("pipeline")},t.addHook=function(n,i,a,l=!1){if(typeof a!="function")throw La("COL7",{key:i,when:n});if(!_y.includes(n))throw La("COL8",{key:i,when:n});if(!gy.includes(i))throw te("COL9",{key:i});if(n==="post"&&i==="create"&&l===!0)throw te("COL10",{when:n,key:i,parallel:l});var f=a.bind(this),m=l?"parallel":"series";this.hooks[i]=this.hooks[i]||{},this.hooks[i][n]=this.hooks[i][n]||{series:[],parallel:[]},this.hooks[i][n][m].push(f)},t.getHooks=function(n,i){return!this.hooks[i]||!this.hooks[i][n]?{series:[],parallel:[]}:this.hooks[i][n]},t.hasHooks=function(n,i){if(!this.hooks[i]||!this.hooks[i][n])return!1;var a=this.getHooks(n,i);return a?a.series.length>0||a.parallel.length>0:!1},t._runHooks=function(n,i,a,l){var f=this.getHooks(n,i);if(!f)return ki;var m=f.series.map(h=>()=>h(a,l));return Ph(m).then(()=>Promise.all(f.parallel.map(h=>h(a,l))))},t._runHooksSync=function(n,i,a,l){if(this.hasHooks(n,i)){var f=this.getHooks(n,i);f&&f.series.forEach(m=>m(a,l))}},t.promiseWait=function(n){var i=new Promise(a=>{var l=setTimeout(()=>{this.timeouts.delete(l),a()},n);this.timeouts.add(l)});return i},t.destroy=async function(){return this.destroyed?_r:(await Promise.all(this.onDestroy.map(n=>n())),this.destroyed=!0,Array.from(this.timeouts).forEach(n=>clearTimeout(n)),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then(()=>this.storageInstance.close()).then(()=>(this._subs.forEach(n=>n.unsubscribe()),delete this.database.collections[this.name],un("postDestroyRxCollection",this).then(()=>!0))))},t.remove=async function(){await this.destroy(),await Promise.all(this.onRemove.map(n=>n())),await Wu(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},at(e,[{key:"insert$",get:function(){return this.$.pipe(Ue(r=>r.operation==="INSERT"))}},{key:"update$",get:function(){return this.$.pipe(Ue(r=>r.operation==="UPDATE"))}},{key:"remove$",get:function(){return this.$.pipe(Ue(r=>r.operation==="DELETE"))}},{key:"asRxCollection",get:function(){return this}}])}();function e1(e){if(!hy){hy=!0;var t=Object.getPrototypeOf(e);gy.forEach(r=>{_y.map(n=>{var i=n+Da(r);t[i]=function(a,l){return this.addHook(n,r,a,l)}})})}}function t1(e,t){return e.incrementalModify(r=>t)}function r1(e,t,r){var n=e._docCache.getLatestDocumentDataIfExists(t);return n?Promise.resolve({doc:e._docCache.getCachedRxDocuments([n])[0],inserted:!1}):e.findOne(t).exec().then(i=>i?{doc:i,inserted:!1}:e.insert(r).then(a=>({doc:a,inserted:!0})))}function yy({database:e,name:t,schema:r,instanceCreationOptions:n={},migrationStrategies:i={},autoMigrate:a=!0,statics:l={},methods:f={},attachments:m={},options:h={},localDocuments:g=!1,cacheReplacementPolicy:v=ep,conflictHandler:O=cp}){var E={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:r.jsonSchema,options:n,multiInstance:e.multiInstance,password:e.password,devMode:Te.isDevMode()};return qe("preCreateRxStorageInstance",E),fy(e,E).then(T=>{var C=new Zb(e,t,r,T,n,i,f,m,h,v,l,O);return C.prepare().then(()=>{Object.entries(l).forEach(([X,Q])=>{Object.defineProperty(C,X,{get:()=>Q.bind(C)})});var G=ki;return a&&C.schema.version!==0&&(G=C.migratePromise()),G}).then(()=>(qe("createRxCollection",{collection:C,creator:{name:t,schema:r,storageInstance:T,instanceCreationOptions:n,migrationStrategies:i,methods:f,attachments:m,options:h,cacheReplacementPolicy:v,localDocuments:g,statics:l}}),C)).catch(G=>T.close().then(()=>Promise.reject(G)))})}var mp=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this._parallels=t||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};mp.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,pp(this)},wrapCall:function(t){var r=this;this.lock();var n;try{n=t()}catch(i){throw this.unlock(),i}return!n.then||typeof n.then!="function"?(this.unlock(),n):n.then(function(i){return r.unlock(),i}).catch(function(i){throw r.unlock(),i})},requestIdlePromise:function(t){var r=this;t=t||{};var n,i=new Promise(function(f){return n=f}),a=function(){fp(r,i),n()};if(i._manRes=a,t.timeout){var l=setTimeout(function(){i._manRes()},t.timeout);i._timeoutObj=l}return this._iC.add(i),pp(this),i},cancelIdlePromise:function(t){fp(this,t)},requestIdleCallback:function(t,r){var n=this._lHN++,i=this.requestIdlePromise(r);return this._hPM.set(n,i),this._pHM.set(i,n),i.then(function(){return t()}),n},cancelIdleCallback:function(t){var r=this._hPM.get(t);this.cancelIdlePromise(r)},clear:function(){var t=this;this._iC.forEach(function(r){return fp(t,r)}),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};function n1(e){if(e._iC.size!==0){var t=e._iC.values(),r=t.next().value;r._manRes(),setTimeout(function(){return pp(e)},0)}}function fp(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var r=e._pHM.get(t);e._hPM.delete(r),e._pHM.delete(t)}e._iC.delete(t)}}function pp(e){e._tryIR||e._iC.size===0||(e._tryIR=!0,setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}n1(e),e._tryIR=!1},0)},0))}var fn=class{ttl;map=new Map;_to=!1;constructor(t){this.ttl=t}has(t){return this.map.has(t)}add(t){this.map.set(t,xy()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,i1(this)},0))}clear(){this.map.clear()}};function i1(e){let t=xy()-e.ttl,r=e.map[Symbol.iterator]();for(;;){let n=r.next().value;if(!n)return;let i=n[0];if(n[1]<t)e.map.delete(i);else return}}function xy(){return Date.now()}var qu=new Set,vy=0,o1=function(){function e(r,n,i,a,l,f,m=!1,h={},g,v,O,E,T){this.idleQueue=new mp,this.rxdbVersion=Wo,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.states={},this.eventBulks$=new ct,this.observable$=this.eventBulks$.pipe(Gt(C=>C.events)),this.storageToken=_r,this.storageTokenDocument=_r,this.emittedEventBulkIds=new fn(60*1e3),this.name=r,this.token=n,this.storage=i,this.instanceCreationOptions=a,this.password=l,this.multiInstance=f,this.eventReduce=m,this.options=h,this.internalStore=g,this.hashFunction=v,this.cleanupPolicy=O,this.allowSlowCount=E,this.reactivity=T,vy++,this.name!=="pseudoInstance"&&(this.internalStore=ju(this.asRxDatabase,g,Ku),this.storageTokenDocument=cy(this.asRxDatabase).catch(C=>this.startupErrors.push(C)),this.storageToken=this.storageTokenDocument.then(C=>C.data.token).catch(C=>this.startupErrors.push(C)))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw te("DB14",{database:this.name});return this.reactivity},t.$emit=function(n){this.emittedEventBulkIds.has(n.id)||(this.emittedEventBulkIds.add(n.id),this.eventBulks$.next(n))},t.removeCollectionDoc=async function(n,i){var a=await ip(this.internalStore,Uu(lp(n,i),Qi));if(!a)throw te("SNH",{name:n,schema:i});var l=Jn(a);l._deleted=!0,await this.internalStore.bulkWrite([{document:l,previous:a}],"rx-database-remove-collection")},t.addCollections=async function(n){var i={},a={},l=[],f={};await Promise.all(Object.entries(n).map(async([g,v])=>{var O=g,E=v.schema;i[O]=E;var T=Gh(E,this.hashFunction);if(a[O]=T,this.collections[g])throw te("DB3",{name:g});var C=lp(g,E),G={id:Uu(C,Qi),key:C,context:Qi,data:{name:O,schemaHash:await T.hash,schema:T.jsonSchema,version:T.version,connectedStorages:[]},_deleted:!1,_meta:nn(),_rev:Mr(),_attachments:{}};l.push({document:G});var X=Object.assign({},v,{name:O,schema:T,database:this}),Q=ke(v);Q.database=this,Q.name=g,qe("preCreateRxCollection",Q),X.conflictHandler=Q.conflictHandler,f[O]=X}));var m=await this.internalStore.bulkWrite(l,"rx-database-add-collection");await u1(this),await Promise.all(m.error.map(async g=>{if(g.status!==409)throw te("DB12",{database:this.name,writeError:g});var v=be(g.documentInDb),O=v.data.name,E=a[O];if(v.data.schemaHash!==await E.hash)throw te("DB6",{database:this.name,collection:O,previousSchemaHash:v.data.schemaHash,schemaHash:await E.hash,previousSchema:v.data.schema,schema:be(i[O])})}));var h={};return await Promise.all(Object.keys(n).map(async g=>{var v=f[g],O=await yy(v);h[g]=O,this.collections[g]=O,this[g]||Object.defineProperty(this,g,{get:()=>this.collections[g]})})),h},t.lockedRun=function(n){return this.idleQueue.wrapCall(n)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(n){throw $e("json-dump")},t.addState=function(n){throw $e("state")},t.importJSON=function(n){throw $e("json-dump")},t.backup=function(n){throw $e("backup")},t.leaderElector=function(){throw $e("leader-election")},t.isLeader=function(){throw $e("leader-election")},t.waitForLeadership=function(){throw $e("leader-election")},t.migrationStates=function(){throw $e("migration-schema")},t.destroy=async function(){return this.destroyed?_r:(this.destroyed=!0,await un("preDestroyRxDatabase",this),this.eventBulks$.complete(),vy--,this._subs.map(n=>n.unsubscribe()),this.name==="pseudoInstance"?_r:this.requestIdlePromise().then(()=>Promise.all(this.onDestroy.map(n=>n()))).then(()=>Promise.all(Object.keys(this.collections).map(n=>this.collections[n]).map(n=>n.destroy()))).then(()=>this.internalStore.close()).then(()=>qu.delete(this.storage.name+"|"+this.name)).then(()=>!0))},t.remove=function(){return this.destroy().then(()=>a1(this.name,this.storage,this.password))},at(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])}();function s1(e,t){var r=t.name+"|"+e;if(qu.has(r))throw te("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}async function wy(e,t,r,n,i,a){var l=await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:ty,schema:Ku,options:n,multiInstance:i,password:a,devMode:Te.isDevMode()});return l}function $y({storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i=!0,eventReduce:a=!0,ignoreDuplicate:l=!1,options:f={},cleanupPolicy:m,allowSlowCount:h=!1,localDocuments:g=!1,hashFunction:v=Ma,reactivity:O}){qe("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:l,options:f,localDocuments:g}),l||s1(r,e),qu.add(e.name+"|"+r);var E=jn(10);return wy(E,e,r,t,i,n).catch(T=>{throw qu.delete(e.name+"|"+r),T}).then(T=>{var C=new o1(r,E,e,t,n,i,a,f,T,v,m,h,O);return un("createRxDatabase",{database:C,creator:{storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:l,options:f,localDocuments:g}}).then(()=>C)})}async function a1(e,t,r){var n=jn(10),i=await wy(n,t,e,{},!1,r),a=await zu(i),l=new Set;a.forEach(m=>l.add(m.data.name));var f=Array.from(l);return await Promise.all(f.map(m=>Wu(t,i,n,e,m,r))),await un("postRemoveRxDatabase",{databaseName:e,storage:t}),await i.remove(),f}async function u1(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}function by(e){return e&&typeof e.then=="function"}var l1=Promise.resolve(!1),sY=Promise.resolve(!0),wr=Promise.resolve();function Vu(e,t){return e||(e=0),new Promise(function(r){return setTimeout(function(){return r(t)},e)})}function Ey(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function os(){return Math.random().toString(36).substring(2)}var dp=0;function Fr(){var e=Date.now()*1e3;return e<=dp&&(e=dp+1),dp=e,e}var c1=Fr,f1="native";function p1(e){var t={time:Fr(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(r){t.messagesCallback&&t.messagesCallback(r.data)},t}function m1(e){e.bc.close(),e.subFns=[]}function d1(e,t){try{return e.bc.postMessage(t,!1),wr}catch(r){return Promise.reject(r)}}function h1(e,t){e.messagesCallback=t}function _1(){if(typeof globalThis<"u"&&globalThis.Deno&&globalThis.Deno.args)return!0;if((typeof window<"u"||typeof self<"u")&&typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function g1(){return 150}var Oy={create:p1,close:m1,onMessage:h1,postMessage:d1,canBeUsed:_1,type:f1,averageResponseTime:g1,microSeconds:c1};function Ji(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var y1=Fr,x1="pubkey.broadcast-channel-0-",Br="messages",Hu={durability:"relaxed"},v1="idb";function Sy(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function hp(e){e.commit&&e.commit()}function w1(e){var t=Sy(),r=x1+e,n=t.open(r);return n.onupgradeneeded=function(i){var a=i.target.result;a.createObjectStore(Br,{keyPath:"id",autoIncrement:!0})},new Promise(function(i,a){n.onerror=function(l){return a(l)},n.onsuccess=function(){i(n.result)}})}function $1(e,t,r){var n=Date.now(),i={uuid:t,time:n,data:r},a=e.transaction([Br],"readwrite",Hu);return new Promise(function(l,f){a.oncomplete=function(){return l()},a.onerror=function(h){return f(h)};var m=a.objectStore(Br);m.add(i),hp(a)})}function b1(e,t){var r=e.transaction(Br,"readonly",Hu),n=r.objectStore(Br),i=[],a=IDBKeyRange.bound(t+1,1/0);if(n.getAll){var l=n.getAll(a);return new Promise(function(m,h){l.onerror=function(g){return h(g)},l.onsuccess=function(g){m(g.target.result)}})}function f(){try{return a=IDBKeyRange.bound(t+1,1/0),n.openCursor(a)}catch{return n.openCursor()}}return new Promise(function(m,h){var g=f();g.onerror=function(v){return h(v)},g.onsuccess=function(v){var O=v.target.result;O?O.value.id<t+1?O.continue(t+1):(i.push(O.value),O.continue()):(hp(r),m(i))}})}function E1(e,t){if(e.closed)return Promise.resolve([]);var r=e.db.transaction(Br,"readwrite",Hu),n=r.objectStore(Br);return Promise.all(t.map(function(i){var a=n.delete(i);return new Promise(function(l){a.onsuccess=function(){return l()}})}))}function O1(e,t){var r=Date.now()-t,n=e.transaction(Br,"readonly",Hu),i=n.objectStore(Br),a=[];return new Promise(function(l){i.openCursor().onsuccess=function(f){var m=f.target.result;if(m){var h=m.value;h.time<r?(a.push(h),m.continue()):(hp(n),l(a))}else l(a)}})}function S1(e){return O1(e.db,e.options.idb.ttl).then(function(t){return E1(e,t.map(function(r){return r.id}))})}function A1(e,t){return t=Ji(t),w1(e).then(function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:os(),eMIs:new fn(t.idb.ttl*2),writeBlockPromise:wr,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},Ay(n),n})}function Ay(e){e.closed||ky(e).then(function(){return Vu(e.options.idb.fallbackInterval)}).then(function(){return Ay(e)})}function k1(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function ky(e){return e.closed?wr:e.messagesCallback?b1(e.db,e.lastCursorId).then(function(t){var r=t.filter(function(n){return!!n}).map(function(n){return n.id>e.lastCursorId&&(e.lastCursorId=n.id),n}).filter(function(n){return k1(n,e)}).sort(function(n,i){return n.time-i.time});return r.forEach(function(n){e.messagesCallback&&(e.eMIs.add(n.id),e.messagesCallback(n.data))}),wr}):wr}function T1(e){e.closed=!0,e.db.close()}function I1(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return $1(e.db,e.uuid,t)}).then(function(){Ey(0,10)===0&&S1(e)}),e.writeBlockPromise}function C1(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,ky(e)}function M1(){return!!Sy()}function D1(e){return e.idb.fallbackInterval*2}var Ty={create:A1,close:T1,onMessage:C1,postMessage:I1,canBeUsed:M1,type:v1,averageResponseTime:D1,microSeconds:y1};var P1=Fr,R1="pubkey.broadcastChannel-",N1="localstorage";function Iy(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function Cy(e){return R1+e}function L1(e,t){return new Promise(function(r){Vu().then(function(){var n=Cy(e.channelName),i={token:os(),time:Date.now(),data:t,uuid:e.uuid},a=JSON.stringify(i);Iy().setItem(n,a);var l=document.createEvent("Event");l.initEvent("storage",!0,!0),l.key=n,l.newValue=a,window.dispatchEvent(l),r()})})}function F1(e,t){var r=Cy(e),n=function(a){a.key===r&&t(JSON.parse(a.newValue))};return window.addEventListener("storage",n),n}function B1(e){window.removeEventListener("storage",e)}function j1(e,t){if(t=Ji(t),!My())throw new Error("BroadcastChannel: localstorage cannot be used");var r=os(),n=new fn(t.localstorage.removeTimeout),i={channelName:e,uuid:r,eMIs:n};return i.listener=F1(e,function(a){i.messagesCallback&&a.uuid!==r&&(!a.token||n.has(a.token)||a.data.time&&a.data.time<i.messagesCallbackTime||(n.add(a.token),i.messagesCallback(a.data)))}),i}function K1(e){B1(e.listener)}function U1(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function My(){var e=Iy();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function z1(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var Dy={create:j1,close:K1,onMessage:U1,postMessage:L1,canBeUsed:My,type:N1,averageResponseTime:z1,microSeconds:P1};var Py=Fr,W1="simulate",_p=new Set;function q1(e){var t={time:Py(),name:e,messagesCallback:null};return _p.add(t),t}function V1(e){_p.delete(e)}var Ry=5;function H1(e,t){return new Promise(function(r){return setTimeout(function(){var n=Array.from(_p);n.forEach(function(i){i.name===e.name&&i!==e&&i.messagesCallback&&i.time<t.time&&i.messagesCallback(t)}),r()},Ry)})}function G1(e,t){e.messagesCallback=t}function Y1(){return!0}function Q1(){return Ry}var Ny={create:q1,close:V1,onMessage:G1,postMessage:H1,canBeUsed:Y1,type:W1,averageResponseTime:Q1,microSeconds:Py};var Ly=[Oy,Ty,Dy];function Fy(e){var t=[].concat(e.methods,Ly).filter(Boolean);if(e.type){if(e.type==="simulate")return Ny;var r=t.find(function(i){return i.type===e.type});if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter(function(i){return i.type!=="idb"}));var n=t.find(function(i){return i.canBeUsed()});if(n)return n;throw new Error("No usable method found in "+JSON.stringify(Ly.map(function(i){return i.type})))}var gp=new Set,J1=0,ss=function(t,r){this.id=J1++,gp.add(this),this.name=t,By&&(r=By),this.options=Ji(r),this.method=Fy(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,X1(this)};ss._pubkey=!0;var By;ss.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(t));return jy(this,"message",t)},postInternal:function(t){return jy(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),r={time:t,fn:e};Uy(this,"message",this._onML),e&&typeof e=="function"?(this._onML=r,Ky(this,"message",r)):this._onML=null},addEventListener:function(t,r){var n=this.method.microSeconds(),i={time:n,fn:r};Ky(this,t,i)},removeEventListener:function(t,r){var n=this._addEL[t].find(function(i){return i.fn===r});Uy(this,t,n)},close:function(){var t=this;if(!this.closed){gp.delete(this),this.closed=!0;var r=this._prepP?this._prepP:wr;return this._onML=null,this._addEL.message=[],r.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(n){return n()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function jy(e,t,r){var n=e.method.microSeconds(),i={time:n,type:t,data:r},a=e._prepP?e._prepP:wr;return a.then(function(){var l=e.method.postMessage(e._state,i);return e._uMP.add(l),l.catch().then(function(){return e._uMP.delete(l)}),l})}function X1(e){var t=e.method.create(e.name,e.options);by(t)?(e._prepP=t,t.then(function(r){e._state=r})):e._state=t}function zy(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Ky(e,t,r){e._addEL[t].push(r),Z1(e)}function Uy(e,t,r){e._addEL[t]=e._addEL[t].filter(function(n){return n!==r}),eE(e)}function Z1(e){if(!e._iL&&zy(e)){var t=function(i){e._addEL[i.type].forEach(function(a){i.time>=a.time&&a.fn(i.data)})},r=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,r)}):(e._iL=!0,e.method.onMessage(e._state,t,r))}}function eE(e){if(e._iL&&!zy(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}var Gu=new Map;function tE(e,t,r,n){var i=Gu.get(t);return i||(i={bc:new ss(["RxDB:",e,r].join("|")),refs:new Set},Gu.set(t,i)),i.refs.add(n),i.bc}function Wy(e,t){var r=Gu.get(e);if(r&&(r.refs.delete(t),r.refs.size===0))return Gu.delete(e),r.bc.close()}function qy(e,t,r,n){if(t.multiInstance){var i=n||tE(e,t.databaseInstanceToken,r.databaseName,r),a=new ct,l=O=>{O.storageName===e&&O.databaseName===t.databaseName&&O.collectionName===t.collectionName&&O.version===t.schema.version&&a.next(O.eventBulk)};i.addEventListener("message",l);var f=r.changeStream(),m=!1,h=f.subscribe(O=>{m||i.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:O})});r.changeStream=function(){return a.asObservable().pipe(xf(f))};var g=r.close.bind(r);r.close=async function(){return m=!0,h.unsubscribe(),i.removeEventListener("message",l),n||await Wy(t.databaseInstanceToken,r),g()};var v=r.remove.bind(r);r.remove=async function(){return m=!0,h.unsubscribe(),i.removeEventListener("message",l),n||await Wy(t.databaseInstanceToken,r),v()}}}var Yu=zv(Vy(),1),Hy=Symbol.for("Dexie"),as=globalThis[Hy]||(globalThis[Hy]=Yu.default);if(Yu.default.semVer!==as.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Yu.default.semVer} and ${as.semVer}`);var{liveQuery:FY,mergeRanges:BY,rangesOverlap:jY,RangeSet:KY,cmp:UY,Entity:zY,PropModSymbol:WY,PropModification:qY,replacePrefix:VY,add:HY,remove:GY}=as;var us="docs",rE="changes",Gy="attachments",Ju="dexie",Yy=new Map,Qu=new Map;function Qy(e,t,r,n){var i="rxdb-dexie-"+e+"--"+n.version+"--"+t,a=xt(Yy,i,()=>{var l=(async()=>{var f=ke(r);f.autoOpen=!1;var m=new as(i,f),h={[us]:nE(n),[rE]:"++sequence, id",[Gy]:"id"};return m.version(1).stores(h),await m.open(),{dexieDb:m,dexieTable:m[us],dexieAttachmentsTable:m[Gy],booleanIndexes:iE(n)}})();return Yy.set(i,a),Qu.set(a,0),l});return a}async function Jy(e){var t=await e,r=Qu.get(e),n=r-1;n===0?(t.dexieDb.close(),Qu.delete(e)):Qu.set(e,n)}var vp="__";function Xn(e){var t=e.split(".");if(t.length>1)return t.map(n=>Xn(n)).join(".");if(e.startsWith("|")){var r=e.substring(1);return vp+r}else return e}function Xy(e){var t=e.split(".");if(t.length>1)return t.map(n=>Xy(n)).join(".");if(e.startsWith(vp)){var r=e.substring(vp.length);return"|"+r}else return e}function Zy(e,t){if(!t)return t;var r=ke(t);return r=wp(r),e.forEach(n=>{var i=Dr(t,n),a=i?"1":"0",l=Xn(n);nf(r,l,a)}),r}function bp(e,t){return t&&(t=ke(t),t=$p(t),e.forEach(r=>{var n=Dr(t,r),i=n==="1";nf(t,r,i)}),t)}function wp(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>wp(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,n])=>{typeof n=="object"&&(n=wp(n)),t[Xn(r)]=n}),t}}function $p(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>$p(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,n])=>{(typeof n=="object"||Array.isArray(e))&&(n=$p(n)),t[Xy(r)]=n}),t}}function nE(e){var t=[],r=Mt(e.primaryKey);t.push([r]),t.push(["_deleted",r]),e.indexes&&e.indexes.forEach(a=>{var l=zo(a);t.push(l)}),t.push(["_meta.lwt",r]),t.push(["_meta.lwt"]),t=t.map(a=>a.map(l=>Xn(l)));var n=t.map(a=>a.length===1?a[0]:"["+a.join("+")+"]");n=n.filter((a,l,f)=>f.indexOf(a)===l);var i=n.join(", ");return i}async function Ep(e,t){var r=await e,n=await r.dexieTable.bulkGet(t);return n.map(i=>bp(r.booleanIndexes,i))}function ls(e,t){return e+"||"+t}function iE(e){var t=new Set,r=[];return e.indexes?(e.indexes.forEach(n=>{var i=zo(n);i.forEach(a=>{if(!t.has(a)){t.add(a);var l=Pr(e,a);l.type==="boolean"&&r.push(a)}})}),r.push("_deleted"),bh(r)):r}function ex(e){return e===Vn?-1/0:e}function tx(e,t,r){if(e.includes(t)){var n=r===qn||r===!0?"1":"0";return n}else return r}function rx(e,t,r){if(!r){if(typeof window>"u")throw new Error("IDBKeyRange missing");r=window.IDBKeyRange}var n=t.startKeys.map((l,f)=>{var m=t.index[f];return tx(e,m,l)}).map(ex),i=t.endKeys.map((l,f)=>{var m=t.index[f];return tx(e,m,l)}).map(ex),a=r.bound(n,i,!t.inclusiveStart,!t.inclusiveEnd);return a}async function Op(e,t){var r=await e.internals,n=t.query,i=n.skip?n.skip:0,a=n.limit?n.limit:1/0,l=i+a,f=t.queryPlan,m=!1;f.selectorSatisfiedByIndex||(m=Vi(e.schema,t.query));var h=rx(r.booleanIndexes,f,r.dexieDb._options.IDBKeyRange),g=f.index,v=[];if(await r.dexieDb.transaction("r",r.dexieTable,async E=>{var T=E.idbtrans,C=T.objectStore(us),G,X;X="["+g.map(K=>Xn(K)).join("+")+"]",G=C.index(X);var Q=G.openCursor(h);await new Promise(K=>{Q.onsuccess=function(ne){var Z=ne.target.result;if(Z){var fe=bp(r.booleanIndexes,Z.value);(!m||m(fe))&&v.push(fe),f.sortSatisfiedByIndex&&v.length===l?K():Z.continue()}else K()}})}),!f.sortSatisfiedByIndex){var O=Fu(e.schema,t.query);v=v.sort(O)}return v=v.slice(i,l),{documents:v}}async function nx(e,t){var r=await e.internals,n=t.queryPlan,i=n.index,a=rx(r.booleanIndexes,n,r.dexieDb._options.IDBKeyRange),l=-1;return await r.dexieDb.transaction("r",r.dexieTable,async f=>{var m=f.idbtrans,h=m.objectStore(us),g,v;v="["+i.map(E=>Xn(E)).join("+")+"]",g=h.index(v);var O=g.count(a);l=await new Promise((E,T)=>{O.onsuccess=function(){E(O.result)},O.onerror=C=>T(C)})}),l}var oE=Ke(),Sp=!1,sE=function(){function e(r,n,i,a,l,f,m,h){this.changes$=new ct,this.instanceId=oE++,this.storage=r,this.databaseName=n,this.collectionName=i,this.schema=a,this.internals=l,this.options=f,this.settings=m,this.devMode=h,this.primaryPath=Mt(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(n,i){Zn(this),!Sp&&(!Ra.premium||typeof Ra.premium!="string"||await Ma(Ra.premium)!==Bh)&&console.warn(["-------------- RxDB Open Core RxStorage -------------------------------","You are using the free Dexie.js based RxStorage implementation from RxDB https://rxdb.info/rx-storage-dexie.html?console=dexie ","While this is a great option, we want to let you know that there are faster storage solutions available in our premium plugins.","For professional users and production environments, we highly recommend considering these premium options to enhance performance and reliability."," https://rxdb.info/premium?console=dexie ","If you already purchased premium access you can disable this log by calling the setPremiumFlag() function from rxdb-premium/plugins/shared.","---------------------------------------------------------------------"].join(`
`)),Sp=!0,n.forEach(g=>{if(!g.document._rev||g.previous&&!g.previous._rev)throw te("SNH",{args:{row:g}})});var a=await this.internals,l={error:[]};this.devMode&&(n=n.map(g=>{var v=Jn(g.document);return{previous:g.previous,document:v}}));var f=n.map(g=>g.document[this.primaryPath]),m;if(await a.dexieDb.transaction("rw",a.dexieTable,a.dexieAttachmentsTable,async()=>{var g=new Map,v=await Ep(this.internals,f);v.forEach(T=>{var C=T;return C&&g.set(C[this.primaryPath],C),C}),m=ry(this,this.primaryPath,g,n,i),l.error=m.errors;var O=[];m.bulkInsertDocs.forEach(T=>{O.push(T.document)}),m.bulkUpdateDocs.forEach(T=>{O.push(T.document)}),O=O.map(T=>Zy(a.booleanIndexes,T)),O.length>0&&await a.dexieTable.bulkPut(O);var E=[];m.attachmentsAdd.forEach(T=>{E.push({id:ls(T.documentId,T.attachmentId),data:T.attachmentData.data})}),m.attachmentsUpdate.forEach(T=>{E.push({id:ls(T.documentId,T.attachmentId),data:T.attachmentData.data})}),await a.dexieAttachmentsTable.bulkPut(E),await a.dexieAttachmentsTable.bulkDelete(m.attachmentsRemove.map(T=>ls(T.documentId,T.attachmentId)))}),m=be(m),m.eventBulk.events.length>0){var h=be(m.newestRow).document;m.eventBulk.checkpoint={id:h[this.primaryPath],lwt:h._meta.lwt},m.eventBulk.endTime=Ke(),this.changes$.next(m.eventBulk)}return l},t.findDocumentsById=async function(n,i){Zn(this);var a=await this.internals,l=[];return await a.dexieDb.transaction("r",a.dexieTable,async()=>{var f=await Ep(this.internals,n);f.forEach(m=>{m&&(!m._deleted||i)&&l.push(m)})}),l},t.query=function(n){return Zn(this),Op(this,n)},t.count=async function(n){if(n.queryPlan.selectorSatisfiedByIndex){var i=await nx(this,n);return{count:i,mode:"fast"}}else{var a=await Op(this,n);return{count:a.documents.length,mode:"slow"}}},t.changeStream=function(){return Zn(this),this.changes$.asObservable()},t.cleanup=async function(n){Zn(this);var i=await this.internals;return await i.dexieDb.transaction("rw",i.dexieTable,async()=>{var a=Ke()-n,l=await i.dexieTable.where("_meta.lwt").below(a).toArray(),f=[];l.forEach(m=>{m._deleted==="1"&&f.push(m[this.primaryPath])}),await i.dexieTable.bulkDelete(f)}),!0},t.getAttachmentData=async function(n,i,a){Zn(this);var l=await this.internals,f=ls(n,i);return await l.dexieDb.transaction("r",l.dexieAttachmentsTable,async()=>{var m=await l.dexieAttachmentsTable.get(f);if(m)return m.data;throw new Error("attachment missing documentId: "+n+" attachmentId: "+i)})},t.remove=async function(){Zn(this);var n=await this.internals;return await n.dexieTable.clear(),this.close()},t.close=function(){return this.closed?this.closed:(this.closed=(async()=>{this.changes$.complete(),await Jy(this.internals)})(),this.closed)},t.conflictResultionTasks=function(){return new ct},t.resolveConflictResultionTask=async function(n){},e}();async function ix(e,t,r){var n=Qy(t.databaseName,t.collectionName,r,t.schema),i=new sE(e,t.databaseName,t.collectionName,t.schema,n,t.options,r,t.devMode);return await qy(Ju,t,i),Promise.resolve(i)}function Zn(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var aE=function(){function e(r){this.name=Ju,this.rxdbVersion=Wo,this.settings=r}var t=e.prototype;return t.createStorageInstance=function(n){return iy(n),ix(this,n,this.settings)},e}();function ox(e={}){var t=new aE(e);return t}function Ap(e){return $y({name:e,storage:ox()})}function kp(e,t,r){return e.addCollections({[t]:{schema:JSON.parse(r)}}).then(n=>n[t])}function Tp(e,t){console.log(t);let r=e.upsert(JSON.parse(t));return console.log(r),r}function Ip(e,t){return e.findOne(t).exec()}var ht=class extends B{},Bt=class extends B{},Xt=class extends B{},Xu=class extends B{},Zu=class extends B{},Cp=class extends B{},el=class extends B{constructor(t,r,n,i){super(),this.id=t,this.name=r,this.eaten=n,this.last_eaten=i}},fs=class extends B{constructor(t){super(),this[0]=t}},tl=class extends B{constructor(t){super(),this[0]=t}},rl=class extends B{constructor(t){super(),this[0]=t}},nl=class extends B{constructor(t){super(),this[0]=t}},il=class extends B{constructor(t){super(),this[0]=t}},ol=class extends B{constructor(t){super(),this[0]=t}},sl=class extends B{constructor(t){super(),this[0]=t}},al=class extends B{constructor(t){super(),this[0]=t}},ul=class extends B{},ps=class extends B{constructor(t){super(),this[0]=t}},ms=class extends B{constructor(t){super(),this[0]=t}},ds=class extends B{constructor(t){super(),this[0]=t}},hs=class extends B{constructor(t){super(),this[0]=t}},Mp=class extends B{},Dp=class extends B{constructor(t,r,n,i,a,l){super(),this.meals=t,this.new_meal=r,this.language=n,this.language_dropdown_open=i,this.db=a,this.collection=l}},ll=class extends B{constructor(t,r){super(),this.meals=t,this.language=r}},cl=class extends B{},Pp=class extends B{};function lE(e){return _a(k([["id",Pn(e.id)],["name",Pn(e.name)],["eaten",Rc(e.eaten)],["last_eaten",(()=>{let t=e.last_eaten;if(t instanceof de){let r=t[0];return ha(Tc(r))}else return Hd()})()]]))}function cE(e){return Pn(e instanceof ht?"en":e instanceof Bt?"sv":e instanceof Xt?"fr":e instanceof Xu?"de":e instanceof Zu?"it":"nl")}function fE(){let e=Co(t=>{let r=(()=>{let n=Ap("everyday_meals"),i=xi(n,a=>t(new J(a)));return vi(i,a=>t(new se(Tt(a))))})()});return Mo(e,t=>new ps(t))}function pE(){return Dn("id",ma,e=>Dn("name",ma,t=>Dn("eaten",jd,r=>Dn("last_eaten",Fd(Mc(Kd,i=>yi(Td(i)))),n=>yi(new el(e,t,r,n))))))}function mE(){return Mc(ma,t=>t==="en"?yi(new ht):t==="sv"?yi(new Bt):Bd(new ht,"Language not supported"))}function dE(){return Dn("meals",Ud(pE()),e=>Dn("language",mE(),t=>yi(new ll(e,t))))}function hE(e){let t=Co(r=>{let n=(()=>{let i=Ip(e,"current"),a=xi(i,l=>{let f=Ld(l,dE());if(f.isOk()){let m=f[0];return r(new J(m))}else return r(new se(Tt(f)))});return vi(a,l=>r(new se(Tt(l))))})()});return Mo(t,r=>new ds(r))}function ei(e){qt("save_state");let t=e.collection;if(t instanceof Ee)return pt();{let r=t[0];qt("save_state: collection");let n=(()=>{let a=_a(k([["id",Pn("current")],["meals",Lc(e.meals,lE)],["language",cE(e.language)]]));return Vd(a)})(),i=Co(a=>{let l=(()=>{let f=Tp(r,n),m=xi(f,h=>a(new J(void 0)));return vi(m,h=>(qt("save_state: error"),qt(Tt(h)),a(new se(Tt(h)))))})()});return Mo(i,a=>new hs(a))}}function sx(e,t,r){let n=Dm(e,[k([]),e],(l,f)=>f.id===t?new Gs(l):new mi([me(f,l[0]),Qs(l[1],1)])),i=n[0],a=n[1];if(a.hasLength(0))return e;{let l=a.head,f=a.tail,m=rt(i);if(r instanceof cl){if(m.hasLength(0))return e;{let h=m.head,g=m.tail;return kt(g,me(l,me(h,f)))}}else{if(f.hasLength(0))return e;{let h=f.head,g=f.tail;return kt(m,me(h,me(l,g)))}}}}function cs(e,t){return e instanceof ht&&t==="title"?"Everyday Meals":e instanceof ht&&t==="add_meal"?"Add Meal":e instanceof ht&&t==="enter_meal"?"Enter a new meal":e instanceof ht&&t==="eat"?"Eat":e instanceof ht&&t==="plan"?"Plan":e instanceof ht&&t==="eaten_meals"?"Eaten Meals":e instanceof ht&&t==="select_language"?"Select Language":e instanceof Bt&&t==="title"?"Vardagsmat":e instanceof Bt&&t==="add_meal"?"L\xE4gg till M\xE5ltid":e instanceof Bt&&t==="enter_meal"?"Ange en ny m\xE5ltid":e instanceof Bt&&t==="eat"?"\xC4t":e instanceof Bt&&t==="plan"?"Planera":e instanceof Bt&&t==="eaten_meals"?"\xC4tna M\xE5ltider":e instanceof Bt&&t==="select_language"?"V\xE4lj Spr\xE5k":e instanceof Xt&&t==="title"?"Suivi des Repas Hebdomadaires":e instanceof Xt&&t==="add_meal"?"Ajouter un Repas":e instanceof Xt&&t==="enter_meal"?"Entrez un nouveau repas":e instanceof Xt&&t==="eat"?"Manger":e instanceof Xt&&t==="plan"?"Pr\xE9voir":e instanceof Xt&&t==="eaten_meals"?"Repas Mang\xE9s":e instanceof Xt&&t==="select_language"?"Choisir la Langue":"Translation missing"}function Xi(e,t,r){return rn(k([Ir(new nl(t)),Oe("block px-4 py-2 text-sm capitalize text-gray-700 hover:bg-gray-100 w-full text-left "+(Me(t,r)?"bg-gray-100":""))]),k([st(e)]))}function _E(e){return je(k([]),k([e.language_dropdown_open?je(k([Oe("fixed inset-0 z-20"),Ir(new Mp)]),k([])):No(),rn(k([Ir(new ul),Oe("p-2 text-gray-600 hover:text-blue-500"),Ro("Select Language")]),k([yh(k([]))])),e.language_dropdown_open?je(k([Oe("absolute right-0 mt-2 py-2 w-48 bg-white rounded-md shadow-xl z-30 border")]),k([Xi("English",new ht,e.language),Xi("Svenska",new Bt,e.language),Xi("Fran\xE7ais",new Xt,e.language),Xi("Deutsch",new Xu,e.language),Xi("Italiano",new Zu,e.language),Xi("Nederlands",new Cp,e.language)])):No()]))}function gE(e){return Md(e)}function yE(e,t,r,n){let i=(()=>{if(t===0)return"Today";{let a=t,l=pa(),f=Id(l,hd(a)),m=Dd(f);return Cd(m)}})();return je(k([Oe("flex items-center")]),k([je(k([Oe("w-12 text-sm text-gray-500 text-right pr-2")]),k([st(i)])),fh(k([Oe("p-2 border rounded flex-1")]),k([je(k([Oe("flex justify-between items-center w-full")]),k([je(k([Oe("flex flex-col gap-0")]),k([st(e.name),Gc(k([Oe("text-xs text-gray-500")]),k([st((()=>{let a=e.last_eaten;if(a instanceof de){let l=a[0];return gE(l)}else return"Never eaten"})())]))])),je(k([Oe("flex items-center gap-1")]),k([r?No():je(k([Oe("flex items-center gap-1")]),k([rn(k([Ir(new sl(e.id)),Oe("p-1 text-gray-500 hover:text-blue-500"),Ro("Move up")]),k([st("\u2B06\uFE0F")])),rn(k([Ir(new al(e.id)),Oe("p-1 text-gray-500 hover:text-blue-500"),Ro("Move down")]),k([st("\u2B07\uFE0F")]))])),rn(k([Ir(new rl(e.id)),Oe(r?"px-3 py-1 border border-gray-300 rounded":"px-3 py-1 bg-green-500 text-white rounded")]),k([st(cs(n,r?"plan":"eat"))])),rn(k([Ir(new ol(e.id)),Oe("p-1 text-gray-500 hover:text-red-500"),Ro("Delete meal")]),k([Gc(k([Oe("text-xl")]),k([st("\u{1F5D1}\uFE0F")]))]))]))]))]))]))}function ax(e,t,r){return ph(k([Oe("space-y-2")]),Ys(e,(n,i)=>yE(n,i,t,r)))}function xE(e){let t=Sr(e.meals,n=>!n.eaten),r=Sr(e.meals,n=>n.eaten);return je(k([]),k([je(k([Oe("bg-white border-b shadow-sm")]),k([je(k([Oe("max-w-md mx-auto px-4 py-3 flex justify-between items-center")]),k([lh(k([Oe("text-2xl font-bold")]),k([st("\u{1F958} "+cs(e.language,"title"))])),_E(e)]))])),je(k([Oe("max-w-md mx-auto p-4")]),k([je(k([Oe("flex mb-4")]),k([je(k([Oe("w-16")]),k([])),je(k([Oe("flex-1")]),k([je(k([Oe("flex gap-2")]),k([mh(k([Zd("text"),eh(e.new_meal),th(cs(e.language,"enter_meal")),hh(n=>new tl(n)),dh(n=>new il(n)),Oe("flex-1 p-2 border rounded")])),rn(k([Ir(new fs(e.new_meal)),Oe("px-4 py-2 bg-blue-500 text-white rounded")]),k([st(cs(e.language,"add_meal"))]))]))]))])),ax(t,!1,e.language),r.hasLength(0)?No():je(k([]),k([ch(k([Oe("text-lg font-semibold mt-6 mb-2")]),k([st(cs(e.language,"eaten_meals"))])),ax(r,!0,e.language)]))]))]))}var vE=`{
  "version": 0,
  "primaryKey": "id",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "maxLength": 100
    },
    "meals": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "eaten": { "type": "boolean" },
          "lastEaten": { "type": "number", "optional": true }
        }
      }
    },
    "language": { "type": "string" }
  }
}`;function wE(e){let t=Co(r=>{let n=(()=>{let i=kp(e,"state",vE),a=xi(i,l=>r(new J(l)));return vi(a,l=>r(new se(Tt(l))))})()});return Mo(t,r=>new ms(r))}function $E(e,t){for(;;){let r=e,n=t;if(n instanceof ps&&n[0].isOk()){let i=n[0][0];return[r.withFields({db:new de(i)}),wE(i)]}else if(n instanceof ps&&!n[0].isOk()){let i=n[0][0];return[r,pt()]}else if(n instanceof ms&&n[0].isOk()){let i=n[0][0];return[r.withFields({collection:new de(i)}),hE(i)]}else if(n instanceof ms&&!n[0].isOk()){let i=n[0][0];return qt(i),[r,pt()]}else if(n instanceof ds&&n[0].isOk()&&n[0][0]instanceof ll){let i=n[0][0].meals,a=n[0][0].language;return qt("StateLoaded: Ok"),qt(Tt(i)),[r.withFields({meals:i,language:a}),pt()]}else if(n instanceof ds&&!n[0].isOk()){let i=n[0][0];return qt(i),[r,pt()]}else{if(n instanceof hs&&n[0].isOk()&&!n[0][0])return qt("StateSaved: Ok"),[r,pt()];if(n instanceof hs&&!n[0].isOk()){let i=n[0][0];return qt(i),[r,pt()]}else if(n instanceof fs){let i=n[0];if(uc(i)==="")return[r,pt()];{let l=new el(Tt(Tc(pa())),i,!1,new Ee),f=r.withFields({meals:kt(r.meals,k([l])),new_meal:""});return[f,ei(f)]}}else if(n instanceof tl){let i=n[0];return[r.withFields({new_meal:i}),pt()]}else if(n instanceof rl){let i=n[0],a=pa(),l=Qe(r.meals,h=>h.id===i?h.withFields({eaten:!h.eaten,last_eaten:h.eaten?h.last_eaten:new de(a)}):h),f=(()=>{let h=Sr(l,g=>!g.eaten);return Cm(h)})();if(f<7){let h=7-f,g=Sr(l,C=>C.eaten),v=Sr(l,C=>!C.eaten),O=(()=>{let G=Mm(g,h);return Qe(G,X=>X.withFields({eaten:!1}))})(),E=Qs(g,h),T=(()=>{let C=kt(v,O);return kt(C,E)})();return[r.withFields({meals:T}),ei(r)]}else return[r.withFields({meals:l}),ei(r)]}else if(n instanceof nl){let i=n[0];return[r.withFields({language:i,language_dropdown_open:!1}),ei(r)]}else if(n instanceof il)if(n[0]==="Enter")e=r,t=new fs(r.new_meal);else return[r,pt()];else if(n instanceof ol){let i=n[0],a=Sr(r.meals,f=>f.id!==i),l=r.withFields({meals:a});return[l,ei(l)]}else if(n instanceof sl){let i=n[0],a=sx(r.meals,i,new cl),l=r.withFields({meals:a});return[l,ei(l)]}else if(n instanceof al){let i=n[0],a=sx(r.meals,i,new Pp),l=r.withFields({meals:a});return[l,ei(l)]}else return n instanceof ul?[r.withFields({language_dropdown_open:!r.language_dropdown_open}),pt()]:[r.withFields({language_dropdown_open:!1}),pt()]}}}function ux(){let t=ah(n=>[new Dp(k([]),"",new ht,!1,new Ee,new Ee),fE()],$E,xE),r=uh(t,"#app",void 0);if(!r.isOk())throw Sn("let_assert","everyday_meals",725,"main","Pattern match failed, no pattern matched the value.",{value:r})}ux();
/*! Bundled license information:

dexie/dist/dexie.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
