var wv=Object.create;var fm=Object.defineProperty;var $v=Object.getOwnPropertyDescriptor;var bv=Object.getOwnPropertyNames;var Ev=Object.getPrototypeOf,Ov=Object.prototype.hasOwnProperty;var Sv=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Av=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of bv(t))!Ov.call(e,i)&&i!==r&&fm(e,i,{get:()=>t[i],enumerable:!(n=$v(t,i))||n.enumerable});return e};var kv=(e,t,r)=>(r=e!=null?wv(Ev(e)):{},Av(t||!e||!e.__esModule?fm(r,"default",{value:e,enumerable:!0}):r,e));var Cy=Sv((lp,cp)=>{(function(e,t){typeof lp=="object"&&typeof cp<"u"?cp.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.Dexie=t())})(lp,function(){"use strict";var e=function(o,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,c){u.__proto__=c}||function(u,c){for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(u[p]=c[p])},e(o,s)};function t(o,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");e(o,s);function u(){this.constructor=o}o.prototype=s===null?Object.create(s):(u.prototype=s.prototype,new u)}var r=function(){return r=Object.assign||function(s){for(var u,c=1,p=arguments.length;c<p;c++){u=arguments[c];for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(s[d]=u[d])}return s},r.apply(this,arguments)};function n(o,s,u){if(u||arguments.length===2)for(var c=0,p=s.length,d;c<p;c++)(d||!(c in s))&&(d||(d=Array.prototype.slice.call(s,0,c)),d[c]=s[c]);return o.concat(d||Array.prototype.slice.call(s))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,a=Object.keys,l=Array.isArray;typeof Promise<"u"&&!i.Promise&&(i.Promise=Promise);function f(o,s){return typeof s!="object"||a(s).forEach(function(u){o[u]=s[u]}),o}var m=Object.getPrototypeOf,h={}.hasOwnProperty;function g(o,s){return h.call(o,s)}function v(o,s){typeof s=="function"&&(s=s(m(o))),(typeof Reflect>"u"?a:Reflect.ownKeys)(s).forEach(function(u){E(o,u,s[u])})}var O=Object.defineProperty;function E(o,s,u,c){O(o,s,f(u&&g(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},c))}function k(o){return{from:function(s){return o.prototype=Object.create(s.prototype),E(o.prototype,"constructor",o),{extend:v.bind(null,o.prototype)}}}}var C=Object.getOwnPropertyDescriptor;function G(o,s){var u=C(o,s),c;return u||(c=m(o))&&G(c,s)}var J=[].slice;function Q(o,s,u){return J.call(o,s,u)}function K(o,s){return s(o)}function ne(o){if(!o)throw new Error("Assertion Failed")}function X(o){i.setImmediate?setImmediate(o):setTimeout(o,0)}function fe(o,s){return o.reduce(function(u,c,p){var d=s(c,p);return d&&(u[d[0]]=d[1]),u},{})}function le(o,s){if(typeof s=="string"&&g(o,s))return o[s];if(!s)return o;if(typeof s!="string"){for(var u=[],c=0,p=s.length;c<p;++c){var d=le(o,s[c]);u.push(d)}return u}var _=s.indexOf(".");if(_!==-1){var y=o[s.substr(0,_)];return y==null?void 0:le(y,s.substr(_+1))}}function pe(o,s,u){if(!(!o||s===void 0)&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof s!="string"&&"length"in s){ne(typeof u!="string"&&"length"in u);for(var c=0,p=s.length;c<p;++c)pe(o,s[c],u[c])}else{var d=s.indexOf(".");if(d!==-1){var _=s.substr(0,d),y=s.substr(d+1);if(y==="")u===void 0?l(o)&&!isNaN(parseInt(_))?o.splice(_,1):delete o[_]:o[_]=u;else{var x=o[_];(!x||!g(o,_))&&(x=o[_]={}),pe(x,y,u)}}else u===void 0?l(o)&&!isNaN(parseInt(s))?o.splice(s,1):delete o[s]:o[s]=u}}function ze(o,s){typeof s=="string"?pe(o,s,void 0):"length"in s&&[].map.call(s,function(u){pe(o,u,void 0)})}function Et(o){var s={};for(var u in o)g(o,u)&&(s[u]=o[u]);return s}var pn=[].concat;function Xt(o){return pn.apply([],o)}var tt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Xt([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(s){return s+o+"Array"})}))).filter(function(o){return i[o]}),Xi=new Set(tt.map(function(o){return i[o]}));function ms(o){var s={};for(var u in o)if(g(o,u)){var c=o[u];s[u]=!c||typeof c!="object"||Xi.has(c.constructor)?c:ms(c)}return s}function rl(o){for(var s in o)if(g(o,s))return!1;return!0}var mn=null;function Ot(o){mn=new WeakMap;var s=Br(o);return mn=null,s}function Br(o){if(!o||typeof o!="object")return o;var s=mn.get(o);if(s)return s;if(l(o)){s=[],mn.set(o,s);for(var u=0,c=o.length;u<c;++u)s.push(Br(o[u]))}else if(Xi.has(o.constructor))s=o;else{var p=m(o);s=p===Object.prototype?{}:Object.create(p),mn.set(o,s);for(var d in o)g(o,d)&&(s[d]=Br(o[d]))}return s}var Zi={}.toString;function jr(o){return Zi.call(o).slice(8,-1)}var eo=typeof Symbol<"u"?Symbol.iterator:"@@iterator",rt=typeof eo=="symbol"?function(o){var s;return o!=null&&(s=o[eo])&&s.apply(o)}:function(){return null};function Be(o,s){var u=o.indexOf(s);return u>=0&&o.splice(u,1),u>=0}var Bt={};function jt(o){var s,u,c,p;if(arguments.length===1){if(l(o))return o.slice();if(this===Bt&&typeof o=="string")return[o];if(p=rt(o)){for(u=[];c=p.next(),!c.done;)u.push(c.value);return u}if(o==null)return[o];if(s=o.length,typeof s=="number"){for(u=new Array(s);s--;)u[s]=o[s];return u}return[o]}for(s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return u}var nl=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Gy=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Sp=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],il=Gy.concat(Sp),Yy={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Zn(o,s){this.name=o,this.message=s}k(Zn).from(Error).extend({toString:function(){return this.name+": "+this.message}});function Ap(o,s){return o+". Errors: "+Object.keys(s).map(function(u){return s[u].toString()}).filter(function(u,c,p){return p.indexOf(u)===c}).join(`
`)}function ds(o,s,u,c){this.failures=s,this.failedKeys=c,this.successCount=u,this.message=Ap(o,s)}k(ds).from(Zn);function ei(o,s){this.name="BulkError",this.failures=Object.keys(s).map(function(u){return s[u]}),this.failuresByPos=s,this.message=Ap(o,this.failures)}k(ei).from(Zn);var ol=il.reduce(function(o,s){return o[s]=s+"Error",o},{}),Qy=Zn,ie=il.reduce(function(o,s){var u=s+"Error";function c(p,d){this.name=u,p?typeof p=="string"?(this.message="".concat(p).concat(d?`
 `+d:""),this.inner=d||null):typeof p=="object"&&(this.message="".concat(p.name," ").concat(p.message),this.inner=p):(this.message=Yy[s]||u,this.inner=null)}return k(c).from(Qy),o[s]=c,o},{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var kp=Sp.reduce(function(o,s){return o[s+"Error"]=ie[s],o},{});function Jy(o,s){if(!o||o instanceof Zn||o instanceof TypeError||o instanceof SyntaxError||!o.name||!kp[o.name])return o;var u=new kp[o.name](s||o.message,o);return"stack"in o&&E(u,"stack",{get:function(){return this.inner.stack}}),u}var hs=il.reduce(function(o,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(o[s+"Error"]=ie[s]),o},{});hs.ModifyError=ds,hs.DexieError=Zn,hs.BulkError=ei;function Se(){}function to(o){return o}function Xy(o,s){return o==null||o===to?s:function(u){return s(o(u))}}function dn(o,s){return function(){o.apply(this,arguments),s.apply(this,arguments)}}function Zy(o,s){return o===Se?s:function(){var u=o.apply(this,arguments);u!==void 0&&(arguments[0]=u);var c=this.onsuccess,p=this.onerror;this.onsuccess=null,this.onerror=null;var d=s.apply(this,arguments);return c&&(this.onsuccess=this.onsuccess?dn(c,this.onsuccess):c),p&&(this.onerror=this.onerror?dn(p,this.onerror):p),d!==void 0?d:u}}function ex(o,s){return o===Se?s:function(){o.apply(this,arguments);var u=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?dn(u,this.onsuccess):u),c&&(this.onerror=this.onerror?dn(c,this.onerror):c)}}function tx(o,s){return o===Se?s:function(u){var c=o.apply(this,arguments);f(u,c);var p=this.onsuccess,d=this.onerror;this.onsuccess=null,this.onerror=null;var _=s.apply(this,arguments);return p&&(this.onsuccess=this.onsuccess?dn(p,this.onsuccess):p),d&&(this.onerror=this.onerror?dn(d,this.onerror):d),c===void 0?_===void 0?void 0:_:f(c,_)}}function rx(o,s){return o===Se?s:function(){return s.apply(this,arguments)===!1?!1:o.apply(this,arguments)}}function sl(o,s){return o===Se?s:function(){var u=o.apply(this,arguments);if(u&&typeof u.then=="function"){for(var c=this,p=arguments.length,d=new Array(p);p--;)d[p]=arguments[p];return u.then(function(){return s.apply(c,d)})}return s.apply(this,arguments)}}var Zt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Tp(o,s){Zt=o}var ro={},Ip=100,al=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,m(o),o];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,m(s),o]}(),Cp=al[0],Mp=al[1],nx=al[2],ix=Mp&&Mp.then,hn=Cp&&Cp.constructor,ul=!!nx;function ox(){queueMicrotask(ax)}var no=function(o,s){io.push([o,s]),_s&&(ox(),_s=!1)},ll=!0,_s=!0,_n=[],gs=[],cl=to,Kr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Se,pgp:!1,env:{},finalize:Se},Z=Kr,io=[],gn=0,ys=[];function q(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Z;if(typeof o!="function"){if(o!==ro)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&pl(this,this._value);return}this._state=null,this._value=null,++s.ref,Pp(this,o)}var fl={get:function(){var o=Z,s=$s;function u(c,p){var d=this,_=!o.global&&(o!==Z||s!==$s),y=_&&!zr(),x=new q(function(w,S){ml(d,new Dp(Lp(c,o,_,y),Lp(p,o,_,y),w,S,o))});return this._consoleTask&&(x._consoleTask=this._consoleTask),x}return u.prototype=ro,u},set:function(o){E(this,"then",o&&o.prototype===ro?fl:{get:function(){return o},set:fl.set})}};v(q.prototype,{then:fl,_then:function(o,s){ml(this,new Dp(null,null,o,s,Z))},catch:function(o){if(arguments.length===1)return this.then(null,o);var s=arguments[0],u=arguments[1];return typeof s=="function"?this.then(null,function(c){return c instanceof s?u(c):xs(c)}):this.then(null,function(c){return c&&c.name===s?u(c):xs(c)})},finally:function(o){return this.then(function(s){return q.resolve(o()).then(function(){return s})},function(s){return q.resolve(o()).then(function(){return xs(s)})})},timeout:function(o,s){var u=this;return o<1/0?new q(function(c,p){var d=setTimeout(function(){return p(new ie.Timeout(s))},o);u.then(c,p).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&E(q.prototype,Symbol.toStringTag,"Dexie.Promise"),Kr.env=Np();function Dp(o,s,u,c,p){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof s=="function"?s:null,this.resolve=u,this.reject=c,this.psd=p}v(q,{all:function(){var o=jt.apply(null,arguments).map(bs);return new q(function(s,u){o.length===0&&s([]);var c=o.length;o.forEach(function(p,d){return q.resolve(p).then(function(_){o[d]=_,--c||s(o)},u)})})},resolve:function(o){if(o instanceof q)return o;if(o&&typeof o.then=="function")return new q(function(u,c){o.then(u,c)});var s=new q(ro,!0,o);return s},reject:xs,race:function(){var o=jt.apply(null,arguments).map(bs);return new q(function(s,u){o.map(function(c){return q.resolve(c).then(s,u)})})},PSD:{get:function(){return Z},set:function(o){return Z=o}},totalEchoes:{get:function(){return $s}},newPSD:Ur,usePSD:yn,scheduler:{get:function(){return no},set:function(o){no=o}},rejectionMapper:{get:function(){return cl},set:function(o){cl=o}},follow:function(o,s){return new q(function(u,c){return Ur(function(p,d){var _=Z;_.unhandleds=[],_.onunhandled=d,_.finalize=dn(function(){var y=this;ux(function(){y.unhandleds.length===0?p():d(y.unhandleds[0])})},_.finalize),o()},s,u,c)})}}),hn&&(hn.allSettled&&E(q,"allSettled",function(){var o=jt.apply(null,arguments).map(bs);return new q(function(s){o.length===0&&s([]);var u=o.length,c=new Array(u);o.forEach(function(p,d){return q.resolve(p).then(function(_){return c[d]={status:"fulfilled",value:_}},function(_){return c[d]={status:"rejected",reason:_}}).then(function(){return--u||s(c)})})})}),hn.any&&typeof AggregateError<"u"&&E(q,"any",function(){var o=jt.apply(null,arguments).map(bs);return new q(function(s,u){o.length===0&&u(new AggregateError([]));var c=o.length,p=new Array(c);o.forEach(function(d,_){return q.resolve(d).then(function(y){return s(y)},function(y){p[_]=y,--c||u(new AggregateError(p))})})})}),hn.withResolvers&&(q.withResolvers=hn.withResolvers));function Pp(o,s){try{s(function(u){if(o._state===null){if(u===o)throw new TypeError("A promise cannot be resolved with itself.");var c=o._lib&&ti();u&&typeof u.then=="function"?Pp(o,function(p,d){u instanceof q?u._then(p,d):u.then(p,d)}):(o._state=!0,o._value=u,Rp(o)),c&&ri()}},pl.bind(null,o))}catch(u){pl(o,u)}}function pl(o,s){if(gs.push(s),o._state===null){var u=o._lib&&ti();s=cl(s),o._state=!1,o._value=s,lx(o),Rp(o),u&&ri()}}function Rp(o){var s=o._listeners;o._listeners=[];for(var u=0,c=s.length;u<c;++u)ml(o,s[u]);var p=o._PSD;--p.ref||p.finalize(),gn===0&&(++gn,no(function(){--gn===0&&dl()},[]))}function ml(o,s){if(o._state===null){o._listeners.push(s);return}var u=o._state?s.onFulfilled:s.onRejected;if(u===null)return(o._state?s.resolve:s.reject)(o._value);++s.psd.ref,++gn,no(sx,[u,o,s])}function sx(o,s,u){try{var c,p=s._value;!s._state&&gs.length&&(gs=[]),c=Zt&&s._consoleTask?s._consoleTask.run(function(){return o(p)}):o(p),!s._state&&gs.indexOf(p)===-1&&cx(s),u.resolve(c)}catch(d){u.reject(d)}finally{--gn===0&&dl(),--u.psd.ref||u.psd.finalize()}}function ax(){yn(Kr,function(){ti()&&ri()})}function ti(){var o=ll;return ll=!1,_s=!1,o}function ri(){var o,s,u;do for(;io.length>0;)for(o=io,io=[],u=o.length,s=0;s<u;++s){var c=o[s];c[0].apply(null,c[1])}while(io.length>0);ll=!0,_s=!0}function dl(){var o=_n;_n=[],o.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)});for(var s=ys.slice(0),u=s.length;u;)s[--u]()}function ux(o){function s(){o(),ys.splice(ys.indexOf(s),1)}ys.push(s),++gn,no(function(){--gn===0&&dl()},[])}function lx(o){_n.some(function(s){return s._value===o._value})||_n.push(o)}function cx(o){for(var s=_n.length;s;)if(_n[--s]._value===o._value){_n.splice(s,1);return}}function xs(o){return new q(ro,!1,o)}function Ie(o,s){var u=Z;return function(){var c=ti(),p=Z;try{return Wr(u,!0),o.apply(this,arguments)}catch(d){s&&s(d)}finally{Wr(p,!1),c&&ri()}}}var We={awaits:0,echoes:0,id:0},fx=0,vs=[],ws=0,$s=0,px=0;function Ur(o,s,u,c){var p=Z,d=Object.create(p);d.parent=p,d.ref=0,d.global=!1,d.id=++px,Kr.env,d.env=ul?{Promise:q,PromiseProp:{value:q,configurable:!0,writable:!0},all:q.all,race:q.race,allSettled:q.allSettled,any:q.any,resolve:q.resolve,reject:q.reject}:{},s&&f(d,s),++p.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()};var _=yn(d,o,u,c);return d.ref===0&&d.finalize(),_}function ni(){return We.id||(We.id=++fx),++We.awaits,We.echoes+=Ip,We.id}function zr(){return We.awaits?(--We.awaits===0&&(We.id=0),We.echoes=We.awaits*Ip,!0):!1}(""+ix).indexOf("[native code]")===-1&&(ni=zr=Se);function bs(o){return We.echoes&&o&&o.constructor===hn?(ni(),o.then(function(s){return zr(),s},function(s){return zr(),Pe(s)})):o}function mx(o){++$s,(!We.echoes||--We.echoes===0)&&(We.echoes=We.awaits=We.id=0),vs.push(Z),Wr(o,!0)}function dx(){var o=vs[vs.length-1];vs.pop(),Wr(o,!1)}function Wr(o,s){var u=Z;if((s?We.echoes&&(!ws++||o!==Z):ws&&(!--ws||o!==Z))&&queueMicrotask(s?mx.bind(null,o):dx),o!==Z&&(Z=o,u===Kr&&(Kr.env=Np()),ul)){var c=Kr.env.Promise,p=o.env;(u.global||o.global)&&(Object.defineProperty(i,"Promise",p.PromiseProp),c.all=p.all,c.race=p.race,c.resolve=p.resolve,c.reject=p.reject,p.allSettled&&(c.allSettled=p.allSettled),p.any&&(c.any=p.any))}}function Np(){var o=i.Promise;return ul?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function yn(o,s,u,c,p){var d=Z;try{return Wr(o,!0),s(u,c,p)}finally{Wr(d,!1)}}function Lp(o,s,u,c){return typeof o!="function"?o:function(){var p=Z;u&&ni(),Wr(s,!0);try{return o.apply(this,arguments)}finally{Wr(p,!1),c&&queueMicrotask(zr)}}}function hl(o){Promise===hn&&We.echoes===0?ws===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}var Pe=q.reject;function _l(o,s,u,c){if(!o.idbdb||!o._state.openComplete&&!Z.letThrough&&!o._vip){if(o._state.openComplete)return Pe(new ie.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return Pe(new ie.DatabaseClosed);o.open().catch(Se)}return o._state.dbReadyPromise.then(function(){return _l(o,s,u,c)})}else{var p=o._createTransaction(s,u,o._dbSchema);try{p.create(),o._state.PR1398_maxLoop=3}catch(d){return d.name===ol.InvalidState&&o.isOpen()&&--o._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),o.close({disableAutoOpen:!1}),o.open().then(function(){return _l(o,s,u,c)})):Pe(d)}return p._promise(s,function(d,_){return Ur(function(){return Z.trans=p,c(d,_,p)})}).then(function(d){if(s==="readwrite")try{p.idbtrans.commit()}catch{}return s==="readonly"?d:p._completion.then(function(){return d})})}}var Fp="4.0.9",xn="\uFFFF",gl=-1/0,$r="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Bp="String expected.",ii=[],Es="__dbnames",yl="readonly",xl="readwrite";function vn(o,s){return o?s?function(){return o.apply(this,arguments)&&s.apply(this,arguments)}:o:s}var jp={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Os(o){return typeof o=="string"&&!/\./.test(o)?function(s){return s[o]===void 0&&o in s&&(s=Ot(s),delete s[o]),s}:function(s){return s}}function Kp(){throw ie.Type()}function ge(o,s){try{var u=Up(o),c=Up(s);if(u!==c)return u==="Array"?1:c==="Array"?-1:u==="binary"?1:c==="binary"?-1:u==="string"?1:c==="string"?-1:u==="Date"?1:c!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return o>s?1:o<s?-1:0;case"binary":return _x(zp(o),zp(s));case"Array":return hx(o,s)}}catch{}return NaN}function hx(o,s){for(var u=o.length,c=s.length,p=u<c?u:c,d=0;d<p;++d){var _=ge(o[d],s[d]);if(_!==0)return _}return u===c?0:u<c?-1:1}function _x(o,s){for(var u=o.length,c=s.length,p=u<c?u:c,d=0;d<p;++d)if(o[d]!==s[d])return o[d]<s[d]?-1:1;return u===c?0:u<c?-1:1}function Up(o){var s=typeof o;if(s!=="object")return s;if(ArrayBuffer.isView(o))return"binary";var u=jr(o);return u==="ArrayBuffer"?"binary":u}function zp(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var Wp=function(){function o(){}return o.prototype._trans=function(s,u,c){var p=this._tx||Z.trans,d=this.name,_=Zt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(s==="readonly"?"read":"write"," ").concat(this.name));function y(S,$,M){if(!M.schema[d])throw new ie.NotFound("Table "+d+" not part of transaction");return u(M.idbtrans,M)}var x=ti();try{var w=p&&p.db._novip===this.db._novip?p===Z.trans?p._promise(s,y,c):Ur(function(){return p._promise(s,y,c)},{trans:p,transless:Z.transless||Z}):_l(this.db,s,[this.name],y);return _&&(w._consoleTask=_,w=w.catch(function(S){return console.trace(S),Pe(S)})),w}finally{x&&ri()}},o.prototype.get=function(s,u){var c=this;return s&&s.constructor===Object?this.where(s).first(u):s==null?Pe(new ie.Type("Invalid argument to Table.get()")):this._trans("readonly",function(p){return c.core.get({trans:p,key:s}).then(function(d){return c.hook.reading.fire(d)})}).then(u)},o.prototype.where=function(s){if(typeof s=="string")return new this.db.WhereClause(this,s);if(l(s))return new this.db.WhereClause(this,"[".concat(s.join("+"),"]"));var u=a(s);if(u.length===1)return this.where(u[0]).equals(s[u[0]]);var c=this.schema.indexes.concat(this.schema.primKey).filter(function(S){if(S.compound&&u.every(function(M){return S.keyPath.indexOf(M)>=0})){for(var $=0;$<u.length;++$)if(u.indexOf(S.keyPath[$])===-1)return!1;return!0}return!1}).sort(function(S,$){return S.keyPath.length-$.keyPath.length})[0];if(c&&this.db._maxKey!==xn){var p=c.keyPath.slice(0,u.length);return this.where(p).equals(p.map(function(S){return s[S]}))}!c&&Zt&&console.warn("The query ".concat(JSON.stringify(s)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var d=this.schema.idxByName;function _(S,$){return ge(S,$)===0}var y=u.reduce(function(S,$){var M=S[0],j=S[1],b=d[$],A=s[$];return[M||b,M||!b?vn(j,b&&b.multi?function(T){var D=le(T,$);return l(D)&&D.some(function(N){return _(A,N)})}:function(T){return _(A,le(T,$))}):j]},[null,null]),x=y[0],w=y[1];return x?this.where(x.name).equals(s[x.keyPath]).filter(w):c?this.filter(w):this.where(u).equals("")},o.prototype.filter=function(s){return this.toCollection().and(s)},o.prototype.count=function(s){return this.toCollection().count(s)},o.prototype.offset=function(s){return this.toCollection().offset(s)},o.prototype.limit=function(s){return this.toCollection().limit(s)},o.prototype.each=function(s){return this.toCollection().each(s)},o.prototype.toArray=function(s){return this.toCollection().toArray(s)},o.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},o.prototype.orderBy=function(s){return new this.db.Collection(new this.db.WhereClause(this,l(s)?"[".concat(s.join("+"),"]"):s))},o.prototype.reverse=function(){return this.toCollection().reverse()},o.prototype.mapToClass=function(s){var u=this,c=u.db,p=u.name;this.schema.mappedClass=s,s.prototype instanceof Kp&&(s=function(x){t(w,x);function w(){return x!==null&&x.apply(this,arguments)||this}return Object.defineProperty(w.prototype,"db",{get:function(){return c},enumerable:!1,configurable:!0}),w.prototype.table=function(){return p},w}(s));for(var d=new Set,_=s.prototype;_;_=m(_))Object.getOwnPropertyNames(_).forEach(function(x){return d.add(x)});var y=function(x){if(!x)return x;var w=Object.create(s.prototype);for(var S in x)if(!d.has(S))try{w[S]=x[S]}catch{}return w};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=y,this.hook("reading",y),s},o.prototype.defineClass=function(){function s(u){f(this,u)}return this.mapToClass(s)},o.prototype.add=function(s,u){var c=this,p=this.schema.primKey,d=p.auto,_=p.keyPath,y=s;return _&&d&&(y=Os(_)(s)),this._trans("readwrite",function(x){return c.core.mutate({trans:x,type:"add",keys:u!=null?[u]:null,values:[y]})}).then(function(x){return x.numFailures?q.reject(x.failures[0]):x.lastResult}).then(function(x){if(_)try{pe(s,_,x)}catch{}return x})},o.prototype.update=function(s,u){if(typeof s=="object"&&!l(s)){var c=le(s,this.schema.primKey.keyPath);return c===void 0?Pe(new ie.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(u)}else return this.where(":id").equals(s).modify(u)},o.prototype.put=function(s,u){var c=this,p=this.schema.primKey,d=p.auto,_=p.keyPath,y=s;return _&&d&&(y=Os(_)(s)),this._trans("readwrite",function(x){return c.core.mutate({trans:x,type:"put",values:[y],keys:u!=null?[u]:null})}).then(function(x){return x.numFailures?q.reject(x.failures[0]):x.lastResult}).then(function(x){if(_)try{pe(s,_,x)}catch{}return x})},o.prototype.delete=function(s){var u=this;return this._trans("readwrite",function(c){return u.core.mutate({trans:c,type:"delete",keys:[s]})}).then(function(c){return c.numFailures?q.reject(c.failures[0]):void 0})},o.prototype.clear=function(){var s=this;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"deleteRange",range:jp})}).then(function(u){return u.numFailures?q.reject(u.failures[0]):void 0})},o.prototype.bulkGet=function(s){var u=this;return this._trans("readonly",function(c){return u.core.getMany({keys:s,trans:c}).then(function(p){return p.map(function(d){return u.hook.reading.fire(d)})})})},o.prototype.bulkAdd=function(s,u,c){var p=this,d=Array.isArray(u)?u:void 0;c=c||(d?void 0:u);var _=c?c.allKeys:void 0;return this._trans("readwrite",function(y){var x=p.schema.primKey,w=x.auto,S=x.keyPath;if(S&&d)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(d&&d.length!==s.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var $=s.length,M=S&&w?s.map(Os(S)):s;return p.core.mutate({trans:y,type:"add",keys:d,values:M,wantResults:_}).then(function(j){var b=j.numFailures,A=j.results,T=j.lastResult,D=j.failures,N=_?A:T;if(b===0)return N;throw new ei("".concat(p.name,".bulkAdd(): ").concat(b," of ").concat($," operations failed"),D)})})},o.prototype.bulkPut=function(s,u,c){var p=this,d=Array.isArray(u)?u:void 0;c=c||(d?void 0:u);var _=c?c.allKeys:void 0;return this._trans("readwrite",function(y){var x=p.schema.primKey,w=x.auto,S=x.keyPath;if(S&&d)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(d&&d.length!==s.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var $=s.length,M=S&&w?s.map(Os(S)):s;return p.core.mutate({trans:y,type:"put",keys:d,values:M,wantResults:_}).then(function(j){var b=j.numFailures,A=j.results,T=j.lastResult,D=j.failures,N=_?A:T;if(b===0)return N;throw new ei("".concat(p.name,".bulkPut(): ").concat(b," of ").concat($," operations failed"),D)})})},o.prototype.bulkUpdate=function(s){var u=this,c=this.core,p=s.map(function(y){return y.key}),d=s.map(function(y){return y.changes}),_=[];return this._trans("readwrite",function(y){return c.getMany({trans:y,keys:p,cache:"clone"}).then(function(x){var w=[],S=[];s.forEach(function(M,j){var b=M.key,A=M.changes,T=x[j];if(T){for(var D=0,N=Object.keys(A);D<N.length;D++){var L=N[D],F=A[L];if(L===u.schema.primKey.keyPath){if(ge(F,b)!==0)throw new ie.Constraint("Cannot update primary key in bulkUpdate()")}else pe(T,L,F)}_.push(j),w.push(b),S.push(T)}});var $=w.length;return c.mutate({trans:y,type:"put",keys:w,values:S,updates:{keys:p,changeSpecs:d}}).then(function(M){var j=M.numFailures,b=M.failures;if(j===0)return $;for(var A=0,T=Object.keys(b);A<T.length;A++){var D=T[A],N=_[Number(D)];if(N!=null){var L=b[D];delete b[D],b[N]=L}}throw new ei("".concat(u.name,".bulkUpdate(): ").concat(j," of ").concat($," operations failed"),b)})})})},o.prototype.bulkDelete=function(s){var u=this,c=s.length;return this._trans("readwrite",function(p){return u.core.mutate({trans:p,type:"delete",keys:s})}).then(function(p){var d=p.numFailures,_=p.lastResult,y=p.failures;if(d===0)return _;throw new ei("".concat(u.name,".bulkDelete(): ").concat(d," of ").concat(c," operations failed"),y)})},o}();function oo(o){var s={},u=function(y,x){if(x){for(var w=arguments.length,S=new Array(w-1);--w;)S[w-1]=arguments[w];return s[y].subscribe.apply(null,S),o}else if(typeof y=="string")return s[y]};u.addEventType=d;for(var c=1,p=arguments.length;c<p;++c)d(arguments[c]);return u;function d(y,x,w){if(typeof y=="object")return _(y);x||(x=rx),w||(w=Se);var S={subscribers:[],fire:w,subscribe:function($){S.subscribers.indexOf($)===-1&&(S.subscribers.push($),S.fire=x(S.fire,$))},unsubscribe:function($){S.subscribers=S.subscribers.filter(function(M){return M!==$}),S.fire=S.subscribers.reduce(x,w)}};return s[y]=u[y]=S,S}function _(y){a(y).forEach(function(x){var w=y[x];if(l(w))d(x,y[x][0],y[x][1]);else if(w==="asap")var S=d(x,to,function(){for(var M=arguments.length,j=new Array(M);M--;)j[M]=arguments[M];S.subscribers.forEach(function(b){X(function(){b.apply(null,j)})})});else throw new ie.InvalidArgument("Invalid event config")})}}function so(o,s){return k(s).from({prototype:o}),s}function gx(o){return so(Wp.prototype,function(u,c,p){this.db=o,this._tx=p,this.name=u,this.schema=c,this.hook=o._allTables[u]?o._allTables[u].hook:oo(null,{creating:[Zy,Se],reading:[Xy,to],updating:[tx,Se],deleting:[ex,Se]})})}function oi(o,s){return!(o.filter||o.algorithm||o.or)&&(s?o.justLimit:!o.replayFilter)}function vl(o,s){o.filter=vn(o.filter,s)}function wl(o,s,u){var c=o.replayFilter;o.replayFilter=c?function(){return vn(c(),s())}:s,o.justLimit=u&&!c}function yx(o,s){o.isMatch=vn(o.isMatch,s)}function Ss(o,s){if(o.isPrimKey)return s.primaryKey;var u=s.getIndexByKeyPath(o.index);if(!u)throw new ie.Schema("KeyPath "+o.index+" on object store "+s.name+" is not indexed");return u}function qp(o,s,u){var c=Ss(o,s.schema);return s.openCursor({trans:u,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:c,range:o.range}})}function As(o,s,u,c){var p=o.replayFilter?vn(o.filter,o.replayFilter()):o.filter;if(o.or){var d={},_=function(y,x,w){if(!p||p(x,w,function(M){return x.stop(M)},function(M){return x.fail(M)})){var S=x.primaryKey,$=""+S;$==="[object ArrayBuffer]"&&($=""+new Uint8Array(S)),g(d,$)||(d[$]=!0,s(y,x,w))}};return Promise.all([o.or._iterate(_,u),Vp(qp(o,c,u),o.algorithm,_,!o.keysOnly&&o.valueMapper)])}else return Vp(qp(o,c,u),vn(o.algorithm,p),s,!o.keysOnly&&o.valueMapper)}function Vp(o,s,u,c){var p=c?function(_,y,x){return u(c(_),y,x)}:u,d=Ie(p);return o.then(function(_){if(_)return _.start(function(){var y=function(){return _.continue()};(!s||s(_,function(x){return y=x},function(x){_.stop(x),y=Se},function(x){_.fail(x),y=Se}))&&d(_.value,_,function(x){return y=x}),y()})})}var xx=Symbol(),ao=function(){function o(s){Object.assign(this,s)}return o.prototype.execute=function(s){var u;if(this.add!==void 0){var c=this.add;if(l(c))return n(n([],l(s)?s:[],!0),c,!0).sort();if(typeof c=="number")return(Number(s)||0)+c;if(typeof c=="bigint")try{return BigInt(s)+c}catch{return BigInt(0)+c}throw new TypeError("Invalid term ".concat(c))}if(this.remove!==void 0){var p=this.remove;if(l(p))return l(s)?s.filter(function(_){return!p.includes(_)}).sort():[];if(typeof p=="number")return Number(s)-p;if(typeof p=="bigint")try{return BigInt(s)-p}catch{return BigInt(0)-p}throw new TypeError("Invalid subtrahend ".concat(p))}var d=(u=this.replacePrefix)===null||u===void 0?void 0:u[0];return d&&typeof s=="string"&&s.startsWith(d)?this.replacePrefix[1]+s.substring(d.length):s},o}(),vx=function(){function o(){}return o.prototype._read=function(s,u){var c=this._ctx;return c.error?c.table._trans(null,Pe.bind(null,c.error)):c.table._trans("readonly",s).then(u)},o.prototype._write=function(s){var u=this._ctx;return u.error?u.table._trans(null,Pe.bind(null,u.error)):u.table._trans("readwrite",s,"locked")},o.prototype._addAlgorithm=function(s){var u=this._ctx;u.algorithm=vn(u.algorithm,s)},o.prototype._iterate=function(s,u){return As(this._ctx,s,u,this._ctx.table.core)},o.prototype.clone=function(s){var u=Object.create(this.constructor.prototype),c=Object.create(this._ctx);return s&&f(c,s),u._ctx=c,u},o.prototype.raw=function(){return this._ctx.valueMapper=null,this},o.prototype.each=function(s){var u=this._ctx;return this._read(function(c){return As(u,s,c,u.table.core)})},o.prototype.count=function(s){var u=this;return this._read(function(c){var p=u._ctx,d=p.table.core;if(oi(p,!0))return d.count({trans:c,query:{index:Ss(p,d.schema),range:p.range}}).then(function(y){return Math.min(y,p.limit)});var _=0;return As(p,function(){return++_,!1},c,d).then(function(){return _})}).then(s)},o.prototype.sortBy=function(s,u){var c=s.split(".").reverse(),p=c[0],d=c.length-1;function _(w,S){return S?_(w[c[S]],S-1):w[p]}var y=this._ctx.dir==="next"?1:-1;function x(w,S){var $=_(w,d),M=_(S,d);return ge($,M)*y}return this.toArray(function(w){return w.sort(x)}).then(u)},o.prototype.toArray=function(s){var u=this;return this._read(function(c){var p=u._ctx;if(p.dir==="next"&&oi(p,!0)&&p.limit>0){var d=p.valueMapper,_=Ss(p,p.table.core.schema);return p.table.core.query({trans:c,limit:p.limit,values:!0,query:{index:_,range:p.range}}).then(function(x){var w=x.result;return d?w.map(d):w})}else{var y=[];return As(p,function(x){return y.push(x)},c,p.table.core).then(function(){return y})}},s)},o.prototype.offset=function(s){var u=this._ctx;return s<=0?this:(u.offset+=s,oi(u)?wl(u,function(){var c=s;return function(p,d){return c===0?!0:c===1?(--c,!1):(d(function(){p.advance(c),c=0}),!1)}}):wl(u,function(){var c=s;return function(){return--c<0}}),this)},o.prototype.limit=function(s){return this._ctx.limit=Math.min(this._ctx.limit,s),wl(this._ctx,function(){var u=s;return function(c,p,d){return--u<=0&&p(d),u>=0}},!0),this},o.prototype.until=function(s,u){return vl(this._ctx,function(c,p,d){return s(c.value)?(p(d),u):!0}),this},o.prototype.first=function(s){return this.limit(1).toArray(function(u){return u[0]}).then(s)},o.prototype.last=function(s){return this.reverse().first(s)},o.prototype.filter=function(s){return vl(this._ctx,function(u){return s(u.value)}),yx(this._ctx,s),this},o.prototype.and=function(s){return this.filter(s)},o.prototype.or=function(s){return new this.db.WhereClause(this._ctx.table,s,this)},o.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},o.prototype.desc=function(){return this.reverse()},o.prototype.eachKey=function(s){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(c,p){s(p.key,p)})},o.prototype.eachUniqueKey=function(s){return this._ctx.unique="unique",this.eachKey(s)},o.prototype.eachPrimaryKey=function(s){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(c,p){s(p.primaryKey,p)})},o.prototype.keys=function(s){var u=this._ctx;u.keysOnly=!u.isMatch;var c=[];return this.each(function(p,d){c.push(d.key)}).then(function(){return c}).then(s)},o.prototype.primaryKeys=function(s){var u=this._ctx;if(u.dir==="next"&&oi(u,!0)&&u.limit>0)return this._read(function(p){var d=Ss(u,u.table.core.schema);return u.table.core.query({trans:p,values:!1,limit:u.limit,query:{index:d,range:u.range}})}).then(function(p){var d=p.result;return d}).then(s);u.keysOnly=!u.isMatch;var c=[];return this.each(function(p,d){c.push(d.primaryKey)}).then(function(){return c}).then(s)},o.prototype.uniqueKeys=function(s){return this._ctx.unique="unique",this.keys(s)},o.prototype.firstKey=function(s){return this.limit(1).keys(function(u){return u[0]}).then(s)},o.prototype.lastKey=function(s){return this.reverse().firstKey(s)},o.prototype.distinct=function(){var s=this._ctx,u=s.index&&s.table.schema.idxByName[s.index];if(!u||!u.multi)return this;var c={};return vl(this._ctx,function(p){var d=p.primaryKey.toString(),_=g(c,d);return c[d]=!0,!_}),this},o.prototype.modify=function(s){var u=this,c=this._ctx;return this._write(function(p){var d;if(typeof s=="function")d=s;else{var _=a(s),y=_.length;d=function(D){for(var N=!1,L=0;L<y;++L){var F=_[L],R=s[F],z=le(D,F);R instanceof ao?(pe(D,F,R.execute(z)),N=!0):z!==R&&(pe(D,F,R),N=!0)}return N}}var x=c.table.core,w=x.schema.primaryKey,S=w.outbound,$=w.extractKey,M=u.db._options.modifyChunkSize||200,j=[],b=0,A=[],T=function(D,N){var L=N.failures,F=N.numFailures;b+=D-F;for(var R=0,z=a(L);R<z.length;R++){var V=z[R];j.push(L[V])}};return u.clone().primaryKeys().then(function(D){var N=oi(c)&&c.limit===1/0&&(typeof s!="function"||s===$l)&&{index:c.index,range:c.range},L=function(F){var R=Math.min(M,D.length-F);return x.getMany({trans:p,keys:D.slice(F,F+R),cache:"immutable"}).then(function(z){for(var V=[],W=[],oe=S?[]:null,ce=[],Y=0;Y<R;++Y){var de=z[Y],re={value:Ot(de),primKey:D[F+Y]};d.call(re,re.value,re)!==!1&&(re.value==null?ce.push(D[F+Y]):!S&&ge($(de),$(re.value))!==0?(ce.push(D[F+Y]),V.push(re.value)):(W.push(re.value),S&&oe.push(D[F+Y])))}return Promise.resolve(V.length>0&&x.mutate({trans:p,type:"add",values:V}).then(function(xe){for(var ae in xe.failures)ce.splice(parseInt(ae),1);T(V.length,xe)})).then(function(){return(W.length>0||N&&typeof s=="object")&&x.mutate({trans:p,type:"put",keys:oe,values:W,criteria:N,changeSpec:typeof s!="function"&&s,isAdditionalChunk:F>0}).then(function(xe){return T(W.length,xe)})}).then(function(){return(ce.length>0||N&&s===$l)&&x.mutate({trans:p,type:"delete",keys:ce,criteria:N,isAdditionalChunk:F>0}).then(function(xe){return T(ce.length,xe)})}).then(function(){return D.length>F+R&&L(F+M)})})};return L(0).then(function(){if(j.length>0)throw new ds("Error modifying one or more objects",j,b,A);return D.length})})})},o.prototype.delete=function(){var s=this._ctx,u=s.range;return oi(s)&&(s.isPrimKey||u.type===3)?this._write(function(c){var p=s.table.core.schema.primaryKey,d=u;return s.table.core.count({trans:c,query:{index:p,range:d}}).then(function(_){return s.table.core.mutate({trans:c,type:"deleteRange",range:d}).then(function(y){var x=y.failures;y.lastResult,y.results;var w=y.numFailures;if(w)throw new ds("Could not delete some values",Object.keys(x).map(function(S){return x[S]}),_-w);return _-w})})}):this.modify($l)},o}(),$l=function(o,s){return s.value=null};function wx(o){return so(vx.prototype,function(u,c){this.db=o;var p=jp,d=null;if(c)try{p=c()}catch(w){d=w}var _=u._ctx,y=_.table,x=y.hook.reading.fire;this._ctx={table:y,index:_.index,isPrimKey:!_.index||y.schema.primKey.keyPath&&_.index===y.schema.primKey.name,range:p,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:_.or,valueMapper:x!==to?x:null}})}function $x(o,s){return o<s?-1:o===s?0:1}function bx(o,s){return o>s?-1:o===s?0:1}function ht(o,s,u){var c=o instanceof Gp?new o.Collection(o):o;return c._ctx.error=u?new u(s):new TypeError(s),c}function si(o){return new o.Collection(o,function(){return Hp("")}).limit(0)}function Ex(o){return o==="next"?function(s){return s.toUpperCase()}:function(s){return s.toLowerCase()}}function Ox(o){return o==="next"?function(s){return s.toLowerCase()}:function(s){return s.toUpperCase()}}function Sx(o,s,u,c,p,d){for(var _=Math.min(o.length,c.length),y=-1,x=0;x<_;++x){var w=s[x];if(w!==c[x])return p(o[x],u[x])<0?o.substr(0,x)+u[x]+u.substr(x+1):p(o[x],c[x])<0?o.substr(0,x)+c[x]+u.substr(x+1):y>=0?o.substr(0,y)+s[y]+u.substr(y+1):null;p(o[x],w)<0&&(y=x)}return _<c.length&&d==="next"?o+u.substr(o.length):_<o.length&&d==="prev"?o.substr(0,u.length):y<0?null:o.substr(0,y)+c[y]+u.substr(y+1)}function ks(o,s,u,c){var p,d,_,y,x,w,S,$=u.length;if(!u.every(function(A){return typeof A=="string"}))return ht(o,Bp);function M(A){p=Ex(A),d=Ox(A),_=A==="next"?$x:bx;var T=u.map(function(D){return{lower:d(D),upper:p(D)}}).sort(function(D,N){return _(D.lower,N.lower)});y=T.map(function(D){return D.upper}),x=T.map(function(D){return D.lower}),w=A,S=A==="next"?"":c}M("next");var j=new o.Collection(o,function(){return qr(y[0],x[$-1]+c)});j._ondirectionchange=function(A){M(A)};var b=0;return j._addAlgorithm(function(A,T,D){var N=A.key;if(typeof N!="string")return!1;var L=d(N);if(s(L,x,b))return!0;for(var F=null,R=b;R<$;++R){var z=Sx(N,L,y[R],x[R],_,w);z===null&&F===null?b=R+1:(F===null||_(F,z)>0)&&(F=z)}return T(F!==null?function(){A.continue(F+S)}:D),!1}),j}function qr(o,s,u,c){return{type:2,lower:o,upper:s,lowerOpen:u,upperOpen:c}}function Hp(o){return{type:1,lower:o,upper:o}}var Gp=function(){function o(){}return Object.defineProperty(o.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),o.prototype.between=function(s,u,c,p){c=c!==!1,p=p===!0;try{return this._cmp(s,u)>0||this._cmp(s,u)===0&&(c||p)&&!(c&&p)?si(this):new this.Collection(this,function(){return qr(s,u,!c,!p)})}catch{return ht(this,$r)}},o.prototype.equals=function(s){return s==null?ht(this,$r):new this.Collection(this,function(){return Hp(s)})},o.prototype.above=function(s){return s==null?ht(this,$r):new this.Collection(this,function(){return qr(s,void 0,!0)})},o.prototype.aboveOrEqual=function(s){return s==null?ht(this,$r):new this.Collection(this,function(){return qr(s,void 0,!1)})},o.prototype.below=function(s){return s==null?ht(this,$r):new this.Collection(this,function(){return qr(void 0,s,!1,!0)})},o.prototype.belowOrEqual=function(s){return s==null?ht(this,$r):new this.Collection(this,function(){return qr(void 0,s)})},o.prototype.startsWith=function(s){return typeof s!="string"?ht(this,Bp):this.between(s,s+xn,!0,!0)},o.prototype.startsWithIgnoreCase=function(s){return s===""?this.startsWith(s):ks(this,function(u,c){return u.indexOf(c[0])===0},[s],xn)},o.prototype.equalsIgnoreCase=function(s){return ks(this,function(u,c){return u===c[0]},[s],"")},o.prototype.anyOfIgnoreCase=function(){var s=jt.apply(Bt,arguments);return s.length===0?si(this):ks(this,function(u,c){return c.indexOf(u)!==-1},s,"")},o.prototype.startsWithAnyOfIgnoreCase=function(){var s=jt.apply(Bt,arguments);return s.length===0?si(this):ks(this,function(u,c){return c.some(function(p){return u.indexOf(p)===0})},s,xn)},o.prototype.anyOf=function(){var s=this,u=jt.apply(Bt,arguments),c=this._cmp;try{u.sort(c)}catch{return ht(this,$r)}if(u.length===0)return si(this);var p=new this.Collection(this,function(){return qr(u[0],u[u.length-1])});p._ondirectionchange=function(_){c=_==="next"?s._ascending:s._descending,u.sort(c)};var d=0;return p._addAlgorithm(function(_,y,x){for(var w=_.key;c(w,u[d])>0;)if(++d,d===u.length)return y(x),!1;return c(w,u[d])===0?!0:(y(function(){_.continue(u[d])}),!1)}),p},o.prototype.notEqual=function(s){return this.inAnyRange([[gl,s],[s,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},o.prototype.noneOf=function(){var s=jt.apply(Bt,arguments);if(s.length===0)return new this.Collection(this);try{s.sort(this._ascending)}catch{return ht(this,$r)}var u=s.reduce(function(c,p){return c?c.concat([[c[c.length-1][1],p]]):[[gl,p]]},null);return u.push([s[s.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},o.prototype.inAnyRange=function(s,u){var c=this,p=this._cmp,d=this._ascending,_=this._descending,y=this._min,x=this._max;if(s.length===0)return si(this);if(!s.every(function(R){return R[0]!==void 0&&R[1]!==void 0&&d(R[0],R[1])<=0}))return ht(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var w=!u||u.includeLowers!==!1,S=u&&u.includeUppers===!0;function $(R,z){for(var V=0,W=R.length;V<W;++V){var oe=R[V];if(p(z[0],oe[1])<0&&p(z[1],oe[0])>0){oe[0]=y(oe[0],z[0]),oe[1]=x(oe[1],z[1]);break}}return V===W&&R.push(z),R}var M=d;function j(R,z){return M(R[0],z[0])}var b;try{b=s.reduce($,[]),b.sort(j)}catch{return ht(this,$r)}var A=0,T=S?function(R){return d(R,b[A][1])>0}:function(R){return d(R,b[A][1])>=0},D=w?function(R){return _(R,b[A][0])>0}:function(R){return _(R,b[A][0])>=0};function N(R){return!T(R)&&!D(R)}var L=T,F=new this.Collection(this,function(){return qr(b[0][0],b[b.length-1][1],!w,!S)});return F._ondirectionchange=function(R){R==="next"?(L=T,M=d):(L=D,M=_),b.sort(j)},F._addAlgorithm(function(R,z,V){for(var W=R.key;L(W);)if(++A,A===b.length)return z(V),!1;return N(W)?!0:(c._cmp(W,b[A][1])===0||c._cmp(W,b[A][0])===0||z(function(){M===d?R.continue(b[A][0]):R.continue(b[A][1])}),!1)}),F},o.prototype.startsWithAnyOf=function(){var s=jt.apply(Bt,arguments);return s.every(function(u){return typeof u=="string"})?s.length===0?si(this):this.inAnyRange(s.map(function(u){return[u,u+xn]})):ht(this,"startsWithAnyOf() only works with strings")},o}();function Ax(o){return so(Gp.prototype,function(u,c,p){if(this.db=o,this._ctx={table:u,index:c===":id"?null:c,or:p},this._cmp=this._ascending=ge,this._descending=function(d,_){return ge(_,d)},this._max=function(d,_){return ge(d,_)>0?d:_},this._min=function(d,_){return ge(d,_)<0?d:_},this._IDBKeyRange=o._deps.IDBKeyRange,!this._IDBKeyRange)throw new ie.MissingAPI})}function er(o){return Ie(function(s){return uo(s),o(s.target.error),!1})}function uo(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var lo="storagemutated",bl="x-storagemutated-1",Vr=oo(null,lo),kx=function(){function o(){}return o.prototype._lock=function(){return ne(!Z.global),++this._reculock,this._reculock===1&&!Z.global&&(Z.lockOwnerFor=this),this},o.prototype._unlock=function(){if(ne(!Z.global),--this._reculock===0)for(Z.global||(Z.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var s=this._blockedFuncs.shift();try{yn(s[1],s[0])}catch{}}return this},o.prototype._locked=function(){return this._reculock&&Z.lockOwnerFor!==this},o.prototype.create=function(s){var u=this;if(!this.mode)return this;var c=this.db.idbdb,p=this.db._state.dbOpenError;if(ne(!this.idbtrans),!s&&!c)switch(p&&p.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(p);case"MissingAPIError":throw new ie.MissingAPI(p.message,p);default:throw new ie.OpenFailed(p)}if(!this.active)throw new ie.TransactionInactive;return ne(this._completion._state===null),s=this.idbtrans=s||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):c.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),s.onerror=Ie(function(d){uo(d),u._reject(s.error)}),s.onabort=Ie(function(d){uo(d),u.active&&u._reject(new ie.Abort(s.error)),u.active=!1,u.on("abort").fire(d)}),s.oncomplete=Ie(function(){u.active=!1,u._resolve(),"mutatedParts"in s&&Vr.storagemutated.fire(s.mutatedParts)}),this},o.prototype._promise=function(s,u,c){var p=this;if(s==="readwrite"&&this.mode!=="readwrite")return Pe(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return Pe(new ie.TransactionInactive);if(this._locked())return new q(function(_,y){p._blockedFuncs.push([function(){p._promise(s,u,c).then(_,y)},Z])});if(c)return Ur(function(){var _=new q(function(y,x){p._lock();var w=u(y,x,p);w&&w.then&&w.then(y,x)});return _.finally(function(){return p._unlock()}),_._lib=!0,_});var d=new q(function(_,y){var x=u(_,y,p);x&&x.then&&x.then(_,y)});return d._lib=!0,d},o.prototype._root=function(){return this.parent?this.parent._root():this},o.prototype.waitFor=function(s){var u=this._root(),c=q.resolve(s);if(u._waitingFor)u._waitingFor=u._waitingFor.then(function(){return c});else{u._waitingFor=c,u._waitingQueue=[];var p=u.idbtrans.objectStore(u.storeNames[0]);(function _(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(p.get(-1/0).onsuccess=_)})()}var d=u._waitingFor;return new q(function(_,y){c.then(function(x){return u._waitingQueue.push(Ie(_.bind(null,x)))},function(x){return u._waitingQueue.push(Ie(y.bind(null,x)))}).finally(function(){u._waitingFor===d&&(u._waitingFor=null)})})},o.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ie.Abort))},o.prototype.table=function(s){var u=this._memoizedTables||(this._memoizedTables={});if(g(u,s))return u[s];var c=this.schema[s];if(!c)throw new ie.NotFound("Table "+s+" not part of transaction");var p=new this.db.Table(s,c,this);return p.core=this.db.core.table(s),u[s]=p,p},o}();function Tx(o){return so(kx.prototype,function(u,c,p,d,_){var y=this;this.db=o,this.mode=u,this.storeNames=c,this.schema=p,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=oo(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new q(function(x,w){y._resolve=x,y._reject=w}),this._completion.then(function(){y.active=!1,y.on.complete.fire()},function(x){var w=y.active;return y.active=!1,y.on.error.fire(x),y.parent?y.parent._reject(x):w&&y.idbtrans&&y.idbtrans.abort(),Pe(x)})})}function El(o,s,u,c,p,d,_){return{name:o,keyPath:s,unique:u,multi:c,auto:p,compound:d,src:(u&&!_?"&":"")+(c?"*":"")+(p?"++":"")+Yp(s)}}function Yp(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Ol(o,s,u){return{name:o,primKey:s,indexes:u,mappedClass:null,idxByName:fe(u,function(c){return[c.name,c]})}}function Ix(o){return o.length===1?o[0]:o}var co=function(o){try{return o.only([[]]),co=function(){return[[]]},[[]]}catch{return co=function(){return xn},xn}};function Sl(o){return o==null?function(){}:typeof o=="string"?Cx(o):function(s){return le(s,o)}}function Cx(o){var s=o.split(".");return s.length===1?function(u){return u[o]}:function(u){return le(u,o)}}function Qp(o){return[].slice.call(o)}var Mx=0;function fo(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function Dx(o,s,u){function c($,M){var j=Qp($.objectStoreNames);return{schema:{name:$.name,tables:j.map(function(b){return M.objectStore(b)}).map(function(b){var A=b.keyPath,T=b.autoIncrement,D=l(A),N=A==null,L={},F={name:b.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:N,compound:D,keyPath:A,autoIncrement:T,unique:!0,extractKey:Sl(A)},indexes:Qp(b.indexNames).map(function(R){return b.index(R)}).map(function(R){var z=R.name,V=R.unique,W=R.multiEntry,oe=R.keyPath,ce=l(oe),Y={name:z,compound:ce,keyPath:oe,unique:V,multiEntry:W,extractKey:Sl(oe)};return L[fo(oe)]=Y,Y}),getIndexByKeyPath:function(R){return L[fo(R)]}};return L[":id"]=F.primaryKey,A!=null&&(L[fo(A)]=F.primaryKey),F})},hasGetAll:j.length>0&&"getAll"in M.objectStore(j[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function p($){if($.type===3)return null;if($.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var M=$.lower,j=$.upper,b=$.lowerOpen,A=$.upperOpen,T=M===void 0?j===void 0?null:s.upperBound(j,!!A):j===void 0?s.lowerBound(M,!!b):s.bound(M,j,!!b,!!A);return T}function d($){var M=$.name;function j(T){var D=T.trans,N=T.type,L=T.keys,F=T.values,R=T.range;return new Promise(function(z,V){z=Ie(z);var W=D.objectStore(M),oe=W.keyPath==null,ce=N==="put"||N==="add";if(!ce&&N!=="delete"&&N!=="deleteRange")throw new Error("Invalid operation type: "+N);var Y=(L||F||{length:1}).length;if(L&&F&&L.length!==F.length)throw new Error("Given keys array must have same length as given values array.");if(Y===0)return z({numFailures:0,failures:{},results:[],lastResult:void 0});var de,re=[],xe=[],ae=0,Re=function(rr){++ae,uo(rr)};if(N==="deleteRange"){if(R.type===4)return z({numFailures:ae,failures:xe,results:[],lastResult:void 0});R.type===3?re.push(de=W.clear()):re.push(de=W.delete(p(R)))}else{var Ye=ce?oe?[F,L]:[F,null]:[L,null],Yr=Ye[0],tr=Ye[1];if(ce)for(var St=0;St<Y;++St)re.push(de=tr&&tr[St]!==void 0?W[N](Yr[St],tr[St]):W[N](Yr[St])),de.onerror=Re;else for(var St=0;St<Y;++St)re.push(de=W[N](Yr[St])),de.onerror=Re}var Qr=function(rr){var ho=rr.target.result;re.forEach(function(Kt,js){return Kt.error!=null&&(xe[js]=Kt.error)}),z({numFailures:ae,failures:xe,results:N==="delete"?L:re.map(function(Kt){return Kt.result}),lastResult:ho})};de.onerror=function(rr){Re(rr),Qr(rr)},de.onsuccess=Qr})}function b(T){var D=T.trans,N=T.values,L=T.query,F=T.reverse,R=T.unique;return new Promise(function(z,V){z=Ie(z);var W=L.index,oe=L.range,ce=D.objectStore(M),Y=W.isPrimaryKey?ce:ce.index(W.name),de=F?R?"prevunique":"prev":R?"nextunique":"next",re=N||!("openKeyCursor"in Y)?Y.openCursor(p(oe),de):Y.openKeyCursor(p(oe),de);re.onerror=er(V),re.onsuccess=Ie(function(xe){var ae=re.result;if(!ae){z(null);return}ae.___id=++Mx,ae.done=!1;var Re=ae.continue.bind(ae),Ye=ae.continuePrimaryKey;Ye&&(Ye=Ye.bind(ae));var Yr=ae.advance.bind(ae),tr=function(){throw new Error("Cursor not started")},St=function(){throw new Error("Cursor not stopped")};ae.trans=D,ae.stop=ae.continue=ae.continuePrimaryKey=ae.advance=tr,ae.fail=Ie(V),ae.next=function(){var Qr=this,rr=1;return this.start(function(){return rr--?Qr.continue():Qr.stop()}).then(function(){return Qr})},ae.start=function(Qr){var rr=new Promise(function(Kt,js){Kt=Ie(Kt),re.onerror=er(js),ae.fail=js,ae.stop=function(vv){ae.stop=ae.continue=ae.continuePrimaryKey=ae.advance=St,Kt(vv)}}),ho=function(){if(re.result)try{Qr()}catch(Kt){ae.fail(Kt)}else ae.done=!0,ae.start=function(){throw new Error("Cursor behind last entry")},ae.stop()};return re.onsuccess=Ie(function(Kt){re.onsuccess=ho,ho()}),ae.continue=Re,ae.continuePrimaryKey=Ye,ae.advance=Yr,ho(),rr},z(ae)},V)})}function A(T){return function(D){return new Promise(function(N,L){N=Ie(N);var F=D.trans,R=D.values,z=D.limit,V=D.query,W=z===1/0?void 0:z,oe=V.index,ce=V.range,Y=F.objectStore(M),de=oe.isPrimaryKey?Y:Y.index(oe.name),re=p(ce);if(z===0)return N({result:[]});if(T){var xe=R?de.getAll(re,W):de.getAllKeys(re,W);xe.onsuccess=function(Yr){return N({result:Yr.target.result})},xe.onerror=er(L)}else{var ae=0,Re=R||!("openKeyCursor"in de)?de.openCursor(re):de.openKeyCursor(re),Ye=[];Re.onsuccess=function(Yr){var tr=Re.result;if(!tr)return N({result:Ye});if(Ye.push(R?tr.value:tr.primaryKey),++ae===z)return N({result:Ye});tr.continue()},Re.onerror=er(L)}})}}return{name:M,schema:$,mutate:j,getMany:function(T){var D=T.trans,N=T.keys;return new Promise(function(L,F){L=Ie(L);for(var R=D.objectStore(M),z=N.length,V=new Array(z),W=0,oe=0,ce,Y=function(ae){var Re=ae.target;(V[Re._pos]=Re.result)!=null,++oe===W&&L(V)},de=er(F),re=0;re<z;++re){var xe=N[re];xe!=null&&(ce=R.get(N[re]),ce._pos=re,ce.onsuccess=Y,ce.onerror=de,++W)}W===0&&L(V)})},get:function(T){var D=T.trans,N=T.key;return new Promise(function(L,F){L=Ie(L);var R=D.objectStore(M),z=R.get(N);z.onsuccess=function(V){return L(V.target.result)},z.onerror=er(F)})},query:A(x),openCursor:b,count:function(T){var D=T.query,N=T.trans,L=D.index,F=D.range;return new Promise(function(R,z){var V=N.objectStore(M),W=L.isPrimaryKey?V:V.index(L.name),oe=p(F),ce=oe?W.count(oe):W.count();ce.onsuccess=Ie(function(Y){return R(Y.target.result)}),ce.onerror=er(z)})}}}var _=c(o,u),y=_.schema,x=_.hasGetAll,w=y.tables.map(function($){return d($)}),S={};return w.forEach(function($){return S[$.name]=$}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function($){var M=S[$];if(!M)throw new Error("Table '".concat($,"' not found"));return S[$]},MIN_KEY:-1/0,MAX_KEY:co(s),schema:y}}function Px(o,s){return s.reduce(function(u,c){var p=c.create;return r(r({},u),p(u))},o)}function Rx(o,s,u,c){var p=u.IDBKeyRange;u.indexedDB;var d=Px(Dx(s,p,c),o.dbcore);return{dbcore:d}}function Ts(o,s){var u=s.db,c=Rx(o._middlewares,u,o._deps,s);o.core=c.dbcore,o.tables.forEach(function(p){var d=p.name;o.core.schema.tables.some(function(_){return _.name===d})&&(p.core=o.core.table(d),o[d]instanceof o.Table&&(o[d].core=p.core))})}function Is(o,s,u,c){u.forEach(function(p){var d=c[p];s.forEach(function(_){var y=G(_,p);(!y||"value"in y&&y.value===void 0)&&(_===o.Transaction.prototype||_ instanceof o.Transaction?E(_,p,{get:function(){return this.table(p)},set:function(x){O(this,p,{value:x,writable:!0,configurable:!0,enumerable:!0})}}):_[p]=new o.Table(p,d))})})}function Al(o,s){s.forEach(function(u){for(var c in u)u[c]instanceof o.Table&&delete u[c]})}function Nx(o,s){return o._cfg.version-s._cfg.version}function Lx(o,s,u,c){var p=o._dbSchema;u.objectStoreNames.contains("$meta")&&!p.$meta&&(p.$meta=Ol("$meta",Xp("")[0],[]),o._storeNames.push("$meta"));var d=o._createTransaction("readwrite",o._storeNames,p);d.create(u),d._completion.catch(c);var _=d._reject.bind(d),y=Z.transless||Z;Ur(function(){if(Z.trans=d,Z.transless=y,s===0)a(p).forEach(function(x){Tl(u,x,p[x].primKey,p[x].indexes)}),Ts(o,u),q.follow(function(){return o.on.populate.fire(d)}).catch(_);else return Ts(o,u),Bx(o,d,s).then(function(x){return jx(o,x,d,u)}).catch(_)})}function Fx(o,s){Jp(o._dbSchema,s),s.db.version%10===0&&!s.objectStoreNames.contains("$meta")&&s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var u=Ms(o,o.idbdb,s);Ds(o,o._dbSchema,s);for(var c=kl(u,o._dbSchema),p=function(w){if(w.change.length||w.recreate)return console.warn("Unable to patch indexes of table ".concat(w.name," because it has changes on the type of index or primary key.")),{value:void 0};var S=s.objectStore(w.name);w.add.forEach(function($){Zt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(w.name,".").concat($.src)),Cs(S,$)})},d=0,_=c.change;d<_.length;d++){var y=_[d],x=p(y);if(typeof x=="object")return x.value}}function Bx(o,s,u){return s.storeNames.includes("$meta")?s.table("$meta").get("version").then(function(c){return c??u}):q.resolve(u)}function jx(o,s,u,c){var p=[],d=o._versions,_=o._dbSchema=Ms(o,o.idbdb,c),y=d.filter(function(w){return w._cfg.version>=s});if(y.length===0)return q.resolve();y.forEach(function(w){p.push(function(){var S=_,$=w._cfg.dbschema;Ds(o,S,c),Ds(o,$,c),_=o._dbSchema=$;var M=kl(S,$);M.add.forEach(function(N){Tl(c,N[0],N[1].primKey,N[1].indexes)}),M.change.forEach(function(N){if(N.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var L=c.objectStore(N.name);N.add.forEach(function(F){return Cs(L,F)}),N.change.forEach(function(F){L.deleteIndex(F.name),Cs(L,F)}),N.del.forEach(function(F){return L.deleteIndex(F)})});var j=w._cfg.contentUpgrade;if(j&&w._cfg.version>s){Ts(o,c),u._memoizedTables={};var b=Et($);M.del.forEach(function(N){b[N]=S[N]}),Al(o,[o.Transaction.prototype]),Is(o,[o.Transaction.prototype],a(b),b),u.schema=b;var A=nl(j);A&&ni();var T,D=q.follow(function(){if(T=j(u),T&&A){var N=zr.bind(null,null);T.then(N,N)}});return T&&typeof T.then=="function"?q.resolve(T):D.then(function(){return T})}}),p.push(function(S){var $=w._cfg.dbschema;Kx($,S),Al(o,[o.Transaction.prototype]),Is(o,[o.Transaction.prototype],o._storeNames,o._dbSchema),u.schema=o._dbSchema}),p.push(function(S){o.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(o.idbdb.version/10)===w._cfg.version?(o.idbdb.deleteObjectStore("$meta"),delete o._dbSchema.$meta,o._storeNames=o._storeNames.filter(function($){return $!=="$meta"})):S.objectStore("$meta").put(w._cfg.version,"version"))})});function x(){return p.length?q.resolve(p.shift()(u.idbtrans)).then(x):q.resolve()}return x().then(function(){Jp(_,c)})}function kl(o,s){var u={del:[],add:[],change:[]},c;for(c in o)s[c]||u.del.push(c);for(c in s){var p=o[c],d=s[c];if(!p)u.add.push([c,d]);else{var _={name:c,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(p.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||p.primKey.auto!==d.primKey.auto)_.recreate=!0,u.change.push(_);else{var y=p.idxByName,x=d.idxByName,w=void 0;for(w in y)x[w]||_.del.push(w);for(w in x){var S=y[w],$=x[w];S?S.src!==$.src&&_.change.push($):_.add.push($)}(_.del.length>0||_.add.length>0||_.change.length>0)&&u.change.push(_)}}}return u}function Tl(o,s,u,c){var p=o.db.createObjectStore(s,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});return c.forEach(function(d){return Cs(p,d)}),p}function Jp(o,s){a(o).forEach(function(u){s.db.objectStoreNames.contains(u)||(Zt&&console.debug("Dexie: Creating missing table",u),Tl(s,u,o[u].primKey,o[u].indexes))})}function Kx(o,s){[].slice.call(s.db.objectStoreNames).forEach(function(u){return o[u]==null&&s.db.deleteObjectStore(u)})}function Cs(o,s){o.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ms(o,s,u){var c={},p=Q(s.objectStoreNames,0);return p.forEach(function(d){for(var _=u.objectStore(d),y=_.keyPath,x=El(Yp(y),y||"",!0,!1,!!_.autoIncrement,y&&typeof y!="string",!0),w=[],S=0;S<_.indexNames.length;++S){var $=_.index(_.indexNames[S]);y=$.keyPath;var M=El($.name,y,!!$.unique,!!$.multiEntry,!1,y&&typeof y!="string",!1);w.push(M)}c[d]=Ol(d,x,w)}),c}function Ux(o,s,u){o.verno=s.version/10;var c=o._dbSchema=Ms(o,s,u);o._storeNames=Q(s.objectStoreNames,0),Is(o,[o._allTables],a(c),c)}function zx(o,s){var u=Ms(o,o.idbdb,s),c=kl(u,o._dbSchema);return!(c.add.length||c.change.some(function(p){return p.add.length||p.change.length}))}function Ds(o,s,u){for(var c=u.db.objectStoreNames,p=0;p<c.length;++p){var d=c[p],_=u.objectStore(d);o._hasGetAll="getAll"in _;for(var y=0;y<_.indexNames.length;++y){var x=_.indexNames[y],w=_.index(x).keyPath,S=typeof w=="string"?w:"["+Q(w).join("+")+"]";if(s[d]){var $=s[d].idxByName[S];$&&($.name=x,delete s[d].idxByName[S],s[d].idxByName[x]=$)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function Xp(o){return o.split(",").map(function(s,u){s=s.trim();var c=s.replace(/([&*]|\+\+)/g,""),p=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return El(c,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),l(p),u===0)})}var Wx=function(){function o(){}return o.prototype._parseStoresSpec=function(s,u){a(s).forEach(function(c){if(s[c]!==null){var p=Xp(s[c]),d=p.shift();if(d.unique=!0,d.multi)throw new ie.Schema("Primary key cannot be multi-valued");p.forEach(function(_){if(_.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!_.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}),u[c]=Ol(c,d,p)}})},o.prototype.stores=function(s){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?f(this._cfg.storesSource,s):s;var c=u._versions,p={},d={};return c.forEach(function(_){f(p,_._cfg.storesSource),d=_._cfg.dbschema={},_._parseStoresSpec(p,d)}),u._dbSchema=d,Al(u,[u._allTables,u,u.Transaction.prototype]),Is(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],a(d),d),u._storeNames=a(d),this},o.prototype.upgrade=function(s){return this._cfg.contentUpgrade=sl(this._cfg.contentUpgrade||Se,s),this},o}();function qx(o){return so(Wx.prototype,function(u){this.db=o,this._cfg={version:u,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Il(o,s){var u=o._dbNamesDB;return u||(u=o._dbNamesDB=new br(Es,{addons:[],indexedDB:o,IDBKeyRange:s}),u.version(1).stores({dbnames:"name"})),u.table("dbnames")}function Cl(o){return o&&typeof o.databases=="function"}function Vx(o){var s=o.indexedDB,u=o.IDBKeyRange;return Cl(s)?Promise.resolve(s.databases()).then(function(c){return c.map(function(p){return p.name}).filter(function(p){return p!==Es})}):Il(s,u).toCollection().primaryKeys()}function Hx(o,s){var u=o.indexedDB,c=o.IDBKeyRange;!Cl(u)&&s!==Es&&Il(u,c).put({name:s}).catch(Se)}function Gx(o,s){var u=o.indexedDB,c=o.IDBKeyRange;!Cl(u)&&s!==Es&&Il(u,c).delete(s).catch(Se)}function Ml(o){return Ur(function(){return Z.letThrough=!0,o()})}function Yx(){var o=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!o||!indexedDB.databases)return Promise.resolve();var s;return new Promise(function(u){var c=function(){return indexedDB.databases().finally(u)};s=setInterval(c,100),c()}).finally(function(){return clearInterval(s)})}var Dl;function Pl(o){return!("from"in o)}var Ze=function(o,s){if(this)f(this,arguments.length?{d:1,from:o,to:arguments.length>1?s:o}:{d:0});else{var u=new Ze;return o&&"d"in o&&f(u,o),u}};v(Ze.prototype,(Dl={add:function(o){return mo(this,o),this},addKey:function(o){return po(this,o,o),this},addKeys:function(o){var s=this;return o.forEach(function(u){return po(s,u,u)}),this},hasKey:function(o){var s=Ps(this).next(o).value;return s&&ge(s.from,o)<=0&&ge(s.to,o)>=0}},Dl[eo]=function(){return Ps(this)},Dl));function po(o,s,u){var c=ge(s,u);if(!isNaN(c)){if(c>0)throw RangeError();if(Pl(o))return f(o,{from:s,to:u,d:1});var p=o.l,d=o.r;if(ge(u,o.from)<0)return p?po(p,s,u):o.l={from:s,to:u,d:1,l:null,r:null},em(o);if(ge(s,o.to)>0)return d?po(d,s,u):o.r={from:s,to:u,d:1,l:null,r:null},em(o);ge(s,o.from)<0&&(o.from=s,o.l=null,o.d=d?d.d+1:1),ge(u,o.to)>0&&(o.to=u,o.r=null,o.d=o.l?o.l.d+1:1);var _=!o.r;p&&!o.l&&mo(o,p),d&&_&&mo(o,d)}}function mo(o,s){function u(c,p){var d=p.from,_=p.to,y=p.l,x=p.r;po(c,d,_),y&&u(c,y),x&&u(c,x)}Pl(s)||u(o,s)}function Zp(o,s){var u=Ps(s),c=u.next();if(c.done)return!1;for(var p=c.value,d=Ps(o),_=d.next(p.from),y=_.value;!c.done&&!_.done;){if(ge(y.from,p.to)<=0&&ge(y.to,p.from)>=0)return!0;ge(p.from,y.from)<0?p=(c=u.next(y.from)).value:y=(_=d.next(p.from)).value}return!1}function Ps(o){var s=Pl(o)?null:{s:0,n:o};return{next:function(u){for(var c=arguments.length>0;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&ge(u,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||ge(u,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function em(o){var s,u,c=(((s=o.r)===null||s===void 0?void 0:s.d)||0)-(((u=o.l)===null||u===void 0?void 0:u.d)||0),p=c>1?"r":c<-1?"l":"";if(p){var d=p==="r"?"l":"r",_=r({},o),y=o[p];o.from=y.from,o.to=y.to,o[p]=y[p],_[p]=y[d],o[d]=_,_.d=tm(_)}o.d=tm(o)}function tm(o){var s=o.r,u=o.l;return(s?u?Math.max(s.d,u.d):s.d:u?u.d:0)+1}function Rs(o,s){return a(s).forEach(function(u){o[u]?mo(o[u],s[u]):o[u]=ms(s[u])}),o}function Rl(o,s){return o.all||s.all||Object.keys(o).some(function(u){return s[u]&&Zp(s[u],o[u])})}var wn={},Nl={},Ll=!1;function Ns(o,s){Rs(Nl,o),Ll||(Ll=!0,setTimeout(function(){Ll=!1;var u=Nl;Nl={},Fl(u,!1)},0))}function Fl(o,s){s===void 0&&(s=!1);var u=new Set;if(o.all)for(var c=0,p=Object.values(wn);c<p.length;c++){var d=p[c];rm(d,o,u,s)}else for(var _ in o){var y=/^idb\:\/\/(.*)\/(.*)\//.exec(_);if(y){var x=y[1],w=y[2],d=wn["idb://".concat(x,"/").concat(w)];d&&rm(d,o,u,s)}}u.forEach(function(S){return S()})}function rm(o,s,u,c){for(var p=[],d=0,_=Object.entries(o.queries.query);d<_.length;d++){for(var y=_[d],x=y[0],w=y[1],S=[],$=0,M=w;$<M.length;$++){var j=M[$];Rl(s,j.obsSet)?j.subscribers.forEach(function(D){return u.add(D)}):c&&S.push(j)}c&&p.push([x,S])}if(c)for(var b=0,A=p;b<A.length;b++){var T=A[b],x=T[0],S=T[1];o.queries.query[x]=S}}function Qx(o){var s=o._state,u=o._deps.indexedDB;if(s.isBeingOpened||o.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?Pe(s.dbOpenError):o});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,p=Math.round(o.verno*10),d=!1;function _(){if(s.openCanceller!==c)throw new ie.DatabaseClosed("db.open() was cancelled")}var y=s.dbReadyResolve,x=null,w=!1,S=function(){return new q(function($,M){if(_(),!u)throw new ie.MissingAPI;var j=o.name,b=s.autoSchema||!p?u.open(j):u.open(j,p);if(!b)throw new ie.MissingAPI;b.onerror=er(M),b.onblocked=Ie(o._fireOnBlocked),b.onupgradeneeded=Ie(function(A){if(x=b.transaction,s.autoSchema&&!o._options.allowEmptyDB){b.onerror=uo,x.abort(),b.result.close();var T=u.deleteDatabase(j);T.onsuccess=T.onerror=Ie(function(){M(new ie.NoSuchDatabase("Database ".concat(j," doesnt exist")))})}else{x.onerror=er(M);var D=A.oldVersion>Math.pow(2,62)?0:A.oldVersion;w=D<1,o.idbdb=b.result,d&&Fx(o,x),Lx(o,D/10,x,M)}},M),b.onsuccess=Ie(function(){x=null;var A=o.idbdb=b.result,T=Q(A.objectStoreNames);if(T.length>0)try{var D=A.transaction(Ix(T),"readonly");if(s.autoSchema)Ux(o,A,D);else if(Ds(o,o._dbSchema,D),!zx(o,D)&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),A.close(),p=A.version+1,d=!0,$(S());Ts(o,D)}catch{}ii.push(o),A.onversionchange=Ie(function(N){s.vcFired=!0,o.on("versionchange").fire(N)}),A.onclose=Ie(function(N){o.on("close").fire(N)}),w&&Hx(o._deps,j),$()},M)}).catch(function($){switch($?.name){case"UnknownError":if(s.PR1398_maxLoop>0)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),S();break;case"VersionError":if(p>0)return p=0,S();break}return q.reject($)})};return q.race([c,(typeof navigator>"u"?q.resolve():Yx()).then(S)]).then(function(){return _(),s.onReadyBeingFired=[],q.resolve(Ml(function(){return o.on.ready.fire(o.vip)})).then(function $(){if(s.onReadyBeingFired.length>0){var M=s.onReadyBeingFired.reduce(sl,Se);return s.onReadyBeingFired=[],q.resolve(Ml(function(){return M(o.vip)})).then($)}})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function($){s.dbOpenError=$;try{x&&x.abort()}catch{}return c===s.openCanceller&&o._close(),Pe($)}).finally(function(){s.openComplete=!0,y()}).then(function(){if(w){var $={};o.tables.forEach(function(M){M.schema.indexes.forEach(function(j){j.name&&($["idb://".concat(o.name,"/").concat(M.name,"/").concat(j.name)]=new Ze(-1/0,[[[]]]))}),$["idb://".concat(o.name,"/").concat(M.name,"/")]=$["idb://".concat(o.name,"/").concat(M.name,"/:dels")]=new Ze(-1/0,[[[]]])}),Vr(lo).fire($),Fl($,!0)}return o})}function Bl(o){var s=function(_){return o.next(_)},u=function(_){return o.throw(_)},c=d(s),p=d(u);function d(_){return function(y){var x=_(y),w=x.value;return x.done?w:!w||typeof w.then!="function"?l(w)?Promise.all(w).then(c,p):c(w):w.then(c,p)}}return d(s)()}function Jx(o,s,u){var c=arguments.length;if(c<2)throw new ie.InvalidArgument("Too few arguments");for(var p=new Array(c-1);--c;)p[c-1]=arguments[c];u=p.pop();var d=Xt(p);return[o,d,u]}function nm(o,s,u,c,p){return q.resolve().then(function(){var d=Z.transless||Z,_=o._createTransaction(s,u,o._dbSchema,c);_.explicit=!0;var y={trans:_,transless:d};if(c)_.idbtrans=c.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,o._state.PR1398_maxLoop=3}catch($){return $.name===ol.InvalidState&&o.isOpen()&&--o._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),o.close({disableAutoOpen:!1}),o.open().then(function(){return nm(o,s,u,null,p)})):Pe($)}var x=nl(p);x&&ni();var w,S=q.follow(function(){if(w=p.call(_,_),w)if(x){var $=zr.bind(null,null);w.then($,$)}else typeof w.next=="function"&&typeof w.throw=="function"&&(w=Bl(w))},y);return(w&&typeof w.then=="function"?q.resolve(w).then(function($){return _.active?$:Pe(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):S.then(function(){return w})).then(function($){return c&&_._resolve(),_._completion.then(function(){return $})}).catch(function($){return _._reject($),Pe($)})})}function Ls(o,s,u){for(var c=l(o)?o.slice():[o],p=0;p<u;++p)c.push(s);return c}function Xx(o){return r(r({},o),{table:function(s){var u=o.table(s),c=u.schema,p={},d=[];function _(A,T,D){var N=fo(A),L=p[N]=p[N]||[],F=A==null?0:typeof A=="string"?1:A.length,R=T>0,z=r(r({},D),{name:R?"".concat(N,"(virtual-from:").concat(D.name,")"):D.name,lowLevelIndex:D,isVirtual:R,keyTail:T,keyLength:F,extractKey:Sl(A),unique:!R&&D.unique});if(L.push(z),z.isPrimaryKey||d.push(z),F>1){var V=F===2?A[0]:A.slice(0,F-1);_(V,T+1,D)}return L.sort(function(W,oe){return W.keyTail-oe.keyTail}),z}var y=_(c.primaryKey.keyPath,0,c.primaryKey);p[":id"]=[y];for(var x=0,w=c.indexes;x<w.length;x++){var S=w[x];_(S.keyPath,0,S)}function $(A){var T=p[fo(A)];return T&&T[0]}function M(A,T){return{type:A.type===1?2:A.type,lower:Ls(A.lower,A.lowerOpen?o.MAX_KEY:o.MIN_KEY,T),lowerOpen:!0,upper:Ls(A.upper,A.upperOpen?o.MIN_KEY:o.MAX_KEY,T),upperOpen:!0}}function j(A){var T=A.query.index;return T.isVirtual?r(r({},A),{query:{index:T.lowLevelIndex,range:M(A.query.range,T.keyTail)}}):A}var b=r(r({},u),{schema:r(r({},c),{primaryKey:y,indexes:d,getIndexByKeyPath:$}),count:function(A){return u.count(j(A))},query:function(A){return u.query(j(A))},openCursor:function(A){var T=A.query.index,D=T.keyTail,N=T.isVirtual,L=T.keyLength;if(!N)return u.openCursor(A);function F(R){function z(W){W!=null?R.continue(Ls(W,A.reverse?o.MAX_KEY:o.MIN_KEY,D)):A.unique?R.continue(R.key.slice(0,L).concat(A.reverse?o.MIN_KEY:o.MAX_KEY,D)):R.continue()}var V=Object.create(R,{continue:{value:z},continuePrimaryKey:{value:function(W,oe){R.continuePrimaryKey(Ls(W,o.MAX_KEY,D),oe)}},primaryKey:{get:function(){return R.primaryKey}},key:{get:function(){var W=R.key;return L===1?W[0]:W.slice(0,L)}},value:{get:function(){return R.value}}});return V}return u.openCursor(j(A)).then(function(R){return R&&F(R)})}});return b}})}var Zx={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Xx};function jl(o,s,u,c){return u=u||{},c=c||"",a(o).forEach(function(p){if(!g(s,p))u[c+p]=void 0;else{var d=o[p],_=s[p];if(typeof d=="object"&&typeof _=="object"&&d&&_){var y=jr(d),x=jr(_);y!==x?u[c+p]=s[p]:y==="Object"?jl(d,_,u,c+p+"."):d!==_&&(u[c+p]=s[p])}else d!==_&&(u[c+p]=s[p])}}),a(s).forEach(function(p){g(o,p)||(u[c+p]=s[p])}),u}function Kl(o,s){return s.type==="delete"?s.keys:s.keys||s.values.map(o.extractKey)}var ev={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return r(r({},o),{table:function(s){var u=o.table(s),c=u.schema.primaryKey,p=r(r({},u),{mutate:function(d){var _=Z.trans,y=_.table(s).hook,x=y.deleting,w=y.creating,S=y.updating;switch(d.type){case"add":if(w.fire===Se)break;return _._promise("readwrite",function(){return $(d)},!0);case"put":if(w.fire===Se&&S.fire===Se)break;return _._promise("readwrite",function(){return $(d)},!0);case"delete":if(x.fire===Se)break;return _._promise("readwrite",function(){return $(d)},!0);case"deleteRange":if(x.fire===Se)break;return _._promise("readwrite",function(){return M(d)},!0)}return u.mutate(d);function $(b){var A=Z.trans,T=b.keys||Kl(c,b);if(!T)throw new Error("Keys missing");return b=b.type==="add"||b.type==="put"?r(r({},b),{keys:T}):r({},b),b.type!=="delete"&&(b.values=n([],b.values,!0)),b.keys&&(b.keys=n([],b.keys,!0)),tv(u,b,T).then(function(D){var N=T.map(function(L,F){var R=D[F],z={onerror:null,onsuccess:null};if(b.type==="delete")x.fire.call(z,L,R,A);else if(b.type==="add"||R===void 0){var V=w.fire.call(z,L,b.values[F],A);L==null&&V!=null&&(L=V,b.keys[F]=L,c.outbound||pe(b.values[F],c.keyPath,L))}else{var W=jl(R,b.values[F]),oe=S.fire.call(z,W,L,R,A);if(oe){var ce=b.values[F];Object.keys(oe).forEach(function(Y){g(ce,Y)?ce[Y]=oe[Y]:pe(ce,Y,oe[Y])})}}return z});return u.mutate(b).then(function(L){for(var F=L.failures,R=L.results,z=L.numFailures,V=L.lastResult,W=0;W<T.length;++W){var oe=R?R[W]:T[W],ce=N[W];oe==null?ce.onerror&&ce.onerror(F[W]):ce.onsuccess&&ce.onsuccess(b.type==="put"&&D[W]?b.values[W]:oe)}return{failures:F,results:R,numFailures:z,lastResult:V}}).catch(function(L){return N.forEach(function(F){return F.onerror&&F.onerror(L)}),Promise.reject(L)})})}function M(b){return j(b.trans,b.range,1e4)}function j(b,A,T){return u.query({trans:b,values:!1,query:{index:c,range:A},limit:T}).then(function(D){var N=D.result;return $({type:"delete",keys:N,trans:b}).then(function(L){return L.numFailures>0?Promise.reject(L.failures[0]):N.length<T?{failures:[],numFailures:0,lastResult:void 0}:j(b,r(r({},A),{lower:N[N.length-1],lowerOpen:!0}),T)})})}}});return p}})}};function tv(o,s,u){return s.type==="add"?Promise.resolve([]):o.getMany({trans:s.trans,keys:u,cache:"immutable"})}function im(o,s,u){try{if(!s||s.keys.length<o.length)return null;for(var c=[],p=0,d=0;p<s.keys.length&&d<o.length;++p)ge(s.keys[p],o[d])===0&&(c.push(u?Ot(s.values[p]):s.values[p]),++d);return c.length===o.length?c:null}catch{return null}}var rv={stack:"dbcore",level:-1,create:function(o){return{table:function(s){var u=o.table(s);return r(r({},u),{getMany:function(c){if(!c.cache)return u.getMany(c);var p=im(c.keys,c.trans._cache,c.cache==="clone");return p?q.resolve(p):u.getMany(c).then(function(d){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?Ot(d):d},d})},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),u.mutate(c)}})}}}};function om(o,s){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function sm(o,s){switch(o){case"query":return s.values&&!s.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var nv={stack:"dbcore",level:0,name:"Observability",create:function(o){var s=o.schema.name,u=new Ze(o.MIN_KEY,o.MAX_KEY);return r(r({},o),{transaction:function(c,p,d){if(Z.subscr&&p!=="readonly")throw new ie.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Z.querier));return o.transaction(c,p,d)},table:function(c){var p=o.table(c),d=p.schema,_=d.primaryKey,y=d.indexes,x=_.extractKey,w=_.outbound,S=_.autoIncrement&&y.filter(function(b){return b.compound&&b.keyPath.includes(_.keyPath)}),$=r(r({},p),{mutate:function(b){var A,T,D=b.trans,N=b.mutatedParts||(b.mutatedParts={}),L=function(re){var xe="idb://".concat(s,"/").concat(c,"/").concat(re);return N[xe]||(N[xe]=new Ze)},F=L(""),R=L(":dels"),z=b.type,V=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[Kl(_,b).filter(function(re){return re}),b.values]:[],W=V[0],oe=V[1],ce=b.trans._cache;if(l(W)){F.addKeys(W);var Y=z==="delete"||W.length===oe.length?im(W,ce):null;Y||R.addKeys(W),(Y||oe)&&iv(L,d,Y,oe)}else if(W){var de={from:(A=W.lower)!==null&&A!==void 0?A:o.MIN_KEY,to:(T=W.upper)!==null&&T!==void 0?T:o.MAX_KEY};R.add(de),F.add(de)}else F.add(u),R.add(u),d.indexes.forEach(function(re){return L(re.name).add(u)});return p.mutate(b).then(function(re){return W&&(b.type==="add"||b.type==="put")&&(F.addKeys(re.results),S&&S.forEach(function(xe){var ae=b.values.map(function(Ye){return xe.extractKey(Ye)}),Re=xe.keyPath.findIndex(function(Ye){return Ye===_.keyPath});re.results.forEach(function(Ye){return ae[Re]=Ye}),L(xe.name).addKeys(ae)})),D.mutatedParts=Rs(D.mutatedParts||{},N),re})}}),M=function(b){var A,T,D=b.query,N=D.index,L=D.range;return[N,new Ze((A=L.lower)!==null&&A!==void 0?A:o.MIN_KEY,(T=L.upper)!==null&&T!==void 0?T:o.MAX_KEY)]},j={get:function(b){return[_,new Ze(b.key)]},getMany:function(b){return[_,new Ze().addKeys(b.keys)]},count:M,query:M,openCursor:M};return a(j).forEach(function(b){$[b]=function(A){var T=Z.subscr,D=!!T,N=om(Z,p)&&sm(b,A),L=N?A.obsSet={}:T;if(D){var F=function(Y){var de="idb://".concat(s,"/").concat(c,"/").concat(Y);return L[de]||(L[de]=new Ze)},R=F(""),z=F(":dels"),V=j[b](A),W=V[0],oe=V[1];if(b==="query"&&W.isPrimaryKey&&!A.values?z.add(oe):F(W.name||"").add(oe),!W.isPrimaryKey)if(b==="count")z.add(u);else{var ce=b==="query"&&w&&A.values&&p.query(r(r({},A),{values:!1}));return p[b].apply(this,arguments).then(function(Y){if(b==="query"){if(w&&A.values)return ce.then(function(ae){var Re=ae.result;return R.addKeys(Re),Y});var de=A.values?Y.result.map(x):Y.result;A.values?R.addKeys(de):z.addKeys(de)}else if(b==="openCursor"){var re=Y,xe=A.values;return re&&Object.create(re,{key:{get:function(){return z.addKey(re.primaryKey),re.key}},primaryKey:{get:function(){var ae=re.primaryKey;return z.addKey(ae),ae}},value:{get:function(){return xe&&R.addKey(re.primaryKey),re.value}}})}return Y})}}return p[b].apply(this,arguments)}}),$}})}};function iv(o,s,u,c){function p(d){var _=o(d.name||"");function y(w){return w!=null?d.extractKey(w):null}var x=function(w){return d.multiEntry&&l(w)?w.forEach(function(S){return _.addKey(S)}):_.addKey(w)};(u||c).forEach(function(w,S){var $=u&&y(u[S]),M=c&&y(c[S]);ge($,M)!==0&&($!=null&&x($),M!=null&&x(M))})}s.indexes.forEach(p)}function am(o,s,u){if(u.numFailures===0)return s;if(s.type==="deleteRange")return null;var c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;if(u.numFailures===c)return null;var p=r({},s);return l(p.keys)&&(p.keys=p.keys.filter(function(d,_){return!(_ in u.failures)})),"values"in p&&l(p.values)&&(p.values=p.values.filter(function(d,_){return!(_ in u.failures)})),p}function ov(o,s){return s.lower===void 0?!0:s.lowerOpen?ge(o,s.lower)>0:ge(o,s.lower)>=0}function sv(o,s){return s.upper===void 0?!0:s.upperOpen?ge(o,s.upper)<0:ge(o,s.upper)<=0}function Ul(o,s){return ov(o,s)&&sv(o,s)}function um(o,s,u,c,p,d){if(!u||u.length===0)return o;var _=s.query.index,y=_.multiEntry,x=s.query.range,w=c.schema.primaryKey,S=w.extractKey,$=_.extractKey,M=(_.lowLevelIndex||_).extractKey,j=u.reduce(function(b,A){var T=b,D=[];if(A.type==="add"||A.type==="put")for(var N=new Ze,L=A.values.length-1;L>=0;--L){var F=A.values[L],R=S(F);if(!N.hasKey(R)){var z=$(F);(y&&l(z)?z.some(function(Y){return Ul(Y,x)}):Ul(z,x))&&(N.addKey(R),D.push(F))}}switch(A.type){case"add":{var V=new Ze().addKeys(s.values?b.map(function(Y){return S(Y)}):b);T=b.concat(s.values?D.filter(function(Y){var de=S(Y);return V.hasKey(de)?!1:(V.addKey(de),!0)}):D.map(function(Y){return S(Y)}).filter(function(Y){return V.hasKey(Y)?!1:(V.addKey(Y),!0)}));break}case"put":{var W=new Ze().addKeys(A.values.map(function(Y){return S(Y)}));T=b.filter(function(Y){return!W.hasKey(s.values?S(Y):Y)}).concat(s.values?D:D.map(function(Y){return S(Y)}));break}case"delete":var oe=new Ze().addKeys(A.keys);T=b.filter(function(Y){return!oe.hasKey(s.values?S(Y):Y)});break;case"deleteRange":var ce=A.range;T=b.filter(function(Y){return!Ul(S(Y),ce)});break}return T},o);return j===o?o:(j.sort(function(b,A){return ge(M(b),M(A))||ge(S(b),S(A))}),s.limit&&s.limit<1/0&&(j.length>s.limit?j.length=s.limit:o.length===s.limit&&j.length<s.limit&&(p.dirty=!0)),d?Object.freeze(j):j)}function lm(o,s){return ge(o.lower,s.lower)===0&&ge(o.upper,s.upper)===0&&!!o.lowerOpen==!!s.lowerOpen&&!!o.upperOpen==!!s.upperOpen}function av(o,s,u,c){if(o===void 0)return s!==void 0?-1:0;if(s===void 0)return 1;var p=ge(o,s);if(p===0){if(u&&c)return 0;if(u)return 1;if(c)return-1}return p}function uv(o,s,u,c){if(o===void 0)return s!==void 0?1:0;if(s===void 0)return-1;var p=ge(o,s);if(p===0){if(u&&c)return 0;if(u)return-1;if(c)return 1}return p}function lv(o,s){return av(o.lower,s.lower,o.lowerOpen,s.lowerOpen)<=0&&uv(o.upper,s.upper,o.upperOpen,s.upperOpen)>=0}function cv(o,s,u,c){var p=wn["idb://".concat(o,"/").concat(s)];if(!p)return[];var d=p.queries[u];if(!d)return[null,!1,p,null];var _=c.query?c.query.index.name:null,y=d[_||""];if(!y)return[null,!1,p,null];switch(u){case"query":var x=y.find(function($){return $.req.limit===c.limit&&$.req.values===c.values&&lm($.req.query.range,c.query.range)});if(x)return[x,!0,p,y];var w=y.find(function($){var M="limit"in $.req?$.req.limit:1/0;return M>=c.limit&&(c.values?$.req.values:!0)&&lv($.req.query.range,c.query.range)});return[w,!1,p,y];case"count":var S=y.find(function($){return lm($.req.query.range,c.query.range)});return[S,!!S,p,y]}}function fv(o,s,u,c){o.subscribers.add(u),c.addEventListener("abort",function(){o.subscribers.delete(u),o.subscribers.size===0&&pv(o,s)})}function pv(o,s){setTimeout(function(){o.subscribers.size===0&&Be(s,o)},3e3)}var mv={stack:"dbcore",level:0,name:"Cache",create:function(o){var s=o.schema.name,u=r(r({},o),{transaction:function(c,p,d){var _=o.transaction(c,p,d);if(p==="readwrite"){var y=new AbortController,x=y.signal,w=function(S){return function(){if(y.abort(),p==="readwrite"){for(var $=new Set,M=0,j=c;M<j.length;M++){var b=j[M],A=wn["idb://".concat(s,"/").concat(b)];if(A){var T=o.table(b),D=A.optimisticOps.filter(function(xe){return xe.trans===_});if(_._explicit&&S&&_.mutatedParts)for(var N=0,L=Object.values(A.queries.query);N<L.length;N++)for(var F=L[N],R=0,z=F.slice();R<z.length;R++){var V=z[R];Rl(V.obsSet,_.mutatedParts)&&(Be(F,V),V.subscribers.forEach(function(xe){return $.add(xe)}))}else if(D.length>0){A.optimisticOps=A.optimisticOps.filter(function(xe){return xe.trans!==_});for(var W=0,oe=Object.values(A.queries.query);W<oe.length;W++)for(var F=oe[W],ce=0,Y=F.slice();ce<Y.length;ce++){var V=Y[ce];if(V.res!=null&&_.mutatedParts)if(S&&!V.dirty){var de=Object.isFrozen(V.res),re=um(V.res,V.req,D,T,V,de);V.dirty?(Be(F,V),V.subscribers.forEach(function(Re){return $.add(Re)})):re!==V.res&&(V.res=re,V.promise=q.resolve({result:re}))}else V.dirty&&Be(F,V),V.subscribers.forEach(function(Re){return $.add(Re)})}}}}$.forEach(function(xe){return xe()})}}};_.addEventListener("abort",w(!1),{signal:x}),_.addEventListener("error",w(!1),{signal:x}),_.addEventListener("complete",w(!0),{signal:x})}return _},table:function(c){var p=o.table(c),d=p.schema.primaryKey,_=r(r({},p),{mutate:function(y){var x=Z.trans;if(d.outbound||x.db._options.cache==="disabled"||x.explicit||x.idbtrans.mode!=="readwrite")return p.mutate(y);var w=wn["idb://".concat(s,"/").concat(c)];if(!w)return p.mutate(y);var S=p.mutate(y);return(y.type==="add"||y.type==="put")&&(y.values.length>=50||Kl(d,y).some(function($){return $==null}))?S.then(function($){var M=r(r({},y),{values:y.values.map(function(b,A){var T;if($.failures[A])return b;var D=!((T=d.keyPath)===null||T===void 0)&&T.includes(".")?Ot(b):r({},b);return pe(D,d.keyPath,$.results[A]),D})}),j=am(w,M,$);w.optimisticOps.push(j),queueMicrotask(function(){return y.mutatedParts&&Ns(y.mutatedParts)})}):(w.optimisticOps.push(y),y.mutatedParts&&Ns(y.mutatedParts),S.then(function($){if($.numFailures>0){Be(w.optimisticOps,y);var M=am(w,y,$);M&&w.optimisticOps.push(M),y.mutatedParts&&Ns(y.mutatedParts)}}),S.catch(function(){Be(w.optimisticOps,y),y.mutatedParts&&Ns(y.mutatedParts)})),S},query:function(y){var x;if(!om(Z,p)||!sm("query",y))return p.query(y);var w=((x=Z.trans)===null||x===void 0?void 0:x.db._options.cache)==="immutable",S=Z,$=S.requery,M=S.signal,j=cv(s,c,"query",y),b=j[0],A=j[1],T=j[2],D=j[3];if(b&&A)b.obsSet=y.obsSet;else{var N=p.query(y).then(function(L){var F=L.result;if(b&&(b.res=F),w){for(var R=0,z=F.length;R<z;++R)Object.freeze(F[R]);Object.freeze(F)}else L.result=Ot(F);return L}).catch(function(L){return D&&b&&Be(D,b),Promise.reject(L)});b={obsSet:y.obsSet,promise:N,subscribers:new Set,type:"query",req:y,dirty:!1},D?D.push(b):(D=[b],T||(T=wn["idb://".concat(s,"/").concat(c)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),T.queries.query[y.query.index.name||""]=D)}return fv(b,D,$,M),b.promise.then(function(L){return{result:um(L.result,y,T?.optimisticOps,p,b,w)}})}});return _}});return u}};function Fs(o,s){return new Proxy(o,{get:function(u,c,p){return c==="db"?s:Reflect.get(u,c,p)}})}var br=function(){function o(s,u){var c=this;this._middlewares={},this.verno=0;var p=o.dependencies;this._options=u=r({addons:o.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange};var d=u.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var _={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Se,dbReadyPromise:null,cancelOpen:Se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};_.dbReadyPromise=new q(function(x){_.dbReadyResolve=x}),_.openCanceller=new q(function(x,w){_.cancelOpen=w}),this._state=_,this.name=s,this.on=oo(this,"populate","blocked","versionchange","close",{ready:[sl,Se]}),this.on.ready.subscribe=K(this.on.ready.subscribe,function(x){return function(w,S){o.vip(function(){var $=c._state;if($.openComplete)$.dbOpenError||q.resolve().then(w),S&&x(w);else if($.onReadyBeingFired)$.onReadyBeingFired.push(w),S&&x(w);else{x(w);var M=c;S||x(function j(){M.on.ready.unsubscribe(w),M.on.ready.unsubscribe(j)})}})}}),this.Collection=wx(this),this.Table=gx(this),this.Transaction=Tx(this),this.Version=qx(this),this.WhereClause=Ax(this),this.on("versionchange",function(x){x.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(c.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(c.name,"'. Closing db now to resume the delete request.")),c.close({disableAutoOpen:!1})}),this.on("blocked",function(x){!x.newVersion||x.newVersion<x.oldVersion?console.warn("Dexie.delete('".concat(c.name,"') was blocked")):console.warn("Upgrade '".concat(c.name,"' blocked by other connection holding version ").concat(x.oldVersion/10))}),this._maxKey=co(u.IDBKeyRange),this._createTransaction=function(x,w,S,$){return new c.Transaction(x,w,S,c._options.chromeTransactionDurability,$)},this._fireOnBlocked=function(x){c.on("blocked").fire(x),ii.filter(function(w){return w.name===c.name&&w!==c&&!w._state.vcFired}).map(function(w){return w.on("versionchange").fire(x)})},this.use(rv),this.use(mv),this.use(nv),this.use(Zx),this.use(ev);var y=new Proxy(this,{get:function(x,w,S){if(w==="_vip")return!0;if(w==="table")return function(M){return Fs(c.table(M),y)};var $=Reflect.get(x,w,S);return $ instanceof Wp?Fs($,y):w==="tables"?$.map(function(M){return Fs(M,y)}):w==="_createTransaction"?function(){var M=$.apply(this,arguments);return Fs(M,y)}:$}});this.vip=y,d.forEach(function(x){return x(c)})}return o.prototype.version=function(s){if(isNaN(s)||s<.1)throw new ie.Type("Given version is not a positive number");if(s=Math.round(s*10)/10,this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,s);var u=this._versions,c=u.filter(function(p){return p._cfg.version===s})[0];return c||(c=new this.Version(s),u.push(c),u.sort(Nx),c.stores({}),this._state.autoSchema=!1,c)},o.prototype._whenReady=function(s){var u=this;return this.idbdb&&(this._state.openComplete||Z.letThrough||this._vip)?s():new q(function(c,p){if(u._state.openComplete)return p(new ie.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen){p(new ie.DatabaseClosed);return}u.open().catch(Se)}u._state.dbReadyPromise.then(c,p)}).then(s)},o.prototype.use=function(s){var u=s.stack,c=s.create,p=s.level,d=s.name;d&&this.unuse({stack:u,name:d});var _=this._middlewares[u]||(this._middlewares[u]=[]);return _.push({stack:u,create:c,level:p??10,name:d}),_.sort(function(y,x){return y.level-x.level}),this},o.prototype.unuse=function(s){var u=s.stack,c=s.name,p=s.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(d){return p?d.create!==p:c?d.name!==c:!1})),this},o.prototype.open=function(){var s=this;return yn(Kr,function(){return Qx(s)})},o.prototype._close=function(){var s=this._state,u=ii.indexOf(this);if(u>=0&&ii.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}s.isBeingOpened||(s.dbReadyPromise=new q(function(c){s.dbReadyResolve=c}),s.openCanceller=new q(function(c,p){s.cancelOpen=p}))},o.prototype.close=function(s){var u=s===void 0?{disableAutoOpen:!0}:s,c=u.disableAutoOpen,p=this._state;c?(p.isBeingOpened&&p.cancelOpen(new ie.DatabaseClosed),this._close(),p.autoOpen=!1,p.dbOpenError=new ie.DatabaseClosed):(this._close(),p.autoOpen=this._options.autoOpen||p.isBeingOpened,p.openComplete=!1,p.dbOpenError=null)},o.prototype.delete=function(s){var u=this;s===void 0&&(s={disableAutoOpen:!0});var c=arguments.length>0&&typeof arguments[0]!="object",p=this._state;return new q(function(d,_){var y=function(){u.close(s);var x=u._deps.indexedDB.deleteDatabase(u.name);x.onsuccess=Ie(function(){Gx(u._deps,u.name),d()}),x.onerror=er(_),x.onblocked=u._fireOnBlocked};if(c)throw new ie.InvalidArgument("Invalid closeOptions argument to db.delete()");p.isBeingOpened?p.dbReadyPromise.then(y):y()})},o.prototype.backendDB=function(){return this.idbdb},o.prototype.isOpen=function(){return this.idbdb!==null},o.prototype.hasBeenClosed=function(){var s=this._state.dbOpenError;return s&&s.name==="DatabaseClosed"},o.prototype.hasFailed=function(){return this._state.dbOpenError!==null},o.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(o.prototype,"tables",{get:function(){var s=this;return a(this._allTables).map(function(u){return s._allTables[u]})},enumerable:!1,configurable:!0}),o.prototype.transaction=function(){var s=Jx.apply(this,arguments);return this._transaction.apply(this,s)},o.prototype._transaction=function(s,u,c){var p=this,d=Z.trans;(!d||d.db!==this||s.indexOf("!")!==-1)&&(d=null);var _=s.indexOf("?")!==-1;s=s.replace("!","").replace("?","");var y,x;try{if(x=u.map(function(S){var $=S instanceof p.Table?S.name:S;if(typeof $!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return $}),s=="r"||s===yl)y=yl;else if(s=="rw"||s==xl)y=xl;else throw new ie.InvalidArgument("Invalid transaction mode: "+s);if(d){if(d.mode===yl&&y===xl)if(_)d=null;else throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");d&&x.forEach(function(S){if(d&&d.storeNames.indexOf(S)===-1)if(_)d=null;else throw new ie.SubTransaction("Table "+S+" not included in parent transaction.")}),_&&d&&!d.active&&(d=null)}}catch(S){return d?d._promise(null,function($,M){M(S)}):Pe(S)}var w=nm.bind(null,this,y,x,d,c);return d?d._promise(y,w,"lock"):Z.trans?yn(Z.transless,function(){return p._whenReady(w)}):this._whenReady(w)},o.prototype.table=function(s){if(!g(this._allTables,s))throw new ie.InvalidTable("Table ".concat(s," does not exist"));return this._allTables[s]},o}(),dv=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",hv=function(){function o(s){this._subscribe=s}return o.prototype.subscribe=function(s,u,c){return this._subscribe(!s||typeof s=="function"?{next:s,error:u,complete:c}:s)},o.prototype[dv]=function(){return this},o}(),Bs;try{Bs={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Bs={indexedDB:null,IDBKeyRange:null}}function cm(o){var s=!1,u,c=new hv(function(p){var d=nl(o);function _(D){var N=ti();try{d&&ni();var L=Ur(o,D);return d&&(L=L.finally(zr)),L}finally{N&&ri()}}var y=!1,x,w={},S={},$={get closed(){return y},unsubscribe:function(){y||(y=!0,x&&x.abort(),M&&Vr.storagemutated.unsubscribe(A))}};p.start&&p.start($);var M=!1,j=function(){return hl(T)};function b(){return Rl(S,w)}var A=function(D){Rs(w,D),b()&&j()},T=function(){if(!(y||!Bs.indexedDB)){w={};var D={};x&&x.abort(),x=new AbortController;var N={subscr:D,signal:x.signal,requery:j,querier:o,trans:null},L=_(N);Promise.resolve(L).then(function(F){s=!0,u=F,!(y||N.signal.aborted)&&(w={},S=D,!rl(S)&&!M&&(Vr(lo,A),M=!0),hl(function(){return!y&&p.next&&p.next(F)}))},function(F){s=!1,["DatabaseClosedError","AbortError"].includes(F?.name)||y||hl(function(){y||p.error&&p.error(F)})})}};return setTimeout(j,0),$});return c.hasValue=function(){return s},c.getValue=function(){return u},c}var $n=br;v($n,r(r({},hs),{delete:function(o){var s=new $n(o,{addons:[]});return s.delete()},exists:function(o){return new $n(o,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return Vx($n.dependencies).then(o)}catch{return Pe(new ie.MissingAPI)}},defineClass:function(){function o(s){f(this,s)}return o},ignoreTransaction:function(o){return Z.trans?yn(Z.transless,o):o()},vip:Ml,async:function(o){return function(){try{var s=Bl(o.apply(this,arguments));return!s||typeof s.then!="function"?q.resolve(s):s}catch(u){return Pe(u)}}},spawn:function(o,s,u){try{var c=Bl(o.apply(u,s||[]));return!c||typeof c.then!="function"?q.resolve(c):c}catch(p){return Pe(p)}},currentTransaction:{get:function(){return Z.trans||null}},waitFor:function(o,s){var u=q.resolve(typeof o=="function"?$n.ignoreTransaction(o):o).timeout(s||6e4);return Z.trans?Z.trans.waitFor(u):u},Promise:q,debug:{get:function(){return Zt},set:function(o){Tp(o)}},derive:k,extend:f,props:v,override:K,Events:oo,on:Vr,liveQuery:cm,extendObservabilitySet:Rs,getByKeyPath:le,setByKeyPath:pe,delByKeyPath:ze,shallowClone:Et,deepClone:Ot,getObjectDiff:jl,cmp:ge,asap:X,minKey:gl,addons:[],connections:ii,errnames:ol,dependencies:Bs,cache:wn,semVer:Fp,version:Fp.split(".").map(function(o){return parseInt(o)}).reduce(function(o,s,u){return o+s/Math.pow(10,u*2)})})),$n.maxKey=co($n.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Vr(lo,function(o){if(!Hr){var s;s=new CustomEvent(bl,{detail:o}),Hr=!0,dispatchEvent(s),Hr=!1}}),addEventListener(bl,function(o){var s=o.detail;Hr||zl(s)}));function zl(o){var s=Hr;try{Hr=!0,Vr.storagemutated.fire(o),Fl(o,!0)}finally{Hr=s}}var Hr=!1,Gr,Wl=function(){};typeof BroadcastChannel<"u"&&(Wl=function(){Gr=new BroadcastChannel(bl),Gr.onmessage=function(o){return o.data&&zl(o.data)}},Wl(),typeof Gr.unref=="function"&&Gr.unref(),Vr(lo,function(o){Hr||Gr.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!br.disableBfCache&&o.persisted){Zt&&console.debug("Dexie: handling persisted pagehide"),Gr?.close();for(var s=0,u=ii;s<u.length;s++){var c=u[s];c.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(o){!br.disableBfCache&&o.persisted&&(Zt&&console.debug("Dexie: handling persisted pageshow"),Wl(),zl({all:new Ze(-1/0,[[]])}))}));function _v(o){return new ao({add:o})}function gv(o){return new ao({remove:o})}function yv(o,s){return new ao({replacePrefix:[o,s]})}q.rejectionMapper=Jy,Tp(Zt);var xv=Object.freeze({__proto__:null,Dexie:br,liveQuery:cm,Entity:Kp,cmp:ge,PropModSymbol:xx,PropModification:ao,replacePrefix:yv,add:_v,remove:gv,default:br,RangeSet:Ze,mergeRanges:mo,rangesOverlap:Zp});return r(br,xv,{default:br}),br})});var B=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},et=class{static fromArray(t,r){let n=r||new Ks;for(let i=t.length-1;i>=0;--i)n=new bn(t[i],n);return n}[Symbol.iterator](){return new ql(this)}toArray(){return[...this]}atLeastLength(t){for(let r of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let r of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let r of this)t++;return t}};function me(e,t){return new bn(e,t)}function I(e,t){return et.fromArray(e,t)}var ql=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Ks)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Ks=class extends et{},bn=class extends et{constructor(t,r){super(),this.head=t,this.tail=r}},_o=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,r,n){return Iv(this.buffer,t,r,n)}intFromSlice(t,r,n,i){return Tv(this.buffer,t,r,n,i)}binaryFromSlice(t,r){return new e(this.buffer.slice(t,r))}sliceAfter(t){return new e(this.buffer.slice(t))}},Us=class{constructor(t){this.value=t}};function Tv(e,t,r,n,i){let a=0;if(n)for(let l=t;l<r;l++)a=a*256+e[l];else for(let l=r-1;l>=t;l--)a=a*256+e[l];if(i){let f=2**((r-t)*8-1);a>=f&&(a-=f*2)}return a}function Iv(e,t,r,n){let i=new DataView(e.buffer),a=r-t;if(a===8)return i.getFloat64(t,!n);if(a===4)return i.getFloat32(t,!n);{let l=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${a*8} bits`;throw new globalThis.Error(l)}}var ai=class e extends B{static isResult(t){return t instanceof e}},te=class extends ai{constructor(t){super(),this[0]=t}isOk(){return!0}},se=class extends ai{constructor(t){super(),this[0]=t}isOk(){return!1}};function Ce(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!pm(n)||!pm(i)||!Fv(n,i)||Mv(n,i)||Dv(n,i)||Pv(n,i)||Rv(n,i)||Nv(n,i)||Lv(n,i))return!1;let l=Object.getPrototypeOf(n);if(l!==null&&typeof l.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[f,m]=Cv(n);for(let h of f(n))r.push(m(n,h),m(i,h))}return!0}function Cv(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function Mv(e,t){return e instanceof Date&&(e>t||e<t)}function Dv(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function Pv(e,t){return Array.isArray(e)&&e.length!==t.length}function Rv(e,t){return e instanceof Map&&e.size!==t.size}function Nv(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Lv(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function pm(e){return typeof e=="object"&&e!==null}function Fv(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function En(e,t){return t===0?0:e%t}function On(e,t){return Math.trunc(mm(e,t))}function mm(e,t){return t===0?0:e/t}function ui(e,t,r,n,i,a){let l=new globalThis.Error(i);l.gleam_error=e,l.module=t,l.line=r,l.function=n,l.fn=n;for(let f in a)l[f]=a[f];return l}function li(e,t,r){return e?t:r()}var he=class extends B{constructor(t){super(),this[0]=t}},Oe=class extends B{};function dm(e,t){if(e instanceof he){let r=e[0];return new te(r)}else return new se(t)}function hm(e,t){if(e instanceof he){let r=e[0];return new he(t(r))}else return new Oe}function _m(e){return e instanceof he?e[0]:new Oe}function or(){return ym()}function fi(e,t,r){return vm(t,r,e)}function jv(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=me(i,n)}}}function Kv(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return jv(n,I([]));{let i=r.head;e=r.tail,t=me(i[0],n)}}}function Uv(e){let t=Ws(e);return Kv(t,I([]))}function Vl(e){return Uv(e)}var pi=class extends B{constructor(t){super(),this[0]=t}},qs=class extends B{constructor(t){super(),this[0]=t}};function qv(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function $m(e){return qv(e,0)}function Vv(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=me(i,n)}}}function nt(e){return Vv(e,I([]))}function Hv(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return nt(a);{let l=n.head,f=n.tail,m=i(l)?me(l,a):a;e=f,t=i,r=m}}}function Sr(e,t){return Hv(e,t,I([]))}function Gv(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return nt(a);{let l=n.head;e=n.tail,t=i,r=me(i(l),a)}}}function je(e,t){return Gv(e,t,I([]))}function Vs(e,t){for(;;){let r=e,n=t;if(n<=0)return r;if(r.hasLength(0))return I([]);e=r.tail,t=n-1}}function Yv(e,t,r){for(;;){let n=e,i=t,a=r;if(i<=0)return nt(a);if(n.hasLength(0))return nt(a);{let f=n.head;e=n.tail,t=i-1,r=me(f,a)}}}function bm(e,t){return Yv(e,t,I([]))}function Qv(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=me(i,n)}}}function At(e,t){return Qv(nt(e),t)}function Jr(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return i;{let l=n.head;e=n.tail,t=a(i,l),r=a}}}function Jv(e,t,r,n){for(;;){let i=e,a=t,l=r,f=n;if(i.hasLength(0))return a;{let m=i.head;e=i.tail,t=l(a,m,f),r=l,n=f+1}}}function Hl(e,t,r){return Jv(e,t,r,0)}function Em(e,t,r){for(;;){let n=e,i=t,a=r;if(n.hasLength(0))return i;{let l=n.head,f=n.tail,m=a(i,l);if(m instanceof pi){let h=m[0];e=f,t=h,r=a}else return m[0]}}}function Om(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return!1;{let i=r.head,a=r.tail;if(n(i))return!0;e=a,t=n}}}function go(e){return Yl(e)}function mi(e){return e}function yo(e){return Tm(e)}function Jl(e,t,r){if(r<0)return"";if(t<0){let a=yo(e)+t;return a<0?"":Ql(e,a,r)}else return Ql(e,t,r)}function Gs(e,t){return t<0?e:Jl(e,t,yo(e)-t)}function xo(e){let r=go(e);return mi(r)}function i0(e,t,r){for(;;){let n=e,i=t,a=r;if(i<=0)return a;e=n,t=i-1,r=a+n}}function Xl(e,t){return i0(e,t,"")}function vo(e,t){return Im(e,t)}function o0(e,t){let r=yo(t),n=On(e,r),i=En(e,r);return Xl(t,n)+Jl(t,0,i)}function Xr(e,t,r){let n=yo(e),i=t-n;return i<=0?e:o0(i,r)+e}function Zl(e){return Cm(e)}function kt(e){let t=ur(e);return mi(t)}function kr(e,t){if(e.isOk()){let r=e[0];return new te(t(r))}else{let r=e[0];return new se(r)}}function tc(e,t){if(e.isOk()){let r=e[0];return new te(r)}else{let r=e[0];return new se(t(r))}}function rc(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new se(r)}}var Ut=class extends B{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function Tr(e){return ic(e)}function Ys(e){return Lm(e)}function nc(e){return Fm(e)}function Rm(e){return t=>Bm(t,e)}function Qs(e){return t=>{if(e.hasLength(0))return new se(I([new Ut("another type",Tr(t),I([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let a=i[0];return new te(a)}else return Qs(n)(t)}}}function c0(e,t){let r=t,n=Qs(I([An,a=>kr(Ys(a),Je)])),i=(()=>{let a=n(r);if(a.isOk())return a[0];{let l=I(["<",Tr(r),">"]),f=go(l);return mi(f)}})();return e.withFields({path:me(i,e.path)})}function f0(e,t){return tc(e,r=>je(r,t))}function An(e){return Nm(e)}function Js(e,t){return r=>{let n=new Ut("field","nothing",I([]));return rc(jm(r,e),i=>{let l=dm(i,I([n])),f=rc(l,t);return f0(f,m=>c0(m,e))})}}var Km=new WeakMap,oc=new DataView(new ArrayBuffer(8)),sc=0;function ac(e){let t=Km.get(e);if(t!==void 0)return t;let r=sc++;return sc===2147483647&&(sc=0),Km.set(e,r),r}function uc(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function cc(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Um(e){oc.setFloat64(0,e);let t=oc.getInt32(0),r=oc.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function p0(e){return cc(e.toString())}function m0(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return ac(e);if(e instanceof Date)return Um(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+Tt(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+Tt(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+uc(Tt(n),Tt(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let a=n[i],l=e[a];r=r+uc(Tt(l),cc(a))|0}}return r}function Tt(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Um(e);case"string":return cc(e);case"bigint":return p0(e);case"object":return m0(e);case"symbol":return ac(e);case"function":return ac(e);default:return 0}}var cr=5,fc=Math.pow(2,cr),d0=fc-1,h0=fc/2,_0=fc/4,it=0,lr=1,_t=2,In=3,pc={type:_t,bitmap:0,array:[]};function wo(e,t){return e>>>t&d0}function Zs(e,t){return 1<<wo(e,t)}function g0(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function mc(e,t){return g0(e&t-1)}function It(e,t,r){let n=e.length,i=new Array(n);for(let a=0;a<n;++a)i[a]=e[a];return i[t]=r,i}function y0(e,t,r){let n=e.length,i=new Array(n+1),a=0,l=0;for(;a<t;)i[l++]=e[a++];for(i[l++]=r;a<n;)i[l++]=e[a++];return i}function lc(e,t){let r=e.length,n=new Array(r-1),i=0,a=0;for(;i<t;)n[a++]=e[i++];for(++i;i<r;)n[a++]=e[i++];return n}function zm(e,t,r,n,i,a){let l=Tt(t);if(l===n)return{type:In,hash:l,array:[{type:it,k:t,v:r},{type:it,k:i,v:a}]};let f={val:!1};return $o(dc(pc,e,l,t,r,f),e,n,i,a,f)}function $o(e,t,r,n,i,a){switch(e.type){case lr:return x0(e,t,r,n,i,a);case _t:return dc(e,t,r,n,i,a);case In:return v0(e,t,r,n,i,a)}}function x0(e,t,r,n,i,a){let l=wo(r,t),f=e.array[l];if(f===void 0)return a.val=!0,{type:lr,size:e.size+1,array:It(e.array,l,{type:it,k:n,v:i})};if(f.type===it)return Ce(n,f.k)?i===f.v?e:{type:lr,size:e.size,array:It(e.array,l,{type:it,k:n,v:i})}:(a.val=!0,{type:lr,size:e.size,array:It(e.array,l,zm(t+cr,f.k,f.v,r,n,i))});let m=$o(f,t+cr,r,n,i,a);return m===f?e:{type:lr,size:e.size,array:It(e.array,l,m)}}function dc(e,t,r,n,i,a){let l=Zs(r,t),f=mc(e.bitmap,l);if(e.bitmap&l){let m=e.array[f];if(m.type!==it){let g=$o(m,t+cr,r,n,i,a);return g===m?e:{type:_t,bitmap:e.bitmap,array:It(e.array,f,g)}}let h=m.k;return Ce(n,h)?i===m.v?e:{type:_t,bitmap:e.bitmap,array:It(e.array,f,{type:it,k:n,v:i})}:(a.val=!0,{type:_t,bitmap:e.bitmap,array:It(e.array,f,zm(t+cr,h,m.v,r,n,i))})}else{let m=e.array.length;if(m>=h0){let h=new Array(32),g=wo(r,t);h[g]=dc(pc,t+cr,r,n,i,a);let v=0,O=e.bitmap;for(let E=0;E<32;E++){if(O&1){let k=e.array[v++];h[E]=k}O=O>>>1}return{type:lr,size:m+1,array:h}}else{let h=y0(e.array,f,{type:it,k:n,v:i});return a.val=!0,{type:_t,bitmap:e.bitmap|l,array:h}}}}function v0(e,t,r,n,i,a){if(r===e.hash){let l=hc(e,n);if(l!==-1)return e.array[l].v===i?e:{type:In,hash:r,array:It(e.array,l,{type:it,k:n,v:i})};let f=e.array.length;return a.val=!0,{type:In,hash:r,array:It(e.array,f,{type:it,k:n,v:i})}}return $o({type:_t,bitmap:Zs(e.hash,t),array:[e]},t,r,n,i,a)}function hc(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(Ce(t,e.array[n].k))return n;return-1}function Xs(e,t,r,n){switch(e.type){case lr:return w0(e,t,r,n);case _t:return $0(e,t,r,n);case In:return b0(e,n)}}function w0(e,t,r,n){let i=wo(r,t),a=e.array[i];if(a!==void 0){if(a.type!==it)return Xs(a,t+cr,r,n);if(Ce(n,a.k))return a}}function $0(e,t,r,n){let i=Zs(r,t);if(!(e.bitmap&i))return;let a=mc(e.bitmap,i),l=e.array[a];if(l.type!==it)return Xs(l,t+cr,r,n);if(Ce(n,l.k))return l}function b0(e,t){let r=hc(e,t);if(!(r<0))return e.array[r]}function _c(e,t,r,n){switch(e.type){case lr:return E0(e,t,r,n);case _t:return O0(e,t,r,n);case In:return S0(e,n)}}function E0(e,t,r,n){let i=wo(r,t),a=e.array[i];if(a===void 0)return e;let l;if(a.type===it){if(!Ce(a.k,n))return e}else if(l=_c(a,t+cr,r,n),l===a)return e;if(l===void 0){if(e.size<=_0){let f=e.array,m=new Array(e.size-1),h=0,g=0,v=0;for(;h<i;){let O=f[h];O!==void 0&&(m[g]=O,v|=1<<h,++g),++h}for(++h;h<f.length;){let O=f[h];O!==void 0&&(m[g]=O,v|=1<<h,++g),++h}return{type:_t,bitmap:v,array:m}}return{type:lr,size:e.size-1,array:It(e.array,i,l)}}return{type:lr,size:e.size,array:It(e.array,i,l)}}function O0(e,t,r,n){let i=Zs(r,t);if(!(e.bitmap&i))return e;let a=mc(e.bitmap,i),l=e.array[a];if(l.type!==it){let f=_c(l,t+cr,r,n);return f===l?e:f!==void 0?{type:_t,bitmap:e.bitmap,array:It(e.array,a,f)}:e.bitmap===i?void 0:{type:_t,bitmap:e.bitmap^i,array:lc(e.array,a)}}return Ce(n,l.k)?e.bitmap===i?void 0:{type:_t,bitmap:e.bitmap^i,array:lc(e.array,a)}:e}function S0(e,t){let r=hc(e,t);if(r<0)return e;if(e.array.length!==1)return{type:In,hash:e.hash,array:lc(e.array,r)}}function Wm(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let a=r[i];if(a!==void 0){if(a.type===it){t(a.v,a.k);continue}Wm(a,t)}}}var fr=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let a=r[i];n=n.set(a,t[a])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=Xs(this.root,0,Tt(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?pc:this.root,a=$o(i,0,Tt(t),t,r,n);return a===this.root?this:new e(a,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=_c(this.root,0,Tt(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:Xs(this.root,0,Tt(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){Wm(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+uc(Tt(r),Tt(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let r=!0;return this.forEach((n,i)=>{r=r&&Ce(t.get(i,!n),n)}),r}};var k0=void 0,qm={};function Ym(e){return e.toString()}function Qm(e){let t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{let r=t.indexOf("e");return r>=0?t.slice(0,r)+".0"+t.slice(r):t+".0"}}function Tm(e){if(e==="")return 0;let t=Jm(e);if(t){let r=0;for(let n of t)r++;return r}else return e.match(/./gsu).length}var Vm;function Jm(e){if(globalThis.Intl&&Intl.Segmenter)return Vm||=new Intl.Segmenter,Vm.segment(e)[Symbol.iterator]()}function Im(e,t){let r=e[Symbol.iterator](),n=r.next().value||"",i=r.next();for(;!i.done;)n=n+t+i.value,i=r.next();return n}function Yl(e){let t="";for(let r of e)t=t+r;return t}function Ql(e,t,r){if(r<=0||t>=e.length)return"";let n=Jm(e);if(n){for(;t-- >0;)n.next();let i="";for(;r-- >0;){let a=n.next().value;if(a===void 0)break;i+=a.segment}return i}else return e.match(/./gsu).slice(t,t+r).join("")}var Xm=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),T0=new RegExp(`^([${Xm}]*)`,"g"),I0=new RegExp(`([${Xm}]*)$`,"g");function Cm(e){return Mm(Dm(e))}function Mm(e){return e.replace(T0,"")}function Dm(e){return e.replace(I0,"")}function Zm(e){typeof process=="object"&&process.stderr?.write?process.stderr.write(e+`
`):typeof Deno=="object"?Deno.stderr.writeSync(new TextEncoder().encode(e+`
`)):console.log(e)}function ym(){return fr.new()}function Ws(e){return et.fromArray(e.entries())}function xm(e,t){let r=e.get(t,qm);return r===qm?new se(k0):new te(r)}function vm(e,t,r){return r.set(e,t)}function ic(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof ai)return"Result";if(e instanceof et)return"List";if(e instanceof _o)return"BitArray";if(e instanceof fr)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function ea(e,t){return C0(e,ic(t))}function C0(e,t){return new se(et.fromArray([new Ut(e,t,et.fromArray([]))]))}function Nm(e){return typeof e=="string"?new te(e):ea("String",e)}function Lm(e){return Number.isInteger(e)?new te(e):ea("Int",e)}function Fm(e){return typeof e=="boolean"?new te(e):ea("Bool",e)}function Bm(e,t){if(e==null||e instanceof Oe)return new te(new Oe);e instanceof he&&(e=e[0]);let r=t(e);return r.isOk()?new te(new he(r[0])):r}function jm(e,t){let r=()=>ea("Dict",e);if(e instanceof fr||e instanceof WeakMap||e instanceof Map){let n=xm(e,t);return new te(n.isOk()?new he(n[0]):new Oe)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?Hm(e,t,()=>new te(new Oe)):Hm(e,t,r)}function Hm(e,t,r){try{return t in e?new te(new he(e[t])):r()}catch{return r()}}function ur(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return M0(e);if(t==="bigint"||Number.isInteger(e))return e.toString();if(t==="number")return Qm(e);if(Array.isArray(e))return`#(${e.map(ur).join(", ")})`;if(e instanceof et)return N0(e);if(e instanceof Us)return F0(e);if(e instanceof _o)return L0(e);if(e instanceof B)return R0(e);if(e instanceof fr)return D0(e);if(e instanceof Set)return`//js(Set(${[...e].map(ur).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return P0(e)}function M0(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];switch(n){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}}return t+='"',t}function D0(e){let t="dict.from_list([",r=!0;return e.forEach((n,i)=>{r||(t=t+", "),t=t+"#("+ur(i)+", "+ur(n)+")",r=!1}),t+"])"}function P0(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let a of Object.keys(e))r.push(`${ur(a)}: ${ur(e[a])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function R0(e){let t=Object.keys(e).map(r=>{let n=ur(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function N0(e){return`[${e.toArray().map(ur).join(", ")}]`}function L0(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function F0(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function Tn(e){return e>=0?e:e*-1}function Je(e){return Ym(e)}var ta=class extends B{constructor(t){super(),this[0]=t}},di=class extends B{},bo=class extends B{},Eo=class extends B{},hi=class extends B{},Cn=class extends B{},Oo=class extends B{},So=class extends B{},Ao=class extends B{},ra=class extends B{};function en(e,t){return[On(e,t),En(e,t)]}var rd=1e3;var nd=1e6;var id=6e7;var od=36e8;var sd=864e8;var ad=6048e8;var ud=2592e9;var ld=31536e9;function cd(e){let r=Jr(e,0,(n,i)=>{if(i[1]instanceof di){let a=i[0];return n+a}else if(i[1]instanceof bo){let a=i[0];return n+a*rd}else if(i[1]instanceof Eo){let a=i[0];return n+a*nd}else if(i[1]instanceof hi){let a=i[0];return n+a*id}else if(i[1]instanceof Cn){let a=i[0];return n+a*od}else if(i[1]instanceof Oo){let a=i[0];return n+a*sd}else if(i[1]instanceof So){let a=i[0];return n+a*ad}else if(i[1]instanceof Ao){let a=i[0];return n+a*ud}else{let a=i[0];return n+a*ld}});return new ta(r)}function fd(e){let t=e[0],r=Tn(t),n=en(r,ld),i=n[0],a=n[1],l=en(a,ud),f=l[0],m=l[1],h=en(m,ad),g=h[0],v=h[1],O=en(v,sd),E=O[0],k=O[1],C=en(k,od),G=C[0],J=C[1],Q=en(J,id),K=Q[0],ne=Q[1],X=en(ne,nd),fe=X[0],le=X[1],pe=en(le,rd),ze=pe[0],Et=pe[1],pn=I([[i,new ra],[f,new Ao],[g,new So],[E,new Oo],[G,new Cn],[K,new hi],[fe,new Eo],[ze,new bo],[Et,new di]]),Xt=Sr(pn,tt=>tt[0]>0);return je(Xt,tt=>t<0?[-1*tt[0],tt[1]]:tt)}var pd=I([["Africa/Abidjan",0],["Africa/Algiers",3600],["Africa/Bissau",0],["Africa/Cairo",7200],["Africa/Casablanca",3600],["Africa/Ceuta",3600],["Africa/El_Aaiun",3600],["Africa/Johannesburg",7200],["Africa/Juba",7200],["Africa/Khartoum",7200],["Africa/Lagos",3600],["Africa/Maputo",7200],["Africa/Monrovia",0],["Africa/Nairobi",10800],["Africa/Ndjamena",3600],["Africa/Sao_Tome",0],["Africa/Tripoli",7200],["Africa/Tunis",3600],["Africa/Windhoek",7200],["America/Adak",-36e3],["America/Anchorage",-32400],["America/Araguaina",-10800],["America/Argentina/Buenos_Aires",-10800],["America/Argentina/Catamarca",-10800],["America/Argentina/Cordoba",-10800],["America/Argentina/Jujuy",-10800],["America/Argentina/La_Rioja",-10800],["America/Argentina/Mendoza",-10800],["America/Argentina/Rio_Gallegos",-10800],["America/Argentina/Salta",-10800],["America/Argentina/San_Juan",-10800],["America/Argentina/San_Luis",-10800],["America/Argentina/Tucuman",-10800],["America/Argentina/Ushuaia",-10800],["America/Asuncion",-14400],["America/Bahia",-10800],["America/Bahia_Banderas",-21600],["America/Barbados",-14400],["America/Belem",-10800],["America/Belize",-21600],["America/Boa_Vista",-14400],["America/Bogota",-18e3],["America/Boise",-25200],["America/Cambridge_Bay",-25200],["America/Campo_Grande",-14400],["America/Cancun",-18e3],["America/Caracas",-14400],["America/Cayenne",-10800],["America/Chicago",-21600],["America/Chihuahua",-21600],["America/Ciudad_Juarez",-25200],["America/Costa_Rica",-21600],["America/Cuiaba",-14400],["America/Danmarkshavn",0],["America/Dawson",-25200],["America/Dawson_Creek",-25200],["America/Denver",-25200],["America/Detroit",-18e3],["America/Edmonton",-25200],["America/Eirunepe",-18e3],["America/El_Salvador",-21600],["America/Fort_Nelson",-25200],["America/Fortaleza",-10800],["America/Glace_Bay",-14400],["America/Goose_Bay",-14400],["America/Grand_Turk",-18e3],["America/Guatemala",-21600],["America/Guayaquil",-18e3],["America/Guyana",-14400],["America/Halifax",-14400],["America/Havana",-18e3],["America/Hermosillo",-25200],["America/Indiana/Indianapolis",-18e3],["America/Indiana/Knox",-21600],["America/Indiana/Marengo",-18e3],["America/Indiana/Petersburg",-18e3],["America/Indiana/Tell_City",-21600],["America/Indiana/Vevay",-18e3],["America/Indiana/Vincennes",-18e3],["America/Indiana/Winamac",-18e3],["America/Inuvik",-25200],["America/Iqaluit",-18e3],["America/Jamaica",-18e3],["America/Juneau",-32400],["America/Kentucky/Louisville",-18e3],["America/Kentucky/Monticello",-18e3],["America/La_Paz",-14400],["America/Lima",-18e3],["America/Los_Angeles",-28800],["America/Maceio",-10800],["America/Managua",-21600],["America/Manaus",-14400],["America/Martinique",-14400],["America/Matamoros",-21600],["America/Mazatlan",-25200],["America/Menominee",-21600],["America/Merida",-21600],["America/Metlakatla",-32400],["America/Mexico_City",-21600],["America/Miquelon",-10800],["America/Moncton",-14400],["America/Monterrey",-21600],["America/Montevideo",-10800],["America/New_York",-18e3],["America/Nome",-32400],["America/Noronha",-7200],["America/North_Dakota/Beulah",-21600],["America/North_Dakota/Center",-21600],["America/North_Dakota/New_Salem",-21600],["America/Nuuk",-7200],["America/Ojinaga",-21600],["America/Panama",-18e3],["America/Paramaribo",-10800],["America/Phoenix",-25200],["America/Port-au-Prince",-18e3],["America/Porto_Velho",-14400],["America/Puerto_Rico",-14400],["America/Punta_Arenas",-10800],["America/Rankin_Inlet",-21600],["America/Recife",-10800],["America/Regina",-21600],["America/Resolute",-21600],["America/Rio_Branco",-18e3],["America/Santarem",-10800],["America/Santiago",-14400],["America/Santo_Domingo",-14400],["America/Sao_Paulo",-10800],["America/Scoresbysund",-7200],["America/Sitka",-32400],["America/St_Johns",-12600],["America/Swift_Current",-21600],["America/Tegucigalpa",-21600],["America/Thule",-14400],["America/Tijuana",-28800],["America/Toronto",-18e3],["America/Vancouver",-28800],["America/Whitehorse",-25200],["America/Winnipeg",-21600],["America/Yakutat",-32400],["Antarctica/Casey",28800],["Antarctica/Davis",25200],["Antarctica/Macquarie",36e3],["Antarctica/Mawson",18e3],["Antarctica/Palmer",-10800],["Antarctica/Rothera",-10800],["Antarctica/Troll",0],["Antarctica/Vostok",18e3],["Asia/Almaty",18e3],["Asia/Amman",10800],["Asia/Anadyr",43200],["Asia/Aqtau",18e3],["Asia/Aqtobe",18e3],["Asia/Ashgabat",18e3],["Asia/Atyrau",18e3],["Asia/Baghdad",10800],["Asia/Baku",14400],["Asia/Bangkok",25200],["Asia/Barnaul",25200],["Asia/Beirut",7200],["Asia/Bishkek",21600],["Asia/Chita",32400],["Asia/Choibalsan",28800],["Asia/Colombo",19800],["Asia/Damascus",10800],["Asia/Dhaka",21600],["Asia/Dili",32400],["Asia/Dubai",14400],["Asia/Dushanbe",18e3],["Asia/Famagusta",7200],["Asia/Gaza",7200],["Asia/Hebron",7200],["Asia/Ho_Chi_Minh",25200],["Asia/Hong_Kong",28800],["Asia/Hovd",25200],["Asia/Irkutsk",28800],["Asia/Jakarta",25200],["Asia/Jayapura",32400],["Asia/Jerusalem",7200],["Asia/Kabul",16200],["Asia/Kamchatka",43200],["Asia/Karachi",18e3],["Asia/Kathmandu",20700],["Asia/Khandyga",32400],["Asia/Kolkata",19800],["Asia/Krasnoyarsk",25200],["Asia/Kuching",28800],["Asia/Macau",28800],["Asia/Magadan",39600],["Asia/Makassar",28800],["Asia/Manila",28800],["Asia/Nicosia",7200],["Asia/Novokuznetsk",25200],["Asia/Novosibirsk",25200],["Asia/Omsk",21600],["Asia/Oral",18e3],["Asia/Pontianak",25200],["Asia/Pyongyang",32400],["Asia/Qatar",10800],["Asia/Qostanay",18e3],["Asia/Qyzylorda",18e3],["Asia/Riyadh",10800],["Asia/Sakhalin",39600],["Asia/Samarkand",18e3],["Asia/Seoul",32400],["Asia/Shanghai",28800],["Asia/Singapore",28800],["Asia/Srednekolymsk",39600],["Asia/Taipei",28800],["Asia/Tashkent",18e3],["Asia/Tbilisi",14400],["Asia/Tehran",12600],["Asia/Thimphu",21600],["Asia/Tokyo",32400],["Asia/Tomsk",25200],["Asia/Ulaanbaatar",28800],["Asia/Urumqi",21600],["Asia/Ust-Nera",36e3],["Asia/Vladivostok",36e3],["Asia/Yakutsk",32400],["Asia/Yangon",23400],["Asia/Yekaterinburg",18e3],["Asia/Yerevan",14400],["Atlantic/Azores",-3600],["Atlantic/Bermuda",-14400],["Atlantic/Canary",0],["Atlantic/Cape_Verde",-3600],["Atlantic/Faroe",0],["Atlantic/Madeira",0],["Atlantic/South_Georgia",-7200],["Atlantic/Stanley",-10800],["Australia/Adelaide",34200],["Australia/Brisbane",36e3],["Australia/Broken_Hill",34200],["Australia/Darwin",34200],["Australia/Eucla",31500],["Australia/Hobart",36e3],["Australia/Lindeman",36e3],["Australia/Lord_Howe",37800],["Australia/Melbourne",36e3],["Australia/Perth",28800],["Australia/Sydney",36e3],["CET",3600],["CST6CDT",-21600],["EET",7200],["EST",-18e3],["EST5EDT",-18e3],["Etc/GMT",0],["Etc/GMT+1",-3600],["Etc/GMT+10",-36e3],["Etc/GMT+11",-39600],["Etc/GMT+12",-43200],["Etc/GMT+2",-7200],["Etc/GMT+3",-10800],["Etc/GMT+4",-14400],["Etc/GMT+5",-18e3],["Etc/GMT+6",-21600],["Etc/GMT+7",-25200],["Etc/GMT+8",-28800],["Etc/GMT+9",-32400],["Etc/GMT-1",3600],["Etc/GMT-10",36e3],["Etc/GMT-11",39600],["Etc/GMT-12",43200],["Etc/GMT-13",46800],["Etc/GMT-14",50400],["Etc/GMT-2",7200],["Etc/GMT-3",10800],["Etc/GMT-4",14400],["Etc/GMT-5",18e3],["Etc/GMT-6",21600],["Etc/GMT-7",25200],["Etc/GMT-8",28800],["Etc/GMT-9",32400],["Etc/UTC",0],["Europe/Andorra",3600],["Europe/Astrakhan",14400],["Europe/Athens",7200],["Europe/Belgrade",3600],["Europe/Berlin",3600],["Europe/Brussels",3600],["Europe/Bucharest",7200],["Europe/Budapest",3600],["Europe/Chisinau",7200],["Europe/Dublin",3600],["Europe/Gibraltar",3600],["Europe/Helsinki",7200],["Europe/Istanbul",10800],["Europe/Kaliningrad",7200],["Europe/Kirov",10800],["Europe/Kyiv",7200],["Europe/Lisbon",0],["Europe/London",0],["Europe/Madrid",3600],["Europe/Malta",3600],["Europe/Minsk",10800],["Europe/Moscow",10800],["Europe/Paris",3600],["Europe/Prague",3600],["Europe/Riga",7200],["Europe/Rome",3600],["Europe/Samara",14400],["Europe/Saratov",14400],["Europe/Simferopol",10800],["Europe/Sofia",7200],["Europe/Tallinn",7200],["Europe/Tirane",3600],["Europe/Ulyanovsk",14400],["Europe/Vienna",3600],["Europe/Vilnius",7200],["Europe/Volgograd",10800],["Europe/Warsaw",3600],["Europe/Zurich",3600],["HST",-36e3],["Indian/Chagos",21600],["Indian/Maldives",18e3],["Indian/Mauritius",14400],["MET",3600],["MST",-25200],["MST7MDT",-25200],["PST8PDT",-28800],["Pacific/Apia",46800],["Pacific/Auckland",43200],["Pacific/Bougainville",39600],["Pacific/Chatham",45900],["Pacific/Easter",-21600],["Pacific/Efate",39600],["Pacific/Fakaofo",46800],["Pacific/Fiji",43200],["Pacific/Galapagos",-21600],["Pacific/Gambier",-32400],["Pacific/Guadalcanal",39600],["Pacific/Guam",36e3],["Pacific/Honolulu",-36e3],["Pacific/Kanton",46800],["Pacific/Kiritimati",50400],["Pacific/Kosrae",39600],["Pacific/Kwajalein",43200],["Pacific/Marquesas",-34200],["Pacific/Nauru",43200],["Pacific/Niue",-39600],["Pacific/Norfolk",39600],["Pacific/Noumea",39600],["Pacific/Pago_Pago",-39600],["Pacific/Palau",32400],["Pacific/Pitcairn",-28800],["Pacific/Port_Moresby",36e3],["Pacific/Rarotonga",-36e3],["Pacific/Tahiti",-36e3],["Pacific/Tarawa",43200],["Pacific/Tongatapu",46800],["WET",0]]);function md(){return Date.now()*1e3}function dd(){return-new Date().getTimezoneOffset()}function hd(){return new he(Intl.DateTimeFormat().resolvedOptions().timeZone)}function _d(){return Math.floor(globalThis.performance.now()*1e3)}function gd(e,t){let r=new Date((e+t)/1e3);return[[r.getUTCFullYear(),r.getUTCMonth()+1,r.getUTCDate()],[r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()]]}var na=class extends B{constructor(t,r,n,i){super(),this.wall_time=t,this.offset=r,this.timezone=n,this.monotonic_time=i}};function yc(e){{let t=e.wall_time;return On(t,1e6)}}function yd(e){return new na(e*1e6,0,new Oe,new Oe)}function J0(e){return li(e===0,new te("Z"),()=>{let t=(()=>{let r=I([[e,new di]]),n=cd(r);return fd(n)})();if(t.hasLength(2)&&t.head[1]instanceof Cn&&t.tail.head[1]instanceof hi){let r=t.head[0],n=t.tail.head[0],i=I([r>0?xo(I(["+",(()=>{let m=Je(r);return Xr(m,2,"0")})()])):xo(I(["-",(()=>{let m=Tn(r),h=Je(m);return Xr(h,2,"0")})()])),(()=>{let f=Tn(n),m=Je(f);return Xr(m,2,"0")})()]),a=vo(i,":");return new te(a)}else if(t.hasLength(1)&&t.head[1]instanceof Cn){let r=t.head[0],n=I([r>0?xo(I(["+",(()=>{let f=Je(r);return Xr(f,2,"0")})()])):xo(I(["-",(()=>{let f=Tn(r),m=Je(f);return Xr(m,2,"0")})()])),"00"]),i=vo(n,":");return new te(i)}else return new se(void 0)})}function X0(e){{let t=e.wall_time,r=e.offset,n=gd(t,r),i=n[0],a=n[1],l=J0(r);if(!l.isOk())throw ui("let_assert","birl",1318,"to_parts","Pattern match failed, no pattern matched the value.",{value:l});let f=l[0];return[i,a,f]}}function xd(e){let t=X0(e),r=t[0][0],n=t[0][1],i=t[0][2];return Je(r)+"-"+(()=>{let l=Je(n);return Xr(l,2,"0")})()+"-"+(()=>{let l=Je(i);return Xr(l,2,"0")})()}function xc(){let e=md(),t=dd(),r=_d(),n=hd();return new na(e,t*6e7,(()=>{let i=hm(n,a=>Om(pd,f=>f[0]===a)?new he(a):new Oe);return _m(i)})(),new he(r))}function vd(e,t){let r=Number.isInteger(t);if(e instanceof fr||e instanceof WeakMap||e instanceof Map){let n=e.get(t,void 0);return new te(n)}if((t===1||t===2)&&e instanceof et){let n=0;for(let i of e){if(n===t)return new te(i);n++}return new se("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?new te(e[t]):new se(r?"Indexable":"Dict")}function wd(e,t,r,n,i){if(!(e instanceof et||Array.isArray(e))){let l=new Ut("List",Tr(e),i);return[i,et.fromArray([l])]}let a=[];for(let l of e){let f=t(l),[m,h]=f;if(h instanceof bn){let[g,v]=r(f,n.toString());return[i,v]}a.push(m),n++}return[et.fromArray(a),i]}var zt=class extends B{constructor(t){super(),this.function=t}};function bd(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new te(n):new se(i)}function _i(e){return new zt(t=>[e,I([])])}function wc(e,t,r){let n=r(e);if(n.isOk())return[n[0],I([])];{let i=n[0];return[t,i]}}function $c(e,t){return new zt(r=>{let n=e.function(r),i=n[0],a=n[1],f=t(i).function(r),m=f,h=f[0];return a.hasLength(0)?m:[h,a]})}function tw(e,t){return I([new Ut(e,Tr(t),I([]))])}function rw(e){return wc(e,"",An)}function nw(e){return wc(e,!1,nc)}function iw(e){return wc(e,0,Ys)}function Ed(e){return new zt(t=>{let r=Rm(n=>new te(n))(t);if(r.isOk()&&r[0]instanceof Oe)return[new Oe,I([])];if(r.isOk()&&r[0]instanceof he){let n=r[0][0],i=e.function(n),a=i[0],l=i[1];return[new he(a),l]}else{let n=e.function(t),i=n[0],a=n[1];return[new he(i),a]}})}function Od(e,t){return new zt(r=>[e,tw(t,r)])}var ia=new zt(rw),Sd=new zt(nw),Ad=new zt(iw);function kd(e){return new zt(t=>wd(t,e.function,(r,n)=>vc(r,I([n])),0,I([])))}function vc(e,t){let r=Qs(I([An,a=>kr(Ys(a),Je)])),n=je(t,a=>{let l=a,f=r(l);return f.isOk()?f[0]:"<"+Tr(l)+">"}),i=je(e[1],a=>a.withFields({path:At(n,a.path)}));return[e[0],i]}function ow(e,t,r,n){for(;;){let i=e,a=t,l=r,f=n;if(i.hasLength(0)){let m=l(f);return vc(m,nt(a))}else{let m=i.head,h=i.tail,g=vd(f,m);if(g.isOk()){let v=g[0];e=h,t=me(m,a),r=l,n=v}else{let v=g[0],k=[l(f)[0],I([new Ut(v,Tr(f),I([]))])];return vc(k,nt(a))}}}}function sw(e,t,r){return new zt(n=>{let i=ow(e,I([]),t.function,n),a=i[0],l=i[1],f=r(a).function(n),m=f[0],h=f[1];return[m,At(l,h)]})}function Mn(e,t,r){return sw(I([e]),t,r)}var oa=class e{constructor(t){this.promise=t}static wrap(t){return t instanceof Promise?new e(t):t}static unwrap(t){return t instanceof e?t.promise:t}};function gi(e,t){return e.then(r=>oa.wrap(t(oa.unwrap(r))))}function yi(e,t){return e.catch(r=>t(r))}function bc(e){return JSON.stringify(e)}function Td(e){return Object.fromEntries(e)}function Id(e){return e.toArray()}function Cd(){return null}function Md(e){return bc(e)}function Dn(e){return e}function Oc(e){return e}function sa(e){return e}function Dd(){return Cd()}function aa(e){return Td(e)}function Sc(e){return Id(e)}function Ac(e,t){let n=je(e,t);return Sc(n)}function Wt(e){let r=kt(e);return Zm(r),e}var ko=class extends B{constructor(t){super(),this.all=t}},Tc=class extends B{constructor(t,r,n,i){super(),this.dispatch=t,this.emit=r,this.select=n,this.root=i}};function Pd(e){return new ko(I([t=>e(t.dispatch,t.emit,t.select,t.root)]))}function To(e){return Pd((t,r,n,i)=>e(t))}function ct(){return new ko(I([]))}function Io(e,t){return new ko(je(e.all,r=>n=>r(new Tc(i=>n.dispatch(t(i)),n.emit,i=>{},n.root))))}var Pn=class extends B{constructor(t){super(),this.content=t}},Ne=class extends B{constructor(t,r,n,i,a,l,f){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=a,this.self_closing=l,this.void=f}},Co=class extends B{constructor(t){super(),this.subtree=t}},wi=class extends B{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},Mo=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}};function dw(e){if(e instanceof wi)return new se(void 0);{let t=e[0],r=e[1],n=Gs(t,2);return new te([n,r])}}function hw(e,t,r){return Hl(e,t,(n,i,a)=>{let l=r+"-"+Je(a);return Rd(i,n,l)})}function Rd(e,t,r){for(;;){let n=e,i=t,a=r;if(n instanceof Pn)return i;if(n instanceof Co){let l=n.subtree;e=l(),t=i,r=a}else{let l=n.attrs,f=n.children,m=Jr(l,i,(h,g)=>{let v=dw(g);if(v.isOk()){let O=v[0][0],E=v[0][1];return fi(h,a+"-"+O,E)}else return h});return hw(f,m,a)}}}function Nd(e){return Rd(e,or(),"0")}function Le(e,t){return new wi(e,t,!1)}function Fd(e,t){return new Mo("on"+e,t)}function Me(e){return Le("class",e)}function Do(e){return Le("title",e)}function Bd(e){return Le("type",e)}function jd(e){return Le("value",e)}function Kd(e){return Le("placeholder",e)}function pr(e,t,r){return e==="area"?new Ne("","",e,t,I([]),!1,!0):e==="base"?new Ne("","",e,t,I([]),!1,!0):e==="br"?new Ne("","",e,t,I([]),!1,!0):e==="col"?new Ne("","",e,t,I([]),!1,!0):e==="embed"?new Ne("","",e,t,I([]),!1,!0):e==="hr"?new Ne("","",e,t,I([]),!1,!0):e==="img"?new Ne("","",e,t,I([]),!1,!0):e==="input"?new Ne("","",e,t,I([]),!1,!0):e==="link"?new Ne("","",e,t,I([]),!1,!0):e==="meta"?new Ne("","",e,t,I([]),!1,!0):e==="param"?new Ne("","",e,t,I([]),!1,!0):e==="source"?new Ne("","",e,t,I([]),!1,!0):e==="track"?new Ne("","",e,t,I([]),!1,!0):e==="wbr"?new Ne("","",e,t,I([]),!1,!0):new Ne("","",e,t,r,!1,!1)}function la(e,t,r,n){return new Ne("",e,t,r,n,!1,!1)}function ft(e){return new Pn(e)}function ca(){return new Pn("")}var Mc=class extends B{constructor(t){super(),this.dict=t}};function Ud(){return new Mc(or())}var fa=class extends B{constructor(t){super(),this[0]=t}},pa=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},ma=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}};function zd(e){return Ce(e.created,or())&&Ce(e.removed,Ud())&&Ce(e.updated,or())}var da=class extends B{constructor(t){super(),this[0]=t}},ha=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},Po=class extends B{constructor(t){super(),this[0]=t}},mr=class extends B{constructor(t){super(),this[0]=t}},Ro=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},_a=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}};var No=class extends B{},ga=class extends B{constructor(t,r){super(),this[0]=t,this[1]=r}},ya=class extends B{constructor(t){super(),this[0]=t}},xa=class extends B{constructor(t){super(),this[0]=t}};window&&window.customElements&&window.customElements.define("lustre-fragment",class extends HTMLElement{constructor(){super()}});function Dc(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:a,next:l,parent:f}=i.pop();for(;l.subtree!==void 0;)l=l.subtree();if(l.content!==void 0)if(a)if(a.nodeType===Node.TEXT_NODE)a.textContent!==l.content&&(a.textContent=l.content),n??=a;else{let m=document.createTextNode(l.content);f.replaceChild(m,a),n??=m}else{let m=document.createTextNode(l.content);f.appendChild(m),n??=m}else if(l.tag!==void 0){let m=vw({prev:a,next:l,dispatch:r,stack:i});a?a!==m&&f.replaceChild(m,a):f.appendChild(m),n??=m}}return n}function vw({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",a=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),l=a?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),f;if(Lo.has(l))f=Lo.get(l);else{let K=new Map;Lo.set(l,K),f=K}let m=a?new Set(f.keys()):null,h=a?new Set(Array.from(e.attributes,K=>K.name)):null,g=null,v=null,O=null;if(a&&t.tag==="textarea"){let K=t.children[Symbol.iterator]().next().value?.content;K!==void 0&&(l.value=K)}let E=[];for(let K of t.attrs){let ne=K[0],X=K[1];if(K.as_property)l[ne]!==X&&(l[ne]=X),a&&h.delete(ne);else if(ne.startsWith("on")){let fe=ne.slice(2),le=r(X,fe==="input");f.has(fe)||l.addEventListener(fe,Fo),f.set(fe,le),a&&m.delete(fe)}else if(ne.startsWith("data-lustre-on-")){let fe=ne.slice(15),le=r(ww);f.has(fe)||l.addEventListener(fe,Fo),f.set(fe,le),l.setAttribute(ne,X)}else ne.startsWith("delegate:data-")||ne.startsWith("delegate:aria-")?(l.setAttribute(ne,X),E.push([ne.slice(10),X])):ne==="class"?g=g===null?X:g+" "+X:ne==="style"?v=v===null?X:v+X:ne==="dangerous-unescaped-html"?O=X:(l.getAttribute(ne)!==X&&l.setAttribute(ne,X),(ne==="value"||ne==="selected")&&(l[ne]=X),a&&h.delete(ne))}if(g!==null&&(l.setAttribute("class",g),a&&h.delete("class")),v!==null&&(l.setAttribute("style",v),a&&h.delete("style")),a){for(let K of h)l.removeAttribute(K);for(let K of m)f.delete(K),l.removeEventListener(K,Fo)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let K of l.assignedElements())for(let[ne,X]of E)K.hasAttribute(ne)||K.setAttribute(ne,X)}),t.key!==void 0&&t.key!=="")l.setAttribute("data-lustre-key",t.key);else if(O!==null)return l.innerHTML=O,l;let k=l.firstChild,C=null,G=null,J=null,Q=va(t).next().value;if(a&&Q!==void 0&&Q.key!==void 0&&Q.key!==""){C=new Set,G=Wd(e),J=Wd(t);for(let K of va(t))k=$w(k,K,l,n,J,G,C)}else for(let K of va(t))n.unshift({prev:k,next:K,parent:l}),k=k?.nextSibling;for(;k;){let K=k.nextSibling;l.removeChild(k),k=K}return l}var Lo=new WeakMap;function Fo(e){let t=e.currentTarget;if(!Lo.has(t)){t.removeEventListener(e.type,Fo);return}let r=Lo.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,Fo);return}r.get(e.type)(e)}function ww(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((a,l)=>{let f=l.split(".");for(let m=0,h=a,g=e;m<f.length;m++)m===f.length-1?h[f[m]]=g[f[m]]:(h[f[m]]??={},g=g[f[m]],h=h[f[m]]);return a},{data:n})}}function Wd(e){let t=new Map;if(e)for(let r of va(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function $w(e,t,r,n,i,a,l){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let m=e.nextSibling;r.removeChild(e),e=m}if(a.size===0)return n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e;if(l.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;l.add(t.key);let f=a.get(t.key);if(!f&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!f&&e!==null){let m=document.createTextNode("");return r.insertBefore(m,e),n.unshift({prev:m,next:t,parent:r}),e}return!f||f===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(f,e),n.unshift({prev:f,next:t,parent:r}),e)}function*va(e){for(let t of e.children)yield*qd(t)}function*qd(e){e.subtree!==void 0?yield*qd(e.subtree()):yield e}var Pc=class e{static start({init:t,update:r,view:n},i,a){if(!Nc())return new se(new Bo);let l=i instanceof HTMLElement?i:document.querySelector(i);if(!l)return new se(new wa(i));let f=new e(l,t(a),r,n);return new te(m=>f.send(m))}constructor(t,[r,n],i,a){this.root=t,this.#e=r,this.#o=i,this.#r=a,this.#t=window.requestAnimationFrame(()=>this.#n(n.all.toArray(),!0))}root;send(t){if(t instanceof Po){if(t[0]instanceof xa){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(a,l=!1)=>f=>{let m=a(f);m instanceof te&&this.send(new mr(m[0],l))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Dc(i,r,n)}}else if(t instanceof mr){let r=t[0],n=t[1]??!1;this.#i.push(r),n?(this.#t=window.cancelAnimationFrame(this.#t),this.#n()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#n()))}else if(t instanceof Ro){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof No)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#o=null,this.#r=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#o;#r;#i=[];#t;#n(t=[],r=!1){if(this.#t=void 0,!this.#s(t,r))return;let n=this.#r(this.#e),i=(l,f=!1)=>m=>{let h=l(m);h instanceof te&&this.send(new mr(h[0],f))},a=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Dc(a,n,i)}#s(t=[],r=!1){for(;this.#i.length>0;){let n=this.#i.shift(),[i,a]=this.#o(this.#e,n);r||=this.#e!==i,t=t.concat(a.all.toArray()),this.#e=i}for(;t.length>0;){let n=t.shift(),i=m=>this.send(new mr(m)),a=(m,h)=>this.root.dispatchEvent(new CustomEvent(m,{detail:h,bubbles:!0,composed:!0})),l=()=>{},f=this.root;n({dispatch:i,emit:a,select:l,root:f})}return this.#i.length>0?this.#s(t,r):r}},Vd=Pc.start;var Rc=class e{static start({init:t,update:r,view:n,on_attribute_change:i},a){let l=new e(t(a),r,n,i);return new te(f=>l.send(f))}constructor([t,r],n,i,a){this.#e=t,this.#o=n,this.#i=i,this.#t=i(t),this.#u=a,this.#n=new Map,this.#s=Nd(this.#t),this.#a(r.all.toArray())}send(t){if(t instanceof da){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof se||this.#r.push(i)}this.#a()}else if(t instanceof ha)this.#r=this.#r.concat(t[0].toArray()),this.#a(t[1].all.toArray());else if(!(t instanceof Po))if(t instanceof mr)this.#r.push(t[0]),this.#a();else if(t instanceof Ro){let r=new pa(t[0],t[1]);for(let[n,i]of this.#n)i(r)}else if(t instanceof _a){let r=this.#s.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof se)return;this.#r.push(n[0]),this.#a()}else if(t instanceof ga){let r=Vl(this.#u),n=new ma(r,this.#t);this.#n=this.#n.set(t[0],t[1]),t[1](n)}else t instanceof ya&&(this.#n=this.#n.delete(t[0]))}#e;#o;#r;#i;#t;#n;#s;#u;#a(t=[]){if(!this.#l(!1,t))return;let r=this.#i(this.#e),n=elements(this.#t,r);if(!zd(n)){let i=new fa(n);for(let[a,l]of this.#n)l(i)}this.#t=r,this.#s=n.handlers}#l(t=!1,r=[]){for(;this.#r.length>0;){let n=this.#r.shift(),[i,a]=this.#o(this.#e,n);t||=this.#e!==i,r=r.concat(a.all.toArray()),this.#e=i}for(;r.length>0;)r.shift()({dispatch:m=>this.send(new mr(m)),emit:(m,h)=>this.root.dispatchEvent(new CustomEvent(m,{detail:h,bubbles:!0,composed:!0})),select:()=>{},root:null});return this.#r.length>0?this.#l(t,r):t}},bw=Rc.start,Nc=()=>globalThis.window&&window.document;var Lc=class extends B{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var wa=class extends B{constructor(t){super(),this.selector=t}},Bo=class extends B{};function Hd(e,t,r){return new Lc(e,t,r,new Oe)}function Gd(e,t,r){return li(!Nc(),new se(new Bo),()=>Vd(e,t,r))}function Yd(e,t){return pr("h1",e,t)}function Qd(e,t){return pr("h2",e,t)}function dr(e,t){return pr("div",e,t)}function Jd(e,t){return pr("li",e,t)}function Fc(e,t){return pr("ul",e,t)}function Bc(e,t){return pr("span",e,t)}function tn(e,t){return pr("button",e,t)}function Xd(e){return pr("input",e,I([]))}function jc(e,t){return Fd(e,t)}function rn(e){return jc("click",t=>new te(e))}function Zd(e){return jc("keydown",t=>{let r=t,n=Js("key",An)(r);return kr(n,e)})}function Sw(e){let t=e;return Js("target",Js("value",An))(t)}function eh(e){return jc("input",t=>{let r=Sw(t);return kr(r,e)})}var th="http://www.w3.org/2000/svg";function rh(e,t){return la(th,"svg",e,t)}function Rn(e){return la(th,"path",e,I([]))}function nh(e){return rh(me(Le("stroke-linejoin","round"),me(Le("stroke-linecap","round"),me(Le("stroke-width","2"),me(Le("stroke","currentColor"),me(Le("fill","none"),me(Le("viewBox","0 0 24 24"),me(Le("height","24"),me(Le("width","24"),e)))))))),I([Rn(I([Le("d","m5 8 6 6")])),Rn(I([Le("d","m4 14 6-6 2-3")])),Rn(I([Le("d","M2 5h12")])),Rn(I([Le("d","M7 2h1")])),Rn(I([Le("d","m22 22-5-10-5 10")])),Rn(I([Le("d","M14 18h6")]))]))}function Nn(e){"@babel/helpers - typeof";return Nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(e)}function ih(e,t){if(Nn(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nn(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oh(e){var t=ih(e,"string");return Nn(t)=="symbol"?t:t+""}function sh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oh(n.key),n)}}function ot(e,t,r){return t&&sh(e.prototype,t),r&&sh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jo(e){return Array.isArray(e)?e.slice(0):[e]}function $i(e){return Array.isArray(e)}function ah(e){return e!=null}function $a(e,t){var r=0,n=-1;for(var i of e){n=n+1;var a=t(i,n);if(a)r=r+1;else break}return r}function Ir(e,t){var r=t.length;if(r!==0){var n=e.length;e.length=n+t.length;for(var i=0;i<r;++i)e[n+i]=t[i]}}function uh(e){return e.filter(function(t,r,n){return n.indexOf(t)===r})}function Ln(e){for(var t="",r=0;r<e.length;r++){var n=e[r];if(n==="-")return parseInt(t,10);t+=n}throw new Error("malformatted revision: "+e)}function bi(e,t){var r=t?Ln(t._rev)+1:1;return r+"-"+e}function lh(e){var t=e.split("."),r=t.length;return r===1?n=>n[e]:n=>{for(var i=n,a=0;a<r;++a){var l=t[a];if(i=i[l],typeof i>"u")return i}return i}}function Ae(e){return Object.assign({},e)}function ch(e){return Object.keys(e)[0]}function Ei(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort((n,i)=>typeof n=="string"&&typeof i=="string"?n.localeCompare(i):typeof n=="object"?1:-1).map(n=>Ei(n,t));if(typeof e=="object"&&!Array.isArray(e)){var r={};return Object.keys(e).sort((n,i)=>n.localeCompare(i)).forEach(n=>{r[n]=Ei(e[n],t)}),r}return e}function Kc(e){if(!e||e===null||typeof e!="object")return e;if(Array.isArray(e)){for(var t=new Array(e.length),r=t.length;r--;)t[r]=Kc(e[r]);return t}var n={};for(var i in e)n[i]=Kc(e[i]);return n}var hr=Kc;function gt(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}var ba=1;function nn(){return{lwt:ba}}function Cr(){return""}function fh(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function ph(e,t,r){if(t.length!==r.length)return!1;for(var n=0,i=t.length;n<i;){var a=t[n],l=r[n];if(n++,a._rev!==l._rev||a[e]!==l[e])return!1}return!0}var yC=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});var xC=Object.freeze(["prototype","__proto__","constructor"]);var Iw="[native code] }",vC=Iw.length;var Cw=Object.defineProperty,Mw=(e,t,r)=>t in e?Cw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Oi=(e,t,r)=>(Mw(e,typeof t!="symbol"?t+"":t,r),r),on=class e{constructor(t,r){Oi(this,"words"),Oi(this,"sigBytes"),t=this.words=t||[],this.sigBytes=r===void 0?t.length*4:r}toString(t){return(t||Dw).stringify(this)}concat(t){if(this.clamp(),this.sigBytes%4)for(let r=0;r<t.sigBytes;r++){let n=t.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=n<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<t.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=t.words[r>>>2];return this.sigBytes+=t.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new e([...this.words])}},Dw={stringify(e){let t=[];for(let r=0;r<e.sigBytes;r++){let n=e.words[r>>>2]>>>24-r%4*8&255;t.push((n>>>4).toString(16),(n&15).toString(16))}return t.join("")}};var Pw={parse(e){let t=e.length,r=[];for(let n=0;n<t;n++)r[n>>>2]|=(e.charCodeAt(n)&255)<<24-n%4*8;return new on(r,t)}},Rw={parse(e){return Pw.parse(unescape(encodeURIComponent(e)))}},Uc=class{constructor(){Oi(this,"_data",new on),Oi(this,"_nDataBytes",0),Oi(this,"_minBufferSize",0),Oi(this,"blockSize",512/32)}reset(){this._data=new on,this._nDataBytes=0}_append(t){typeof t=="string"&&(t=Rw.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_doProcessBlock(t,r){}_process(t){let r,n=this._data.sigBytes/(this.blockSize*4);t?n=Math.ceil(n):n=Math.max((n|0)-this._minBufferSize,0);let i=n*this.blockSize,a=Math.min(i*4,this._data.sigBytes);if(i){for(let l=0;l<i;l+=this.blockSize)this._doProcessBlock(this._data.words,l);r=this._data.words.splice(0,i),this._data.sigBytes-=a}return new on(r,a)}},zc=class extends Uc{update(t){return this._append(t),this._process(),this}finalize(t){t&&this._append(t)}},Nw=Object.defineProperty,Lw=(e,t,r)=>t in e?Nw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Fw=(e,t,r)=>(Lw(e,typeof t!="symbol"?t+"":t,r),r),mh=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Bw=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Fn=[],Wc=class extends zc{constructor(){super(...arguments),Fw(this,"_hash",new on([...mh]))}reset(){super.reset(),this._hash=new on([...mh])}_doProcessBlock(t,r){let n=this._hash.words,i=n[0],a=n[1],l=n[2],f=n[3],m=n[4],h=n[5],g=n[6],v=n[7];for(let O=0;O<64;O++){if(O<16)Fn[O]=t[r+O]|0;else{let K=Fn[O-15],ne=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,X=Fn[O-2],fe=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;Fn[O]=ne+Fn[O-7]+fe+Fn[O-16]}let E=m&h^~m&g,k=i&a^i&l^a&l,C=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),G=(m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25),J=v+G+E+Bw[O]+Fn[O],Q=C+k;v=g,g=h,h=m,m=f+J|0,f=l,l=a,a=i,i=J+Q|0}n[0]=n[0]+i|0,n[1]=n[1]+a|0,n[2]=n[2]+l|0,n[3]=n[3]+f|0,n[4]=n[4]+m|0,n[5]=n[5]+h|0,n[6]=n[6]+g|0,n[7]=n[7]+v|0}finalize(t){super.finalize(t);let r=this._nDataBytes*8,n=this._data.sigBytes*8;return this._data.words[n>>>5]|=128<<24-n%32,this._data.words[(n+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(n+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}};function dh(e){return new Wc().finalize(e).toString()}function jw(e){return Promise.resolve(dh(e))}async function Kw(e){var t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t),n=Array.prototype.map.call(new Uint8Array(r),i=>("00"+i.toString(16)).slice(-2)).join("");return n}var Uw=typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof crypto.subtle.digest=="function",Ea=Uw?Kw:jw;function hh(){return new Promise(e=>setTimeout(e,0))}function _h(e=0){return new Promise(t=>setTimeout(t,e))}var zw=Promise.resolve(!0),_r=Promise.resolve(!1),gh=Promise.resolve(null),Si=Promise.resolve();function Ai(e=1e4){return typeof requestIdleCallback=="function"?new Promise(t=>{requestIdleCallback(()=>t(),{timeout:e})}):_h(0)}var qc=Si;function yh(e=void 0){return qc=qc.then(()=>Ai(e)),qc}function xh(e,t){return e.reduce((r,n)=>r.then(n),Promise.resolve(t))}var vh=/\./g;var wh="abcdefghijklmnopqrstuvwxyz";function Bn(e=10){for(var t="",r=0;r<e;r++)t+=wh.charAt(Math.floor(Math.random()*wh.length));return t}function Oa(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)}function jn(e){for(;e.charAt(0)===".";)e=e.substr(1);for(;e.slice(-1)===".";)e=e.slice(0,-1);return e}function ki(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n;if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!ki(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var i=Object.keys(e);if(r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){var a=i[n];if(!ki(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}var Hc=e=>{var t=typeof e;return e!==null&&(t==="object"||t==="function")},Vc=new Set(["__proto__","prototype","constructor"]),Ww=new Set("0123456789");function $h(e){var t=[],r="",n="start",i=!1;for(var a of e)switch(a){case"\\":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");i&&(r+=a),n="property",i=!i;break}case".":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="property";break}if(i){i=!1,r+=a;break}if(Vc.has(r))return[];t.push(r),r="",n="property";break}case"[":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="index";break}if(i){i=!1,r+=a;break}if(n==="property"){if(Vc.has(r))return[];t.push(r),r=""}n="index";break}case"]":{if(n==="index"){t.push(Number.parseInt(r,10)),r="",n="indexEnd";break}if(n==="indexEnd")throw new Error("Invalid character after an index")}default:{if(n==="index"&&!Ww.has(a))throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");n==="start"&&(n="property"),i&&(i=!1,r+="\\"),r+=a}}switch(i&&(r+="\\"),n){case"property":{if(Vc.has(r))return[];t.push(r);break}case"index":throw new Error("Index was not closed");case"start":{t.push("");break}}return t}function bh(e,t){if(typeof t!="number"&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function qw(e,t){if(bh(e,t))throw new Error("Cannot use string index")}function Mr(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!Hc(e)||typeof t!="string")return r===void 0?e:r;var n=$h(t);if(n.length===0)return r;for(var i=0;i<n.length;i++){var a=n[i];if(bh(e,a)?e=i===n.length-1?void 0:null:e=e[a],e==null){if(i!==n.length-1)return r;break}}return e===void 0?r:e}function Gc(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!Hc(e)||typeof t!="string")return e;for(var n=e,i=$h(t),a=0;a<i.length;a++){var l=i[a];qw(e,l),a===i.length-1?e[l]=r:Hc(e[l])||(e[l]=typeof i[a+1]=="number"?[]:{}),e=e[l]}return n}function sn(e,t){var r=e.get(t);if(typeof r>"u")throw new Error("missing value from map "+t);return r}function yt(e,t,r,n){var i=e.get(t);return typeof i>"u"?(i=r(),e.set(t,i)):n&&n(i),i}function $e(e){var t=e.split("-"),r="RxDB";return t.forEach(n=>{r+=Oa(n)}),r+="Plugin",new Error(`You are using a function which must be overwritten by a plugin.
        You should either prevent the usage of this function or add the plugin via:
            import { `+r+" } from 'rxdb/plugins/"+e+`';
            addRxPlugin(`+r+`);
        `)}var Yc=0;function Ke(){var e=Date.now();e=e+.01,e<=Yc&&(e=Yc+.01);var t=parseFloat(e.toFixed(2));return Yc=t,t}function be(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}var Sa={bufferSize:1,refCount:!0};var Ko="15.38.1";var Aa={},Eh="6da4936d1425ff3a5c44c02342c6daf791d266be3ae8479b8ec59e261df41b93";function an(e,t){return an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},an(e,t)}function Qc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,an(e,t)}function ka(e){return ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ka(e)}function Oh(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function Jc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jc=function(){return!!e})()}function Sh(e,t,r){if(Jc())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&an(i,r.prototype),i}function Uo(e){var t=typeof Map=="function"?new Map:void 0;return Uo=function(n){if(n===null||!Oh(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(n))return t.get(n);t.set(n,i)}function i(){return Sh(n,arguments,ka(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),an(i,n)},Uo(e)}var ke={isDevMode(){return!1},deepFreezeWhenDevMode(e){return e},tunnelErrorMessage(e){return"RxDB Error-Code "+e+`.
        Error messages are not included in RxDB core to reduce build size.
        `}};function Vw(e){var t="";return Object.keys(e).length===0||(t+=`Given parameters: {
`,t+=Object.keys(e).map(r=>{var n="[object Object]";try{r==="errors"?n=e[r].map(i=>JSON.stringify(i,Object.getOwnPropertyNames(i))):n=JSON.stringify(e[r],function(i,a){return a===void 0?null:a},2)}catch{}return r+":"+n}).join(`
`),t+="}"),t}function Ah(e,t,r){return"RxError ("+t+`):
`+e+`
`+Vw(r)}var Hw=function(e){function t(n,i,a={}){var l,f=Ah(i,n,a);return l=e.call(this,f)||this,l.code=n,l.message=f,l.url=Xc(n),l.parameters=a,l.rxdb=!0,l}Qc(t,e);var r=t.prototype;return r.toString=function(){return this.message},ot(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])}(Uo(Error)),Gw=function(e){function t(n,i,a={}){var l,f=Ah(i,n,a);return l=e.call(this,f)||this,l.code=n,l.message=f,l.url=Xc(n),l.parameters=a,l.rxdb=!0,l}Qc(t,e);var r=t.prototype;return r.toString=function(){return this.message},ot(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])}(Uo(TypeError));function Xc(e){return"https://rxdb.info/errors.html?console=errors#"+e}function kh(e){return`
 You can find out more about this error here: `+Xc(e)+" "}function ee(e,t){return new Hw(e,ke.tunnelErrorMessage(e)+kh(e),t)}function Ta(e,t){return new Gw(e,ke.tunnelErrorMessage(e)+kh(e),t)}function Ia(e){return e&&e.status===409?e:!1}var Yw={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function Th(e){return ee("COL20",{name:Yw[e.status],document:e.documentId,writeError:e})}var Zc={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],postCleanup:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function qe(e,t){Zc[e].length>0&&Zc[e].forEach(r=>r(t))}function un(e,t){return Promise.all(Zc[e].map(r=>r(t)))}function Dr(e,t){var r=t;r=r.replace(vh,".properties."),r="properties."+r,r=jn(r);var n=Mr(e,r);return n}function Ih(e,t,r){if(typeof t.primaryKey=="string")return r;var n=zo(t,r),i=r[e];if(i&&i!==n)throw ee("DOC19",{args:{documentData:r,existingPrimary:i,newPrimary:n},schema:t});return r[e]=n,r}function Ct(e){return typeof e=="string"?e:e.key}function zo(e,t){if(typeof e.primaryKey=="string")return t[e.primaryKey];var r=e.primaryKey;return r.fields.map(n=>{var i=Mr(t,n);if(typeof i>"u")throw ee("DOC18",{args:{field:n,documentData:t}});return i}).join(r.separator)}function Ch(e){var t=Ei(e,!0);return t}function Qw(e){return["_deleted",e]}function Ca(e){e=Ae(e);var t=Ct(e.primaryKey);e.properties=Ae(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=Jw,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=ef(e);Ir(e.required,r),e.required=e.required.filter(a=>!a.includes(".")).filter((a,l,f)=>f.indexOf(a)===l),e.version=e.version||0;var n=e.indexes.map(a=>{var l=$i(a)?a.slice(0):[a];return l.includes(t)||l.push(t),l[0]!=="_deleted"&&l.unshift("_deleted"),l});n.length===0&&n.push(Qw(t)),n.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map(a=>{n.push(a)});var i=new Set;return n.filter(a=>{var l=a.join(",");return i.has(l)?!1:(i.add(l),!0)}),e.indexes=n,e}var Jw={type:"object",properties:{lwt:{type:"number",minimum:ba,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function ef(e){var t=Object.keys(e.properties).filter(n=>e.properties[n].final),r=Ct(e.primaryKey);return t.push(r),typeof e.primaryKey!="string"&&e.primaryKey.fields.forEach(n=>t.push(n)),t}function Mh(e,t){for(var r=Object.keys(e.defaultValues),n=0;n<r.length;++n){var i=r[n];(!Object.prototype.hasOwnProperty.call(t,i)||typeof t[i]>"u")&&(t[i]=e.defaultValues[i])}return t}var Xw=function(){function e(r,n){this.jsonSchema=r,this.hashFunction=n,this.indexes=Zw(this.jsonSchema),this.primaryPath=Ct(this.jsonSchema.primaryKey),this.finalFields=ef(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(n,i){this.finalFields.forEach(a=>{if(!ki(n[a],i[a]))throw ee("DOC9",{dataBefore:n,dataAfter:i,fieldName:a,schema:this.jsonSchema})})},t.getDocumentPrototype=function(){var n={},i=Dr(this.jsonSchema,"");return Object.keys(i).forEach(a=>{var l=a;n.__defineGetter__(a,function(){if(!(!this.get||typeof this.get!="function")){var f=this.get(l);return f}}),Object.defineProperty(n,a+"$",{get:function(){return this.get$(l)},enumerable:!1,configurable:!1}),Object.defineProperty(n,a+"$$",{get:function(){return this.get$$(l)},enumerable:!1,configurable:!1}),Object.defineProperty(n,a+"_",{get:function(){return this.populate(l)},enumerable:!1,configurable:!1})}),gt(this,"getDocumentPrototype",()=>n),n},t.getPrimaryOfDocumentData=function(n){return zo(this.jsonSchema,n)},ot(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var r={};return Object.entries(this.jsonSchema.properties).filter(([,n])=>Object.prototype.hasOwnProperty.call(n,"default")).forEach(([n,i])=>r[n]=i.default),gt(this,"defaultValues",r)}},{key:"hash",get:function(){return gt(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])}();function Zw(e){return(e.indexes||[]).map(t=>$i(t)?t:[t])}function Dh(e,t,r=!0){r&&qe("preCreateRxSchema",e);var n=Ca(e);n=Ch(n),ke.deepFreezeWhenDevMode(n);var i=new Xw(n,t);return qe("createRxSchema",i),i}function ve(e){return typeof e=="function"}function e$(e){return ve(e?.lift)}function Ve(e){return function(t){if(e$(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var tf=function(e,t){return tf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},tf(e,t)};function Mt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");tf(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Ph(e,t,r,n){function i(a){return a instanceof r?a:new r(function(l){l(a)})}return new(r||(r=Promise))(function(a,l){function f(g){try{h(n.next(g))}catch(v){l(v)}}function m(g){try{h(n.throw(g))}catch(v){l(v)}}function h(g){g.done?a(g.value):i(g.value).then(f,m)}h((n=n.apply(e,t||[])).next())})}function Ma(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=f(0),l.throw=f(1),l.return=f(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(h){return function(g){return m([h,g])}}function m(h){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,h[0]&&(r=0)),r;)try{if(n=1,i&&(a=h[0]&2?i.return:h[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,h[1])).done)return a;switch(i=0,a&&(h=[h[0]&2,a.value]),h[0]){case 0:case 1:a=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){r.label=h[1];break}if(h[0]===6&&r.label<a[1]){r.label=a[1],a=h;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(h);break}a[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(g){h=[6,g],i=0}finally{n=a=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Pr(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dt(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],l;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(f){l={error:f}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return a}function Pt(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function Kn(e){return this instanceof Kn?(this.v=e,this):new Kn(e)}function Rh(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(E){return function(k){return Promise.resolve(k).then(E,v)}}function f(E,k){n[E]&&(i[E]=function(C){return new Promise(function(G,J){a.push([E,C,G,J])>1||m(E,C)})},k&&(i[E]=k(i[E])))}function m(E,k){try{h(n[E](k))}catch(C){O(a[0][3],C)}}function h(E){E.value instanceof Kn?Promise.resolve(E.value.v).then(g,v):O(a[0][2],E)}function g(E){m("next",E)}function v(E){m("throw",E)}function O(E,k){E(k),a.shift(),a.length&&m(a[0][0],a[0][1])}}function Nh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Pr=="function"?Pr(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(l){return new Promise(function(f,m){l=e[a](l),i(f,m,l.done,l.value)})}}function i(a,l,f,m){Promise.resolve(m).then(function(h){a({value:h,done:f})},l)}}var Da=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Pa(e){return ve(e?.then)}function Ra(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var Na=Ra(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function Wo(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var Ti=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,n,i,a;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var f=Pr(l),m=f.next();!m.done;m=f.next()){var h=m.value;h.remove(this)}}catch(C){t={error:C}}finally{try{m&&!m.done&&(r=f.return)&&r.call(f)}finally{if(t)throw t.error}}else l.remove(this);var g=this.initialTeardown;if(ve(g))try{g()}catch(C){a=C instanceof Na?C.errors:[C]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var O=Pr(v),E=O.next();!E.done;E=O.next()){var k=E.value;try{Lh(k)}catch(C){a=a??[],C instanceof Na?a=Pt(Pt([],Dt(a)),Dt(C.errors)):a.push(C)}}}catch(C){n={error:C}}finally{try{E&&!E.done&&(i=O.return)&&i.call(O)}finally{if(n)throw n.error}}}if(a)throw new Na(a)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Lh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&Wo(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&Wo(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();var rf=Ti.EMPTY;function La(e){return e instanceof Ti||e&&"closed"in e&&ve(e.remove)&&ve(e.add)&&ve(e.unsubscribe)}function Lh(e){ve(e)?e():e.unsubscribe()}var qt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ii={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=Ii.delegate;return i?.setTimeout?i.setTimeout.apply(i,Pt([e,t],Dt(r))):setTimeout.apply(void 0,Pt([e,t],Dt(r)))},clearTimeout:function(e){var t=Ii.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Fa(e){Ii.setTimeout(function(){var t=qt.onUnhandledError;if(t)t(e);else throw e})}function nf(){}var Fh=function(){return of("C",void 0,void 0)}();function Bh(e){return of("E",void 0,e)}function jh(e){return of("N",e,void 0)}function of(e,t,r){return{kind:e,value:t,error:r}}var Un=null;function Ci(e){if(qt.useDeprecatedSynchronousErrorHandling){var t=!Un;if(t&&(Un={errorThrown:!1,error:null}),e(),t){var r=Un,n=r.errorThrown,i=r.error;if(Un=null,n)throw i}}else e()}function Kh(e){qt.useDeprecatedSynchronousErrorHandling&&Un&&(Un.errorThrown=!0,Un.error=e)}var qo=function(e){Mt(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,La(r)&&r.add(n)):n.destination=i$,n}return t.create=function(r,n,i){return new zn(r,n,i)},t.prototype.next=function(r){this.isStopped?af(jh(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?af(Bh(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?af(Fh,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Ti);var t$=Function.prototype.bind;function sf(e,t){return t$.call(e,t)}var r$=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(n){Ba(n)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(n){Ba(n)}else Ba(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){Ba(r)}},e}(),zn=function(e){Mt(t,e);function t(r,n,i){var a=e.call(this)||this,l;if(ve(r)||!r)l={next:r??void 0,error:n??void 0,complete:i??void 0};else{var f;a&&qt.useDeprecatedNextContext?(f=Object.create(r),f.unsubscribe=function(){return a.unsubscribe()},l={next:r.next&&sf(r.next,f),error:r.error&&sf(r.error,f),complete:r.complete&&sf(r.complete,f)}):l=r}return a.destination=new r$(l),a}return t}(qo);function Ba(e){qt.useDeprecatedSynchronousErrorHandling?Kh(e):Fa(e)}function n$(e){throw e}function af(e,t){var r=qt.onStoppedNotification;r&&Ii.setTimeout(function(){return r(e,t)})}var i$={closed:!0,next:nf,error:n$,complete:nf};var Mi=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Di(e){return e}function Uh(e){return e.length===0?Di:e.length===1?e[0]:function(r){return e.reduce(function(n,i){return i(n)},r)}}var He=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var i=this,a=s$(t)?t:new zn(t,r,n);return Ci(function(){var l=i,f=l.operator,m=l.source;a.add(f?f.call(a,m):m?i._subscribe(a):i._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=zh(r),new r(function(i,a){var l=new zn({next:function(f){try{t(f)}catch(m){a(m),l.unsubscribe()}},error:a,complete:i});n.subscribe(l)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[Mi]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Uh(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=zh(t),new t(function(n,i){var a;r.subscribe(function(l){return a=l},function(l){return i(l)},function(){return n(a)})})},e.create=function(t){return new e(t)},e}();function zh(e){var t;return(t=e??qt.Promise)!==null&&t!==void 0?t:Promise}function o$(e){return e&&ve(e.next)&&ve(e.error)&&ve(e.complete)}function s$(e){return e&&e instanceof qo||o$(e)&&La(e)}function ja(e){return ve(e[Mi])}function Ka(e){return Symbol.asyncIterator&&ve(e?.[Symbol.asyncIterator])}function Ua(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function a$(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var za=a$();function Wa(e){return ve(e?.[za])}function qa(e){return Rh(this,arguments,function(){var r,n,i,a;return Ma(this,function(l){switch(l.label){case 0:r=e.getReader(),l.label=1;case 1:l.trys.push([1,,9,10]),l.label=2;case 2:return[4,Kn(r.read())];case 3:return n=l.sent(),i=n.value,a=n.done,a?[4,Kn(void 0)]:[3,5];case 4:return[2,l.sent()];case 5:return[4,Kn(i)];case 6:return[4,l.sent()];case 7:return l.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function Va(e){return ve(e?.getReader)}function st(e){if(e instanceof He)return e;if(e!=null){if(ja(e))return u$(e);if(Da(e))return l$(e);if(Pa(e))return c$(e);if(Ka(e))return Wh(e);if(Wa(e))return f$(e);if(Va(e))return p$(e)}throw Ua(e)}function u$(e){return new He(function(t){var r=e[Mi]();if(ve(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function l$(e){return new He(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function c$(e){return new He(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,Fa)})}function f$(e){return new He(function(t){var r,n;try{for(var i=Pr(e),a=i.next();!a.done;a=i.next()){var l=a.value;if(t.next(l),t.closed)return}}catch(f){r={error:f}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t.complete()})}function Wh(e){return new He(function(t){m$(e,t).catch(function(r){return t.error(r)})})}function p$(e){return Wh(qa(e))}function m$(e,t){var r,n,i,a;return Ph(this,void 0,void 0,function(){var l,f;return Ma(this,function(m){switch(m.label){case 0:m.trys.push([0,5,6,11]),r=Nh(e),m.label=1;case 1:return[4,r.next()];case 2:if(n=m.sent(),!!n.done)return[3,4];if(l=n.value,t.next(l),t.closed)return[2];m.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return f=m.sent(),i={error:f},[3,11];case 6:return m.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:m.sent(),m.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Vt(e,t,r,n,i){return new d$(e,t,r,n,i)}var d$=function(e){Mt(t,e);function t(r,n,i,a,l,f){var m=e.call(this,r)||this;return m.onFinalize=l,m.shouldUnsubscribe=f,m._next=n?function(h){try{n(h)}catch(g){r.error(g)}}:e.prototype._next,m._error=a?function(h){try{a(h)}catch(g){r.error(g)}finally{this.unsubscribe()}}:e.prototype._error,m._complete=i?function(){try{i()}catch(h){r.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,m}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(qo);var uf={now:function(){return(uf.delegate||Date).now()},delegate:void 0};function qh(e){return e&&ve(e.schedule)}function Vh(e){return e[e.length-1]}function ln(e){return qh(Vh(e))?e.pop():void 0}function Ha(e,t){return typeof Vh(e)=="number"?e.pop():t}function Rt(e,t,r,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var a=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(a),!i)return a}function Ga(e,t){return t===void 0&&(t=0),Ve(function(r,n){r.subscribe(Vt(n,function(i){return Rt(n,e,function(){return n.next(i)},t)},function(){return Rt(n,e,function(){return n.complete()},t)},function(i){return Rt(n,e,function(){return n.error(i)},t)}))})}function Ya(e,t){return t===void 0&&(t=0),Ve(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function Hh(e,t){return st(e).pipe(Ya(t),Ga(t))}function Gh(e,t){return st(e).pipe(Ya(t),Ga(t))}function Yh(e,t){return new He(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function Qh(e,t){return new He(function(r){var n;return Rt(r,t,function(){n=e[za](),Rt(r,t,function(){var i,a,l;try{i=n.next(),a=i.value,l=i.done}catch(f){r.error(f);return}l?r.complete():r.next(a)},0,!0)}),function(){return ve(n?.return)&&n.return()}})}function Qa(e,t){if(!e)throw new Error("Iterable cannot be null");return new He(function(r){Rt(r,t,function(){var n=e[Symbol.asyncIterator]();Rt(r,t,function(){n.next().then(function(i){i.done?r.complete():r.next(i.value)})},0,!0)})})}function Jh(e,t){return Qa(qa(e),t)}function Xh(e,t){if(e!=null){if(ja(e))return Hh(e,t);if(Da(e))return Yh(e,t);if(Pa(e))return Gh(e,t);if(Ka(e))return Qa(e,t);if(Wa(e))return Qh(e,t);if(Va(e))return Jh(e,t)}throw Ua(e)}function Pi(e,t){return t?Xh(e,t):st(e)}function at(e,t){return Ve(function(r,n){var i=0;r.subscribe(Vt(n,function(a){n.next(e.call(t,a,i++))}))})}function Zh(e,t,r,n,i,a,l,f){var m=[],h=0,g=0,v=!1,O=function(){v&&!m.length&&!h&&t.complete()},E=function(C){return h<n?k(C):m.push(C)},k=function(C){a&&t.next(C),h++;var G=!1;st(r(C,g++)).subscribe(Vt(t,function(J){i?.(J),a?E(J):t.next(J)},function(){G=!0},void 0,function(){if(G)try{h--;for(var J=function(){var Q=m.shift();l?Rt(t,l,function(){return k(Q)}):k(Q)};m.length&&h<n;)J();O()}catch(Q){t.error(Q)}}))};return e.subscribe(Vt(t,E,function(){v=!0,O()})),function(){f?.()}}function Ht(e,t,r){return r===void 0&&(r=1/0),ve(t)?Ht(function(n,i){return at(function(a,l){return t(n,a,i,l)})(st(e(n,i)))},r):(typeof t=="number"&&(r=t),Ve(function(n,i){return Zh(n,i,e,r)}))}var h$=Array.isArray;function e_(e){return e.length===1&&h$(e[0])?e[0]:e}function Ri(e){return e===void 0&&(e=1/0),Ht(Di,e)}function t_(){return Ri(1)}var r_=Ra(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var ut=function(e){Mt(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new n_(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new r_},t.prototype.next=function(r){var n=this;Ci(function(){var i,a;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var l=Pr(n.currentObservers),f=l.next();!f.done;f=l.next()){var m=f.value;m.next(r)}}catch(h){i={error:h}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}})},t.prototype.error=function(r){var n=this;Ci(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},t.prototype.complete=function(){var r=this;Ci(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,i=this,a=i.hasError,l=i.isStopped,f=i.observers;return a||l?rf:(this.currentObservers=null,f.push(r),new Ti(function(){n.currentObservers=null,Wo(f,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,a=n.thrownError,l=n.isStopped;i?r.error(a):l&&r.complete()},t.prototype.asObservable=function(){var r=new He;return r.source=this,r},t.create=function(r,n){return new n_(r,n)},t}(He);var n_=function(e){Mt(t,e);function t(r,n){var i=e.call(this)||this;return i.destination=r,i.source=n,i}return t.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},t.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:rf},t}(ut);function lf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return t_()(Pi(e,ln(e)))}var i_=new He(function(e){return e.complete()});function Ni(e,t){return t===void 0&&(t=Di),e=e??_$,Ve(function(r,n){var i,a=!0;r.subscribe(Vt(n,function(l){var f=t(l);(a||!e(i,f))&&(a=!1,i=f,n.next(l))}))})}function _$(e,t){return e===t}function Ue(e,t){return Ve(function(r,n){var i=0;r.subscribe(Vt(n,function(a){return e.call(t,a,i++)&&n.next(a)}))})}function o_(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ln(e),n=Ha(e,1/0);return e=e_(e),Ve(function(i,a){Ri(n)(Pi(Pt([i],Dt(e)),r)).subscribe(a)})}function cf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o_.apply(void 0,Pt([],Dt(e)))}var ff=function(e){Mt(t,e);function t(r){var n=e.call(this)||this;return n._value=r,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(r){var n=e.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},t.prototype.getValue=function(){var r=this,n=r.hasError,i=r.thrownError,a=r._value;if(n)throw i;return this._throwIfClosed(),a},t.prototype.next=function(r){e.prototype.next.call(this,this._value=r)},t}(ut);var s_=function(e){Mt(t,e);function t(r,n,i){r===void 0&&(r=1/0),n===void 0&&(n=1/0),i===void 0&&(i=uf);var a=e.call(this)||this;return a._bufferSize=r,a._windowTime=n,a._timestampProvider=i,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=n===1/0,a._bufferSize=Math.max(1,r),a._windowTime=Math.max(1,n),a}return t.prototype.next=function(r){var n=this,i=n.isStopped,a=n._buffer,l=n._infiniteTimeWindow,f=n._timestampProvider,m=n._windowTime;i||(a.push(r),!l&&a.push(f.now()+m)),this._trimBuffer(),e.prototype.next.call(this,r)},t.prototype._subscribe=function(r){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(r),i=this,a=i._infiniteTimeWindow,l=i._buffer,f=l.slice(),m=0;m<f.length&&!r.closed;m+=a?1:2)r.next(f[m]);return this._checkFinalizedStatuses(r),n},t.prototype._trimBuffer=function(){var r=this,n=r._bufferSize,i=r._timestampProvider,a=r._buffer,l=r._infiniteTimeWindow,f=(l?1:2)*n;if(n<1/0&&f<a.length&&a.splice(0,a.length-f),!l){for(var m=i.now(),h=0,g=1;g<a.length&&a[g]<=m;g+=2)h=g;h&&a.splice(0,h+1)}},t}(ut);function a_(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new ut}:t,n=e.resetOnError,i=n===void 0?!0:n,a=e.resetOnComplete,l=a===void 0?!0:a,f=e.resetOnRefCountZero,m=f===void 0?!0:f;return function(h){var g,v,O,E=0,k=!1,C=!1,G=function(){v?.unsubscribe(),v=void 0},J=function(){G(),g=O=void 0,k=C=!1},Q=function(){var K=g;J(),K?.unsubscribe()};return Ve(function(K,ne){E++,!C&&!k&&G();var X=O=O??r();ne.add(function(){E--,E===0&&!C&&!k&&(v=pf(Q,m))}),X.subscribe(ne),!g&&E>0&&(g=new zn({next:function(fe){return X.next(fe)},error:function(fe){C=!0,G(),v=pf(J,i,fe),X.error(fe)},complete:function(){k=!0,G(),v=pf(J,l),X.complete()}}),st(K).subscribe(g))})(h)}}function pf(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(t===!0){e();return}if(t!==!1){var i=new zn({next:function(){i.unsubscribe(),e()}});return st(t.apply(void 0,Pt([],Dt(r)))).subscribe(i)}}function Vo(e,t,r){var n,i,a,l,f=!1;return e&&typeof e=="object"?(n=e.bufferSize,l=n===void 0?1/0:n,i=e.windowTime,t=i===void 0?1/0:i,a=e.refCount,f=a===void 0?!1:a,r=e.scheduler):l=e??1/0,a_({connector:function(){return new s_(l,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:f})}function Ho(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ln(e);return Ve(function(n,i){(r?lf(e,n,r):lf(e,n)).subscribe(i)})}function u_(e){return e.documentData?e.documentData:e.previousDocumentData}function l_(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:ke.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}function mf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ln(e),n=Ha(e,1/0),i=e;return i.length?i.length===1?st(i[0]):Ri(n)(Pi(i,r)):i_}function Ja(e){return e[e.length-1]}function g$(e){let t=typeof e;return e!==null&&(t==="object"||t==="function")}function df(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!g$(e)||typeof t!="string")return r===void 0?e:r;let n=t.split(".");if(n.length===0)return r;for(let i=0;i<n.length;i++){let a=n[i];if(y$(e,a)?e=i===n.length-1?void 0:null:e=e[a],e==null){if(i!==n.length-1)return r;break}}return e===void 0?r:e}function y$(e,t){if(typeof t!="number"&&Array.isArray(e)){let r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}var hf=e=>!!e.queryParams.limit,c_=e=>e.queryParams.limit===1,f_=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),p_=e=>e.changeEvent.operation==="DELETE",m_=e=>e.changeEvent.operation==="INSERT",d_=e=>e.changeEvent.operation==="UPDATE",h_=e=>hf(e)&&e.previousResults.length>=e.queryParams.limit,__=e=>{let t=e.queryParams.sortFields,r=e.changeEvent.previous,n=e.changeEvent.doc;if(!n)return!1;if(!r)return!0;for(let i=0;i<t.length;i++){let a=t[i],l=df(r,a),f=df(n,a);if(l!==f)return!0}return!1},g_=e=>{let t=e.changeEvent.id;if(e.keyDocumentMap)return e.keyDocumentMap.has(t);{let r=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][r]===t)return!0;return!1}},y_=e=>{let t=e.previousResults[0];return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},x_=e=>{let t=Ja(e.previousResults);return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},v_=e=>{let t=e.changeEvent.previous;if(!t)return!1;let r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},w_=e=>{let t=e.changeEvent.previous;if(!t)return!1;let r=Ja(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},$_=e=>{let t=e.changeEvent.doc;if(!t)return!1;let r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},b_=e=>{let t=e.changeEvent.doc;if(!t)return!1;let r=Ja(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},E_=e=>{let t=e.changeEvent.previous;return t?e.queryParams.queryMatcher(t):!1},O_=e=>{let t=e.changeEvent.doc;return t?e.queryParams.queryMatcher(t):!1},S_=e=>e.previousResults.length===0;var A_={0:m_,1:d_,2:p_,3:hf,4:c_,5:f_,6:S_,7:h_,8:y_,9:x_,10:__,11:g_,12:v_,13:w_,14:$_,15:b_,16:E_,17:O_};function k_(e,t,r,n){var i=e.length,a=i-1,l=0;if(i===0)return e.push(t),0;for(var f;n<=a;)l=n+(a-n>>1),f=e[l],r(f,t)<=0?n=l+1:a=l-1;return r(f,t)<=0&&l++,e.splice(l,0,t),l}var T_=e=>{},Xa=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},Za=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},eu=e=>{let t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},tu=e=>{let t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},I_=e=>{eu(e),Za(e)},C_=e=>{tu(e),Xa(e)},M_=e=>{eu(e),Xa(e)},D_=e=>{tu(e),Za(e)},_f=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);let t=e.queryParams.primaryKey,r=e.previousResults;for(let n=0;n<r.length;n++)if(r[n][t]===e.changeEvent.id){r.splice(n,1);break}},P_=e=>{let t=e.changeEvent.doc,r=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][r]===e.changeEvent.id){n[i]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}},R_=e=>{let t={_id:"wrongHuman"+new Date().getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},gf=e=>{let t=e.changeEvent.id,r=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,r)}else if(e.previousResults.find(i=>i[e.queryParams.primaryKey]===t))return;k_(e.previousResults,r,e.queryParams.sortComparator,0)},N_=e=>{_f(e),gf(e)},L_=e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},F_=e=>{throw new Error("Action unknownAction should never be called")};var B_=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],j_={doNothing:T_,insertFirst:Xa,insertLast:Za,removeFirstItem:eu,removeLastItem:tu,removeFirstInsertLast:I_,removeLastInsertFirst:C_,removeFirstInsertFirst:M_,removeLastInsertLast:D_,removeExisting:_f,replaceExisting:P_,alwaysWrong:R_,insertAtSortPosition:gf,removeExistingAndInsertAtSortPosition:N_,runFullQueryAgain:L_,unknownAction:F_};function ru(e){return e.charCodeAt(0)-40}function K_(e){return e?"1":"0"}function x$(e=6){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length;for(let i=0;i<e;i++)t+=r.charAt(Math.floor(Math.random()*n));return t}var MR=x$(4);function yf(e,t){let r=[];for(let n=0,i=e.length;n<i;n+=t)r.push(e.substring(n,n+t));return r}function U_(e){let t=new Map,n=2+parseInt(e.charAt(0)+e.charAt(1),10)*2,i=e.substring(2,n),a=yf(i,2);for(let C=0;C<a.length;C++){let G=a[C],J=G.charAt(0),Q=ru(G.charAt(1));t.set(J,Q)}let l=e.substring(n,e.length-3),f=yf(l,4);for(let C=0;C<f.length;C++){let G=f[C],J=G.charAt(0),Q=G.charAt(1),K=G.charAt(2),ne=ru(G.charAt(3));if(!t.has(Q))throw new Error("missing node with id "+Q);if(!t.has(K))throw new Error("missing node with id "+K);let X=t.get(Q),fe=t.get(K),le={l:ne,0:X,1:fe};t.set(J,le)}let m=e.slice(-3),h=m.charAt(0),g=m.charAt(1),v=ru(m.charAt(2)),O=t.get(h),E=t.get(g);return{l:v,0:O,1:E}}function z_(e,t,r){let n=e,i=e.l;for(;;){let a=t[i](r),l=K_(a);if(n=n[l],typeof n=="number"||typeof n=="string")return n;i=n.l}}var v$="14a1b,c+d2e5f0g/h.i4j*k-l)m(n6oeh6pnm6qen6ril6snh6tin6ubo9vce9wmh9xns9yne9zmi9{cm9|ad9}cp9~aq9\x7Fae9\xA1bf9\xA2bq9\xA3cg9\xA4ck9\xA5cn9\xA6nd9\xA7np9\xA8nq9\xA9nf9\xAAng9\xABnm9\xACnk9\xADmr9\xAEms9\xAFmt9\xB0mj9\xB1mk9\xB2ml9\xB3mn9\xB4mc8\xB5\xB3{8\xB6\xAF}8\xB7\xB0\xA48\xB8\xB3\xA78\xB9mn8\xBA\xB3\xAB8\xBB\xB3m8\xBCm\xB44\xBDz\xB24\xBE\xB3w4\xBFz\xB54\xC0\xAF\xB64\xC1\xB0\xB74\xC2\xB3\xBA4\xC3\xB3\xB84\xC4m\xB94\xC5v\xA47\xC6yn7\xC7\xC0\xC17\xC8~\x7F7\xC9\xA5\xA47\xCA\xC3\xC47\xCB\xA8n7\xCC\xBA\xB97\xCD\xAD\xB07\xCE\xAEm7\xCF\xAF\xB07\xD0\xB1m7\xD1\xB3m7\xD2\xBCm5\xD3\xC4m5\xD4\xB9m5\xD5\xBD\xB05\xD6\xBEm5\xD7\xBF\xB05\xD8\xC7\xCF5\xD9\xC2m5\xDA\xCA\xD15\xDB\xB1m5\xDC\xBAm5\xDD\xCC\xD15\xDE\xD5\xCD2\xDF|\x7F2\xE0\xA1u2\xE1\xA3\xC52\xE2\xD6\xCE2\xE3\xA6\xC62\xE4\xA9x2\xE5\xAA\xC62\xE6\xD7\xD82\xE7|\xC82\xE8\xA1\xA22\xE9\xA3\xC92\xEA\xA4\xA52\xEB\xD9\xDA2\xEC\xA6\xCB2\xED\xA9n2\xEE\xAAn2\xEF\xDB\xD02\xF0\xDC\xDD2\xF1\xACn2\xF2\xD2\xD3/\xF3an/\xF4bn/\xF5cn/\xF6\xDE\xE2/\xF7\xDF\xE3/\xF8\xE0\xE4/\xF9\xE1\xE5/\xFA\xE6\xEB/\xFB\xE7\xEC/\xFC\xE8\xED/\xFD\xE9\xEE/\xFE\xCD\xCE/\xFF\xCF\xD1/\u0100\xF2\xD4,\u0101cn,\u0102\xF6\xEF,\u0103\xA4\xF1,\u0104\xFA\xF0,\u0105\xEA\xF1,\u0106\xFE\xD0,\u0107\xFF\xD1,\u0108ac0\u0109bc0\u010A\xF3\xF50\u010B\xF4\u01010\u010C\xDF\xE10\u010D\xE0\xA40\u010E\xE7\xE90\u010F\xE8\xEA0\u0110\xF7\xF90\u0111\xF8\u01030\u0112\xFB\xFD0\u0113\xFC\u01050\u0114m\xD2-\u0115m\u0100-\u0116\xDE\xE6-\u0117\u010C\u010E-\u0118\u010D\u010F-\u0119\u0102\u0104-\u011A\u0110\u0112-\u011B\u0111\u0113-\u011C\xB2\xBB-\u011D\xCD\xCF-\u011E\u0106\u0107-\u011F\xB2\xB3-\u0120\u0114\u01083\u0121\u0115\u010A3\u0122\u0116\u01173\u0123\u0119\u011A3\u0124\u0122\u011D(\u0125\u011C\u011F(\u0126\u0123\u011E(\u0127\u0120\u0121+\u0128\u0109\u010B+\u0129\u0124\u0126+\u012A\u0118\u011B+\u012B\u0127\u01281\u012C\u0129\u012A1\u012D\u012C\u012B*\u012E\u0125m*\u012D\u012E.",xf;function w$(){return xf||(xf=U_(v$)),xf}var W_=e=>z_(w$(),A_,e);function q_(e){let t=W_(e);return B_[t]}function V_(e,t,r,n,i){let a=j_[e];return a({queryParams:t,changeEvent:r,previousResults:n,keyDocumentMap:i}),n}var Wn="\uFFFF",qn=Number.MIN_SAFE_INTEGER;function H_(e,t){var r=t.selector,n=e.indexes?e.indexes.slice(0):[];t.index&&(n=[t.index]);var i=!!t.sort.find(g=>Object.values(g)[0]==="desc"),a=new Set;Object.keys(r).forEach(g=>{var v=Dr(e,g);v&&v.type==="boolean"&&Object.prototype.hasOwnProperty.call(r[g],"$eq")&&a.add(g)});var l=t.sort.map(g=>Object.keys(g)[0]),f=l.filter(g=>!a.has(g)).join(","),m=-1,h;if(n.forEach(g=>{var v=!0,O=!0,E=g.map(Q=>{var K=r[Q],ne=K?Object.keys(K):[],X={};if(!K||!ne.length){var fe=O?qn:Wn;X={startKey:fe,endKey:v?Wn:qn,inclusiveStart:!0,inclusiveEnd:!0}}else ne.forEach(le=>{if(nu.has(le)){var pe=K[le],ze=O$(le,pe);X=Object.assign(X,ze)}});return typeof X.startKey>"u"&&(X.startKey=qn),typeof X.endKey>"u"&&(X.endKey=Wn),typeof X.inclusiveStart>"u"&&(X.inclusiveStart=!0),typeof X.inclusiveEnd>"u"&&(X.inclusiveEnd=!0),O&&!X.inclusiveStart&&(O=!1),v&&!X.inclusiveEnd&&(v=!1),X}),k=E.map(Q=>Q.startKey),C=E.map(Q=>Q.endKey),G={index:g,startKeys:k,endKeys:C,inclusiveEnd:v,inclusiveStart:O,sortSatisfiedByIndex:!i&&f===g.filter(Q=>!a.has(Q)).join(","),selectorSatisfiedByIndex:E$(g,t.selector,k,C)},J=S$(e,t,G);(J>=m||t.index)&&(m=J,h=G)}),!h)throw ee("SNH",{query:t});return h}var nu=new Set(["$eq","$gt","$gte","$lt","$lte"]),$$=new Set(["$eq","$gt","$gte"]),b$=new Set(["$eq","$lt","$lte"]);function E$(e,t,r,n){var i=Object.entries(t),a=i.find(([le,pe])=>{if(!e.includes(le))return!0;var ze=Object.entries(pe).find(([Et,pn])=>!nu.has(Et));return ze});if(a||t.$and||t.$or)return!1;var l=[],f=new Set;for(var[m,h]of Object.entries(t)){if(!e.includes(m))return!1;var g=Object.keys(h).filter(le=>$$.has(le));if(g.length>1)return!1;var v=g[0];if(v&&f.add(m),v!=="$eq"){if(l.length>0)return!1;l.push(v)}}var O=[],E=new Set;for(var[k,C]of Object.entries(t)){if(!e.includes(k))return!1;var G=Object.keys(C).filter(le=>b$.has(le));if(G.length>1)return!1;var J=G[0];if(J&&E.add(k),J!=="$eq"){if(O.length>0)return!1;O.push(J)}}var Q=0;for(var K of e){for(var ne of[f,E]){if(!ne.has(K)&&ne.size>0)return!1;ne.delete(K)}var X=r[Q],fe=n[Q];if(X!==fe&&f.size>0&&E.size>0)return!1;Q++}return!0}function O$(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}function S$(e,t,r){var n=0,i=g=>{g>0&&(n=n+g)},a=10,l=$a(r.startKeys,g=>g!==qn&&g!==Wn);i(l*a);var f=$a(r.startKeys,g=>g!==Wn&&g!==qn);i(f*a);var m=$a(r.startKeys,(g,v)=>g===r.endKeys[v]);i(m*a*1.5);var h=r.sortSatisfiedByIndex?5:0;return i(h),n}var Xe=class extends Error{},uu=2147483647,lu=-2147483648,bf=Number.MAX_SAFE_INTEGER,Ef=Number.MIN_SAFE_INTEGER,Vn=Symbol("missing"),J_=Object.freeze(new Error("mingo: cycle detected while processing object/array")),A$="[object Object]",k$=/^\[object ([a-zA-Z0-9]+)\]$/,cu=e=>{let t=D$(e),r=0,n=t.length;for(;n;)r=(r<<5)-r^t.charCodeAt(--n);return r>>>0},X_=new Set(["null","undefined","boolean","number","string","date","regexp"]),T$={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},Fe=(e,t)=>{e===Vn&&(e=void 0),t===Vn&&(t=void 0);let[r,n]=[e,t].map(i=>T$[cn(i).toLowerCase()]);return r!==n?r-n:r===1||r===2||r===6?e<t?-1:e>t?1:0:vt(e,t)?0:e<t?-1:e>t?1:0};function U(e,t){if(!e)throw new Xe(t)}var cn=e=>k$.exec(Object.prototype.toString.call(e))[1],Go=e=>typeof e=="boolean",we=e=>typeof e=="string";var _e=e=>!isNaN(e)&&typeof e=="number";var ue=Array.isArray,ye=e=>{if(!e)return!1;let t=Object.getPrototypeOf(e);return(t===Object.prototype||t===null)&&A$===Object.prototype.toString.call(e)},Yo=e=>e===Object(e),Fi=e=>e instanceof Date,Bi=e=>e instanceof RegExp,fu=e=>typeof e=="function",H=e=>e==null,gr=(e,t)=>e.includes(t),pu=(e,t)=>!gr(e,t),yr=(e,t=!0)=>!!e||t&&e==="",xt=e=>H(e)||we(e)&&!e||e instanceof Array&&e.length===0||ye(e)&&Object.keys(e).length===0,G_=e=>e===Vn,Rr=e=>e instanceof Array?e:[e],pt=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),Of=e=>typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e),I$=[Fi,Bi,Of],wf=(e,t)=>{if(H(e))return e;if(t.has(e))throw J_;let r=e.constructor;if(I$.some(n=>n(e)))return new r(e);try{if(t.add(e),ue(e))return e.map(n=>wf(n,t));if(ye(e)){let n={};for(let i in e)n[i]=wf(e[i],t);return n}}finally{t.delete(e)}return e},mu=e=>wf(e,new Set),C$=(e,t)=>ye(e)&&ye(t)||ue(e)&&ue(t);function ou(e,t,r){if(r=r||{flatten:!1},G_(e)||H(e))return t;if(G_(t)||H(t))return e;if(!C$(e,t)){if(r.skipValidation)return t||e;throw Error("mismatched types. must both be array or object")}if(r.skipValidation=!0,ue(e)){let n=e,i=t;if(r.flatten){let a=0,l=0;for(;a<n.length&&l<i.length;)n[a]=ou(n[a++],i[l++],r);for(;l<i.length;)n.push(t[l++])}else Nt(n,i)}else for(let n in t)e[n]=ou(e[n],t[n],r);return e}function Y_(e,t=cu){let r=new Map;return e.forEach((n,i)=>{let a=du(n,t);r.has(a)?r.get(a).some(l=>vt(e[l],n))||r.get(a).push(i):r.set(a,[i])}),r}function Hn(e,t=cu){if(e.some(f=>f.length==0))return[];if(e.length===1)return Array.from(e);let r=Z_(e.map((f,m)=>[m,f.length]),f=>f[1]),n=e[r[0][0]],i=Y_(n,t),a=new Map,l=new Array;return i.forEach((f,m)=>{let h=f.map(E=>n[E]),g=h.map(E=>0),v=h.map(E=>[r[0][0],0]),O=!1;for(let E=1;E<e.length;E++){let[k,C]=r[E],G=e[k];if(a.has(E)||a.set(E,Y_(G)),a.get(E).has(m)){let J=a.get(E).get(m).map(Q=>G[Q]);O=h.map((Q,K)=>J.some((ne,X)=>{let fe=g[K];return vt(Q,ne)&&(g[K]++,k<v[K][0]&&(v[K]=[k,a.get(E).get(m)[X]])),fe<g[K]})).some(Boolean)}if(!O)return}O&&Nt(l,g.map((E,k)=>E===e.length-1?[h[k],v[k]]:Vn).filter(E=>E!==Vn))}),l.sort((f,m)=>{let[h,[g,v]]=f,[O,[E,k]]=m,C=Fe(g,E);return C!==0?C:Fe(v,k)}).map(f=>f[0])}function Sf(e,t=0){let r=new Array;function n(i,a){for(let l=0,f=i.length;l<f;l++)ue(i[l])&&(a>0||a<0)?n(i[l],Math.max(-1,a-1)):r.push(i[l])}return n(e,t),r}var M$=e=>{let[t,r]=[Object.getPrototypeOf(e),Object.getOwnPropertyNames(e)],n=t;for(;!r.length&&t!==Object.prototype&&t!==Array.prototype;)n=t,r=Object.getOwnPropertyNames(t),t=Object.getPrototypeOf(t);let i={};return r.forEach(a=>i[a]=e[a]),[i,n]};function vt(e,t){if(e===t||Object.is(e,t))return!0;let r=!!e&&e.constructor||e;if(e===null||t===null||e===void 0||t===void 0||r!==t.constructor||r===Function)return!1;if(r===Array||r===Object){let a=Object.keys(e),l=Object.keys(t);if(a.length!==l.length||new Set([...a,...l]).size!=a.length)return!1;for(let f of a)if(!vt(e[f],t[f]))return!1;return!0}let n=Object.getPrototypeOf(e);return(Of(e)||n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))&&e.toString()===t.toString()}var iu=(e,t)=>{if(e===null)return"null";if(e===void 0)return"undefined";let r=e.constructor;switch(r){case RegExp:case Number:case Boolean:case Function:case Symbol:return e.toString();case String:return JSON.stringify(e);case Date:return e.toISOString()}if(Of(e))return r.name+"["+e.toString()+"]";if(t.has(e))throw J_;try{if(t.add(e),ue(e))return"["+e.map(l=>iu(l,t)).join(",")+"]";if(r===Object)return"{"+Object.keys(e).sort().map(l=>l+":"+iu(e[l],t)).join(",")+"}";let n=Object.getPrototypeOf(e);if(n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))return r.name+"("+JSON.stringify(e.toString())+")";let[i,a]=M$(e);return r.name+iu(i,t)}finally{t.delete(e)}},D$=e=>iu(e,new Set);function du(e,t){return t=t||cu,H(e)?null:t(e).toString()}function Z_(e,t,r=Fe){if(xt(e))return e;let n=new Array,i=new Array;for(let a=0;a<e.length;a++){let l=e[a],f=t(l,a);H(f)?i.push(l):n.push([f,l])}return n.sort((a,l)=>r(a[0],l[0])),Nt(i,n.map(a=>a[1]))}function hu(e,t,r=cu){if(e.length<1)return new Map;let n=new Map,i=new Map;for(let a=0;a<e.length;a++){let l=e[a],f=t(l,a),m=du(f,r);if(m===null)i.has(null)?i.get(null).push(l):i.set(null,[l]);else{let h=n.has(m)?n.get(m).find(g=>vt(g,f)):null;H(h)?(i.set(f,[l]),n.has(m)?n.get(m).push(f):n.set(m,[f])):i.get(h).push(l)}}return i}var vf=5e4;function Nt(e,...t){return e instanceof Array?t.reduce((r,n)=>{let i=Math.ceil(n.length/vf),a=0;for(;i-- >0;)Array.prototype.push.apply(r,n.slice(a,a+vf)),a+=vf;return r},e):t.filter(Yo).reduce((r,n)=>(Object.assign(r,n),r),e)}function $f(e,t){return Yo(e)?e[t]:void 0}function P$(e,t){if(t<1)return e;for(;t--&&e.length===1;)e=e[0];return e}function Nr(e,t,r){let n=0;function i(l,f){let m=l;for(let h=0;h<f.length;h++){let g=f[h];if(/^\d+$/.exec(g)===null&&m instanceof Array){if(h===0&&n>0)break;n+=1;let O=f.slice(h);m=m.reduce((E,k)=>{let C=i(k,O);return C!==void 0&&E.push(C),E},[]);break}else m=$f(m,g);if(m===void 0)break}return m}let a=X_.has(cn(e).toLowerCase())?e:i(e,t.split("."));return a instanceof Array&&r?.unwrapArray?P$(a,n):a}function Li(e,t,r){let n=t.split("."),i=n[0],a=n.slice(1).join("."),l=/^\d+$/.exec(i)!==null,f=n.length>1,m,h;if(e instanceof Array)if(l)m=$f(e,Number(i)),f&&(m=Li(m,a,r)),m=[m];else{m=[];for(let g of e)h=Li(g,t,r),r?.preserveMissing?(h===void 0&&(h=Vn),m.push(h)):h!==void 0&&m.push(h)}else{if(h=$f(e,i),f&&(h=Li(h,a,r)),h===void 0)return;m=r?.preserveKeys?{...e}:{},m[i]=h}return m}function su(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===Vn?e.splice(t,1):su(e[t]);else if(ye(e))for(let t in e)pt(e,t)&&su(e[t])}var Q_=/^\d+$/;function au(e,t,r,n){let i=t.split("."),a=i[0],l=i.slice(1).join(".");if(i.length===1)(ye(e)||ue(e)&&Q_.test(a))&&r(e,a);else{n?.buildGraph&&H(e[a])&&(e[a]={});let f=e[a];if(!f)return;let m=!!(i.length>1&&Q_.test(i[1]));f instanceof Array&&n?.descendArray&&!m?f.forEach(h=>au(h,l,r,n)):au(f,l,r,n)}}function _u(e,t,r){au(e,t,(n,i)=>{n[i]=fu(r)?r(n[i]):r},{buildGraph:!0})}function Qo(e,t,r){au(e,t,(n,i)=>{if(n instanceof Array){if(/^\d+$/.test(i))n.splice(parseInt(i),1);else if(r&&r.descendArray)for(let a of n)ye(a)&&delete a[i]}else ye(n)&&delete n[i]},r)}var R$=/^\$[a-zA-Z0-9_]+$/;function Gt(e){return R$.test(e)}function gu(e){if(X_.has(cn(e).toLowerCase()))return Bi(e)?{$regex:e}:{$eq:e};if(Yo(e)){if(!Object.keys(e).some(Gt))return{$eq:e};if(pt(e,"$regex")){let r={...e};return r.$regex=new RegExp(e.$regex,e.$options),delete r.$options,r}}return e}var Yn=(e=>(e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF",e))(Yn||{}),De=class e{constructor(t,r,n,i=Date.now()){this._opts=t,this._root=r,this._local=n,this.timestamp=i,this.update(r,n)}static init(t,r,n){return t instanceof e?new e(t._opts,H(t.root)?r:t.root,Object.assign({},t.local,n)):new e(t,r,n)}update(t,r){return this._root=t,this._local=r&&Object.assign({},r,{variables:Object.assign({},this._local?.variables,r?.variables)}),this}getOptions(){return Object.freeze({...this._opts,context:ji.from(this._opts.context)})}get root(){return this._root}get local(){return this._local}get idKey(){return this._opts.idKey}get collation(){return this._opts?.collation}get processingMode(){return this._opts?.processingMode||"CLONE_OFF"}get useStrictMode(){return this._opts?.useStrictMode}get scriptEnabled(){return this._opts?.scriptEnabled}get useGlobalContext(){return this._opts?.useGlobalContext}get hashFunction(){return this._opts?.hashFunction}get collectionResolver(){return this._opts?.collectionResolver}get jsonSchemaValidator(){return this._opts?.jsonSchemaValidator}get variables(){return this._opts?.variables}get context(){return this._opts?.context}};function Ki(e){return e instanceof De?e.getOptions():Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:"CLONE_OFF",...e,context:e?.context?ji.from(e?.context):ji.init({})})}var Qt=(e=>(e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window",e))(Qt||{}),ji=class e{constructor(t){this.operators={accumulator:{},expression:{},pipeline:{},projection:{},query:{},window:{}};for(let[r,n]of Object.entries(t))this.addOperators(r,n)}static init(t={}){return new e(t)}static from(t){return new e(t.operators)}addOperators(t,r){for(let[n,i]of Object.entries(r))this.getOperator(t,n)||(this.operators[t][n]=i);return this}addAccumulatorOps(t){return this.addOperators("accumulator",t)}addExpressionOps(t){return this.addOperators("expression",t)}addQueryOps(t){return this.addOperators("query",t)}addPipelineOps(t){return this.addOperators("pipeline",t)}addProjectionOps(t){return this.addOperators("projection",t)}addWindowOps(t){return this.addOperators("window",t)}getOperator(t,r){return t in this.operators&&this.operators[t][r]||null}},Gn=ji.init();function Tf(e,t){for(let[r,n]of Object.entries(t)){U(fu(n)&&Gt(r),`'${r}' is not a valid operator`);let i=Yt(e,r,null);U(!i||n===i,`${r} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case"accumulator":Gn.addAccumulatorOps(t);break;case"expression":Gn.addExpressionOps(t);break;case"pipeline":Gn.addPipelineOps(t);break;case"projection":Gn.addProjectionOps(t);break;case"query":Gn.addQueryOps(t);break;case"window":Gn.addWindowOps(t);break}}function Yt(e,t,r){let{context:n,useGlobalContext:i}=r||{},a=n?n.getOperator(e,t):null;return!a&&i?Gn.getOperator(e,t):a}var eg={$$ROOT(e,t,r){return r.root},$$CURRENT(e,t,r){return e},$$REMOVE(e,t,r){},$$NOW(e,t,r){return new Date(r.timestamp)}},Af={$$KEEP(e,t,r){return e},$$PRUNE(e,t,r){},$$DESCEND(e,t,r){if(!pt(t,"$cond"))return e;let n;for(let[i,a]of Object.entries(e))if(Yo(a)){if(a instanceof Array){let l=[];for(let f of a)ye(f)&&(f=kf(f,t,r.update(f))),H(f)||l.push(f);n=l}else n=kf(a,t,r.update(a));H(n)?delete e[i]:e[i]=n}return e}};function P(e,t,r,n){let i=De.init(n,e);if(r=r||"",Gt(r)){let a=Yt("expression",r,n);if(a)return a(e,t,i);let l=Yt("accumulator",r,n);if(l)return e instanceof Array||(e=P(e,t,null,i),t=null),U(e instanceof Array,`'${r}' target must be an array.`),l(e,t,i.update(null,i.local));throw new Xe(`operator '${r}' is not registered`)}if(we(t)&&t.length>0&&t[0]==="$"){if(pt(Af,t))return t;let a=i.root,l=t.split(".");if(pt(eg,l[0]))a=eg[l[0]](e,null,i),t=t.slice(l[0].length+1);else if(l[0].slice(0,2)==="$$"){a=Object.assign({},i.variables,{this:e},i.local?.variables);let f=l[0].slice(2);U(pt(a,f),`Use of undefined variable: ${f}`),t=t.slice(2)}else t=t.slice(1);return t===""?a:Nr(a,t)}if(ue(t))return t.map(a=>P(e,a,null,i));if(ye(t)){let a={};for(let[l,f]of Object.entries(t))if(a[l]=P(e,f,l,i),["expression","accumulator"].some(m=>!!Yt(m,l,n)))return U(Object.keys(t).length===1,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),a[l];return a}return t}function kf(e,t,r){let n=P(e,t,null,r);return pt(Af,n)?Af[n](e,t,r):n}function wt(e){return e instanceof Jo?e:new Jo(e)}function yu(...e){let t=0;return wt(()=>{for(;t<e.length;){let r=e[t].next();if(!r.done)return r;t++}return{done:!0}})}function N$(e){return!!e&&typeof e=="object"&&e?.next instanceof Function}function L$(e,t){let r=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,r)}var If=new Error;function F$(e,t,r){let n=!1,i=-1,a=0;return function(l){try{e:for(;!n;){let f=e();i++;let m=-1,h=t.length,g=!1;for(;++m<h;){let v=t[m];switch(v.action){case 0:f=v.func(f,i);break;case 1:if(!v.func(f,i))continue e;break;case 2:--v.count,v.count||(g=!0);break;case 3:--v.count,v.count||L$(t,m);continue e;default:break e}}if(n=g,l)r[a++]=f;else return{value:f,done:!1}}}catch(f){if(f!==If)throw f}return n=!0,{done:n}}}var Jo=class{constructor(t){this.iteratees=[],this.yieldedValues=[],this.isDone=!1;let r;if(t instanceof Function&&(t={next:t}),N$(t)){let n=t;r=()=>{let i=n.next();if(i.done)throw If;return i.value}}else if(t instanceof Array){let n=t,i=n.length,a=0;r=()=>{if(a<i)return n[a++];throw If}}else if(!(t instanceof Function))throw new Xe("Lazy must be initialized with an array, generator, or function.");this.getNext=F$(r,this.iteratees,this.yieldedValues)}push(t,r){return typeof r=="function"?this.iteratees.push({action:t,func:r}):typeof r=="number"&&this.iteratees.push({action:t,count:r}),this}next(){return this.getNext()}map(t){return this.push(0,t)}filter(t){return this.push(1,t)}take(t){return t>0?this.push(2,t):this}drop(t){return t>0?this.push(3,t):this}transform(t){let r=this,n;return wt(()=>(n||(n=wt(t(r.value()))),n.next()))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(t){for(;;){let r=this.next();if(r.done)break;if(t(r.value)===!1)return!1}return!0}reduce(t,r){let n=this.next();for(r===void 0&&!n.done&&(r=n.value,n=this.next());!n.done;)r=t(r,n.value),n=this.next();return r}size(){return this.reduce((t,r)=>++t,0)}[Symbol.iterator](){return this}};var xr=class{constructor(t,r){this.pipeline=t,this.options=Ki(r)}stream(t){let r=wt(t),n=this.options.processingMode;(n==Yn.CLONE_ALL||n==Yn.CLONE_INPUT)&&r.map(mu);let i=new Array;if(!xt(this.pipeline))for(let a of this.pipeline){let l=Object.keys(a),f=l[0],m=Yt(Qt.PIPELINE,f,this.options);U(l.length===1&&!!m,`invalid pipeline operator ${f}`),i.push(f),r=m(r,a[f],this.options)}return(n==Yn.CLONE_OUTPUT||n==Yn.CLONE_ALL&&Hn([["$group","$unwind"],i]).length)&&r.map(mu),r}run(t){return this.stream(t).value()}};var xu=class{constructor(t,r,n,i){this.source=t,this.predicate=r,this.projection=n,this.options=i,this.operators=[],this.result=null,this.buffer=[]}fetch(){return this.result?this.result:(ye(this.projection)&&this.operators.push({$project:this.projection}),this.result=wt(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new xr(this.operators,this.options).stream(this.result)),this.result)}fetchAll(){let t=wt([...this.buffer]);return this.buffer=[],yu(t,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(t){return this.operators.push({$skip:t}),this}limit(t){return this.operators.push({$limit:t}),this}sort(t){return this.operators.push({$sort:t}),this}collation(t){return this.options={...this.options,collation:t},this}next(){if(this.buffer.length>0)return this.buffer.pop();let t=this.fetch().next();if(!t.done)return t.value}hasNext(){if(this.buffer.length>0)return!0;let t=this.fetch().next();return t.done?!1:(this.buffer.push(t.value),!0)}map(t){return this.all().map(t)}forEach(t){this.all().forEach(t)}[Symbol.iterator](){return this.fetchAll()}};var $t=class{constructor(t,r){this.condition=t,this.options=Ki(r),this.compiled=[],this.compile()}compile(){U(ye(this.condition),`query criteria must be an object: ${JSON.stringify(this.condition)}`);let t={};for(let[r,n]of Object.entries(this.condition)){if(r==="$where")Object.assign(t,{field:r,expr:n});else if(gr(["$and","$or","$nor","$expr","$jsonSchema"],r))this.processOperator(r,r,n);else{U(!Gt(r),`unknown top level operator: ${r}`);for(let[i,a]of Object.entries(gu(n)))this.processOperator(r,i,a)}t.field&&this.processOperator(t.field,t.field,t.expr)}}processOperator(t,r,n){let i=Yt(Qt.QUERY,r,this.options);if(!i)throw new Xe(`unknown query operator ${r}`);let a=i(t,n,this.options);this.compiled.push(a)}test(t){for(let r=0,n=this.compiled.length;r<n;r++)if(!this.compiled[r](t))return!1;return!0}find(t,r){return new xu(t,n=>this.test(n),r||{},this.options)}remove(t){return t.reduce((r,n)=>(this.test(n)||r.push(n),r),[])}};var Ui=1e3*60*60*24,rg={week:Ui*7,day:Ui,hour:1e3*60*60,minute:1e3*60,second:1e3,millisecond:1};var jF={week:Ui*7,day:Ui,hour:Ui/24,minute:6e4,second:1e3,millisecond:1};var wu=(e,t,r)=>{if(xt(t)||!ye(t))return e;let n=Fe,i=r.collation;return ye(i)&&we(i.locale)&&(n=G$(i)),e.transform(a=>{let l=Object.keys(t);for(let f of l.reverse()){let m=hu(a,g=>Nr(g,f),r.hashFunction),h=Array.from(m.keys()).sort(n);t[f]===-1&&h.reverse(),a=[],h.reduce((g,v)=>Nt(g,m.get(v)),a)}return a})},H$={1:"base",2:"accent",3:"variant"};function G$(e){let t={sensitivity:H$[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(t.sensitivity==="base"&&(t.sensitivity="case"),t.sensitivity==="accent"&&(t.sensitivity="variant"));let r=new Intl.Collator(e.locale,t);return(n,i)=>{if(!we(n)||!we(i))return Fe(n,i);let a=r.compare(n,i);return a<0?-1:a>0?1:0}}function Ee(e){let t=(r,n,i)=>{let a={unwrapArray:!0},l=Math.max(1,r.split(".").length-1);return f=>{let m=Nr(f,r,a);return e(m,n,{...i,depth:l})}};return t.op="query",t}function mt(e){return(t,r,n)=>{let i=P(t,r,null,n);return e(...i)}}function Xo(e,t,r){if(vt(e,t)||H(e)&&H(t))return!0;if(e instanceof Array){let n=vt.bind(null,t);return e.some(n)||Sf(e,r?.depth).some(n)}return!1}function $u(e,t,r){return!Xo(e,t,r)}function Mf(e,t,r){return H(e)?t.some(n=>n===null):Hn([Rr(e),t],r?.hashFunction).length>0}function bu(e,t,r){return!Mf(e,t,r)}function Eu(e,t,r){return ku(e,t,(n,i)=>Fe(n,i)<0)}function Ou(e,t,r){return ku(e,t,(n,i)=>Fe(n,i)<=0)}function Su(e,t,r){return ku(e,t,(n,i)=>Fe(n,i)>0)}function Au(e,t,r){return ku(e,t,(n,i)=>Fe(n,i)>=0)}function ug(e,t,r){return Rr(e).some(n=>t.length===2&&n%t[0]===t[1])}function lg(e,t,r){let n=Rr(e),i=a=>we(a)&&yr(t.exec(a),r?.useStrictMode);return n.some(i)||Sf(n,1).some(i)}function cg(e,t,r){return(t===!1||t===0)&&e===void 0||(t===!0||t===1)&&e!==void 0}function fg(e,t,r){if(!ue(e)||!ue(t)||!e.length||!t.length)return!1;let n=!0;for(let i of t){if(!n)break;ye(i)&&gr(Object.keys(i),"$elemMatch")?n=Df(e,i.$elemMatch,r):i instanceof RegExp?n=e.some(a=>typeof a=="string"&&i.test(a)):n=e.some(a=>vt(i,a))}return n}function pg(e,t,r){return Array.isArray(e)&&e.length===t}function X$(e){return Gt(e)&&["$and","$or","$nor"].indexOf(e)===-1}function Df(e,t,r){if(ue(e)&&!xt(e)){let n=l=>l,i=t;Object.keys(t).every(X$)&&(i={temp:t},n=l=>({temp:l}));let a=new $t(i,r);for(let l=0,f=e.length;l<f;l++)if(a.test(n(e[l])))return!0}return!1}var ig=e=>e===null,og=e=>_e(e)&&e>=lu&&e<=uu&&e.toString().indexOf(".")===-1,sg=e=>_e(e)&&e>=Ef&&e<=bf&&e.toString().indexOf(".")===-1,Z$={array:ue,bool:Go,boolean:Go,date:Fi,decimal:_e,double:_e,int:og,long:sg,number:_e,null:ig,object:ye,regex:Bi,regexp:Bi,string:we,undefined:H,function:e=>{throw new Xe("unsupported type key `function`.")},1:_e,2:we,3:ye,4:ue,6:H,8:Go,9:Fi,10:ig,11:Bi,16:og,18:sg,19:_e};function ag(e,t,r){let n=Z$[t];return n?n(e):!1}function mg(e,t,r){return Array.isArray(t)?t.findIndex(n=>ag(e,n,r))>=0:ag(e,t,r)}function ku(e,t,r){return Rr(e).some(n=>cn(n)===cn(t)&&r(n,t))}var Yj=mt(bu);var zi=(e,t)=>(r,n,i)=>{U(ue(n),`${e}: expression must be an array.`);let a=P(r,n,null,i);return a.some(H)?null:(U(a.every(_e),`${e}: expression must evalue to array of numbers.`),t(a))};var q4=zi("$bitAnd",e=>e.reduce((t,r)=>t&r,-1));var J4=zi("$bitOr",e=>e.reduce((t,r)=>t|r,0));var e6=zi("$bitXor",e=>e.reduce((t,r)=>t^r,0));var b6=mt(Xo);var S6=mt(Su);var T6=mt(Au);var M6=mt(Eu);var R6=mt(Ou);var F6=mt($u);var dg=(e,t)=>{let r={};return e.split("").forEach((n,i)=>r[n]=t*(i+1)),r},x5={...dg("ABCDEFGHIKLM",1),...dg("NOPQRSTUVWXY",-1),Z:0};var yg={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function Te(e,t=yg){let r=Object.assign({},yg,t),n=new Set(Object.keys(r));return(i,a,l)=>{let f=P(i,a,null,l);if(n.has(`${f}`)){let m=r[`${f}`];if(m instanceof Error)throw new Xe(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return m}return e(f)}}var bU=Te(Math.acos,{Infinity:1/0,0:new Error});var SU=Te(Math.acosh,{Infinity:1/0,0:new Error});var TU=Te(Math.asin);var MU=Te(Math.asinh,{Infinity:1/0,"-Infinity":-1/0});var RU=Te(Math.atan);var KU=Te(Math.atanh,{1:1/0,"-1":-1/0});var WU=Te(Math.cos);var HU=Te(Math.cosh,{"-Infinity":1/0,Infinity:1/0});var nb=Math.PI/180,QU=Te(e=>e*nb,{Infinity:1/0,"-Infinity":1/0});var ib=180/Math.PI,ZU=Te(e=>e*ib,{Infinity:1/0,"-Infinity":-1/0});var rz=Te(Math.sin);var oz=Te(Math.sinh,{"-Infinity":-1/0,Infinity:1/0});var uz=Te(Math.tan);var Rf=(e,t,r)=>{if(xt(t))return e;let n=Object.keys(t),i=!1;vg(t,r);let a=r.idKey;if(gr(n,a)){let f=t[a];(f===0||f===!1)&&(n=n.filter(pu.bind(null,[a])),i=n.length==0)}else n.push(a);let l=De.init(r);return e.map(f=>Pf(f,t,l.update(f),n,i))};function Pf(e,t,r,n,i){let a={},l=!1,f=!1,m=[];i&&m.push(r.idKey);for(let h of n){let g,v=t[h];if(h!==r.idKey&&gr([0,!1],v)&&(f=!0),h===r.idKey&&xt(v))g=e[h];else if(we(v))g=P(e,v,h,r);else if(!gr([1,!0],v))if(v instanceof Array)g=v.map(E=>{let k=P(e,E,null,r);return H(k)?null:k});else if(ye(v)){let E=v,k=Object.keys(v),C=k.length==1?k[0]:"",G=Yt(Qt.PROJECTION,C,r);if(G)C==="$slice"?Rr(E[C]).every(_e)?(g=G(e,E[C],h,r),l=!0):g=P(e,E,h,r):g=G(e,E[C],h,r);else if(Gt(C))g=P(e,E[C],C,r);else if(pt(e,h)){vg(E,r);let J=e[h];J instanceof Array?g=J.map(Q=>Pf(Q,E,r,k,!1)):(J=ye(J)?J:e,g=Pf(J,E,r,k,!1))}else g=P(e,v,null,r)}else{m.push(h);continue}let O=Li(e,h,{preserveMissing:!0});O!==void 0&&ou(a,O,{flatten:!0}),pu([0,1,!1,!0],v)&&(g===void 0?Qo(a,h,{descendArray:!0}):_u(a,h,g))}if(su(a),(l||f||i)&&(a=Nt({},e,a),m.length>0))for(let h of m)Qo(a,h,{descendArray:!0});return a}function vg(e,t){let r=[!1,!1];for(let[n,i]of Object.entries(e)){if(n===t?.idKey)return;i===0||i===!1?r[0]=!0:(i===1||i===!0)&&(r[1]=!0),U(!(r[0]&&r[1]),"Projection cannot have a mix of inclusion and exclusion.")}}var wg=(e,t,r)=>{U(ue(t),"Invalid expression: $and expects value to be an Array.");let n=t.map(i=>new $t(i,r));return i=>n.every(a=>a.test(i))};var Tu=(e,t,r)=>{U(ue(t),"Invalid expression. $or expects value to be an Array");let n=t.map(i=>new $t(i,r));return i=>n.some(a=>a.test(i))};var $g=(e,t,r)=>{U(ue(t),"Invalid expression. $nor expects value to be an array.");let n=Tu("$or",t,r);return i=>!n(i)};var bg=(e,t,r)=>{let n={};n[e]=gu(t);let i=new $t(n,r);return a=>!i.test(a)};var Nf=Ee(Xo);var Lf=Ee(Su);var Ff=Ee(Au);var Bf=Ee(Mf);var jf=Ee(Eu);var Kf=Ee(Ou);var Uf=Ee($u);var zf=Ee(bu);var Eg=Ee(ug);var Og=Ee(lg);var f7=Ee(fg);var Sg=Ee(Df);var Ag=Ee(pg);var kg=Ee(cg);var Tg=Ee(mg);var Ig=!1;function Cg(e){return Ig||(Tf(Qt.PIPELINE,{$sort:wu,$project:Rf}),Tf(Qt.QUERY,{$and:wg,$eq:Nf,$elemMatch:Sg,$exists:kg,$gt:Lf,$gte:Ff,$in:Bf,$lt:jf,$lte:Kf,$ne:Uf,$nin:zf,$mod:Eg,$nor:$g,$not:bg,$or:Tu,$regex:Og,$size:Ag,$type:Tg}),Ig=!0),new $t(e)}function Zo(e,t){var r=Ct(e.primaryKey);t=Ae(t);var n=hr(t);if(typeof n.skip!="number"&&(n.skip=0),n.selector?(n.selector=n.selector,Object.entries(n.selector).forEach(([h,g])=>{(typeof g!="object"||g===null)&&(n.selector[h]={$eq:g})})):n.selector={},n.index){var i=jo(n.index);i.includes(r)||i.push(r),n.index=i}if(n.sort){var m=n.sort.find(h=>ch(h)===r);m||(n.sort=n.sort.slice(0),n.sort.push({[r]:"asc"}))}else if(n.index)n.sort=n.index.map(h=>({[h]:"asc"}));else{if(e.indexes){var a=new Set;Object.entries(n.selector).forEach(([h,g])=>{var v=!1;typeof g=="object"&&g!==null?v=!!Object.keys(g).find(O=>nu.has(O)):v=!0,v&&a.add(h)});var l=-1,f;e.indexes.forEach(h=>{var g=$i(h)?h:[h],v=g.findIndex(O=>!a.has(O));v>0&&v>l&&(l=v,f=g)}),f&&(n.sort=f.map(h=>({[h]:"asc"})))}n.sort||(n.sort=[{[r]:"asc"}])}return n}function Iu(e,t){if(!t.sort)throw ee("SNH",{query:t});var r=[];t.sort.forEach(i=>{var a=Object.keys(i)[0],l=Object.values(i)[0];r.push({key:a,direction:l,getValueFn:lh(a)})});var n=(i,a)=>{for(var l=0;l<r.length;++l){var f=r[l],m=f.getValueFn(i),h=f.getValueFn(a);if(m!==h){var g=f.direction==="asc"?Fe(m,h):Fe(h,m);return g}}};return n}function Wi(e,t){if(!t.sort)throw ee("SNH",{query:t});var r=Cg(t.selector),n=i=>r.test(i);return n}async function qi(e,t){var r=await e.exec();if(!r)return null;if(Array.isArray(r))return Promise.all(r.map(i=>t(i)));var n=await t(r);return n}function ab(e,t){return!t.sort||t.sort.length===0?[e]:t.sort.map(r=>Object.keys(r)[0])}var ub=new WeakMap;function lb(e){return yt(ub,e,()=>{var t=e.collection,r=Zo(t.storageInstance.schema,hr(e.mangoQuery)),n=t.schema.primaryPath,i=Iu(t.schema.jsonSchema,r),a=(h,g)=>{var v={docA:h,docB:g,rxQuery:e};return i(v.docA,v.docB)},l=Wi(t.schema.jsonSchema,r),f=h=>{var g={doc:h,rxQuery:e};return l(g.doc)},m={primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:ab(n,r),sortComparator:a,queryMatcher:f};return m})}function Mg(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=lb(e),n=be(e._result).docsData.slice(0),i=be(e._result).docsDataMap,a=!1,l=t.map(m=>l_(m)).filter(ah),f=l.find(m=>{var h={queryParams:r,changeEvent:m,previousResults:n,keyDocumentMap:i},g=q_(h);if(g==="runFullQueryAgain")return!0;if(g!=="doNothing")return a=!0,V_(g,r,m,n,i),!1});return f?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:a,newResults:n}}var cb=function(){function e(){this._map=new Map}var t=e.prototype;return t.getByQuery=function(n){var i=n.toString();return yt(this._map,i,()=>n)},e}();function Pg(){return new cb}function Dg(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function fb(e){return e.refCount$.observers.length}var pb=100,mb=30*1e3,db=(e,t)=>(r,n)=>{if(!(n._map.size<e)){var i=Ke()-t,a=[],l=Array.from(n._map.values());for(var f of l)if(!(fb(f)>0)){if(f._lastEnsureEqual===0&&f._creationTime<i){Dg(n,f);continue}a.push(f)}var m=a.length-e;if(!(m<=0)){var h=a.sort((v,O)=>v._lastEnsureEqual-O._lastEnsureEqual),g=h.slice(0,m);g.forEach(v=>Dg(n,v))}}},qf=db(pb,mb),Wf=new WeakSet;function Rg(e){Wf.has(e)||(Wf.add(e),hh().then(()=>yh(200)).then(()=>{e.destroyed||e.cacheReplacementPolicy(e,e._queryCache),Wf.delete(e)}))}var Lg=function(){function e(r,n,i){this.cacheItemByDocId=new Map,this.tasks=new Set,this.registry=typeof FinalizationRegistry=="function"?new FinalizationRegistry(a=>{var l=a.docId,f=this.cacheItemByDocId.get(l);f&&(f[0].delete(a.revisionHeight),f[0].size===0&&this.cacheItemByDocId.delete(l))}):void 0,this.primaryPath=r,this.changes$=n,this.documentCreator=i,n.subscribe(a=>{this.tasks.add(()=>{for(var l=this.cacheItemByDocId,f=0;f<a.length;f++){var m=a[f],h=l.get(m.documentId);if(h){var g=m.documentData;g||(g=m.previousDocumentData),h[1]=g}}}),this.tasks.size<=1&&Ai().then(()=>{this.processTasks()})})}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var n=Array.from(this.tasks);n.forEach(i=>i()),this.tasks.clear()}},t.getLatestDocumentData=function(n){this.processTasks();var i=sn(this.cacheItemByDocId,n);return i[1]},t.getLatestDocumentDataIfExists=function(n){this.processTasks();var i=this.cacheItemByDocId.get(n);if(i)return i[1]},ot(e,[{key:"getCachedRxDocuments",get:function(){var r=Ng(this);return gt(this,"getCachedRxDocuments",r)}},{key:"getCachedRxDocument",get:function(){var r=Ng(this);return gt(this,"getCachedRxDocument",n=>r([n])[0])}}])}();function Ng(e){var t=e.primaryPath,r=e.cacheItemByDocId,n=e.registry,i=ke.deepFreezeWhenDevMode,a=e.documentCreator,l=f=>{for(var m=new Array(f.length),h=[],g=0;g<f.length;g++){var v=f[g],O=v[t],E=Ln(v._rev),k=void 0,C=void 0,G=r.get(O);G?(k=G[0],C=k.get(E)):(k=new Map,G=[k,v],r.set(O,G));var J=C?C.deref():void 0;J||(v=i(v),J=a(v),k.set(E,_b(J)),n&&h.push(J)),m[g]=J}return h.length>0&&n&&(e.tasks.add(()=>{for(var Q=0;Q<h.length;Q++){var K=h[Q];n.register(K,{docId:K.primary,revisionHeight:Ln(K.revision)})}}),e.tasks.size<=1&&Ai().then(()=>{e.processTasks()})),m};return l}function Cu(e,t){var r=e.getCachedRxDocuments;return r(t)}var hb=typeof WeakRef=="function",_b=hb?gb:yb;function gb(e){return new WeakRef(e)}function yb(e){return{deref(){return e}}}var Vf=function(){function e(r,n,i){this.time=Ke(),this.query=r,this.count=i,this.documents=Cu(this.query.collection._docCache,n)}var t=e.prototype;return t.getValue=function(n){var i=this.query.op;if(i==="count")return this.count;if(i==="findOne"){var a=this.documents.length===0?null:this.documents[0];if(!a&&n)throw ee("QU10",{collection:this.query.collection.name,query:this.query.mangoQuery,op:i});return a}else return i==="findByIds"?this.docsMap:this.documents.slice(0)},ot(e,[{key:"docsData",get:function(){return gt(this,"docsData",this.documents.map(r=>r._data))}},{key:"docsDataMap",get:function(){var r=new Map;return this.documents.forEach(n=>{r.set(n.primary,n._data)}),gt(this,"docsDataMap",r)}},{key:"docsMap",get:function(){for(var r=new Map,n=this.documents,i=0;i<n.length;i++){var a=n[i];r.set(a.primary,a)}return gt(this,"docsMap",r)}}])}();var xb=0,vb=function(){return++xb},wb=function(){function e(r,n,i,a={}){this.id=vb(),this._execOverDatabaseCount=0,this._creationTime=Ke(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new ff(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=_r,this.op=r,this.mangoQuery=n,this.collection=i,this.other=a,n||(this.mangoQuery=es()),this.isFindOneByIdQuery=Ob(this.collection.schema.primaryPath,n)}var t=e.prototype;return t._setResultData=function(n){if(typeof n>"u")throw ee("QU18",{database:this.collection.database.name,collection:this.collection.name});if(typeof n=="number"){this._result=new Vf(this,[],n);return}else n instanceof Map&&(n=Array.from(n.values()));var i=new Vf(this,n,n.length);this._result=i},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=Ke(),this.op==="count"){var n=this.getPreparedQuery(),i=await this.collection.storageInstance.count(n);if(i.mode==="slow"&&!this.collection.database.allowSlowCount)throw ee("QU14",{collection:this.collection,queryObj:this.mangoQuery});return i.count}if(this.op==="findByIds"){var a=be(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,l=new Map,f=[];if(a.forEach(g=>{var v=this.collection._docCache.getLatestDocumentDataIfExists(g);if(v){if(!v._deleted){var O=this.collection._docCache.getCachedRxDocument(v);l.set(g,O)}}else f.push(g)}),f.length>0){var m=await this.collection.storageInstance.findDocumentsById(f,!1);m.forEach(g=>{var v=this.collection._docCache.getCachedRxDocument(g);l.set(v.primary,v)})}return l}var h=Eb(this);return h.then(g=>(this._lastExecEnd=Ke(),g))},t.exec=async function(n){if(n&&this.op!=="findOne")throw ee("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});await Fg(this);var i=be(this._result);return i.getValue(n)},t.toString=function(){var n=Ei({op:this.op,query:this.mangoQuery,other:this.other},!0),i=JSON.stringify(n);return this.toString=()=>i,i},t.getPreparedQuery=function(){var n={rxQuery:this,mangoQuery:Zo(this.collection.schema.jsonSchema,this.mangoQuery)};n.mangoQuery.selector._deleted={$eq:!1},n.mangoQuery.index&&n.mangoQuery.index.unshift("_deleted"),qe("prePrepareQuery",n);var i=Hf(this.collection.schema.jsonSchema,n.mangoQuery);return this.getPreparedQuery=()=>i,i},t.doesDocumentDataMatch=function(n){return n._deleted?!1:this.queryMatcher(n)},t.remove=function(){return this.exec().then(n=>Array.isArray(n)?Promise.all(n.map(i=>i.remove())):n.remove())},t.incrementalRemove=function(){return qi(this.asRxQuery,n=>n.incrementalRemove())},t.update=function(n){throw $e("update")},t.patch=function(n){return qi(this.asRxQuery,i=>i.patch(n))},t.incrementalPatch=function(n){return qi(this.asRxQuery,i=>i.incrementalPatch(n))},t.modify=function(n){return qi(this.asRxQuery,i=>i.modify(n))},t.incrementalModify=function(n){return qi(this.asRxQuery,i=>i.incrementalModify(n))},t.where=function(n){throw $e("query-builder")},t.sort=function(n){throw $e("query-builder")},t.skip=function(n){throw $e("query-builder")},t.limit=function(n){throw $e("query-builder")},ot(e,[{key:"$",get:function(){if(!this._$){var r=this.collection.$.pipe(Ue(n=>!n.isLocal),Ho(null),Ht(()=>Fg(this)),at(()=>this._result),Vo(Sa),Ni((n,i)=>!!(n&&n.time===be(i).time)),Ue(n=>!!n),at(n=>be(n).getValue()));this._$=mf(r,this.refCount$.pipe(Ue(()=>!1)))}return this._$}},{key:"$$",get:function(){var r=this.collection.database.getReactivityFactory();return r.fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){var r=this.collection.schema.jsonSchema,n=Zo(this.collection.schema.jsonSchema,this.mangoQuery);return gt(this,"queryMatcher",Wi(r,n))}},{key:"asRxQuery",get:function(){return this}}])}();function es(){return{selector:{}}}function $b(e){return e.collection._queryCache.getByQuery(e)}function Vi(e,t,r,n){qe("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:n});var i=new wb(e,t,r,n);return i=$b(i),Rg(r),i}function Bg(e){var t=e.asRxQuery.collection._changeEventBuffer.getCounter();return e._latestChangeEvent>=t}async function Fg(e){return e.collection.awaitBeforeReads.size>0&&await Promise.all(Array.from(e.collection.awaitBeforeReads).map(t=>t())),e.collection.database.destroyed||Bg(e)?!1:(e._ensureEqualQueue=e._ensureEqualQueue.then(()=>bb(e)),e._ensureEqualQueue)}function bb(e){if(e._lastEnsureEqual=Ke(),e.collection.database.destroyed||Bg(e))return _r;var t=!1,r=!1;if(e._latestChangeEvent===-1&&(r=!0),!r){var n=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(n===null)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.getCounter();var i=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(n);if(e.op==="count"){var a=be(e._result).count,l=a;i.forEach(m=>{var h=m.previousDocumentData&&e.doesDocumentDataMatch(m.previousDocumentData),g=e.doesDocumentDataMatch(m.documentData);!h&&g&&l++,h&&!g&&l--}),l!==a&&(t=!0,e._setResultData(l))}else{var f=Mg(e,i);f.runFullQueryAgain?r=!0:f.changed&&(t=!0,e._setResultData(f.newResults))}}}return r?e._execOverDatabase().then(m=>(e._latestChangeEvent=e.collection._changeEventBuffer.getCounter(),typeof m=="number"?((!e._result||m!==e._result.count)&&(t=!0,e._setResultData(m)),t):((!e._result||!ph(e.collection.schema.primaryPath,m,e._result.docsData))&&(t=!0,e._setResultData(m)),t))):Promise.resolve(t)}function Hf(e,t){if(!t.sort)throw ee("SNH",{query:t});var r=H_(e,t);return{query:t,queryPlan:r}}async function Eb(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var n=e.isFindOneByIdQuery;if(n=n.filter(g=>{var v=e.collection._docCache.getLatestDocumentDataIfExists(g);return v?(v._deleted||t.push(v),!1):!0}),n.length>0){var i=await r.storageInstance.findDocumentsById(n,!1);Ir(t,i)}}else{var a=e.isFindOneByIdQuery,l=e.collection._docCache.getLatestDocumentDataIfExists(a);if(!l){var f=await r.storageInstance.findDocumentsById([a],!1);f[0]&&(l=f[0])}l&&!l._deleted&&t.push(l)}else{var m=e.getPreparedQuery(),h=await r.storageInstance.query(m);t=h.documents}return t}function Ob(e,t){if(!t.skip&&t.selector&&Object.keys(t.selector).length===1&&t.selector[e]){var r=t.selector[e];if(typeof r=="string")return r;if(Object.keys(r).length===1&&typeof r.$eq=="string"||Object.keys(r).length===1&&Array.isArray(r.$eq)&&!r.$eq.find(n=>typeof n!="string"))return r.$eq}return!1}var jg="_rxdb_internal";async function Yf(e,t){var r=await e.findDocumentsById([t],!1),n=r[0];if(n)return n}function Hi(e,t,r,n){if(n)throw n.status===409?ee("CONFLICT",{collection:e.name,id:t,writeError:n,data:r}):n.status===422?ee("VD2",{collection:e.name,id:t,writeError:n,data:r}):n}function Kg(e,t,r,n,i,a,l){for(var f=!!e.schema.attachments,m=[],h=[],g=[],v=Bn(10),O={id:v,events:[],checkpoint:null,context:i,startTime:Ke(),endTime:0},E=O.events,k=[],C=[],G=[],J=r.size>0,Q,K=n.length,ne=function(){var fe=n[X],le=fe.document,pe=fe.previous,ze=le[t],Et=le._deleted,pn=pe&&pe._deleted,Xt=void 0;J&&(Xt=r.get(ze));var tt;if(Xt){var rl=Xt._rev;if(!pe||pe&&rl!==pe._rev){var mn={isError:!0,status:409,documentId:ze,writeRow:fe,documentInDb:Xt};return g.push(mn),1}var Ot=f?Gf(fe):fe;f&&(Et?pe&&Object.keys(pe._attachments).forEach(rt=>{C.push({documentId:ze,attachmentId:rt,digest:be(pe)._attachments[rt].digest})}):(Object.entries(le._attachments).find(([rt,Be])=>{var Bt=pe?pe._attachments[rt]:void 0;return!Bt&&!Be.data&&(tt={documentId:ze,documentInDb:Xt,isError:!0,status:510,writeRow:fe,attachmentId:rt}),!0}),tt||Object.entries(le._attachments).forEach(([rt,Be])=>{var Bt=pe?pe._attachments[rt]:void 0;if(!Bt)k.push({documentId:ze,attachmentId:rt,attachmentData:Be,digest:Be.digest});else{var jt=Ot.document._attachments[rt].digest;Be.data&&Bt.digest!==jt&&G.push({documentId:ze,attachmentId:rt,attachmentData:Be,digest:Be.digest})}}))),tt?g.push(tt):(f?(h.push(Gf(Ot)),l&&l(le)):(h.push(Ot),l&&l(le)),Q=Ot);var Br=null,Zi=null,jr=null;if(pn&&!Et)jr="INSERT",Br=f?vr(le):le;else if(pe&&!pn&&!Et)jr="UPDATE",Br=f?vr(le):le,Zi=pe;else if(Et)jr="DELETE",Br=be(le),Zi=pe;else throw ee("SNH",{args:{writeRow:fe}});var eo={documentId:ze,documentData:Br,previousDocumentData:Zi,operation:jr};E.push(eo)}else{var Xi=!!Et;if(f&&Object.entries(le._attachments).forEach(([rt,Be])=>{Be.data?k.push({documentId:ze,attachmentId:rt,attachmentData:Be,digest:Be.digest}):(tt={documentId:ze,isError:!0,status:510,writeRow:fe,attachmentId:rt},g.push(tt))}),tt||(f?(m.push(Gf(fe)),a&&a(le)):(m.push(fe),a&&a(le)),Q=fe),!Xi){var ms={documentId:ze,operation:"INSERT",documentData:f?vr(le):le,previousDocumentData:f&&pe?vr(pe):pe};E.push(ms)}}},X=0;X<K;X++)ne();return{bulkInsertDocs:m,bulkUpdateDocs:h,newestRow:Q,errors:g,eventBulk:O,attachmentsAdd:k,attachmentsRemove:C,attachmentsUpdate:G}}function Gf(e){return{previous:e.previous,document:vr(e.document)}}function Sb(e){return atob(e).length}function Ab(e){var t=e.data;if(!t)return e;var r={length:Sb(t),digest:e.digest,type:e.type};return r}function vr(e){if(!e._attachments||Object.keys(e._attachments).length===0)return e;var t=Ae(e);return t._attachments={},Object.entries(e._attachments).forEach(([r,n])=>{t._attachments[r]=Ab(n)}),t}function Qn(e){return Object.assign({},e,{_meta:Ae(e._meta)})}var Ug=new WeakMap;function Mu(e,t,r){ke.deepFreezeWhenDevMode(r);var n=Ct(t.schema.primaryKey),i={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(a,l){for(var f=e.token,m=new Array(a.length),h=Ke(),g=0;g<a.length;g++){var v=a[g],O=Qn(v.document);O._meta.lwt=h;var E=v.previous;O._rev=bi(f,E),m[g]={document:O,previous:E}}return qe("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:m}),e.lockedRun(()=>t.bulkWrite(m,l)).then(k=>{var C={error:[]},G=Lt(n,m,k);Ug.set(C,G);var J=k.error.length===0?[]:k.error.filter(K=>K.status===409&&!K.writeRow.previous&&!K.writeRow.document._deleted&&be(K.documentInDb)._deleted?!0:(C.error.push(K),!1));if(J.length>0){var Q=J.map(K=>({previous:K.documentInDb,document:Object.assign({},K.writeRow.document,{_rev:bi(e.token,K.documentInDb)})}));return e.lockedRun(()=>t.bulkWrite(Q,l)).then(K=>{Ir(C.error,K.error);var ne=Lt(n,Q,K);return Ir(G,ne),C})}return C})},query(a){return e.lockedRun(()=>t.query(a))},count(a){return e.lockedRun(()=>t.count(a))},findDocumentsById(a,l){return e.lockedRun(()=>t.findDocumentsById(a,l))},getAttachmentData(a,l,f){return e.lockedRun(()=>t.getAttachmentData(a,l,f))},getChangedDocumentsSince:t.getChangedDocumentsSince?(a,l)=>e.lockedRun(()=>t.getChangedDocumentsSince(be(a),l)):void 0,cleanup(a){return e.lockedRun(()=>t.cleanup(a))},remove(){return e.storageInstances.delete(i),e.lockedRun(()=>t.remove())},close(){return e.storageInstances.delete(i),e.lockedRun(()=>t.close())},changeStream(){return t.changeStream()},conflictResultionTasks(){return t.conflictResultionTasks()},resolveConflictResultionTask(a){if(a.output.isEqual)return t.resolveConflictResultionTask(a);var l=Object.assign({},a.output.documentData,{_meta:nn(),_rev:Cr(),_attachments:{}}),f=Ae(l);return delete f._meta,delete f._rev,delete f._attachments,t.resolveConflictResultionTask({id:a.id,output:{isEqual:!1,documentData:f}})}};return e.storageInstances.add(i),i}function zg(e){if(e.schema.keyCompression)throw ee("UT5",{args:{params:e}});if(kb(e.schema))throw ee("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw ee("UT7",{args:{params:e}})}function kb(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}function Lt(e,t,r){var n=Ug.get(r);if(n)return n;var i=[];if(r.error.length>0){for(var a=new Set,l=0;l<r.error.length;l++){var f=r.error[l];a.add(f.documentId)}for(var m=0;m<t.length;m++){var h=t[m].document;a.has(h[e])||i.push(vr(h))}}else{i.length=t.length-r.error.length;for(var g=0;g<t.length;g++){var v=t[g].document;i[g]=vr(v)}}return i}var Wg=function(){function e(r,n,i,a){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=r,this.primaryPath=n,this.preWrite=i,this.postWrite=a}var t=e.prototype;return t.addWrite=function(n,i){var a=n[this.primaryPath],l=yt(this.queueByDocId,a,()=>[]),f=new Promise((m,h)=>{var g={lastKnownDocumentState:n,modifier:i,resolve:m,reject:h};be(l).push(g),this.triggerRun()});return f},t.triggerRun=async function(){if(!(this.isRunning===!0||this.queueByDocId.size===0)){this.isRunning=!0;var n=[],i=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(i.entries()).map(async([l,f])=>{var m=Tb(f.map(v=>v.lastKnownDocumentState)),h=m;for(var g of f)try{h=await g.modifier(hr(h))}catch(v){g.reject(v),g.reject=()=>{},g.resolve=()=>{}}try{await this.preWrite(h,m)}catch(v){f.forEach(O=>O.reject(v));return}n.push({previous:m,document:h})}));var a=n.length>0?await this.storageInstance.bulkWrite(n,"incremental-write"):{error:[]};return await Promise.all(Lt(this.primaryPath,n,a).map(l=>{var f=l[this.primaryPath];this.postWrite(l);var m=sn(i,f);m.forEach(h=>h.resolve(l))})),a.error.forEach(l=>{var f=l.documentId,m=sn(i,f),h=Ia(l);if(h){var g=yt(this.queueByDocId,f,()=>[]);m.reverse().forEach(O=>{O.lastKnownDocumentState=be(h.documentInDb),be(g).unshift(O)})}else{var v=Th(l);m.forEach(O=>O.reject(v))}}),this.isRunning=!1,this.triggerRun()}},e}();function Qf(e){var t=async r=>{var n=fh(r);n._deleted=r._deleted;var i=await e(n),a=Object.assign({},i,{_meta:r._meta,_attachments:r._attachments,_rev:r._rev,_deleted:typeof i._deleted<"u"?i._deleted:r._deleted});return typeof a._deleted>"u"&&(a._deleted=!1),a};return t}function Tb(e){var t=e[0],r=Ln(t._rev);return e.forEach(n=>{var i=Ln(n._rev);i>r&&(t=n,r=i)}),t}var Jf={get primaryPath(){var e=this;if(e.isInstanceOfRxDocument)return e.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){var e=this;if(e.isInstanceOfRxDocument)return e._data._rev},get deleted$(){var e=this;if(e.isInstanceOfRxDocument)return e.$.pipe(at(t=>t._data._deleted))},get deleted$$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){var e=this;if(e.isInstanceOfRxDocument)return e._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){var e=this;return e.collection.$.pipe(Ue(t=>!t.isLocal),Ue(t=>t.documentId===this.primary),at(t=>u_(t)),Ho(e.collection._docCache.getLatestDocumentData(this.primary)),Ni((t,r)=>t._rev===r._rev),at(t=>this.collection._docCache.getCachedRxDocument(t)),Vo(Sa))},get $$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(ke.isDevMode()){if(e.includes(".item."))throw ee("DOC1",{path:e});if(e===this.primaryPath)throw ee("DOC2");if(this.collection.schema.finalFields.includes(e))throw ee("DOC3",{path:e});var t=Dr(this.collection.schema.jsonSchema,e);if(!t)throw ee("DOC4",{path:e})}return this.$.pipe(at(r=>Mr(r,e)),Ni())},get$$(e){var t=this.get$(e),r=this.collection.database.getReactivityFactory();return r.fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=Dr(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return gh;if(!t)throw ee("DOC5",{path:e});if(!t.ref)throw ee("DOC6",{path:e,schemaObj:t});var n=this.collection.database.collections[t.ref];if(!n)throw ee("DOC7",{ref:t.ref,path:e,schemaObj:t});return t.type==="array"?n.findByIds(r).exec().then(i=>{var a=i.values();return Array.from(a)}):n.findOne(r).exec()},get(e){return Hg(this,e)},toJSON(e=!1){if(e)return ke.deepFreezeWhenDevMode(this._data);var t=Ae(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,ke.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return hr(this.toJSON(e))},update(e){throw $e("update")},incrementalUpdate(e){throw $e("update")},updateCRDT(e){throw $e("crdt")},putAttachment(){throw $e("attachments")},getAttachment(){throw $e("attachments")},allAttachments(){throw $e("attachments")},get allAttachments$(){throw $e("attachments")},async modify(e,t){var r=this._data,n=await Qf(e)(r);return this._saveData(n,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,Qf(e)).then(r=>this.collection._docCache.getCachedRxDocument(r))},patch(e){var t=this._data,r=hr(t);return Object.entries(e).forEach(([n,i])=>{r[n]=i}),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify(t=>(Object.entries(e).forEach(([r,n])=>{t[r]=n}),t))},async _saveData(e,t){if(e=Ae(e),this._data._deleted)throw ee("DOC11",{id:this.primary,document:this});await Xf(this.collection,e,t);var r=[{previous:t,document:e}],n=await this.collection.storageInstance.bulkWrite(r,"rx-document-save-data"),i=n.error[0];return Hi(this.collection,this.primary,e,i),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(Lt(this.collection.schema.primaryPath,r,n)[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject(ee("DOC13",{document:this,id:this.primary}));var t=Ae(this._data),r;return e._runHooks("pre","remove",t,this).then(async()=>{t._deleted=!0;var n=[{previous:this._data,document:t}],i=await e.storageInstance.bulkWrite(n,"rx-document-remove"),a=i.error[0];return Hi(e,this.primary,t,a),Lt(this.collection.schema.primaryPath,n,i)[0]}).then(n=>(r=n,this.collection._runHooks("post","remove",t,this))).then(()=>this.collection._docCache.getCachedRxDocument(r))},incrementalRemove(){return this.incrementalModify(async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e)).then(async e=>(await this.collection._runHooks("post","remove",e._data,e),e))},destroy(){throw ee("DOC14")}};function qg(e=Jf){var t=function(n,i){this.collection=n,this._data=i,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function Vg(e,t,r){var n=new e(t,r);return qe("createRxDocument",n),n}function Xf(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),ke.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}function Hg(e,t){return yt(e._propertyCache,t,()=>{var r=Mr(e._data,t);if(typeof r!="object"||r===null||Array.isArray(r))return ke.deepFreezeWhenDevMode(r);var n=new Proxy(Ae(r),{get(i,a){if(typeof a!="string")return i[a];var l=a.charAt(a.length-1);if(l==="$")if(a.endsWith("$$")){var f=a.slice(0,-2);return e.get$$(jn(t+"."+f))}else{var m=a.slice(0,-1);return e.get$(jn(t+"."+m))}else if(l==="_"){var h=a.slice(0,-1);return e.populate(jn(t+"."+h))}else{var g=i[a];return typeof g=="number"||typeof g=="string"||typeof g=="boolean"?g:Hg(e,jn(t+"."+a))}}});return n})}var Gi="collection",Zf="storage-token",Ib="rx-migration-status",Cb="RxInternalDocument",Du=Ca({version:0,title:Cb,primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[Gi,Zf,Ib,"OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function Pu(e,t){return zo(Du,{key:e,context:t})}async function Ru(e){var t=Hf(e.schema,{selector:{context:Gi,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0}),r=await e.query(t),n=r.documents;return n}var Gg="storageToken",Mb=Pu(Gg,Zf);async function Yg(e){var t=Bn(10),r=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,n={id:Mb,context:Zf,key:Gg,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:nn(),_rev:Cr(),_attachments:{}},i=[{document:n}],a=await e.internalStore.bulkWrite(i,"internal-add-storage-token");if(!a.error[0])return Lt("id",i,a)[0];var l=be(a.error[0]);if(l.isError&&Ia(l)){var f=l;if(!Db(f.documentInDb.data.rxdbVersion,e.rxdbVersion))throw ee("DM5",{args:{database:e.name,databaseStateVersion:f.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(r&&r!==f.documentInDb.data.passwordHash)throw ee("DB1",{passwordHash:r,existingPasswordHash:f.documentInDb.data.passwordHash});var m=f.documentInDb;return be(m)}throw l}function Db(e,t){if(!e||t.includes("beta")&&t!==e)return!1;var r=e.split(".")[0],n=t.split(".")[0];return r===n}function ep(e,t){return e+"-"+t.version}function ts(e,t){return t=Ae(t),t=Mh(e,t),typeof e.jsonSchema.primaryKey!="string"&&(t=Ih(e.primaryPath,e.jsonSchema,t)),t._meta=nn(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=Cr()),t}async function Qg(e,t){t.multiInstance=e.multiInstance;var r=await e.storage.createStorageInstance(t);return r}async function Nu(e,t,r,n,i,a,l){var f=await Ru(t),m=f.filter(O=>O.data.name===i),h=[];m.forEach(O=>{h.push({collectionName:O.data.name,schema:O.data.schema,isCollection:!0}),O.data.connectedStorages.forEach(E=>h.push({collectionName:E.collectionName,isCollection:!1,schema:E.schema}))});var g=new Set;if(h=h.filter(O=>{var E=O.collectionName+"||"+O.schema.version;return g.has(E)?!1:(g.add(E),!0)}),await Promise.all(h.map(async O=>{var E=await e.createStorageInstance({collectionName:O.collectionName,databaseInstanceToken:r,databaseName:n,multiInstance:!1,options:{},schema:O.schema,password:a,devMode:ke.isDevMode()});await E.remove(),O.isCollection&&await un("postRemoveRxCollection",{storage:e,databaseName:n,collectionName:i})})),l){var v=m.map(O=>{var E=Qn(O);return E._deleted=!0,E._meta.lwt=Ke(),E._rev=bi(r,O),{previous:O,document:E}});await t.bulkWrite(v,"rx-database-remove-collection-all")}}function bt(e){if(e.destroyed)throw ee("COL21",{collection:e.name,version:e.schema.version})}var Pb=function(){function e(r){this.subs=[],this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.limit=100,this.tasks=new Set,this.collection=r,this.subs.push(this.collection.database.eventBulks$.pipe(Ue(n=>n.collectionName===this.collection.name),Ue(n=>{var i=n.events[0];return!i.isLocal})).subscribe(n=>{this.tasks.add(()=>this._handleChangeEvents(n.events)),this.tasks.size<=1&&Ai().then(()=>{this.processTasks()})}))}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var n=Array.from(this.tasks);n.forEach(i=>i()),this.tasks.clear()}},t._handleChangeEvents=function(n){var i=this.counter;this.counter=this.counter+n.length,n.length>this.limit?this.buffer=n.slice(n.length*-1):(Ir(this.buffer,n),this.buffer=this.buffer.slice(this.limit*-1));for(var a=i+1,l=this.eventCounterMap,f=0;f<n.length;f++){var m=n[f];l.set(m,a+f)}},t.getCounter=function(){return this.processTasks(),this.counter},t.getBuffer=function(){return this.processTasks(),this.buffer},t.getArrayIndexByPointer=function(n){this.processTasks();var i=this.buffer[0],a=this.eventCounterMap.get(i);if(n<a)return null;var l=n-a;return l},t.getFrom=function(n){this.processTasks();var i=[],a=this.getArrayIndexByPointer(n);if(a===null)return null;for(;;){var l=this.buffer[a];if(a++,l)i.push(l);else return i}},t.runFrom=function(n,i){this.processTasks();var a=this.getFrom(n);if(a===null)throw new Error("out of bounds");a.forEach(l=>i(l))},t.reduceByLastOfDoc=function(n){return this.processTasks(),n.slice(0);var i={};return n.forEach(a=>{i[a.documentId]=a}),Object.values(i)},t.destroy=function(){this.tasks.clear(),this.subs.forEach(n=>n.unsubscribe())},e}();function Jg(e){return new Pb(e)}var Rb=new WeakMap;function Nb(e){var t=e.schema.getDocumentPrototype(),r=Lb(e),n=Jf,i={};return[t,r,n].forEach(a=>{var l=Object.getOwnPropertyNames(a);l.forEach(f=>{var m=Object.getOwnPropertyDescriptor(a,f),h=!0;(f.startsWith("_")||f.endsWith("_")||f.startsWith("$")||f.endsWith("$"))&&(h=!1),typeof m.value=="function"?Object.defineProperty(i,f,{get(){return m.value.bind(this)},enumerable:h,configurable:!1}):(m.enumerable=h,m.configurable=!1,m.writable&&(m.writable=!1),Object.defineProperty(i,f,m))})}),i}function Xg(e){return yt(Rb,e,()=>qg(Nb(e)))}function Zg(e,t,r){var n=Vg(t,e,ke.deepFreezeWhenDevMode(r));return e._runHooksSync("post","create",r,n),qe("postCreateRxDocument",n),n}function Lb(e){var t={};return Object.entries(e.methods).forEach(([r,n])=>{t[r]=n}),t}var tp=function(e,t){var r=vr(e.newDocumentState),n=vr(e.realMasterState);return ki(r,n)?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};var ty=["pre","post"],ry=["insert","save","remove","create"],ey=!1,Fb=function(){function e(r,n,i,a,l={},f={},m={},h={},g={},v=qf,O={},E=tp){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this.awaitBeforeReads=new Set,this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=Pg(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.onRemove=[],this.database=r,this.name=n,this.schema=i,this.internalStorageInstance=a,this.instanceCreationOptions=l,this.migrationStrategies=f,this.methods=m,this.attachments=h,this.options=g,this.cacheReplacementPolicy=v,this.statics=O,this.conflictHandler=E,Bb(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=Mu(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new Wg(this.storageInstance,this.schema.primaryPath,(m,h)=>Xf(this,m,h),m=>this._runHooks("post","save",m));var n=this.database.eventBulks$.pipe(Ue(m=>m.collectionName===this.name));this.$=n.pipe(Ht(m=>m.events)),this.checkpoint$=n.pipe(at(m=>m.checkpoint)),this._changeEventBuffer=Jg(this.asRxCollection);var i;this._docCache=new Lg(this.schema.primaryPath,this.database.eventBulks$.pipe(Ue(m=>m.collectionName===this.name&&!m.events[0].isLocal),at(m=>m.events)),m=>(i||(i=Xg(this.asRxCollection)),Zg(this.asRxCollection,i,m)));var a=this.database.internalStore.changeStream().pipe(Ue(m=>{var h=this.name+"-"+this.schema.version,g=m.events.find(v=>v.documentData.context==="collection"&&v.documentData.key===h&&v.operation==="DELETE");return!!g})).subscribe(async()=>{await this.destroy(),await Promise.all(this.onRemove.map(m=>m()))});this._subs.push(a);var l=await this.database.storageToken,f=this.storageInstance.changeStream().subscribe(m=>{for(var h=new Array(m.events.length),g=m.events,v=this.name,O=ke.deepFreezeWhenDevMode,E=0;E<g.length;E++){var k=g[E];h[E]={documentId:k.documentId,collectionName:v,isLocal:!1,operation:k.operation,documentData:O(k.documentData),previousDocumentData:O(k.previousDocumentData)}}var C={id:m.id,internal:!1,collectionName:this.name,storageToken:l,events:h,databaseToken:this.database.token,checkpoint:m.checkpoint,context:m.context,endTime:m.endTime,startTime:m.startTime};this.database.$emit(C)});return this._subs.push(f),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe(m=>{this.conflictHandler(m.input,m.context).then(h=>{this.storageInstance.resolveConflictResultionTask({id:m.id,output:h})})})),Si},t.cleanup=function(n){throw bt(this),$e("cleanup")},t.migrationNeeded=function(){throw $e("migration-schema")},t.getMigrationState=function(){throw $e("migration-schema")},t.startMigration=function(n=10){return bt(this),this.getMigrationState().startMigration(n)},t.migratePromise=function(n=10){return this.getMigrationState().migratePromise(n)},t.insert=async function(n){bt(this);var i=await this.bulkInsert([n]),a=i.error[0];Hi(this,n[this.schema.primaryPath],n,a);var l=be(i.success[0]);return l},t.bulkInsert=async function(n){if(bt(this),n.length===0)return{success:[],error:[]};var i=this.schema.primaryPath,a;if(this.hasHooks("pre","insert"))a=await Promise.all(n.map(C=>{var G=ts(this.schema,C);return this._runHooks("pre","insert",G).then(()=>({document:G}))}));else{a=new Array(n.length);for(var l=this.schema,f=0;f<n.length;f++){var m=n[f],h=ts(l,m);a[f]={document:h}}}var g=await this.storageInstance.bulkWrite(a,"rx-collection-bulk-insert"),v,O=this,E={get success(){if(!v){var C=Lt(O.schema.primaryPath,a,g);v=Cu(O._docCache,C)}return v},error:g.error};if(this.hasHooks("post","insert")){var k=new Map;a.forEach(C=>{var G=C.document;k.set(G[i],G)}),await Promise.all(E.success.map(C=>this._runHooks("post","insert",k.get(C.primary),C)))}return E},t.bulkRemove=async function(n){bt(this);var i=this.schema.primaryPath;if(n.length===0)return{success:[],error:[]};var a=await this.findByIds(n).exec(),l=[],f=new Map;Array.from(a.values()).forEach(E=>{var k=E.toMutableJSON(!0);l.push(k),f.set(E.primary,k)}),await Promise.all(l.map(E=>{var k=E[this.schema.primaryPath];return this._runHooks("pre","remove",E,a.get(k))}));var m=l.map(E=>{var k=Ae(E);return k._deleted=!0,{previous:E,document:k}}),h=await this.storageInstance.bulkWrite(m,"rx-collection-bulk-remove"),g=Lt(this.schema.primaryPath,m,h),v=g.map(E=>E[i]);await Promise.all(v.map(E=>this._runHooks("post","remove",f.get(E),a.get(E))));var O=v.map(E=>sn(a,E));return{success:O,error:h.error}},t.bulkUpsert=async function(n){bt(this);var i=[],a=new Map;n.forEach(h=>{var g=ts(this.schema,h),v=g[this.schema.primaryPath];if(!v)throw ee("COL3",{primaryPath:this.schema.primaryPath,data:g,schema:this.schema.jsonSchema});a.set(v,g),i.push(g)});var l=await this.bulkInsert(i),f=l.success.slice(0),m=[];return await Promise.all(l.error.map(async h=>{if(h.status!==409)m.push(h);else{var g=h.documentId,v=sn(a,g),O=be(h.documentInDb),E=this._docCache.getCachedRxDocuments([O])[0],k=await E.incrementalModify(()=>v);f.push(k)}})),{error:m,success:f}},t.upsert=async function(n){bt(this);var i=await this.bulkUpsert([n]);return Hi(this.asRxCollection,n[this.schema.primaryPath],n,i.error[0]),i.success[0]},t.incrementalUpsert=function(n){bt(this);var i=ts(this.schema,n),a=i[this.schema.primaryPath];if(!a)throw ee("COL4",{data:n});var l=this._incrementalUpsertQueues.get(a);return l||(l=Si),l=l.then(()=>Kb(this,a,i)).then(f=>f.inserted?f.doc:jb(f.doc,i)),this._incrementalUpsertQueues.set(a,l),l},t.find=function(n){if(bt(this),typeof n=="string")throw ee("COL5",{queryObj:n});n||(n=es());var i=Vi("find",n,this);return i},t.findOne=function(n){if(bt(this),typeof n=="number"||Array.isArray(n))throw Ta("COL6",{queryObj:n});var i;if(typeof n=="string")i=Vi("findOne",{selector:{[this.schema.primaryPath]:n},limit:1},this);else{if(n||(n=es()),n.limit)throw ee("QU6");n=Ae(n),n.limit=1,i=Vi("findOne",n,this)}return i},t.count=function(n){bt(this),n||(n=es());var i=Vi("count",n,this);return i},t.findByIds=function(n){bt(this);var i={selector:{[this.schema.primaryPath]:{$in:n.slice(0)}}},a=Vi("findByIds",i,this);return a},t.exportJSON=function(){throw $e("json-dump")},t.importJSON=function(n){throw $e("json-dump")},t.insertCRDT=function(n){throw $e("crdt")},t.addPipeline=function(n){throw $e("pipeline")},t.addHook=function(n,i,a,l=!1){if(typeof a!="function")throw Ta("COL7",{key:i,when:n});if(!ty.includes(n))throw Ta("COL8",{key:i,when:n});if(!ry.includes(i))throw ee("COL9",{key:i});if(n==="post"&&i==="create"&&l===!0)throw ee("COL10",{when:n,key:i,parallel:l});var f=a.bind(this),m=l?"parallel":"series";this.hooks[i]=this.hooks[i]||{},this.hooks[i][n]=this.hooks[i][n]||{series:[],parallel:[]},this.hooks[i][n][m].push(f)},t.getHooks=function(n,i){return!this.hooks[i]||!this.hooks[i][n]?{series:[],parallel:[]}:this.hooks[i][n]},t.hasHooks=function(n,i){if(!this.hooks[i]||!this.hooks[i][n])return!1;var a=this.getHooks(n,i);return a?a.series.length>0||a.parallel.length>0:!1},t._runHooks=function(n,i,a,l){var f=this.getHooks(n,i);if(!f)return Si;var m=f.series.map(h=>()=>h(a,l));return xh(m).then(()=>Promise.all(f.parallel.map(h=>h(a,l))))},t._runHooksSync=function(n,i,a,l){if(this.hasHooks(n,i)){var f=this.getHooks(n,i);f&&f.series.forEach(m=>m(a,l))}},t.promiseWait=function(n){var i=new Promise(a=>{var l=setTimeout(()=>{this.timeouts.delete(l),a()},n);this.timeouts.add(l)});return i},t.destroy=async function(){return this.destroyed?_r:(await Promise.all(this.onDestroy.map(n=>n())),this.destroyed=!0,Array.from(this.timeouts).forEach(n=>clearTimeout(n)),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then(()=>this.storageInstance.close()).then(()=>(this._subs.forEach(n=>n.unsubscribe()),delete this.database.collections[this.name],un("postDestroyRxCollection",this).then(()=>!0))))},t.remove=async function(){await this.destroy(),await Promise.all(this.onRemove.map(n=>n())),await Nu(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},ot(e,[{key:"insert$",get:function(){return this.$.pipe(Ue(r=>r.operation==="INSERT"))}},{key:"update$",get:function(){return this.$.pipe(Ue(r=>r.operation==="UPDATE"))}},{key:"remove$",get:function(){return this.$.pipe(Ue(r=>r.operation==="DELETE"))}},{key:"asRxCollection",get:function(){return this}}])}();function Bb(e){if(!ey){ey=!0;var t=Object.getPrototypeOf(e);ry.forEach(r=>{ty.map(n=>{var i=n+Oa(r);t[i]=function(a,l){return this.addHook(n,r,a,l)}})})}}function jb(e,t){return e.incrementalModify(r=>t)}function Kb(e,t,r){var n=e._docCache.getLatestDocumentDataIfExists(t);return n?Promise.resolve({doc:e._docCache.getCachedRxDocuments([n])[0],inserted:!1}):e.findOne(t).exec().then(i=>i?{doc:i,inserted:!1}:e.insert(r).then(a=>({doc:a,inserted:!0})))}function ny({database:e,name:t,schema:r,instanceCreationOptions:n={},migrationStrategies:i={},autoMigrate:a=!0,statics:l={},methods:f={},attachments:m={},options:h={},localDocuments:g=!1,cacheReplacementPolicy:v=qf,conflictHandler:O=tp}){var E={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:r.jsonSchema,options:n,multiInstance:e.multiInstance,password:e.password,devMode:ke.isDevMode()};return qe("preCreateRxStorageInstance",E),Qg(e,E).then(k=>{var C=new Fb(e,t,r,k,n,i,f,m,h,v,l,O);return C.prepare().then(()=>{Object.entries(l).forEach(([J,Q])=>{Object.defineProperty(C,J,{get:()=>Q.bind(C)})});var G=Si;return a&&C.schema.version!==0&&(G=C.migratePromise()),G}).then(()=>(qe("createRxCollection",{collection:C,creator:{name:t,schema:r,storageInstance:k,instanceCreationOptions:n,migrationStrategies:i,methods:f,attachments:m,options:h,cacheReplacementPolicy:v,localDocuments:g,statics:l}}),C)).catch(G=>k.close().then(()=>Promise.reject(G)))})}var ip=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this._parallels=t||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};ip.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,np(this)},wrapCall:function(t){var r=this;this.lock();var n;try{n=t()}catch(i){throw this.unlock(),i}return!n.then||typeof n.then!="function"?(this.unlock(),n):n.then(function(i){return r.unlock(),i}).catch(function(i){throw r.unlock(),i})},requestIdlePromise:function(t){var r=this;t=t||{};var n,i=new Promise(function(f){return n=f}),a=function(){rp(r,i),n()};if(i._manRes=a,t.timeout){var l=setTimeout(function(){i._manRes()},t.timeout);i._timeoutObj=l}return this._iC.add(i),np(this),i},cancelIdlePromise:function(t){rp(this,t)},requestIdleCallback:function(t,r){var n=this._lHN++,i=this.requestIdlePromise(r);return this._hPM.set(n,i),this._pHM.set(i,n),i.then(function(){return t()}),n},cancelIdleCallback:function(t){var r=this._hPM.get(t);this.cancelIdlePromise(r)},clear:function(){var t=this;this._iC.forEach(function(r){return rp(t,r)}),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};function Ub(e){if(e._iC.size!==0){var t=e._iC.values(),r=t.next().value;r._manRes(),setTimeout(function(){return np(e)},0)}}function rp(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var r=e._pHM.get(t);e._hPM.delete(r),e._pHM.delete(t)}e._iC.delete(t)}}function np(e){e._tryIR||e._iC.size===0||(e._tryIR=!0,setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}Ub(e),e._tryIR=!1},0)},0))}var fn=class{ttl;map=new Map;_to=!1;constructor(t){this.ttl=t}has(t){return this.map.has(t)}add(t){this.map.set(t,iy()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,zb(this)},0))}clear(){this.map.clear()}};function zb(e){let t=iy()-e.ttl,r=e.map[Symbol.iterator]();for(;;){let n=r.next().value;if(!n)return;let i=n[0];if(n[1]<t)e.map.delete(i);else return}}function iy(){return Date.now()}var Lu=new Set,oy=0,Wb=function(){function e(r,n,i,a,l,f,m=!1,h={},g,v,O,E,k){this.idleQueue=new ip,this.rxdbVersion=Ko,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.states={},this.eventBulks$=new ut,this.observable$=this.eventBulks$.pipe(Ht(C=>C.events)),this.storageToken=_r,this.storageTokenDocument=_r,this.emittedEventBulkIds=new fn(60*1e3),this.name=r,this.token=n,this.storage=i,this.instanceCreationOptions=a,this.password=l,this.multiInstance=f,this.eventReduce=m,this.options=h,this.internalStore=g,this.hashFunction=v,this.cleanupPolicy=O,this.allowSlowCount=E,this.reactivity=k,oy++,this.name!=="pseudoInstance"&&(this.internalStore=Mu(this.asRxDatabase,g,Du),this.storageTokenDocument=Yg(this.asRxDatabase).catch(C=>this.startupErrors.push(C)),this.storageToken=this.storageTokenDocument.then(C=>C.data.token).catch(C=>this.startupErrors.push(C)))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw ee("DB14",{database:this.name});return this.reactivity},t.$emit=function(n){this.emittedEventBulkIds.has(n.id)||(this.emittedEventBulkIds.add(n.id),this.eventBulks$.next(n))},t.removeCollectionDoc=async function(n,i){var a=await Yf(this.internalStore,Pu(ep(n,i),Gi));if(!a)throw ee("SNH",{name:n,schema:i});var l=Qn(a);l._deleted=!0,await this.internalStore.bulkWrite([{document:l,previous:a}],"rx-database-remove-collection")},t.addCollections=async function(n){var i={},a={},l=[],f={};await Promise.all(Object.entries(n).map(async([g,v])=>{var O=g,E=v.schema;i[O]=E;var k=Dh(E,this.hashFunction);if(a[O]=k,this.collections[g])throw ee("DB3",{name:g});var C=ep(g,E),G={id:Pu(C,Gi),key:C,context:Gi,data:{name:O,schemaHash:await k.hash,schema:k.jsonSchema,version:k.version,connectedStorages:[]},_deleted:!1,_meta:nn(),_rev:Cr(),_attachments:{}};l.push({document:G});var J=Object.assign({},v,{name:O,schema:k,database:this}),Q=Ae(v);Q.database=this,Q.name=g,qe("preCreateRxCollection",Q),J.conflictHandler=Q.conflictHandler,f[O]=J}));var m=await this.internalStore.bulkWrite(l,"rx-database-add-collection");await Hb(this),await Promise.all(m.error.map(async g=>{if(g.status!==409)throw ee("DB12",{database:this.name,writeError:g});var v=be(g.documentInDb),O=v.data.name,E=a[O];if(v.data.schemaHash!==await E.hash)throw ee("DB6",{database:this.name,collection:O,previousSchemaHash:v.data.schemaHash,schemaHash:await E.hash,previousSchema:v.data.schema,schema:be(i[O])})}));var h={};return await Promise.all(Object.keys(n).map(async g=>{var v=f[g],O=await ny(v);h[g]=O,this.collections[g]=O,this[g]||Object.defineProperty(this,g,{get:()=>this.collections[g]})})),h},t.lockedRun=function(n){return this.idleQueue.wrapCall(n)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(n){throw $e("json-dump")},t.addState=function(n){throw $e("state")},t.importJSON=function(n){throw $e("json-dump")},t.backup=function(n){throw $e("backup")},t.leaderElector=function(){throw $e("leader-election")},t.isLeader=function(){throw $e("leader-election")},t.waitForLeadership=function(){throw $e("leader-election")},t.migrationStates=function(){throw $e("migration-schema")},t.destroy=async function(){return this.destroyed?_r:(this.destroyed=!0,await un("preDestroyRxDatabase",this),this.eventBulks$.complete(),oy--,this._subs.map(n=>n.unsubscribe()),this.name==="pseudoInstance"?_r:this.requestIdlePromise().then(()=>Promise.all(this.onDestroy.map(n=>n()))).then(()=>Promise.all(Object.keys(this.collections).map(n=>this.collections[n]).map(n=>n.destroy()))).then(()=>this.internalStore.close()).then(()=>Lu.delete(this.storage.name+"|"+this.name)).then(()=>!0))},t.remove=function(){return this.destroy().then(()=>Vb(this.name,this.storage,this.password))},ot(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])}();function qb(e,t){var r=t.name+"|"+e;if(Lu.has(r))throw ee("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}async function sy(e,t,r,n,i,a){var l=await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:jg,schema:Du,options:n,multiInstance:i,password:a,devMode:ke.isDevMode()});return l}function ay({storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i=!0,eventReduce:a=!0,ignoreDuplicate:l=!1,options:f={},cleanupPolicy:m,allowSlowCount:h=!1,localDocuments:g=!1,hashFunction:v=Ea,reactivity:O}){qe("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:l,options:f,localDocuments:g}),l||qb(r,e),Lu.add(e.name+"|"+r);var E=Bn(10);return sy(E,e,r,t,i,n).catch(k=>{throw Lu.delete(e.name+"|"+r),k}).then(k=>{var C=new Wb(r,E,e,t,n,i,a,f,k,v,m,h,O);return un("createRxDatabase",{database:C,creator:{storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:l,options:f,localDocuments:g}}).then(()=>C)})}async function Vb(e,t,r){var n=Bn(10),i=await sy(n,t,e,{},!1,r),a=await Ru(i),l=new Set;a.forEach(m=>l.add(m.data.name));var f=Array.from(l);return await Promise.all(f.map(m=>Nu(t,i,n,e,m,r))),await un("postRemoveRxDatabase",{databaseName:e,storage:t}),await i.remove(),f}async function Hb(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}function uy(e){return e&&typeof e.then=="function"}var Gb=Promise.resolve(!1),qG=Promise.resolve(!0),wr=Promise.resolve();function Fu(e,t){return e||(e=0),new Promise(function(r){return setTimeout(function(){return r(t)},e)})}function ly(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function rs(){return Math.random().toString(36).substring(2)}var op=0;function Lr(){var e=Date.now()*1e3;return e<=op&&(e=op+1),op=e,e}var Yb=Lr,Qb="native";function Jb(e){var t={time:Lr(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(r){t.messagesCallback&&t.messagesCallback(r.data)},t}function Xb(e){e.bc.close(),e.subFns=[]}function Zb(e,t){try{return e.bc.postMessage(t,!1),wr}catch(r){return Promise.reject(r)}}function e1(e,t){e.messagesCallback=t}function t1(){if(typeof globalThis<"u"&&globalThis.Deno&&globalThis.Deno.args)return!0;if((typeof window<"u"||typeof self<"u")&&typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function r1(){return 150}var cy={create:Jb,close:Xb,onMessage:e1,postMessage:Zb,canBeUsed:t1,type:Qb,averageResponseTime:r1,microSeconds:Yb};function Yi(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var n1=Lr,i1="pubkey.broadcast-channel-0-",Fr="messages",Bu={durability:"relaxed"},o1="idb";function fy(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function sp(e){e.commit&&e.commit()}function s1(e){var t=fy(),r=i1+e,n=t.open(r);return n.onupgradeneeded=function(i){var a=i.target.result;a.createObjectStore(Fr,{keyPath:"id",autoIncrement:!0})},new Promise(function(i,a){n.onerror=function(l){return a(l)},n.onsuccess=function(){i(n.result)}})}function a1(e,t,r){var n=Date.now(),i={uuid:t,time:n,data:r},a=e.transaction([Fr],"readwrite",Bu);return new Promise(function(l,f){a.oncomplete=function(){return l()},a.onerror=function(h){return f(h)};var m=a.objectStore(Fr);m.add(i),sp(a)})}function u1(e,t){var r=e.transaction(Fr,"readonly",Bu),n=r.objectStore(Fr),i=[],a=IDBKeyRange.bound(t+1,1/0);if(n.getAll){var l=n.getAll(a);return new Promise(function(m,h){l.onerror=function(g){return h(g)},l.onsuccess=function(g){m(g.target.result)}})}function f(){try{return a=IDBKeyRange.bound(t+1,1/0),n.openCursor(a)}catch{return n.openCursor()}}return new Promise(function(m,h){var g=f();g.onerror=function(v){return h(v)},g.onsuccess=function(v){var O=v.target.result;O?O.value.id<t+1?O.continue(t+1):(i.push(O.value),O.continue()):(sp(r),m(i))}})}function l1(e,t){if(e.closed)return Promise.resolve([]);var r=e.db.transaction(Fr,"readwrite",Bu),n=r.objectStore(Fr);return Promise.all(t.map(function(i){var a=n.delete(i);return new Promise(function(l){a.onsuccess=function(){return l()}})}))}function c1(e,t){var r=Date.now()-t,n=e.transaction(Fr,"readonly",Bu),i=n.objectStore(Fr),a=[];return new Promise(function(l){i.openCursor().onsuccess=function(f){var m=f.target.result;if(m){var h=m.value;h.time<r?(a.push(h),m.continue()):(sp(n),l(a))}else l(a)}})}function f1(e){return c1(e.db,e.options.idb.ttl).then(function(t){return l1(e,t.map(function(r){return r.id}))})}function p1(e,t){return t=Yi(t),s1(e).then(function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:rs(),eMIs:new fn(t.idb.ttl*2),writeBlockPromise:wr,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},py(n),n})}function py(e){e.closed||my(e).then(function(){return Fu(e.options.idb.fallbackInterval)}).then(function(){return py(e)})}function m1(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function my(e){return e.closed?wr:e.messagesCallback?u1(e.db,e.lastCursorId).then(function(t){var r=t.filter(function(n){return!!n}).map(function(n){return n.id>e.lastCursorId&&(e.lastCursorId=n.id),n}).filter(function(n){return m1(n,e)}).sort(function(n,i){return n.time-i.time});return r.forEach(function(n){e.messagesCallback&&(e.eMIs.add(n.id),e.messagesCallback(n.data))}),wr}):wr}function d1(e){e.closed=!0,e.db.close()}function h1(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return a1(e.db,e.uuid,t)}).then(function(){ly(0,10)===0&&f1(e)}),e.writeBlockPromise}function _1(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,my(e)}function g1(){return!!fy()}function y1(e){return e.idb.fallbackInterval*2}var dy={create:p1,close:d1,onMessage:_1,postMessage:h1,canBeUsed:g1,type:o1,averageResponseTime:y1,microSeconds:n1};var x1=Lr,v1="pubkey.broadcastChannel-",w1="localstorage";function hy(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function _y(e){return v1+e}function $1(e,t){return new Promise(function(r){Fu().then(function(){var n=_y(e.channelName),i={token:rs(),time:Date.now(),data:t,uuid:e.uuid},a=JSON.stringify(i);hy().setItem(n,a);var l=document.createEvent("Event");l.initEvent("storage",!0,!0),l.key=n,l.newValue=a,window.dispatchEvent(l),r()})})}function b1(e,t){var r=_y(e),n=function(a){a.key===r&&t(JSON.parse(a.newValue))};return window.addEventListener("storage",n),n}function E1(e){window.removeEventListener("storage",e)}function O1(e,t){if(t=Yi(t),!gy())throw new Error("BroadcastChannel: localstorage cannot be used");var r=rs(),n=new fn(t.localstorage.removeTimeout),i={channelName:e,uuid:r,eMIs:n};return i.listener=b1(e,function(a){i.messagesCallback&&a.uuid!==r&&(!a.token||n.has(a.token)||a.data.time&&a.data.time<i.messagesCallbackTime||(n.add(a.token),i.messagesCallback(a.data)))}),i}function S1(e){E1(e.listener)}function A1(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function gy(){var e=hy();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function k1(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var yy={create:O1,close:S1,onMessage:A1,postMessage:$1,canBeUsed:gy,type:w1,averageResponseTime:k1,microSeconds:x1};var xy=Lr,T1="simulate",ap=new Set;function I1(e){var t={time:xy(),name:e,messagesCallback:null};return ap.add(t),t}function C1(e){ap.delete(e)}var vy=5;function M1(e,t){return new Promise(function(r){return setTimeout(function(){var n=Array.from(ap);n.forEach(function(i){i.name===e.name&&i!==e&&i.messagesCallback&&i.time<t.time&&i.messagesCallback(t)}),r()},vy)})}function D1(e,t){e.messagesCallback=t}function P1(){return!0}function R1(){return vy}var wy={create:I1,close:C1,onMessage:D1,postMessage:M1,canBeUsed:P1,type:T1,averageResponseTime:R1,microSeconds:xy};var $y=[cy,dy,yy];function by(e){var t=[].concat(e.methods,$y).filter(Boolean);if(e.type){if(e.type==="simulate")return wy;var r=t.find(function(i){return i.type===e.type});if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter(function(i){return i.type!=="idb"}));var n=t.find(function(i){return i.canBeUsed()});if(n)return n;throw new Error("No usable method found in "+JSON.stringify($y.map(function(i){return i.type})))}var up=new Set,N1=0,ns=function(t,r){this.id=N1++,up.add(this),this.name=t,Ey&&(r=Ey),this.options=Yi(r),this.method=by(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,L1(this)};ns._pubkey=!0;var Ey;ns.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(t));return Oy(this,"message",t)},postInternal:function(t){return Oy(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),r={time:t,fn:e};Ay(this,"message",this._onML),e&&typeof e=="function"?(this._onML=r,Sy(this,"message",r)):this._onML=null},addEventListener:function(t,r){var n=this.method.microSeconds(),i={time:n,fn:r};Sy(this,t,i)},removeEventListener:function(t,r){var n=this._addEL[t].find(function(i){return i.fn===r});Ay(this,t,n)},close:function(){var t=this;if(!this.closed){up.delete(this),this.closed=!0;var r=this._prepP?this._prepP:wr;return this._onML=null,this._addEL.message=[],r.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(n){return n()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function Oy(e,t,r){var n=e.method.microSeconds(),i={time:n,type:t,data:r},a=e._prepP?e._prepP:wr;return a.then(function(){var l=e.method.postMessage(e._state,i);return e._uMP.add(l),l.catch().then(function(){return e._uMP.delete(l)}),l})}function L1(e){var t=e.method.create(e.name,e.options);uy(t)?(e._prepP=t,t.then(function(r){e._state=r})):e._state=t}function ky(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Sy(e,t,r){e._addEL[t].push(r),F1(e)}function Ay(e,t,r){e._addEL[t]=e._addEL[t].filter(function(n){return n!==r}),B1(e)}function F1(e){if(!e._iL&&ky(e)){var t=function(i){e._addEL[i.type].forEach(function(a){i.time>=a.time&&a.fn(i.data)})},r=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,r)}):(e._iL=!0,e.method.onMessage(e._state,t,r))}}function B1(e){if(e._iL&&!ky(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}var ju=new Map;function j1(e,t,r,n){var i=ju.get(t);return i||(i={bc:new ns(["RxDB:",e,r].join("|")),refs:new Set},ju.set(t,i)),i.refs.add(n),i.bc}function Ty(e,t){var r=ju.get(e);if(r&&(r.refs.delete(t),r.refs.size===0))return ju.delete(e),r.bc.close()}function Iy(e,t,r,n){if(t.multiInstance){var i=n||j1(e,t.databaseInstanceToken,r.databaseName,r),a=new ut,l=O=>{O.storageName===e&&O.databaseName===t.databaseName&&O.collectionName===t.collectionName&&O.version===t.schema.version&&a.next(O.eventBulk)};i.addEventListener("message",l);var f=r.changeStream(),m=!1,h=f.subscribe(O=>{m||i.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:O})});r.changeStream=function(){return a.asObservable().pipe(cf(f))};var g=r.close.bind(r);r.close=async function(){return m=!0,h.unsubscribe(),i.removeEventListener("message",l),n||await Ty(t.databaseInstanceToken,r),g()};var v=r.remove.bind(r);r.remove=async function(){return m=!0,h.unsubscribe(),i.removeEventListener("message",l),n||await Ty(t.databaseInstanceToken,r),v()}}}var Ku=kv(Cy(),1),My=Symbol.for("Dexie"),is=globalThis[My]||(globalThis[My]=Ku.default);if(Ku.default.semVer!==is.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ku.default.semVer} and ${is.semVer}`);var{liveQuery:bY,mergeRanges:EY,rangesOverlap:OY,RangeSet:SY,cmp:AY,Entity:kY,PropModSymbol:TY,PropModification:IY,replacePrefix:CY,add:MY,remove:DY}=is;var os="docs",K1="changes",Dy="attachments",zu="dexie",Py=new Map,Uu=new Map;function Ry(e,t,r,n){var i="rxdb-dexie-"+e+"--"+n.version+"--"+t,a=yt(Py,i,()=>{var l=(async()=>{var f=Ae(r);f.autoOpen=!1;var m=new is(i,f),h={[os]:U1(n),[K1]:"++sequence, id",[Dy]:"id"};return m.version(1).stores(h),await m.open(),{dexieDb:m,dexieTable:m[os],dexieAttachmentsTable:m[Dy],booleanIndexes:z1(n)}})();return Py.set(i,a),Uu.set(a,0),l});return a}async function Ny(e){var t=await e,r=Uu.get(e),n=r-1;n===0?(t.dexieDb.close(),Uu.delete(e)):Uu.set(e,n)}var fp="__";function Jn(e){var t=e.split(".");if(t.length>1)return t.map(n=>Jn(n)).join(".");if(e.startsWith("|")){var r=e.substring(1);return fp+r}else return e}function Ly(e){var t=e.split(".");if(t.length>1)return t.map(n=>Ly(n)).join(".");if(e.startsWith(fp)){var r=e.substring(fp.length);return"|"+r}else return e}function Fy(e,t){if(!t)return t;var r=Ae(t);return r=pp(r),e.forEach(n=>{var i=Mr(t,n),a=i?"1":"0",l=Jn(n);Gc(r,l,a)}),r}function dp(e,t){return t&&(t=Ae(t),t=mp(t),e.forEach(r=>{var n=Mr(t,r),i=n==="1";Gc(t,r,i)}),t)}function pp(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>pp(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,n])=>{typeof n=="object"&&(n=pp(n)),t[Jn(r)]=n}),t}}function mp(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>mp(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,n])=>{(typeof n=="object"||Array.isArray(e))&&(n=mp(n)),t[Ly(r)]=n}),t}}function U1(e){var t=[],r=Ct(e.primaryKey);t.push([r]),t.push(["_deleted",r]),e.indexes&&e.indexes.forEach(a=>{var l=jo(a);t.push(l)}),t.push(["_meta.lwt",r]),t.push(["_meta.lwt"]),t=t.map(a=>a.map(l=>Jn(l)));var n=t.map(a=>a.length===1?a[0]:"["+a.join("+")+"]");n=n.filter((a,l,f)=>f.indexOf(a)===l);var i=n.join(", ");return i}async function hp(e,t){var r=await e,n=await r.dexieTable.bulkGet(t);return n.map(i=>dp(r.booleanIndexes,i))}function ss(e,t){return e+"||"+t}function z1(e){var t=new Set,r=[];return e.indexes?(e.indexes.forEach(n=>{var i=jo(n);i.forEach(a=>{if(!t.has(a)){t.add(a);var l=Dr(e,a);l.type==="boolean"&&r.push(a)}})}),r.push("_deleted"),uh(r)):r}function By(e){return e===qn?-1/0:e}function jy(e,t,r){if(e.includes(t)){var n=r===Wn||r===!0?"1":"0";return n}else return r}function Ky(e,t,r){if(!r){if(typeof window>"u")throw new Error("IDBKeyRange missing");r=window.IDBKeyRange}var n=t.startKeys.map((l,f)=>{var m=t.index[f];return jy(e,m,l)}).map(By),i=t.endKeys.map((l,f)=>{var m=t.index[f];return jy(e,m,l)}).map(By),a=r.bound(n,i,!t.inclusiveStart,!t.inclusiveEnd);return a}async function _p(e,t){var r=await e.internals,n=t.query,i=n.skip?n.skip:0,a=n.limit?n.limit:1/0,l=i+a,f=t.queryPlan,m=!1;f.selectorSatisfiedByIndex||(m=Wi(e.schema,t.query));var h=Ky(r.booleanIndexes,f,r.dexieDb._options.IDBKeyRange),g=f.index,v=[];if(await r.dexieDb.transaction("r",r.dexieTable,async E=>{var k=E.idbtrans,C=k.objectStore(os),G,J;J="["+g.map(K=>Jn(K)).join("+")+"]",G=C.index(J);var Q=G.openCursor(h);await new Promise(K=>{Q.onsuccess=function(ne){var X=ne.target.result;if(X){var fe=dp(r.booleanIndexes,X.value);(!m||m(fe))&&v.push(fe),f.sortSatisfiedByIndex&&v.length===l?K():X.continue()}else K()}})}),!f.sortSatisfiedByIndex){var O=Iu(e.schema,t.query);v=v.sort(O)}return v=v.slice(i,l),{documents:v}}async function Uy(e,t){var r=await e.internals,n=t.queryPlan,i=n.index,a=Ky(r.booleanIndexes,n,r.dexieDb._options.IDBKeyRange),l=-1;return await r.dexieDb.transaction("r",r.dexieTable,async f=>{var m=f.idbtrans,h=m.objectStore(os),g,v;v="["+i.map(E=>Jn(E)).join("+")+"]",g=h.index(v);var O=g.count(a);l=await new Promise((E,k)=>{O.onsuccess=function(){E(O.result)},O.onerror=C=>k(C)})}),l}var W1=Ke(),gp=!1,q1=function(){function e(r,n,i,a,l,f,m,h){this.changes$=new ut,this.instanceId=W1++,this.storage=r,this.databaseName=n,this.collectionName=i,this.schema=a,this.internals=l,this.options=f,this.settings=m,this.devMode=h,this.primaryPath=Ct(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(n,i){Xn(this),!gp&&(!Aa.premium||typeof Aa.premium!="string"||await Ea(Aa.premium)!==Eh)&&console.warn(["-------------- RxDB Open Core RxStorage -------------------------------","You are using the free Dexie.js based RxStorage implementation from RxDB https://rxdb.info/rx-storage-dexie.html?console=dexie ","While this is a great option, we want to let you know that there are faster storage solutions available in our premium plugins.","For professional users and production environments, we highly recommend considering these premium options to enhance performance and reliability."," https://rxdb.info/premium?console=dexie ","If you already purchased premium access you can disable this log by calling the setPremiumFlag() function from rxdb-premium/plugins/shared.","---------------------------------------------------------------------"].join(`
`)),gp=!0,n.forEach(g=>{if(!g.document._rev||g.previous&&!g.previous._rev)throw ee("SNH",{args:{row:g}})});var a=await this.internals,l={error:[]};this.devMode&&(n=n.map(g=>{var v=Qn(g.document);return{previous:g.previous,document:v}}));var f=n.map(g=>g.document[this.primaryPath]),m;if(await a.dexieDb.transaction("rw",a.dexieTable,a.dexieAttachmentsTable,async()=>{var g=new Map,v=await hp(this.internals,f);v.forEach(k=>{var C=k;return C&&g.set(C[this.primaryPath],C),C}),m=Kg(this,this.primaryPath,g,n,i),l.error=m.errors;var O=[];m.bulkInsertDocs.forEach(k=>{O.push(k.document)}),m.bulkUpdateDocs.forEach(k=>{O.push(k.document)}),O=O.map(k=>Fy(a.booleanIndexes,k)),O.length>0&&await a.dexieTable.bulkPut(O);var E=[];m.attachmentsAdd.forEach(k=>{E.push({id:ss(k.documentId,k.attachmentId),data:k.attachmentData.data})}),m.attachmentsUpdate.forEach(k=>{E.push({id:ss(k.documentId,k.attachmentId),data:k.attachmentData.data})}),await a.dexieAttachmentsTable.bulkPut(E),await a.dexieAttachmentsTable.bulkDelete(m.attachmentsRemove.map(k=>ss(k.documentId,k.attachmentId)))}),m=be(m),m.eventBulk.events.length>0){var h=be(m.newestRow).document;m.eventBulk.checkpoint={id:h[this.primaryPath],lwt:h._meta.lwt},m.eventBulk.endTime=Ke(),this.changes$.next(m.eventBulk)}return l},t.findDocumentsById=async function(n,i){Xn(this);var a=await this.internals,l=[];return await a.dexieDb.transaction("r",a.dexieTable,async()=>{var f=await hp(this.internals,n);f.forEach(m=>{m&&(!m._deleted||i)&&l.push(m)})}),l},t.query=function(n){return Xn(this),_p(this,n)},t.count=async function(n){if(n.queryPlan.selectorSatisfiedByIndex){var i=await Uy(this,n);return{count:i,mode:"fast"}}else{var a=await _p(this,n);return{count:a.documents.length,mode:"slow"}}},t.changeStream=function(){return Xn(this),this.changes$.asObservable()},t.cleanup=async function(n){Xn(this);var i=await this.internals;return await i.dexieDb.transaction("rw",i.dexieTable,async()=>{var a=Ke()-n,l=await i.dexieTable.where("_meta.lwt").below(a).toArray(),f=[];l.forEach(m=>{m._deleted==="1"&&f.push(m[this.primaryPath])}),await i.dexieTable.bulkDelete(f)}),!0},t.getAttachmentData=async function(n,i,a){Xn(this);var l=await this.internals,f=ss(n,i);return await l.dexieDb.transaction("r",l.dexieAttachmentsTable,async()=>{var m=await l.dexieAttachmentsTable.get(f);if(m)return m.data;throw new Error("attachment missing documentId: "+n+" attachmentId: "+i)})},t.remove=async function(){Xn(this);var n=await this.internals;return await n.dexieTable.clear(),this.close()},t.close=function(){return this.closed?this.closed:(this.closed=(async()=>{this.changes$.complete(),await Ny(this.internals)})(),this.closed)},t.conflictResultionTasks=function(){return new ut},t.resolveConflictResultionTask=async function(n){},e}();async function zy(e,t,r){var n=Ry(t.databaseName,t.collectionName,r,t.schema),i=new q1(e,t.databaseName,t.collectionName,t.schema,n,t.options,r,t.devMode);return await Iy(zu,t,i),Promise.resolve(i)}function Xn(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var V1=function(){function e(r){this.name=zu,this.rxdbVersion=Ko,this.settings=r}var t=e.prototype;return t.createStorageInstance=function(n){return zg(n),zy(this,n,this.settings)},e}();function Wy(e={}){var t=new V1(e);return t}function yp(e){return ay({name:e,storage:Wy()})}function xp(e,t,r){return e.addCollections({[t]:{schema:JSON.parse(r)}}).then(n=>n[t])}function vp(e,t){console.log(t);let r=e.upsert(JSON.parse(t));return console.log(r),r}function wp(e,t){return e.findOne(t).exec()}var dt=class extends B{},Ft=class extends B{},Jt=class extends B{},Wu=class extends B{},qu=class extends B{},$p=class extends B{},Vu=class extends B{constructor(t,r,n,i){super(),this.id=t,this.name=r,this.eaten=n,this.last_eaten=i}},us=class extends B{constructor(t){super(),this[0]=t}},Hu=class extends B{constructor(t){super(),this[0]=t}},Gu=class extends B{constructor(t){super(),this[0]=t}},Yu=class extends B{constructor(t){super(),this[0]=t}},Qu=class extends B{constructor(t){super(),this[0]=t}},Ju=class extends B{constructor(t){super(),this[0]=t}},Xu=class extends B{constructor(t){super(),this[0]=t}},Zu=class extends B{constructor(t){super(),this[0]=t}},bp=class extends B{},ls=class extends B{constructor(t){super(),this[0]=t}},cs=class extends B{constructor(t){super(),this[0]=t}},fs=class extends B{constructor(t){super(),this[0]=t}},ps=class extends B{constructor(t){super(),this[0]=t}},Ep=class extends B{constructor(t,r,n,i,a,l){super(),this.meals=t,this.new_meal=r,this.language=n,this.language_dropdown_open=i,this.db=a,this.collection=l}},el=class extends B{constructor(t,r){super(),this.meals=t,this.language=r}},tl=class extends B{},Op=class extends B{};function G1(e){return aa(I([["id",Dn(e.id)],["name",Dn(e.name)],["eaten",Oc(e.eaten)],["last_eaten",(()=>{let t=e.last_eaten;if(t instanceof he){let r=t[0];return sa(yc(r))}else return Dd()})()]]))}function Y1(e){return Dn(e instanceof dt?"en":e instanceof Ft?"sv":e instanceof Jt?"fr":e instanceof Wu?"de":e instanceof qu?"it":"nl")}function Q1(){let e=To(t=>{let r=(()=>{let n=yp("everyday_meals"),i=gi(n,a=>t(new te(a)));return yi(i,a=>t(new se(kt(a))))})()});return Io(e,t=>new ls(t))}function J1(){return Mn("id",ia,e=>Mn("name",ia,t=>Mn("eaten",Sd,r=>Mn("last_eaten",Ed($c(Ad,i=>_i(yd(i)))),n=>_i(new Vu(e,t,r,n))))))}function X1(){return $c(ia,t=>t==="en"?_i(new dt):t==="sv"?_i(new Ft):Od(new dt,"Language not supported"))}function Z1(){return Mn("meals",kd(J1()),e=>Mn("language",X1(),t=>_i(new el(e,t))))}function eE(e){let t=To(r=>{let n=(()=>{let i=wp(e,"current"),a=gi(i,l=>{let f=bd(l,Z1());if(f.isOk()){let m=f[0];return r(new te(m))}else return r(new se(kt(f)))});return yi(a,l=>r(new se(kt(l))))})()});return Io(t,r=>new fs(r))}function Qi(e){Wt("save_state");let t=e.collection;if(t instanceof Oe)return ct();{let r=t[0];Wt("save_state: collection");let n=(()=>{let a=aa(I([["id",Dn("current")],["meals",Ac(e.meals,G1)],["language",Y1(e.language)]]));return Md(a)})(),i=To(a=>{let l=(()=>{let f=vp(r,n),m=gi(f,h=>a(new te(void 0)));return yi(m,h=>(Wt("save_state: error"),Wt(kt(h)),a(new se(kt(h)))))})()});return Io(i,a=>new ps(a))}}function qy(e,t,r){let n=Em(e,[I([]),e],(l,f)=>f.id===t?new qs(l):new pi([me(f,l[0]),Vs(l[1],1)])),i=n[0],a=n[1];if(a.hasLength(0))return e;{let l=a.head,f=a.tail,m=nt(i);if(r instanceof tl){if(m.hasLength(0))return e;{let h=m.head,g=m.tail;return At(g,me(l,me(h,f)))}}else{if(f.hasLength(0))return e;{let h=f.head,g=f.tail;return At(m,me(h,me(l,g)))}}}}function as(e,t){return e instanceof dt&&t==="title"?"Weekly Meal Tracker":e instanceof dt&&t==="add_meal"?"Add Meal":e instanceof dt&&t==="enter_meal"?"Enter a new meal":e instanceof dt&&t==="eat"?"Eat":e instanceof dt&&t==="plan"?"Plan":e instanceof dt&&t==="eaten_meals"?"Eaten Meals":e instanceof dt&&t==="select_language"?"Select Language":e instanceof Ft&&t==="title"?"Veckans M\xE5ltidssp\xE5rare":e instanceof Ft&&t==="add_meal"?"L\xE4gg till M\xE5ltid":e instanceof Ft&&t==="enter_meal"?"Ange en ny m\xE5ltid":e instanceof Ft&&t==="eat"?"\xC4t":e instanceof Ft&&t==="plan"?"Planera":e instanceof Ft&&t==="eaten_meals"?"\xC4tna M\xE5ltider":e instanceof Ft&&t==="select_language"?"V\xE4lj Spr\xE5k":e instanceof Jt&&t==="title"?"Suivi des Repas Hebdomadaires":e instanceof Jt&&t==="add_meal"?"Ajouter un Repas":e instanceof Jt&&t==="enter_meal"?"Entrez un nouveau repas":e instanceof Jt&&t==="eat"?"Manger":e instanceof Jt&&t==="plan"?"Pr\xE9voir":e instanceof Jt&&t==="eaten_meals"?"Repas Mang\xE9s":e instanceof Jt&&t==="select_language"?"Choisir la Langue":"Translation missing"}function Ji(e,t,r){return tn(I([rn(new Yu(t)),Me("block px-4 py-2 text-sm capitalize text-gray-700 hover:bg-gray-100 w-full text-left "+(Ce(t,r)?"bg-gray-100":""))]),I([ft(e)]))}function tE(e){return dr(I([Me("fixed top-4 right-4")]),I([tn(I([rn(new bp),Me("p-2 text-gray-600 hover:text-blue-500"),Do("Select Language")]),I([nh(I([]))])),e.language_dropdown_open?dr(I([Me("absolute right-0 mt-2 py-2 w-48 bg-white rounded-md shadow-xl z-20 border")]),I([Ji("English",new dt,e.language),Ji("Svenska",new Ft,e.language),Ji("Fran\xE7ais",new Jt,e.language),Ji("Deutsch",new Wu,e.language),Ji("Italiano",new qu,e.language),Ji("Nederlands",new $p,e.language)])):ca()]))}function rE(e){return xd(e)}function Vy(e,t,r){return Jd(I([Me("p-4 border rounded flex flex-col")]),I([dr(I([Me("flex justify-between items-center w-full")]),I([dr(I([Me("flex flex-col")]),I([ft(e.name),Bc(I([Me("text-sm text-gray-500")]),I([ft((()=>{let n=e.last_eaten;if(n instanceof he){let i=n[0];return rE(i)}else return"Never eaten"})())]))])),dr(I([Me("flex items-center gap-2")]),I([t?ca():dr(I([Me("flex items-center gap-1")]),I([tn(I([rn(new Xu(e.id)),Me("p-1 text-gray-500 hover:text-blue-500"),Do("Move up")]),I([ft("\u2B06\uFE0F")])),tn(I([rn(new Zu(e.id)),Me("p-1 text-gray-500 hover:text-blue-500"),Do("Move down")]),I([ft("\u2B07\uFE0F")]))])),tn(I([rn(new Gu(e.id)),Me(t?"px-3 py-1 border border-gray-300 rounded":"px-3 py-1 bg-green-500 text-white rounded")]),I([ft(as(r,t?"plan":"eat"))])),tn(I([rn(new Ju(e.id)),Me("p-1 text-gray-500 hover:text-red-500"),Do("Delete meal")]),I([Bc(I([Me("text-xl")]),I([ft("\u{1F5D1}\uFE0F")]))]))]))]))]))}function nE(e){let t=Sr(e.meals,n=>!n.eaten),r=Sr(e.meals,n=>n.eaten);return dr(I([Me("max-w-md mx-auto p-4 relative")]),I([tE(e),Yd(I([Me("text-2xl font-bold mb-4")]),I([ft("\u{1F958} "+as(e.language,"title"))])),dr(I([Me("flex mb-4")]),I([Xd(I([Bd("text"),jd(e.new_meal),Kd(as(e.language,"enter_meal")),eh(n=>new Hu(n)),Zd(n=>new Qu(n)),Me("mr-2 p-2 border rounded")])),tn(I([rn(new us(e.new_meal)),Me("px-4 py-2 bg-blue-500 text-white rounded")]),I([ft(as(e.language,"add_meal"))]))])),Fc(I([Me("space-y-2")]),je(t,n=>Vy(n,!1,e.language))),r.hasLength(0)?ca():dr(I([]),I([Qd(I([Me("text-lg font-semibold mt-6 mb-2")]),I([ft(as(e.language,"eaten_meals"))])),Fc(I([Me("space-y-2")]),je(r,n=>Vy(n,!0,e.language)))]))]))}var iE=`{
  "version": 0,
  "primaryKey": "id",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "maxLength": 100
    },
    "meals": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "eaten": { "type": "boolean" },
          "lastEaten": { "type": "number", "optional": true }
        }
      }
    },
    "language": { "type": "string" }
  }
}`;function oE(e){let t=To(r=>{let n=(()=>{let i=xp(e,"state",iE),a=gi(i,l=>r(new te(l)));return yi(a,l=>r(new se(kt(l))))})()});return Io(t,r=>new cs(r))}function sE(e,t){for(;;){let r=e,n=t;if(n instanceof ls&&n[0].isOk()){let i=n[0][0];return[r.withFields({db:new he(i)}),oE(i)]}else if(n instanceof ls&&!n[0].isOk()){let i=n[0][0];return[r,ct()]}else if(n instanceof cs&&n[0].isOk()){let i=n[0][0];return[r.withFields({collection:new he(i)}),eE(i)]}else if(n instanceof cs&&!n[0].isOk()){let i=n[0][0];return Wt(i),[r,ct()]}else if(n instanceof fs&&n[0].isOk()&&n[0][0]instanceof el){let i=n[0][0].meals,a=n[0][0].language;return Wt("StateLoaded: Ok"),Wt(kt(i)),[r.withFields({meals:i,language:a}),ct()]}else if(n instanceof fs&&!n[0].isOk()){let i=n[0][0];return Wt(i),[r,ct()]}else{if(n instanceof ps&&n[0].isOk()&&!n[0][0])return Wt("StateSaved: Ok"),[r,ct()];if(n instanceof ps&&!n[0].isOk()){let i=n[0][0];return Wt(i),[r,ct()]}else if(n instanceof us){let i=n[0];if(Zl(i)==="")return[r,ct()];{let l=new Vu(kt(yc(xc())),i,!1,new Oe),f=r.withFields({meals:At(r.meals,I([l])),new_meal:""});return[f,Qi(f)]}}else if(n instanceof Hu){let i=n[0];return[r.withFields({new_meal:i}),ct()]}else if(n instanceof Gu){let i=n[0],a=xc(),l=je(r.meals,h=>h.id===i?h.withFields({eaten:!h.eaten,last_eaten:h.eaten?h.last_eaten:new he(a)}):h),f=(()=>{let h=Sr(l,g=>!g.eaten);return $m(h)})();if(f<7){let h=7-f,g=Sr(l,C=>C.eaten),v=Sr(l,C=>!C.eaten),O=(()=>{let G=bm(g,h);return je(G,J=>J.withFields({eaten:!1}))})(),E=Vs(g,h),k=(()=>{let C=At(v,O);return At(C,E)})();return[r.withFields({meals:k}),Qi(r)]}else return[r.withFields({meals:l}),Qi(r)]}else if(n instanceof Yu){let i=n[0];return[r.withFields({language:i}),ct()]}else if(n instanceof Qu)if(n[0]==="Enter")e=r,t=new us(r.new_meal);else return[r,ct()];else if(n instanceof Ju){let i=n[0],a=Sr(r.meals,f=>f.id!==i),l=r.withFields({meals:a});return[l,Qi(l)]}else if(n instanceof Xu){let i=n[0],a=qy(r.meals,i,new tl),l=r.withFields({meals:a});return[l,Qi(l)]}else if(n instanceof Zu){let i=n[0],a=qy(r.meals,i,new Op),l=r.withFields({meals:a});return[l,Qi(l)]}else return[r.withFields({language_dropdown_open:!r.language_dropdown_open}),ct()]}}}function Hy(){let t=Hd(n=>[new Ep(I([]),"",new dt,!1,new Oe,new Oe),Q1()],sE,nE),r=Gd(t,"#app",void 0);if(!r.isOk())throw ui("let_assert","everyday_meals",656,"main","Pattern match failed, no pattern matched the value.",{value:r})}Hy();
/*! Bundled license information:

dexie/dist/dexie.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
